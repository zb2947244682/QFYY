var ci=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);import{r as g,a as di,R as qs,L as As,u as Ke,b as ui,O as hi,B as fi,c as mi,d as Ce}from"./react-vendor-RGTUMA6Z.js";import{l as Xs,c as pi}from"./game-vendor-B_MNHd1B.js";var Yu=ci((th,Et)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();var Dr={exports:{}},ns={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gi=g,xi=Symbol.for("react.element"),yi=Symbol.for("react.fragment"),vi=Object.prototype.hasOwnProperty,bi=gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wi={key:!0,ref:!0,__self:!0,__source:!0};function Lr(e,t,s){var n,o={},i=null,a=null;s!==void 0&&(i=""+s),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)vi.call(t,n)&&!wi.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:xi,type:e,key:i,ref:a,props:o,_owner:bi.current}}ns.Fragment=yi;ns.jsx=Lr;ns.jsxs=Lr;Dr.exports=ns;var r=Dr.exports,Vs={},vn=di;Vs.createRoot=vn.createRoot,Vs.hydrateRoot=vn.hydrateRoot;const Ir=g.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),rs=g.createContext({}),os=g.createContext(null),is=typeof document<"u",Ks=is?g.useLayoutEffect:g.useEffect,Fr=g.createContext({strict:!1}),Ys=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ji="framerAppearId",Br="data-"+Ys(ji);function Ni(e,t,s,n){const{visualElement:o}=g.useContext(rs),i=g.useContext(Fr),a=g.useContext(os),l=g.useContext(Ir).reducedMotion,c=g.useRef();n=n||i.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:o,props:s,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;g.useInsertionEffect(()=>{d&&d.update(s,a)});const u=g.useRef(!!(s[Br]&&!window.HandoffComplete));return Ks(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),g.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function it(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Si(e,t,s){return g.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),s&&(typeof s=="function"?s(n):it(s)&&(s.current=n))},[t])}function Tt(e){return typeof e=="string"||Array.isArray(e)}function as(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Zs=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Js=["initial",...Zs];function ls(e){return as(e.animate)||Js.some(t=>Tt(e[t]))}function Or(e){return!!(ls(e)||e.variants)}function Ci(e,t){if(ls(e)){const{initial:s,animate:n}=e;return{initial:s===!1||Tt(s)?s:void 0,animate:Tt(n)?n:void 0}}return e.inherit!==!1?t:{}}function Ti(e){const{initial:t,animate:s}=Ci(e,g.useContext(rs));return g.useMemo(()=>({initial:t,animate:s}),[bn(t),bn(s)])}function bn(e){return Array.isArray(e)?e.join(" "):e}const wn={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Pt={};for(const e in wn)Pt[e]={isEnabled:t=>wn[e].some(s=>!!t[s])};function Pi(e){for(const t in e)Pt[t]={...Pt[t],...e[t]}}const Qs=g.createContext({}),zr=g.createContext({}),ki=Symbol.for("motionComponentSymbol");function Mi({preloadedFeatures:e,createVisualElement:t,useRender:s,useVisualState:n,Component:o}){e&&Pi(e);function i(l,c){let d;const u={...g.useContext(Ir),...l,layoutId:Ri(l)},{isStatic:h}=u,p=Ti(l),x=n(l,h);if(!h&&is){p.visualElement=Ni(o,x,u,t);const j=g.useContext(zr),b=g.useContext(Fr).strict;p.visualElement&&(d=p.visualElement.loadFeatures(u,b,e,j))}return g.createElement(rs.Provider,{value:p},d&&p.visualElement?g.createElement(d,{visualElement:p.visualElement,...u}):null,s(o,l,Si(x,p.visualElement,c),x,h,p.visualElement))}const a=g.forwardRef(i);return a[ki]=o,a}function Ri({layoutId:e}){const t=g.useContext(Qs).id;return t&&e!==void 0?t+"-"+e:e}function Ai(e){function t(n,o={}){return Mi(e(n,o))}if(typeof Proxy>"u")return t;const s=new Map;return new Proxy(t,{get:(n,o)=>(s.has(o)||s.set(o,t(o)),s.get(o))})}const Vi=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function en(e){return typeof e!="string"||e.includes("-")?!1:!!(Vi.indexOf(e)>-1||/[A-Z]/.test(e))}const Kt={};function Ei(e){Object.assign(Kt,e)}const Mt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ye=new Set(Mt);function $r(e,{layout:t,layoutId:s}){return Ye.has(e)||e.startsWith("origin")||(t||s!==void 0)&&(!!Kt[e]||e==="opacity")}const pe=e=>!!(e&&e.getVelocity),Di={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Li=Mt.length;function Ii(e,{enableHardwareAcceleration:t=!0,allowTransformNone:s=!0},n,o){let i="";for(let a=0;a<Li;a++){const l=Mt[a];if(e[l]!==void 0){const c=Di[l]||l;i+=`${c}(${e[l]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),o?i=o(e,n?"":i):s&&n&&(i="none"),i}const Ur=e=>t=>typeof t=="string"&&t.startsWith(e),Hr=Ur("--"),Es=Ur("var(--"),Fi=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Bi=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Fe=(e,t,s)=>Math.min(Math.max(s,e),t),Ze={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},jt={...Ze,transform:e=>Fe(0,1,e)},Bt={...Ze,default:1},Nt=e=>Math.round(e*1e5)/1e5,cs=/(-)?([\d]*\.?[\d])+/g,Gr=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Oi=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Rt(e){return typeof e=="string"}const At=e=>({test:t=>Rt(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),De=At("deg"),Pe=At("%"),J=At("px"),zi=At("vh"),$i=At("vw"),jn={...Pe,parse:e=>Pe.parse(e)/100,transform:e=>Pe.transform(e*100)},Nn={...Ze,transform:Math.round},_r={borderWidth:J,borderTopWidth:J,borderRightWidth:J,borderBottomWidth:J,borderLeftWidth:J,borderRadius:J,radius:J,borderTopLeftRadius:J,borderTopRightRadius:J,borderBottomRightRadius:J,borderBottomLeftRadius:J,width:J,maxWidth:J,height:J,maxHeight:J,size:J,top:J,right:J,bottom:J,left:J,padding:J,paddingTop:J,paddingRight:J,paddingBottom:J,paddingLeft:J,margin:J,marginTop:J,marginRight:J,marginBottom:J,marginLeft:J,rotate:De,rotateX:De,rotateY:De,rotateZ:De,scale:Bt,scaleX:Bt,scaleY:Bt,scaleZ:Bt,skew:De,skewX:De,skewY:De,distance:J,translateX:J,translateY:J,translateZ:J,x:J,y:J,z:J,perspective:J,transformPerspective:J,opacity:jt,originX:jn,originY:jn,originZ:J,zIndex:Nn,fillOpacity:jt,strokeOpacity:jt,numOctaves:Nn};function tn(e,t,s,n){const{style:o,vars:i,transform:a,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const h in t){const p=t[h];if(Hr(h)){i[h]=p;continue}const x=_r[h],j=Bi(p,x);if(Ye.has(h)){if(c=!0,a[h]=j,!u)continue;p!==(x.default||0)&&(u=!1)}else h.startsWith("origin")?(d=!0,l[h]=j):o[h]=j}if(t.transform||(c||n?o.transform=Ii(e.transform,s,u,n):o.transform&&(o.transform="none")),d){const{originX:h="50%",originY:p="50%",originZ:x=0}=l;o.transformOrigin=`${h} ${p} ${x}`}}const sn=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Wr(e,t,s){for(const n in t)!pe(t[n])&&!$r(n,s)&&(e[n]=t[n])}function Ui({transformTemplate:e},t,s){return g.useMemo(()=>{const n=sn();return tn(n,t,{enableHardwareAcceleration:!s},e),Object.assign({},n.vars,n.style)},[t])}function Hi(e,t,s){const n=e.style||{},o={};return Wr(o,n,e),Object.assign(o,Ui(e,t,s)),e.transformValues?e.transformValues(o):o}function Gi(e,t,s){const n={},o=Hi(e,t,s);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=o,n}const _i=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Yt(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||_i.has(e)}let qr=e=>!Yt(e);function Wi(e){e&&(qr=t=>t.startsWith("on")?!Yt(t):e(t))}try{Wi(require("@emotion/is-prop-valid").default)}catch{}function qi(e,t,s){const n={};for(const o in e)o==="values"&&typeof e.values=="object"||(qr(o)||s===!0&&Yt(o)||!t&&!Yt(o)||e.draggable&&o.startsWith("onDrag"))&&(n[o]=e[o]);return n}function Sn(e,t,s){return typeof e=="string"?e:J.transform(t+s*e)}function Xi(e,t,s){const n=Sn(t,e.x,e.width),o=Sn(s,e.y,e.height);return`${n} ${o}`}const Ki={offset:"stroke-dashoffset",array:"stroke-dasharray"},Yi={offset:"strokeDashoffset",array:"strokeDasharray"};function Zi(e,t,s=1,n=0,o=!0){e.pathLength=1;const i=o?Ki:Yi;e[i.offset]=J.transform(-n);const a=J.transform(t),l=J.transform(s);e[i.array]=`${a} ${l}`}function nn(e,{attrX:t,attrY:s,attrScale:n,originX:o,originY:i,pathLength:a,pathSpacing:l=1,pathOffset:c=0,...d},u,h,p){if(tn(e,d,u,p),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:x,style:j,dimensions:b}=e;x.transform&&(b&&(j.transform=x.transform),delete x.transform),b&&(o!==void 0||i!==void 0||j.transform)&&(j.transformOrigin=Xi(b,o!==void 0?o:.5,i!==void 0?i:.5)),t!==void 0&&(x.x=t),s!==void 0&&(x.y=s),n!==void 0&&(x.scale=n),a!==void 0&&Zi(x,a,l,c,!1)}const Xr=()=>({...sn(),attrs:{}}),rn=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Ji(e,t,s,n){const o=g.useMemo(()=>{const i=Xr();return nn(i,t,{enableHardwareAcceleration:!1},rn(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};Wr(i,e.style,e),o.style={...i,...o.style}}return o}function Qi(e=!1){return(s,n,o,{latestValues:i},a)=>{const c=(en(s)?Ji:Gi)(n,i,a,s),u={...qi(n,typeof s=="string",e),...c,ref:o},{children:h}=n,p=g.useMemo(()=>pe(h)?h.get():h,[h]);return g.createElement(s,{...u,children:p})}}function Kr(e,{style:t,vars:s},n,o){Object.assign(e.style,t,o&&o.getProjectionStyles(n));for(const i in s)e.style.setProperty(i,s[i])}const Yr=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Zr(e,t,s,n){Kr(e,t,void 0,n);for(const o in t.attrs)e.setAttribute(Yr.has(o)?o:Ys(o),t.attrs[o])}function on(e,t){const{style:s}=e,n={};for(const o in s)(pe(s[o])||t.style&&pe(t.style[o])||$r(o,e))&&(n[o]=s[o]);return n}function Jr(e,t){const s=on(e,t);for(const n in e)if(pe(e[n])||pe(t[n])){const o=Mt.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;s[o]=e[n]}return s}function an(e,t,s,n={},o={}){return typeof t=="function"&&(t=t(s!==void 0?s:e.custom,n,o)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(s!==void 0?s:e.custom,n,o)),t}function Qr(e){const t=g.useRef(null);return t.current===null&&(t.current=e()),t.current}const Zt=e=>Array.isArray(e),ea=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),ta=e=>Zt(e)?e[e.length-1]||0:e;function qt(e){const t=pe(e)?e.get():e;return ea(t)?t.toValue():t}function sa({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:s},n,o,i){const a={latestValues:na(n,o,i,e),renderState:t()};return s&&(a.mount=l=>s(n,l,a)),a}const eo=e=>(t,s)=>{const n=g.useContext(rs),o=g.useContext(os),i=()=>sa(e,t,n,o);return s?i():Qr(i)};function na(e,t,s,n){const o={},i=n(e,{});for(const p in i)o[p]=qt(i[p]);let{initial:a,animate:l}=e;const c=ls(e),d=Or(e);t&&d&&!c&&e.inherit!==!1&&(a===void 0&&(a=t.initial),l===void 0&&(l=t.animate));let u=s?s.initial===!1:!1;u=u||a===!1;const h=u?l:a;return h&&typeof h!="boolean"&&!as(h)&&(Array.isArray(h)?h:[h]).forEach(x=>{const j=an(e,x);if(!j)return;const{transitionEnd:b,transition:w,...A}=j;for(const k in A){let S=A[k];if(Array.isArray(S)){const I=u?S.length-1:0;S=S[I]}S!==null&&(o[k]=S)}for(const k in b)o[k]=b[k]}),o}const ae=e=>e;class Cn{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const s=this.order.indexOf(t);s!==-1&&(this.order.splice(s,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function ra(e){let t=new Cn,s=new Cn,n=0,o=!1,i=!1;const a=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const h=u&&o,p=h?t:s;return d&&a.add(c),p.add(c)&&h&&o&&(n=t.order.length),c},cancel:c=>{s.remove(c),a.delete(c)},process:c=>{if(o){i=!0;return}if(o=!0,[t,s]=[s,t],s.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),a.has(u)&&(l.schedule(u),e())}o=!1,i&&(i=!1,l.process(c))}};return l}const Ot=["prepare","read","update","preRender","render","postRender"],oa=40;function ia(e,t){let s=!1,n=!0;const o={delta:0,timestamp:0,isProcessing:!1},i=Ot.reduce((h,p)=>(h[p]=ra(()=>s=!0),h),{}),a=h=>i[h].process(o),l=()=>{const h=performance.now();s=!1,o.delta=n?1e3/60:Math.max(Math.min(h-o.timestamp,oa),1),o.timestamp=h,o.isProcessing=!0,Ot.forEach(a),o.isProcessing=!1,s&&t&&(n=!1,e(l))},c=()=>{s=!0,n=!0,o.isProcessing||e(l)};return{schedule:Ot.reduce((h,p)=>{const x=i[p];return h[p]=(j,b=!1,w=!1)=>(s||c(),x.schedule(j,b,w)),h},{}),cancel:h=>Ot.forEach(p=>i[p].cancel(h)),state:o,steps:i}}const{schedule:ne,cancel:Ve,state:ue,steps:ms}=ia(typeof requestAnimationFrame<"u"?requestAnimationFrame:ae,!0),aa={useVisualState:eo({scrapeMotionValuesFromProps:Jr,createRenderState:Xr,onMount:(e,t,{renderState:s,latestValues:n})=>{ne.read(()=>{try{s.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}),ne.render(()=>{nn(s,n,{enableHardwareAcceleration:!1},rn(t.tagName),e.transformTemplate),Zr(t,s)})}})},la={useVisualState:eo({scrapeMotionValuesFromProps:on,createRenderState:sn})};function ca(e,{forwardMotionProps:t=!1},s,n){return{...en(e)?aa:la,preloadedFeatures:s,useRender:Qi(t),createVisualElement:n,Component:e}}function Me(e,t,s,n={passive:!0}){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s)}const to=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function ds(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const da=e=>t=>to(t)&&e(t,ds(t));function Re(e,t,s,n){return Me(e,t,da(s),n)}const ua=(e,t)=>s=>t(e(s)),Ie=(...e)=>e.reduce(ua);function so(e){let t=null;return()=>{const s=()=>{t=null};return t===null?(t=e,s):!1}}const Tn=so("dragHorizontal"),Pn=so("dragVertical");function no(e){let t=!1;if(e==="y")t=Pn();else if(e==="x")t=Tn();else{const s=Tn(),n=Pn();s&&n?t=()=>{s(),n()}:(s&&s(),n&&n())}return t}function ro(){const e=no(!0);return e?(e(),!1):!0}class Oe{constructor(t){this.isMounted=!1,this.node=t}update(){}}function kn(e,t){const s="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),o=(i,a)=>{if(i.pointerType==="touch"||ro())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&ne.update(()=>l[n](i,a))};return Re(e.current,s,o,{passive:!e.getProps()[n]})}class ha extends Oe{mount(){this.unmount=Ie(kn(this.node,!0),kn(this.node,!1))}unmount(){}}class fa extends Oe{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ie(Me(this.node.current,"focus",()=>this.onFocus()),Me(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const oo=(e,t)=>t?e===t?!0:oo(e,t.parentElement):!1;function ps(e,t){if(!t)return;const s=new PointerEvent("pointer"+e);t(s,ds(s))}class ma extends Oe{constructor(){super(...arguments),this.removeStartListeners=ae,this.removeEndListeners=ae,this.removeAccessibleListeners=ae,this.startPointerPress=(t,s)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Re(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:h}=this.node.getProps();ne.update(()=>{!h&&!oo(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),a=Re(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Ie(i,a),this.startPress(t,s)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const a=l=>{l.key!=="Enter"||!this.checkPressEnd()||ps("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&ne.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=Me(this.node.current,"keyup",a),ps("down",(l,c)=>{this.startPress(l,c)})},s=Me(this.node.current,"keydown",t),n=()=>{this.isPressing&&ps("cancel",(i,a)=>this.cancelPress(i,a))},o=Me(this.node.current,"blur",n);this.removeAccessibleListeners=Ie(s,o)}}startPress(t,s){this.isPressing=!0;const{onTapStart:n,whileTap:o}=this.node.getProps();o&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&ne.update(()=>n(t,s))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!ro()}cancelPress(t,s){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&ne.update(()=>n(t,s))}mount(){const t=this.node.getProps(),s=Re(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Me(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Ie(s,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Ds=new WeakMap,gs=new WeakMap,pa=e=>{const t=Ds.get(e.target);t&&t(e)},ga=e=>{e.forEach(pa)};function xa({root:e,...t}){const s=e||document;gs.has(s)||gs.set(s,{});const n=gs.get(s),o=JSON.stringify(t);return n[o]||(n[o]=new IntersectionObserver(ga,{root:e,...t})),n[o]}function ya(e,t,s){const n=xa(t);return Ds.set(e,s),n.observe(e),()=>{Ds.delete(e),n.unobserve(e)}}const va={some:0,all:1};class ba extends Oe{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:s,margin:n,amount:o="some",once:i}=t,a={root:s?s.current:void 0,rootMargin:n,threshold:typeof o=="number"?o:va[o]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),p=d?u:h;p&&p(c)};return ya(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:s}=this.node;["amount","margin","root"].some(wa(t,s))&&this.startObserver()}unmount(){}}function wa({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}const ja={inView:{Feature:ba},tap:{Feature:ma},focus:{Feature:fa},hover:{Feature:ha}};function io(e,t){if(!Array.isArray(t))return!1;const s=t.length;if(s!==e.length)return!1;for(let n=0;n<s;n++)if(t[n]!==e[n])return!1;return!0}function Na(e){const t={};return e.values.forEach((s,n)=>t[n]=s.get()),t}function Sa(e){const t={};return e.values.forEach((s,n)=>t[n]=s.getVelocity()),t}function us(e,t,s){const n=e.getProps();return an(n,t,s!==void 0?s:n.custom,Na(e),Sa(e))}let ln=ae;const Xe=e=>e*1e3,Ae=e=>e/1e3,Ca={current:!1},ao=e=>Array.isArray(e)&&typeof e[0]=="number";function lo(e){return!!(!e||typeof e=="string"&&co[e]||ao(e)||Array.isArray(e)&&e.every(lo))}const bt=([e,t,s,n])=>`cubic-bezier(${e}, ${t}, ${s}, ${n})`,co={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:bt([0,.65,.55,1]),circOut:bt([.55,0,1,.45]),backIn:bt([.31,.01,.66,-.59]),backOut:bt([.33,1.53,.69,.99])};function uo(e){if(e)return ao(e)?bt(e):Array.isArray(e)?e.map(uo):co[e]}function Ta(e,t,s,{delay:n=0,duration:o,repeat:i=0,repeatType:a="loop",ease:l,times:c}={}){const d={[t]:s};c&&(d.offset=c);const u=uo(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:o,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"})}function Pa(e,{repeat:t,repeatType:s="loop"}){const n=t&&s!=="loop"&&t%2===1?0:e.length-1;return e[n]}const ho=(e,t,s)=>(((1-3*s+3*t)*e+(3*s-6*t))*e+3*t)*e,ka=1e-7,Ma=12;function Ra(e,t,s,n,o){let i,a,l=0;do a=t+(s-t)/2,i=ho(a,n,o)-e,i>0?s=a:t=a;while(Math.abs(i)>ka&&++l<Ma);return a}function Vt(e,t,s,n){if(e===t&&s===n)return ae;const o=i=>Ra(i,0,1,e,s);return i=>i===0||i===1?i:ho(o(i),t,n)}const Aa=Vt(.42,0,1,1),Va=Vt(0,0,.58,1),fo=Vt(.42,0,.58,1),Ea=e=>Array.isArray(e)&&typeof e[0]!="number",mo=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,po=e=>t=>1-e(1-t),cn=e=>1-Math.sin(Math.acos(e)),go=po(cn),Da=mo(cn),xo=Vt(.33,1.53,.69,.99),dn=po(xo),La=mo(dn),Ia=e=>(e*=2)<1?.5*dn(e):.5*(2-Math.pow(2,-10*(e-1))),Fa={linear:ae,easeIn:Aa,easeInOut:fo,easeOut:Va,circIn:cn,circInOut:Da,circOut:go,backIn:dn,backInOut:La,backOut:xo,anticipate:Ia},Mn=e=>{if(Array.isArray(e)){ln(e.length===4);const[t,s,n,o]=e;return Vt(t,s,n,o)}else if(typeof e=="string")return Fa[e];return e},un=(e,t)=>s=>!!(Rt(s)&&Oi.test(s)&&s.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(s,t)),yo=(e,t,s)=>n=>{if(!Rt(n))return n;const[o,i,a,l]=n.match(cs);return{[e]:parseFloat(o),[t]:parseFloat(i),[s]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},Ba=e=>Fe(0,255,e),xs={...Ze,transform:e=>Math.round(Ba(e))},qe={test:un("rgb","red"),parse:yo("red","green","blue"),transform:({red:e,green:t,blue:s,alpha:n=1})=>"rgba("+xs.transform(e)+", "+xs.transform(t)+", "+xs.transform(s)+", "+Nt(jt.transform(n))+")"};function Oa(e){let t="",s="",n="",o="";return e.length>5?(t=e.substring(1,3),s=e.substring(3,5),n=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),s=e.substring(2,3),n=e.substring(3,4),o=e.substring(4,5),t+=t,s+=s,n+=n,o+=o),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:o?parseInt(o,16)/255:1}}const Ls={test:un("#"),parse:Oa,transform:qe.transform},at={test:un("hsl","hue"),parse:yo("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:s,alpha:n=1})=>"hsla("+Math.round(e)+", "+Pe.transform(Nt(t))+", "+Pe.transform(Nt(s))+", "+Nt(jt.transform(n))+")"},fe={test:e=>qe.test(e)||Ls.test(e)||at.test(e),parse:e=>qe.test(e)?qe.parse(e):at.test(e)?at.parse(e):Ls.parse(e),transform:e=>Rt(e)?e:e.hasOwnProperty("red")?qe.transform(e):at.transform(e)},oe=(e,t,s)=>-s*e+s*t+e;function ys(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(t-e)*6*s:s<1/2?t:s<2/3?e+(t-e)*(2/3-s)*6:e}function za({hue:e,saturation:t,lightness:s,alpha:n}){e/=360,t/=100,s/=100;let o=0,i=0,a=0;if(!t)o=i=a=s;else{const l=s<.5?s*(1+t):s+t-s*t,c=2*s-l;o=ys(c,l,e+1/3),i=ys(c,l,e),a=ys(c,l,e-1/3)}return{red:Math.round(o*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:n}}const vs=(e,t,s)=>{const n=e*e;return Math.sqrt(Math.max(0,s*(t*t-n)+n))},$a=[Ls,qe,at],Ua=e=>$a.find(t=>t.test(e));function Rn(e){const t=Ua(e);let s=t.parse(e);return t===at&&(s=za(s)),s}const vo=(e,t)=>{const s=Rn(e),n=Rn(t),o={...s};return i=>(o.red=vs(s.red,n.red,i),o.green=vs(s.green,n.green,i),o.blue=vs(s.blue,n.blue,i),o.alpha=oe(s.alpha,n.alpha,i),qe.transform(o))};function Ha(e){var t,s;return isNaN(e)&&Rt(e)&&(((t=e.match(cs))===null||t===void 0?void 0:t.length)||0)+(((s=e.match(Gr))===null||s===void 0?void 0:s.length)||0)>0}const bo={regex:Fi,countKey:"Vars",token:"${v}",parse:ae},wo={regex:Gr,countKey:"Colors",token:"${c}",parse:fe.parse},jo={regex:cs,countKey:"Numbers",token:"${n}",parse:Ze.parse};function bs(e,{regex:t,countKey:s,token:n,parse:o}){const i=e.tokenised.match(t);i&&(e["num"+s]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(o)))}function Jt(e){const t=e.toString(),s={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return s.value.includes("var(--")&&bs(s,bo),bs(s,wo),bs(s,jo),s}function No(e){return Jt(e).values}function So(e){const{values:t,numColors:s,numVars:n,tokenised:o}=Jt(e),i=t.length;return a=>{let l=o;for(let c=0;c<i;c++)c<n?l=l.replace(bo.token,a[c]):c<n+s?l=l.replace(wo.token,fe.transform(a[c])):l=l.replace(jo.token,Nt(a[c]));return l}}const Ga=e=>typeof e=="number"?0:e;function _a(e){const t=No(e);return So(e)(t.map(Ga))}const Be={test:Ha,parse:No,createTransformer:So,getAnimatableNone:_a},Co=(e,t)=>s=>`${s>0?t:e}`;function To(e,t){return typeof e=="number"?s=>oe(e,t,s):fe.test(e)?vo(e,t):e.startsWith("var(")?Co(e,t):ko(e,t)}const Po=(e,t)=>{const s=[...e],n=s.length,o=e.map((i,a)=>To(i,t[a]));return i=>{for(let a=0;a<n;a++)s[a]=o[a](i);return s}},Wa=(e,t)=>{const s={...e,...t},n={};for(const o in s)e[o]!==void 0&&t[o]!==void 0&&(n[o]=To(e[o],t[o]));return o=>{for(const i in n)s[i]=n[i](o);return s}},ko=(e,t)=>{const s=Be.createTransformer(t),n=Jt(e),o=Jt(t);return n.numVars===o.numVars&&n.numColors===o.numColors&&n.numNumbers>=o.numNumbers?Ie(Po(n.values,o.values),s):Co(e,t)},kt=(e,t,s)=>{const n=t-e;return n===0?1:(s-e)/n},An=(e,t)=>s=>oe(e,t,s);function qa(e){return typeof e=="number"?An:typeof e=="string"?fe.test(e)?vo:ko:Array.isArray(e)?Po:typeof e=="object"?Wa:An}function Xa(e,t,s){const n=[],o=s||qa(e[0]),i=e.length-1;for(let a=0;a<i;a++){let l=o(e[a],e[a+1]);if(t){const c=Array.isArray(t)?t[a]||ae:t;l=Ie(c,l)}n.push(l)}return n}function Mo(e,t,{clamp:s=!0,ease:n,mixer:o}={}){const i=e.length;if(ln(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=Xa(t,n,o),l=a.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const h=kt(e[u],e[u+1],d);return a[u](h)};return s?d=>c(Fe(e[0],e[i-1],d)):c}function Ka(e,t){const s=e[e.length-1];for(let n=1;n<=t;n++){const o=kt(0,t,n);e.push(oe(s,1,o))}}function Ya(e){const t=[0];return Ka(t,e.length-1),t}function Za(e,t){return e.map(s=>s*t)}function Ja(e,t){return e.map(()=>t||fo).splice(0,e.length-1)}function Qt({duration:e=300,keyframes:t,times:s,ease:n="easeInOut"}){const o=Ea(n)?n.map(Mn):Mn(n),i={done:!1,value:t[0]},a=Za(s&&s.length===t.length?s:Ya(t),e),l=Mo(a,t,{ease:Array.isArray(o)?o:Ja(t,o)});return{calculatedDuration:e,next:c=>(i.value=l(c),i.done=c>=e,i)}}function Ro(e,t){return t?e*(1e3/t):0}const Qa=5;function Ao(e,t,s){const n=Math.max(t-Qa,0);return Ro(s-e(n),t-n)}const ws=.001,el=.01,tl=10,sl=.05,nl=1;function rl({duration:e=800,bounce:t=.25,velocity:s=0,mass:n=1}){let o,i,a=1-t;a=Fe(sl,nl,a),e=Fe(el,tl,Ae(e)),a<1?(o=d=>{const u=d*a,h=u*e,p=u-s,x=Is(d,a),j=Math.exp(-h);return ws-p/x*j},i=d=>{const h=d*a*e,p=h*s+s,x=Math.pow(a,2)*Math.pow(d,2)*e,j=Math.exp(-h),b=Is(Math.pow(d,2),a);return(-o(d)+ws>0?-1:1)*((p-x)*j)/b}):(o=d=>{const u=Math.exp(-d*e),h=(d-s)*e+1;return-ws+u*h},i=d=>{const u=Math.exp(-d*e),h=(s-d)*(e*e);return u*h});const l=5/e,c=il(o,i,l);if(e=Xe(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:a*2*Math.sqrt(n*d),duration:e}}}const ol=12;function il(e,t,s){let n=s;for(let o=1;o<ol;o++)n=n-e(n)/t(n);return n}function Is(e,t){return e*Math.sqrt(1-t*t)}const al=["duration","bounce"],ll=["stiffness","damping","mass"];function Vn(e,t){return t.some(s=>e[s]!==void 0)}function cl(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!Vn(e,ll)&&Vn(e,al)){const s=rl(e);t={...t,...s,mass:1},t.isResolvedFromDuration=!0}return t}function Vo({keyframes:e,restDelta:t,restSpeed:s,...n}){const o=e[0],i=e[e.length-1],a={done:!1,value:o},{stiffness:l,damping:c,mass:d,duration:u,velocity:h,isResolvedFromDuration:p}=cl({...n,velocity:-Ae(n.velocity||0)}),x=h||0,j=c/(2*Math.sqrt(l*d)),b=i-o,w=Ae(Math.sqrt(l/d)),A=Math.abs(b)<5;s||(s=A?.01:2),t||(t=A?.005:.5);let k;if(j<1){const S=Is(w,j);k=I=>{const D=Math.exp(-j*w*I);return i-D*((x+j*w*b)/S*Math.sin(S*I)+b*Math.cos(S*I))}}else if(j===1)k=S=>i-Math.exp(-w*S)*(b+(x+w*b)*S);else{const S=w*Math.sqrt(j*j-1);k=I=>{const D=Math.exp(-j*w*I),R=Math.min(S*I,300);return i-D*((x+j*w*b)*Math.sinh(R)+S*b*Math.cosh(R))/S}}return{calculatedDuration:p&&u||null,next:S=>{const I=k(S);if(p)a.done=S>=u;else{let D=x;S!==0&&(j<1?D=Ao(k,S,I):D=0);const R=Math.abs(D)<=s,B=Math.abs(i-I)<=t;a.done=R&&B}return a.value=a.done?i:I,a}}}function En({keyframes:e,velocity:t=0,power:s=.8,timeConstant:n=325,bounceDamping:o=10,bounceStiffness:i=500,modifyTarget:a,min:l,max:c,restDelta:d=.5,restSpeed:u}){const h=e[0],p={done:!1,value:h},x=V=>l!==void 0&&V<l||c!==void 0&&V>c,j=V=>l===void 0?c:c===void 0||Math.abs(l-V)<Math.abs(c-V)?l:c;let b=s*t;const w=h+b,A=a===void 0?w:a(w);A!==w&&(b=A-h);const k=V=>-b*Math.exp(-V/n),S=V=>A+k(V),I=V=>{const v=k(V),T=S(V);p.done=Math.abs(v)<=d,p.value=p.done?A:T};let D,R;const B=V=>{x(p.value)&&(D=V,R=Vo({keyframes:[p.value,j(p.value)],velocity:Ao(S,V,p.value),damping:o,stiffness:i,restDelta:d,restSpeed:u}))};return B(0),{calculatedDuration:null,next:V=>{let v=!1;return!R&&D===void 0&&(v=!0,I(V),B(V)),D!==void 0&&V>D?R.next(V-D):(!v&&I(V),p)}}}const dl=e=>{const t=({timestamp:s})=>e(s);return{start:()=>ne.update(t,!0),stop:()=>Ve(t),now:()=>ue.isProcessing?ue.timestamp:performance.now()}},Dn=2e4;function Ln(e){let t=0;const s=50;let n=e.next(t);for(;!n.done&&t<Dn;)t+=s,n=e.next(t);return t>=Dn?1/0:t}const ul={decay:En,inertia:En,tween:Qt,keyframes:Qt,spring:Vo};function es({autoplay:e=!0,delay:t=0,driver:s=dl,keyframes:n,type:o="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:h,...p}){let x=1,j=!1,b,w;const A=()=>{w=new Promise(f=>{b=f})};A();let k;const S=ul[o]||Qt;let I;S!==Qt&&typeof n[0]!="number"&&(I=Mo([0,100],n,{clamp:!1}),n=[0,100]);const D=S({...p,keyframes:n});let R;l==="mirror"&&(R=S({...p,keyframes:[...n].reverse(),velocity:-(p.velocity||0)}));let B="idle",V=null,v=null,T=null;D.calculatedDuration===null&&i&&(D.calculatedDuration=Ln(D));const{calculatedDuration:L}=D;let N=1/0,M=1/0;L!==null&&(N=L+a,M=N*(i+1)-a);let P=0;const m=f=>{if(v===null)return;x>0&&(v=Math.min(v,f)),x<0&&(v=Math.min(f-M/x,v)),V!==null?P=V:P=Math.round(f-v)*x;const C=P-t*(x>=0?1:-1),E=x>=0?C<0:C>M;P=Math.max(C,0),B==="finished"&&V===null&&(P=M);let F=P,$=D;if(i){const te=Math.min(P,M)/N;let O=Math.floor(te),X=te%1;!X&&te>=1&&(X=1),X===1&&O--,O=Math.min(O,i+1),!!(O%2)&&(l==="reverse"?(X=1-X,a&&(X-=a/N)):l==="mirror"&&($=R)),F=Fe(0,1,X)*N}const U=E?{done:!1,value:n[0]}:$.next(F);I&&(U.value=I(U.value));let{done:W}=U;!E&&L!==null&&(W=x>=0?P>=M:P<=0);const Y=V===null&&(B==="finished"||B==="running"&&W);return h&&h(U.value),Y&&K(),U},z=()=>{k&&k.stop(),k=void 0},_=()=>{B="idle",z(),b(),A(),v=T=null},K=()=>{B="finished",u&&u(),z(),b()},q=()=>{if(j)return;k||(k=s(m));const f=k.now();c&&c(),V!==null?v=f-V:(!v||B==="finished")&&(v=f),B==="finished"&&A(),T=v,V=null,B="running",k.start()};e&&q();const y={then(f,C){return w.then(f,C)},get time(){return Ae(P)},set time(f){f=Xe(f),P=f,V!==null||!k||x===0?V=f:v=k.now()-f/x},get duration(){const f=D.calculatedDuration===null?Ln(D):D.calculatedDuration;return Ae(f)},get speed(){return x},set speed(f){f===x||!k||(x=f,y.time=Ae(P))},get state(){return B},play:q,pause:()=>{B="paused",V=P},stop:()=>{j=!0,B!=="idle"&&(B="idle",d&&d(),_())},cancel:()=>{T!==null&&m(T),_()},complete:()=>{B="finished"},sample:f=>(v=0,m(f))};return y}function hl(e){let t;return()=>(t===void 0&&(t=e()),t)}const fl=hl(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),ml=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),zt=10,pl=2e4,gl=(e,t)=>t.type==="spring"||e==="backgroundColor"||!lo(t.ease);function xl(e,t,{onUpdate:s,onComplete:n,...o}){if(!(fl()&&ml.has(t)&&!o.repeatDelay&&o.repeatType!=="mirror"&&o.damping!==0&&o.type!=="inertia"))return!1;let a=!1,l,c,d=!1;const u=()=>{c=new Promise(S=>{l=S})};u();let{keyframes:h,duration:p=300,ease:x,times:j}=o;if(gl(t,o)){const S=es({...o,repeat:0,delay:0});let I={done:!1,value:h[0]};const D=[];let R=0;for(;!I.done&&R<pl;)I=S.sample(R),D.push(I.value),R+=zt;j=void 0,h=D,p=R-zt,x="linear"}const b=Ta(e.owner.current,t,h,{...o,duration:p,ease:x,times:j}),w=()=>{d=!1,b.cancel()},A=()=>{d=!0,ne.update(w),l(),u()};return b.onfinish=()=>{d||(e.set(Pa(h,o)),n&&n(),A())},{then(S,I){return c.then(S,I)},attachTimeline(S){return b.timeline=S,b.onfinish=null,ae},get time(){return Ae(b.currentTime||0)},set time(S){b.currentTime=Xe(S)},get speed(){return b.playbackRate},set speed(S){b.playbackRate=S},get duration(){return Ae(p)},play:()=>{a||(b.play(),Ve(w))},pause:()=>b.pause(),stop:()=>{if(a=!0,b.playState==="idle")return;const{currentTime:S}=b;if(S){const I=es({...o,autoplay:!1});e.setWithVelocity(I.sample(S-zt).value,I.sample(S).value,zt)}A()},complete:()=>{d||b.finish()},cancel:A}}function yl({keyframes:e,delay:t,onUpdate:s,onComplete:n}){const o=()=>(s&&s(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:ae,pause:ae,stop:ae,then:i=>(i(),Promise.resolve()),cancel:ae,complete:ae});return t?es({keyframes:[0,1],duration:0,delay:t,onComplete:o}):o()}const vl={type:"spring",stiffness:500,damping:25,restSpeed:10},bl=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),wl={type:"keyframes",duration:.8},jl={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Nl=(e,{keyframes:t})=>t.length>2?wl:Ye.has(e)?e.startsWith("scale")?bl(t[1]):vl:jl,Fs=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Be.test(t)||t==="0")&&!t.startsWith("url(")),Sl=new Set(["brightness","contrast","saturate","opacity"]);function Cl(e){const[t,s]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=s.match(cs)||[];if(!n)return e;const o=s.replace(n,"");let i=Sl.has(t)?1:0;return n!==s&&(i*=100),t+"("+i+o+")"}const Tl=/([a-z-]*)\(.*?\)/g,Bs={...Be,getAnimatableNone:e=>{const t=e.match(Tl);return t?t.map(Cl).join(" "):e}},Pl={..._r,color:fe,backgroundColor:fe,outlineColor:fe,fill:fe,stroke:fe,borderColor:fe,borderTopColor:fe,borderRightColor:fe,borderBottomColor:fe,borderLeftColor:fe,filter:Bs,WebkitFilter:Bs},hn=e=>Pl[e];function Eo(e,t){let s=hn(e);return s!==Bs&&(s=Be),s.getAnimatableNone?s.getAnimatableNone(t):void 0}const Do=e=>/^0[^.\s]+$/.test(e);function kl(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Do(e)}function Ml(e,t,s,n){const o=Fs(t,s);let i;Array.isArray(s)?i=[...s]:i=[null,s];const a=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<i.length;d++)i[d]===null&&(i[d]=d===0?a:i[d-1]),kl(i[d])&&c.push(d),typeof i[d]=="string"&&i[d]!=="none"&&i[d]!=="0"&&(l=i[d]);if(o&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];i[u]=Eo(t,l)}return i}function Rl({when:e,delay:t,delayChildren:s,staggerChildren:n,staggerDirection:o,repeat:i,repeatType:a,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function fn(e,t){return e[t]||e.default||e}const Al={skipAnimations:!1},mn=(e,t,s,n={})=>o=>{const i=fn(n,e)||{},a=i.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Xe(a);const c=Ml(t,e,s,i),d=c[0],u=c[c.length-1],h=Fs(e,d),p=Fs(e,u);let x={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:j=>{t.set(j),i.onUpdate&&i.onUpdate(j)},onComplete:()=>{o(),i.onComplete&&i.onComplete()}};if(Rl(i)||(x={...x,...Nl(e,x)}),x.duration&&(x.duration=Xe(x.duration)),x.repeatDelay&&(x.repeatDelay=Xe(x.repeatDelay)),!h||!p||Ca.current||i.type===!1||Al.skipAnimations)return yl(x);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const j=xl(t,e,x);if(j)return j}return es(x)};function ts(e){return!!(pe(e)&&e.add)}const Lo=e=>/^\-?\d*\.?\d+$/.test(e);function pn(e,t){e.indexOf(t)===-1&&e.push(t)}function gn(e,t){const s=e.indexOf(t);s>-1&&e.splice(s,1)}class xn{constructor(){this.subscriptions=[]}add(t){return pn(this.subscriptions,t),()=>gn(this.subscriptions,t)}notify(t,s,n){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,s,n);else for(let i=0;i<o;i++){const a=this.subscriptions[i];a&&a(t,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Vl=e=>!isNaN(parseFloat(e));class El{constructor(t,s={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,o=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:a}=ue;this.lastUpdated!==a&&(this.timeDelta=i,this.lastUpdated=a,ne.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>ne.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=Vl(this.current),this.owner=s.owner}onChange(t){return this.on("change",t)}on(t,s){this.events[t]||(this.events[t]=new xn);const n=this.events[t].add(s);return t==="change"?()=>{n(),ne.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,s){this.passiveEffect=t,this.stopPassiveEffect=s}set(t,s=!0){!s||!this.passiveEffect?this.updateAndNotify(t,s):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,s,n){this.set(s),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Ro(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=t(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function dt(e,t){return new El(e,t)}const Io=e=>t=>t.test(e),Dl={test:e=>e==="auto",parse:e=>e},Fo=[Ze,J,Pe,De,$i,zi,Dl],gt=e=>Fo.find(Io(e)),Ll=[...Fo,fe,Be],Il=e=>Ll.find(Io(e));function Fl(e,t,s){e.hasValue(t)?e.getValue(t).set(s):e.addValue(t,dt(s))}function Bl(e,t){const s=us(e,t);let{transitionEnd:n={},transition:o={},...i}=s?e.makeTargetAnimatable(s,!1):{};i={...i,...n};for(const a in i){const l=ta(i[a]);Fl(e,a,l)}}function Ol(e,t,s){var n,o;const i=Object.keys(t).filter(l=>!e.hasValue(l)),a=i.length;if(a)for(let l=0;l<a;l++){const c=i[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(o=(n=s[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&o!==void 0?o:t[c]),u!=null&&(typeof u=="string"&&(Lo(u)||Do(u))?u=parseFloat(u):!Il(u)&&Be.test(d)&&(u=Eo(c,d)),e.addValue(c,dt(u,{owner:e})),s[c]===void 0&&(s[c]=u),u!==null&&e.setBaseTarget(c,u))}}function zl(e,t){return t?(t[e]||t.default||t).from:void 0}function $l(e,t,s){const n={};for(const o in e){const i=zl(o,t);if(i!==void 0)n[o]=i;else{const a=s.getValue(o);a&&(n[o]=a.get())}}return n}function Ul({protectedKeys:e,needsAnimating:t},s){const n=e.hasOwnProperty(s)&&t[s]!==!0;return t[s]=!1,n}function Hl(e,t){const s=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==s)return!0}else return s!==t}function Bo(e,t,{delay:s=0,transitionOverride:n,type:o}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(i=n);const d=[],u=o&&e.animationState&&e.animationState.getState()[o];for(const h in l){const p=e.getValue(h),x=l[h];if(!p||x===void 0||u&&Ul(u,h))continue;const j={delay:s,elapsed:0,...fn(i||{},h)};if(window.HandoffAppearAnimations){const A=e.getProps()[Br];if(A){const k=window.HandoffAppearAnimations(A,h,p,ne);k!==null&&(j.elapsed=k,j.isHandoff=!0)}}let b=!j.isHandoff&&!Hl(p,x);if(j.type==="spring"&&(p.getVelocity()||j.velocity)&&(b=!1),p.animation&&(b=!1),b)continue;p.start(mn(h,p,x,e.shouldReduceMotion&&Ye.has(h)?{type:!1}:j));const w=p.animation;ts(c)&&(c.add(h),w.then(()=>c.remove(h))),d.push(w)}return a&&Promise.all(d).then(()=>{a&&Bl(e,a)}),d}function Os(e,t,s={}){const n=us(e,t,s.custom);let{transition:o=e.getDefaultTransition()||{}}=n||{};s.transitionOverride&&(o=s.transitionOverride);const i=n?()=>Promise.all(Bo(e,n,s)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:h}=o;return Gl(e,t,d+c,u,h,s)}:()=>Promise.resolve(),{when:l}=o;if(l){const[c,d]=l==="beforeChildren"?[i,a]:[a,i];return c().then(()=>d())}else return Promise.all([i(),a(s.delay)])}function Gl(e,t,s=0,n=0,o=1,i){const a=[],l=(e.variantChildren.size-1)*n,c=o===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(_l).forEach((d,u)=>{d.notify("AnimationStart",t),a.push(Os(d,t,{...i,delay:s+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(a)}function _l(e,t){return e.sortNodePosition(t)}function Wl(e,t,s={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const o=t.map(i=>Os(e,i,s));n=Promise.all(o)}else if(typeof t=="string")n=Os(e,t,s);else{const o=typeof t=="function"?us(e,t,s.custom):t;n=Promise.all(Bo(e,o,s))}return n.then(()=>e.notify("AnimationComplete",t))}const ql=[...Zs].reverse(),Xl=Zs.length;function Kl(e){return t=>Promise.all(t.map(({animation:s,options:n})=>Wl(e,s,n)))}function Yl(e){let t=Kl(e);const s=Jl();let n=!0;const o=(c,d)=>{const u=us(e,d);if(u){const{transition:h,transitionEnd:p,...x}=u;c={...c,...x,...p}}return c};function i(c){t=c(e)}function a(c,d){const u=e.getProps(),h=e.getVariantContext(!0)||{},p=[],x=new Set;let j={},b=1/0;for(let A=0;A<Xl;A++){const k=ql[A],S=s[k],I=u[k]!==void 0?u[k]:h[k],D=Tt(I),R=k===d?S.isActive:null;R===!1&&(b=A);let B=I===h[k]&&I!==u[k]&&D;if(B&&n&&e.manuallyAnimateOnMount&&(B=!1),S.protectedKeys={...j},!S.isActive&&R===null||!I&&!S.prevProp||as(I)||typeof I=="boolean")continue;let v=Zl(S.prevProp,I)||k===d&&S.isActive&&!B&&D||A>b&&D,T=!1;const L=Array.isArray(I)?I:[I];let N=L.reduce(o,{});R===!1&&(N={});const{prevResolvedValues:M={}}=S,P={...M,...N},m=z=>{v=!0,x.has(z)&&(T=!0,x.delete(z)),S.needsAnimating[z]=!0};for(const z in P){const _=N[z],K=M[z];if(j.hasOwnProperty(z))continue;let q=!1;Zt(_)&&Zt(K)?q=!io(_,K):q=_!==K,q?_!==void 0?m(z):x.add(z):_!==void 0&&x.has(z)?m(z):S.protectedKeys[z]=!0}S.prevProp=I,S.prevResolvedValues=N,S.isActive&&(j={...j,...N}),n&&e.blockInitialAnimation&&(v=!1),v&&(!B||T)&&p.push(...L.map(z=>({animation:z,options:{type:k,...c}})))}if(x.size){const A={};x.forEach(k=>{const S=e.getBaseTarget(k);S!==void 0&&(A[k]=S)}),p.push({animation:A})}let w=!!p.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(w=!1),n=!1,w?t(p):Promise.resolve()}function l(c,d,u){var h;if(s[c].isActive===d)return Promise.resolve();(h=e.variantChildren)===null||h===void 0||h.forEach(x=>{var j;return(j=x.animationState)===null||j===void 0?void 0:j.setActive(c,d)}),s[c].isActive=d;const p=a(u,c);for(const x in s)s[x].protectedKeys={};return p}return{animateChanges:a,setActive:l,setAnimateFunction:i,getState:()=>s}}function Zl(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!io(t,e):!1}function Ue(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Jl(){return{animate:Ue(!0),whileInView:Ue(),whileHover:Ue(),whileTap:Ue(),whileDrag:Ue(),whileFocus:Ue(),exit:Ue()}}class Ql extends Oe{constructor(t){super(t),t.animationState||(t.animationState=Yl(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),as(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:s}=this.node.prevProps||{};t!==s&&this.updateAnimationControlsSubscription()}unmount(){}}let ec=0;class tc extends Oe{constructor(){super(...arguments),this.id=ec++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:s,custom:n}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===o)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});s&&!t&&i.then(()=>s(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const sc={animation:{Feature:Ql},exit:{Feature:tc}},In=(e,t)=>Math.abs(e-t);function nc(e,t){const s=In(e.x,t.x),n=In(e.y,t.y);return Math.sqrt(s**2+n**2)}class Oo{constructor(t,s,{transformPagePoint:n,contextWindow:o,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Ns(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=nc(h.offset,{x:0,y:0})>=3;if(!p&&!x)return;const{point:j}=h,{timestamp:b}=ue;this.history.push({...j,timestamp:b});const{onStart:w,onMove:A}=this.handlers;p||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=js(p,this.transformPagePoint),ne.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:x,onSessionEnd:j,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Ns(h.type==="pointercancel"?this.lastMoveEventInfo:js(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,w),j&&j(h,w)},!to(t))return;this.dragSnapToOrigin=i,this.handlers=s,this.transformPagePoint=n,this.contextWindow=o||window;const a=ds(t),l=js(a,this.transformPagePoint),{point:c}=l,{timestamp:d}=ue;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=s;u&&u(t,Ns(l,this.history)),this.removeListeners=Ie(Re(this.contextWindow,"pointermove",this.handlePointerMove),Re(this.contextWindow,"pointerup",this.handlePointerUp),Re(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ve(this.updatePoint)}}function js(e,t){return t?{point:t(e.point)}:e}function Fn(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ns({point:e},t){return{point:e,delta:Fn(e,zo(t)),offset:Fn(e,rc(t)),velocity:oc(t,.1)}}function rc(e){return e[0]}function zo(e){return e[e.length-1]}function oc(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,n=null;const o=zo(e);for(;s>=0&&(n=e[s],!(o.timestamp-n.timestamp>Xe(t)));)s--;if(!n)return{x:0,y:0};const i=Ae(o.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const a={x:(o.x-n.x)/i,y:(o.y-n.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function ye(e){return e.max-e.min}function zs(e,t=0,s=.01){return Math.abs(e-t)<=s}function Bn(e,t,s,n=.5){e.origin=n,e.originPoint=oe(t.min,t.max,e.origin),e.scale=ye(s)/ye(t),(zs(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=oe(s.min,s.max,e.origin)-e.originPoint,(zs(e.translate)||isNaN(e.translate))&&(e.translate=0)}function St(e,t,s,n){Bn(e.x,t.x,s.x,n?n.originX:void 0),Bn(e.y,t.y,s.y,n?n.originY:void 0)}function On(e,t,s){e.min=s.min+t.min,e.max=e.min+ye(t)}function ic(e,t,s){On(e.x,t.x,s.x),On(e.y,t.y,s.y)}function zn(e,t,s){e.min=t.min-s.min,e.max=e.min+ye(t)}function Ct(e,t,s){zn(e.x,t.x,s.x),zn(e.y,t.y,s.y)}function ac(e,{min:t,max:s},n){return t!==void 0&&e<t?e=n?oe(t,e,n.min):Math.max(e,t):s!==void 0&&e>s&&(e=n?oe(s,e,n.max):Math.min(e,s)),e}function $n(e,t,s){return{min:t!==void 0?e.min+t:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function lc(e,{top:t,left:s,bottom:n,right:o}){return{x:$n(e.x,s,o),y:$n(e.y,t,n)}}function Un(e,t){let s=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,n]=[n,s]),{min:s,max:n}}function cc(e,t){return{x:Un(e.x,t.x),y:Un(e.y,t.y)}}function dc(e,t){let s=.5;const n=ye(e),o=ye(t);return o>n?s=kt(t.min,t.max-n,e.min):n>o&&(s=kt(e.min,e.max-o,t.min)),Fe(0,1,s)}function uc(e,t){const s={};return t.min!==void 0&&(s.min=t.min-e.min),t.max!==void 0&&(s.max=t.max-e.min),s}const $s=.35;function hc(e=$s){return e===!1?e=0:e===!0&&(e=$s),{x:Hn(e,"left","right"),y:Hn(e,"top","bottom")}}function Hn(e,t,s){return{min:Gn(e,t),max:Gn(e,s)}}function Gn(e,t){return typeof e=="number"?e:e[t]||0}const _n=()=>({translate:0,scale:1,origin:0,originPoint:0}),lt=()=>({x:_n(),y:_n()}),Wn=()=>({min:0,max:0}),ce=()=>({x:Wn(),y:Wn()});function Ne(e){return[e("x"),e("y")]}function $o({top:e,left:t,right:s,bottom:n}){return{x:{min:t,max:s},y:{min:e,max:n}}}function fc({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function mc(e,t){if(!t)return e;const s=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function Ss(e){return e===void 0||e===1}function Us({scale:e,scaleX:t,scaleY:s}){return!Ss(e)||!Ss(t)||!Ss(s)}function Ge(e){return Us(e)||Uo(e)||e.z||e.rotate||e.rotateX||e.rotateY}function Uo(e){return qn(e.x)||qn(e.y)}function qn(e){return e&&e!=="0%"}function ss(e,t,s){const n=e-s,o=t*n;return s+o}function Xn(e,t,s,n,o){return o!==void 0&&(e=ss(e,o,n)),ss(e,s,n)+t}function Hs(e,t=0,s=1,n,o){e.min=Xn(e.min,t,s,n,o),e.max=Xn(e.max,t,s,n,o)}function Ho(e,{x:t,y:s}){Hs(e.x,t.translate,t.scale,t.originPoint),Hs(e.y,s.translate,s.scale,s.originPoint)}function pc(e,t,s,n=!1){const o=s.length;if(!o)return;t.x=t.y=1;let i,a;for(let l=0;l<o;l++){i=s[l],a=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ct(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Ho(e,a)),n&&Ge(i.latestValues)&&ct(e,i.latestValues))}t.x=Kn(t.x),t.y=Kn(t.y)}function Kn(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Le(e,t){e.min=e.min+t,e.max=e.max+t}function Yn(e,t,[s,n,o]){const i=t[o]!==void 0?t[o]:.5,a=oe(e.min,e.max,i);Hs(e,t[s],t[n],a,t.scale)}const gc=["x","scaleX","originX"],xc=["y","scaleY","originY"];function ct(e,t){Yn(e.x,t,gc),Yn(e.y,t,xc)}function Go(e,t){return $o(mc(e.getBoundingClientRect(),t))}function yc(e,t,s){const n=Go(e,s),{scroll:o}=t;return o&&(Le(n.x,o.offset.x),Le(n.y,o.offset.y)),n}const _o=({current:e})=>e?e.ownerDocument.defaultView:null,vc=new WeakMap;class bc{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ce(),this.visualElement=t}start(t,{snapToCursor:s=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const o=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(ds(u,"page").point)},i=(u,h)=>{const{drag:p,dragPropagation:x,onDragStart:j}=this.getProps();if(p&&!x&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=no(p),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ne(w=>{let A=this.getAxisMotionValue(w).get()||0;if(Pe.test(A)){const{projection:k}=this.visualElement;if(k&&k.layout){const S=k.layout.layoutBox[w];S&&(A=ye(S)*(parseFloat(A)/100))}}this.originPoint[w]=A}),j&&ne.update(()=>j(u,h),!1,!0);const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,h)=>{const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:j,onDrag:b}=this.getProps();if(!p&&!this.openGlobalLock)return;const{offset:w}=h;if(x&&this.currentDirection===null){this.currentDirection=wc(w),this.currentDirection!==null&&j&&j(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),b&&b(u,h)},l=(u,h)=>this.stop(u,h),c=()=>Ne(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new Oo(t,{onSessionStart:o,onStart:i,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:_o(this.visualElement)})}stop(t,s){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:i}=this.getProps();i&&ne.update(()=>i(t,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:s}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(t,s,n){const{drag:o}=this.getProps();if(!n||!$t(t,o,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(a=ac(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var t;const{dragConstraints:s,dragElastic:n}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;s&&it(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&o?this.constraints=lc(o.layoutBox,s):this.constraints=!1,this.elastic=hc(n),i!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&Ne(a=>{this.getAxisMotionValue(a)&&(this.constraints[a]=uc(o.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:s}=this.getProps();if(!t||!it(t))return!1;const n=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const i=yc(n,o.root,this.visualElement.getTransformPagePoint());let a=cc(o.layout.layoutBox,i);if(s){const l=s(fc(a));this.hasMutatedConstraints=!!l,l&&(a=$o(l))}return a}startAnimation(t){const{drag:s,dragMomentum:n,dragElastic:o,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Ne(u=>{if(!$t(u,s,this.currentDirection))return;let h=c&&c[u]||{};a&&(h={min:0,max:0});const p=o?200:1e6,x=o?40:1e7,j={type:"inertia",velocity:n?t[u]:0,bounceStiffness:p,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,j)});return Promise.all(d).then(l)}startAxisValueAnimation(t,s){const n=this.getAxisMotionValue(t);return n.start(mn(t,n,0,s))}stopAnimation(){Ne(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ne(t=>{var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(t){var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(t){const s="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),o=n[s];return o||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Ne(s=>{const{drag:n}=this.getProps();if(!$t(s,n,this.currentDirection))return;const{projection:o}=this.visualElement,i=this.getAxisMotionValue(s);if(o&&o.layout){const{min:a,max:l}=o.layout.layoutBox[s];i.set(t[s]-oe(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!it(s)||!n||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Ne(a=>{const l=this.getAxisMotionValue(a);if(l){const c=l.get();o[a]=dc({min:c,max:c},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Ne(a=>{if(!$t(a,t,null))return;const l=this.getAxisMotionValue(a),{min:c,max:d}=this.constraints[a];l.set(oe(c,d,o[a]))})}addListeners(){if(!this.visualElement.current)return;vc.set(this.visualElement,this);const t=this.visualElement.current,s=Re(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();it(c)&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,i=o.addEventListener("measure",n);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),n();const a=Me(window,"resize",()=>this.scalePositionWithinConstraints()),l=o.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Ne(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=c[u].translate,h.set(h.get()+c[u].translate))}),this.visualElement.render())});return()=>{a(),s(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:o=!1,dragConstraints:i=!1,dragElastic:a=$s,dragMomentum:l=!0}=t;return{...t,drag:s,dragDirectionLock:n,dragPropagation:o,dragConstraints:i,dragElastic:a,dragMomentum:l}}}function $t(e,t,s){return(t===!0||t===e)&&(s===null||s===e)}function wc(e,t=10){let s=null;return Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x"),s}class jc extends Oe{constructor(t){super(t),this.removeGroupControls=ae,this.removeListeners=ae,this.controls=new bc(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ae}unmount(){this.removeGroupControls(),this.removeListeners()}}const Zn=e=>(t,s)=>{e&&ne.update(()=>e(t,s))};class Nc extends Oe{constructor(){super(...arguments),this.removePointerDownListener=ae}onPointerDown(t){this.session=new Oo(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:_o(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:s,onPan:n,onPanEnd:o}=this.node.getProps();return{onSessionStart:Zn(t),onStart:Zn(s),onMove:n,onEnd:(i,a)=>{delete this.session,o&&ne.update(()=>o(i,a))}}}mount(){this.removePointerDownListener=Re(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Sc(){const e=g.useContext(os);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:s,register:n}=e,o=g.useId();return g.useEffect(()=>n(o),[]),!t&&s?[!1,()=>s&&s(o)]:[!0]}const Xt={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Jn(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const xt={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(J.test(e))e=parseFloat(e);else return e;const s=Jn(e,t.target.x),n=Jn(e,t.target.y);return`${s}% ${n}%`}},Cc={correct:(e,{treeScale:t,projectionDelta:s})=>{const n=e,o=Be.parse(e);if(o.length>5)return n;const i=Be.createTransformer(e),a=typeof o[0]!="number"?1:0,l=s.x.scale*t.x,c=s.y.scale*t.y;o[0+a]/=l,o[1+a]/=c;const d=oe(l,c,.5);return typeof o[2+a]=="number"&&(o[2+a]/=d),typeof o[3+a]=="number"&&(o[3+a]/=d),i(o)}};class Tc extends qs.Component{componentDidMount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n,layoutId:o}=this.props,{projection:i}=t;Ei(Pc),i&&(s.group&&s.group.add(i),n&&n.register&&o&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Xt.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:s,visualElement:n,drag:o,isPresent:i}=this.props,a=n.projection;return a&&(a.isPresent=i,o||t.layoutDependency!==s||s===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ne.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:o}=t;o&&(o.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(o),n&&n.deregister&&n.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Wo(e){const[t,s]=Sc(),n=g.useContext(Qs);return qs.createElement(Tc,{...e,layoutGroup:n,switchLayoutGroup:g.useContext(zr),isPresent:t,safeToRemove:s})}const Pc={borderRadius:{...xt,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:xt,borderTopRightRadius:xt,borderBottomLeftRadius:xt,borderBottomRightRadius:xt,boxShadow:Cc},qo=["TopLeft","TopRight","BottomLeft","BottomRight"],kc=qo.length,Qn=e=>typeof e=="string"?parseFloat(e):e,er=e=>typeof e=="number"||J.test(e);function Mc(e,t,s,n,o,i){o?(e.opacity=oe(0,s.opacity!==void 0?s.opacity:1,Rc(n)),e.opacityExit=oe(t.opacity!==void 0?t.opacity:1,0,Ac(n))):i&&(e.opacity=oe(t.opacity!==void 0?t.opacity:1,s.opacity!==void 0?s.opacity:1,n));for(let a=0;a<kc;a++){const l=`border${qo[a]}Radius`;let c=tr(t,l),d=tr(s,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||er(c)===er(d)?(e[l]=Math.max(oe(Qn(c),Qn(d),n),0),(Pe.test(d)||Pe.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||s.rotate)&&(e.rotate=oe(t.rotate||0,s.rotate||0,n))}function tr(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Rc=Xo(0,.5,go),Ac=Xo(.5,.95,ae);function Xo(e,t,s){return n=>n<e?0:n>t?1:s(kt(e,t,n))}function sr(e,t){e.min=t.min,e.max=t.max}function je(e,t){sr(e.x,t.x),sr(e.y,t.y)}function nr(e,t,s,n,o){return e-=t,e=ss(e,1/s,n),o!==void 0&&(e=ss(e,1/o,n)),e}function Vc(e,t=0,s=1,n=.5,o,i=e,a=e){if(Pe.test(t)&&(t=parseFloat(t),t=oe(a.min,a.max,t/100)-a.min),typeof t!="number")return;let l=oe(i.min,i.max,n);e===i&&(l-=t),e.min=nr(e.min,t,s,l,o),e.max=nr(e.max,t,s,l,o)}function rr(e,t,[s,n,o],i,a){Vc(e,t[s],t[n],t[o],t.scale,i,a)}const Ec=["x","scaleX","originX"],Dc=["y","scaleY","originY"];function or(e,t,s,n){rr(e.x,t,Ec,s?s.x:void 0,n?n.x:void 0),rr(e.y,t,Dc,s?s.y:void 0,n?n.y:void 0)}function ir(e){return e.translate===0&&e.scale===1}function Ko(e){return ir(e.x)&&ir(e.y)}function Lc(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function Yo(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function ar(e){return ye(e.x)/ye(e.y)}class Ic{constructor(){this.members=[]}add(t){pn(this.members,t),t.scheduleRender()}remove(t){if(gn(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(t){const s=this.members.findIndex(o=>t===o);if(s===0)return!1;let n;for(let o=s;o>=0;o--){const i=this.members[o];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,s){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,s&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:s,resumingFrom:n}=t;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function lr(e,t,s){let n="";const o=e.x.translate/t.x,i=e.y.translate/t.y;if((o||i)&&(n=`translate3d(${o}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),s){const{rotate:c,rotateX:d,rotateY:u}=s;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const Fc=(e,t)=>e.depth-t.depth;class Bc{constructor(){this.children=[],this.isDirty=!1}add(t){pn(this.children,t),this.isDirty=!0}remove(t){gn(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Fc),this.isDirty=!1,this.children.forEach(t)}}function Oc(e,t){const s=performance.now(),n=({timestamp:o})=>{const i=o-s;i>=t&&(Ve(n),e(i-t))};return ne.read(n,!0),()=>Ve(n)}function zc(e){window.MotionDebug&&window.MotionDebug.record(e)}function $c(e){return e instanceof SVGElement&&e.tagName!=="svg"}function Uc(e,t,s){const n=pe(e)?e:dt(e);return n.start(mn("",n,t,s)),n.animation}const cr=["","X","Y","Z"],Hc={visibility:"hidden"},dr=1e3;let Gc=0;const _e={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Zo({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:n,resetTransform:o}){return class{constructor(a={},l=t==null?void 0:t()){this.id=Gc++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,_e.totalNodes=_e.resolvedTargetDeltas=_e.recalculatedProjection=0,this.nodes.forEach(qc),this.nodes.forEach(Jc),this.nodes.forEach(Qc),this.nodes.forEach(Xc),zc(_e)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Bc)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new xn),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=$c(a),this.instance=a;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let h;const p=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=Oc(p,250),Xt.hasAnimatedSinceResize&&(Xt.hasAnimatedSinceResize=!1,this.nodes.forEach(hr))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeTargetChanged:x,layout:j})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||u.getDefaultTransition()||rd,{onLayoutAnimationStart:w,onLayoutAnimationComplete:A}=u.getProps(),k=!this.targetLayout||!Yo(this.targetLayout,j)||x,S=!p&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||p&&(k||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,S);const I={...fn(b,"layout"),onPlay:w,onComplete:A};(u.shouldReduceMotion||this.options.layoutRoot)&&(I.delay=0,I.type=!1),this.startAnimation(I)}else p||hr(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=j})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ve(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ed),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ur);return}this.isUpdating||this.nodes.forEach(Yc),this.isUpdating=!1,this.nodes.forEach(Zc),this.nodes.forEach(_c),this.nodes.forEach(Wc),this.clearAllSnapshots();const l=performance.now();ue.delta=Fe(0,1e3/60,l-ue.timestamp),ue.timestamp=l,ue.isProcessing=!0,ms.update.process(ue),ms.preRender.process(ue),ms.render.process(ue),ue.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Kc),this.sharedNodes.forEach(td)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ne.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ne.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ce(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:n(this.instance),offset:s(this.instance)})}resetTransform(){if(!o)return;const a=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!Ko(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;a&&(l||Ge(this.latestValues)||u)&&(o(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),od(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return ce();const l=a.measureViewportBox(),{scroll:c}=this.root;return c&&(Le(l.x,c.offset.x),Le(l.y,c.offset.y)),l}removeElementScroll(a){const l=ce();je(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:h}=d;if(d!==this.root&&u&&h.layoutScroll){if(u.isRoot){je(l,a);const{scroll:p}=this.root;p&&(Le(l.x,-p.offset.x),Le(l.y,-p.offset.y))}Le(l.x,u.offset.x),Le(l.y,u.offset.y)}}return l}applyTransform(a,l=!1){const c=ce();je(c,a);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&ct(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Ge(u.latestValues)&&ct(c,u.latestValues)}return Ge(this.latestValues)&&ct(c,this.latestValues),c}removeTransform(a){const l=ce();je(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Ge(d.latestValues))continue;Us(d.latestValues)&&d.updateSnapshot();const u=ce(),h=d.measurePageBox();je(u,h),or(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Ge(this.latestValues)&&or(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ue.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=ue.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ce(),this.relativeTargetOrigin=ce(),Ct(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),je(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ce(),this.targetWithTransforms=ce()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ic(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):je(this.target,this.layout.layoutBox),Ho(this.target,this.targetDelta)):je(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ce(),this.relativeTargetOrigin=ce(),Ct(this.relativeTargetOrigin,this.target,x.target),je(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}_e.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Us(this.parent.latestValues)||Uo(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===ue.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;je(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,x=this.treeScale.y;pc(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:j}=l;if(!j){this.projectionTransform&&(this.projectionDelta=lt(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=lt(),this.projectionDeltaWithTransform=lt());const b=this.projectionTransform;St(this.projectionDelta,this.layoutCorrected,j,this.latestValues),this.projectionTransform=lr(this.projectionDelta,this.treeScale),(this.projectionTransform!==b||this.treeScale.x!==p||this.treeScale.y!==x)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",j)),_e.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},h=lt();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const p=ce(),x=c?c.source:void 0,j=this.layout?this.layout.source:void 0,b=x!==j,w=this.getStack(),A=!w||w.members.length<=1,k=!!(b&&!A&&this.options.crossfade===!0&&!this.path.some(nd));this.animationProgress=0;let S;this.mixTargetDelta=I=>{const D=I/1e3;fr(h.x,a.x,D),fr(h.y,a.y,D),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ct(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),sd(this.relativeTarget,this.relativeTargetOrigin,p,D),S&&Lc(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=ce()),je(S,this.relativeTarget)),b&&(this.animationValues=u,Mc(u,d,this.latestValues,D,k,A)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ve(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ne.update(()=>{Xt.hasAnimatedSinceResize=!0,this.currentAnimation=Uc(0,dr,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(dr),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=a;if(!(!l||!c||!d)){if(this!==a&&this.layout&&d&&Jo(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||ce();const h=ye(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+h;const p=ye(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+p}je(l,c),ct(l,u),St(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Ic),this.sharedNodes.get(a).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<cr.length;u++){const h="rotate"+cr[u];c[h]&&(d[h]=c[h],a.setStaticValue(h,0))}a.render();for(const u in d)a.setStaticValue(u,d[u]);a.scheduleRender()}getProjectionStyles(a){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Hc;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=qt(a==null?void 0:a.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=qt(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Ge(this.latestValues)&&(b.transform=u?u({},""):"none",this.hasProjected=!1),b}const p=h.animationValues||h.latestValues;this.applyTransformsToTarget(),d.transform=lr(this.projectionDeltaWithTransform,this.treeScale,p),u&&(d.transform=u(p,d.transform));const{x,y:j}=this.projectionDelta;d.transformOrigin=`${x.origin*100}% ${j.origin*100}% 0`,h.animationValues?d.opacity=h===this?(c=(l=p.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:d.opacity=h===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const b in Kt){if(p[b]===void 0)continue;const{correct:w,applyTo:A}=Kt[b],k=d.transform==="none"?p[b]:w(p[b],h);if(A){const S=A.length;for(let I=0;I<S;I++)d[A[I]]=k}else d[b]=k}return this.options.layoutId&&(d.pointerEvents=h===this?qt(a==null?void 0:a.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(ur),this.root.sharedNodes.clear()}}}function _c(e){e.updateLayout()}function Wc(e){var t;const s=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:o}=e.layout,{animationType:i}=e.options,a=s.source!==e.layout.source;i==="size"?Ne(h=>{const p=a?s.measuredBox[h]:s.layoutBox[h],x=ye(p);p.min=n[h].min,p.max=p.min+x}):Jo(i,s.layoutBox,n)&&Ne(h=>{const p=a?s.measuredBox[h]:s.layoutBox[h],x=ye(n[h]);p.max=p.min+x,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+x)});const l=lt();St(l,n,s.layoutBox);const c=lt();a?St(c,e.applyTransform(o,!0),s.measuredBox):St(c,n,s.layoutBox);const d=!Ko(l);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:x}=h;if(p&&x){const j=ce();Ct(j,s.layoutBox,p.layoutBox);const b=ce();Ct(b,n,x.layoutBox),Yo(j,b)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=j,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function qc(e){_e.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Xc(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Kc(e){e.clearSnapshot()}function ur(e){e.clearMeasurements()}function Yc(e){e.isLayoutDirty=!1}function Zc(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function hr(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Jc(e){e.resolveTargetDelta()}function Qc(e){e.calcProjection()}function ed(e){e.resetRotation()}function td(e){e.removeLeadSnapshot()}function fr(e,t,s){e.translate=oe(t.translate,0,s),e.scale=oe(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function mr(e,t,s,n){e.min=oe(t.min,s.min,n),e.max=oe(t.max,s.max,n)}function sd(e,t,s,n){mr(e.x,t.x,s.x,n),mr(e.y,t.y,s.y,n)}function nd(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const rd={duration:.45,ease:[.4,0,.1,1]},pr=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),gr=pr("applewebkit/")&&!pr("chrome/")?Math.round:ae;function xr(e){e.min=gr(e.min),e.max=gr(e.max)}function od(e){xr(e.x),xr(e.y)}function Jo(e,t,s){return e==="position"||e==="preserve-aspect"&&!zs(ar(t),ar(s),.2)}const id=Zo({attachResizeListener:(e,t)=>Me(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Cs={current:void 0},Qo=Zo({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Cs.current){const e=new id({});e.mount(window),e.setOptions({layoutScroll:!0}),Cs.current=e}return Cs.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),ad={pan:{Feature:Nc},drag:{Feature:jc,ProjectionNode:Qo,MeasureLayout:Wo}},ld=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function cd(e){const t=ld.exec(e);if(!t)return[,];const[,s,n]=t;return[s,n]}function Gs(e,t,s=1){const[n,o]=cd(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const a=i.trim();return Lo(a)?parseFloat(a):a}else return Es(o)?Gs(o,t,s+1):o}function dd(e,{...t},s){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:s};s&&(s={...s}),e.values.forEach(o=>{const i=o.get();if(!Es(i))return;const a=Gs(i,n);a&&o.set(a)});for(const o in t){const i=t[o];if(!Es(i))continue;const a=Gs(i,n);a&&(t[o]=a,s||(s={}),s[o]===void 0&&(s[o]=i))}return{target:t,transitionEnd:s}}const ud=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),ei=e=>ud.has(e),hd=e=>Object.keys(e).some(ei),yr=e=>e===Ze||e===J,vr=(e,t)=>parseFloat(e.split(", ")[t]),br=(e,t)=>(s,{transform:n})=>{if(n==="none"||!n)return 0;const o=n.match(/^matrix3d\((.+)\)$/);if(o)return vr(o[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?vr(i[1],e):0}},fd=new Set(["x","y","z"]),md=Mt.filter(e=>!fd.has(e));function pd(e){const t=[];return md.forEach(s=>{const n=e.getValue(s);n!==void 0&&(t.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),t.length&&e.render(),t}const ut={width:({x:e},{paddingLeft:t="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),height:({y:e},{paddingTop:t="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:br(4,13),y:br(5,14)};ut.translateX=ut.x;ut.translateY=ut.y;const gd=(e,t,s)=>{const n=t.measureViewportBox(),o=t.current,i=getComputedStyle(o),{display:a}=i,l={};a==="none"&&t.setStaticValue("display",e.display||"block"),s.forEach(d=>{l[d]=ut[d](n,i)}),t.render();const c=t.measureViewportBox();return s.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=ut[d](c,i)}),e},xd=(e,t,s={},n={})=>{t={...t},n={...n};const o=Object.keys(t).filter(ei);let i=[],a=!1;const l=[];if(o.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=s[c],h=gt(u);const p=t[c];let x;if(Zt(p)){const j=p.length,b=p[0]===null?1:0;u=p[b],h=gt(u);for(let w=b;w<j&&p[w]!==null;w++)x?ln(gt(p[w])===x):x=gt(p[w])}else x=gt(p);if(h!==x)if(yr(h)&&yr(x)){const j=d.get();typeof j=="string"&&d.set(parseFloat(j)),typeof p=="string"?t[c]=parseFloat(p):Array.isArray(p)&&x===J&&(t[c]=p.map(parseFloat))}else h!=null&&h.transform&&(x!=null&&x.transform)&&(u===0||p===0)?u===0?d.set(x.transform(u)):t[c]=h.transform(p):(a||(i=pd(e),a=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(p))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=gd(t,e,l);return i.length&&i.forEach(([u,h])=>{e.getValue(u).set(h)}),e.render(),is&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function yd(e,t,s,n){return hd(t)?xd(e,t,s,n):{target:t,transitionEnd:n}}const vd=(e,t,s,n)=>{const o=dd(e,t,n);return t=o.target,n=o.transitionEnd,yd(e,t,s,n)},_s={current:null},ti={current:!1};function bd(){if(ti.current=!0,!!is)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>_s.current=e.matches;e.addListener(t),t()}else _s.current=!1}function wd(e,t,s){const{willChange:n}=t;for(const o in t){const i=t[o],a=s[o];if(pe(i))e.addValue(o,i),ts(n)&&n.add(o);else if(pe(a))e.addValue(o,dt(i,{owner:e})),ts(n)&&n.remove(o);else if(a!==i)if(e.hasValue(o)){const l=e.getValue(o);!l.hasAnimated&&l.set(i)}else{const l=e.getStaticValue(o);e.addValue(o,dt(l!==void 0?l:i,{owner:e}))}}for(const o in s)t[o]===void 0&&e.removeValue(o);return t}const wr=new WeakMap,si=Object.keys(Pt),jd=si.length,jr=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Nd=Js.length;class Sd{constructor({parent:t,props:s,presenceContext:n,reducedMotionConfig:o,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ne.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=s.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=s,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=a,this.isControllingVariants=ls(s),this.isVariantNode=Or(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(s,{});for(const h in u){const p=u[h];l[h]!==void 0&&pe(p)&&(p.set(l[h],!1),ts(d)&&d.add(h))}}scrapeMotionValuesFromProps(t,s){return{}}mount(t){this.current=t,wr.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),ti.current||bd(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:_s.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){wr.delete(this.current),this.projection&&this.projection.unmount(),Ve(this.notifyUpdate),Ve(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,s){const n=Ye.has(t),o=s.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&ne.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=s.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{o(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...s},n,o,i){let a,l;for(let c=0;c<jd;c++){const d=si[c],{isEnabled:u,Feature:h,ProjectionNode:p,MeasureLayout:x}=Pt[d];p&&(a=p),u(s)&&(!this.features[d]&&h&&(this.features[d]=new h(this)),x&&(l=x))}if((this.type==="html"||this.type==="svg")&&!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:h,layoutScroll:p,layoutRoot:x}=s;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||h&&it(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:i,layoutScroll:p,layoutRoot:x})}return l}updateFeatures(){for(const t in this.features){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ce()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,s){this.latestValues[t]=s}makeTargetAnimatable(t,s=!0){return this.makeTargetAnimatableFromInstance(t,this.props,s)}update(t,s){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<jr.length;n++){const o=jr[n];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const i=t["on"+o];i&&(this.propEventSubscriptions[o]=this.on(o,i))}this.prevMotionValues=wd(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const s={};for(let n=0;n<Nd;n++){const o=Js[n],i=this.props[o];(Tt(i)||i===!1)&&(s[o]=i)}return s}addVariantChild(t){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(t),()=>s.variantChildren.delete(t)}addValue(t,s){s!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,s)),this.values.set(t,s),this.latestValues[t]=s.get()}removeValue(t){this.values.delete(t);const s=this.valueSubscriptions.get(t);s&&(s(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,s){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&s!==void 0&&(n=dt(s,{owner:this}),this.addValue(t,n)),n}readValue(t){var s;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(s=this.getBaseTargetFromProps(this.props,t))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,s){this.baseTarget[t]=s}getBaseTarget(t){var s;const{initial:n}=this.props,o=typeof n=="string"||typeof n=="object"?(s=an(this.props,n))===null||s===void 0?void 0:s[t]:void 0;if(n&&o!==void 0)return o;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!pe(i)?i:this.initialValues[t]!==void 0&&o===void 0?void 0:this.baseTarget[t]}on(t,s){return this.events[t]||(this.events[t]=new xn),this.events[t].add(s)}notify(t,...s){this.events[t]&&this.events[t].notify(...s)}}class ni extends Sd{sortInstanceNodePosition(t,s){return t.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(t,s){return t.style?t.style[s]:void 0}removeValueFromRenderState(t,{vars:s,style:n}){delete s[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:s,...n},{transformValues:o},i){let a=$l(n,t||{},this);if(o&&(s&&(s=o(s)),n&&(n=o(n)),a&&(a=o(a))),i){Ol(this,n,a);const l=vd(this,n,a,s);s=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:s,...n}}}function Cd(e){return window.getComputedStyle(e)}class Td extends ni{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,s){if(Ye.has(s)){const n=hn(s);return n&&n.default||0}else{const n=Cd(t),o=(Hr(s)?n.getPropertyValue(s):n[s])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(t,{transformPagePoint:s}){return Go(t,s)}build(t,s,n,o){tn(t,s,n,o.transformTemplate)}scrapeMotionValuesFromProps(t,s){return on(t,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;pe(t)&&(this.childSubscription=t.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}renderInstance(t,s,n,o){Kr(t,s,n,o)}}class Pd extends ni{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,s){return t[s]}readValueFromInstance(t,s){if(Ye.has(s)){const n=hn(s);return n&&n.default||0}return s=Yr.has(s)?s:Ys(s),t.getAttribute(s)}measureInstanceViewportBox(){return ce()}scrapeMotionValuesFromProps(t,s){return Jr(t,s)}build(t,s,n,o){nn(t,s,n,this.isSVGTag,o.transformTemplate)}renderInstance(t,s,n,o){Zr(t,s,n,o)}mount(t){this.isSVGTag=rn(t.tagName),super.mount(t)}}const kd=(e,t)=>en(e)?new Pd(t,{enableHardwareAcceleration:!1}):new Td(t,{enableHardwareAcceleration:!0}),Md={layout:{ProjectionNode:Qo,MeasureLayout:Wo}},Rd={...sc,...ja,...ad,...Md},G=Ai((e,t)=>ca(e,t,Rd,kd));function ri(){const e=g.useRef(!1);return Ks(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Ad(){const e=ri(),[t,s]=g.useState(0),n=g.useCallback(()=>{e.current&&s(t+1)},[t]);return[g.useCallback(()=>ne.postRender(n),[n]),t]}class Vd extends g.Component{getSnapshotBeforeUpdate(t){const s=this.props.childRef.current;if(s&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=s.offsetHeight||0,n.width=s.offsetWidth||0,n.top=s.offsetTop,n.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Ed({children:e,isPresent:t}){const s=g.useId(),n=g.useRef(null),o=g.useRef({width:0,height:0,top:0,left:0});return g.useInsertionEffect(()=>{const{width:i,height:a,top:l,left:c}=o.current;if(t||!n.current||!i||!a)return;n.current.dataset.motionPopId=s;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),g.createElement(Vd,{isPresent:t,childRef:n,sizeRef:o},g.cloneElement(e,{ref:n}))}const Ts=({children:e,initial:t,isPresent:s,onExitComplete:n,custom:o,presenceAffectsLayout:i,mode:a})=>{const l=Qr(Dd),c=g.useId(),d=g.useMemo(()=>({id:c,initial:t,isPresent:s,custom:o,onExitComplete:u=>{l.set(u,!0);for(const h of l.values())if(!h)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),i?void 0:[s]);return g.useMemo(()=>{l.forEach((u,h)=>l.set(h,!1))},[s]),g.useEffect(()=>{!s&&!l.size&&n&&n()},[s]),a==="popLayout"&&(e=g.createElement(Ed,{isPresent:s},e)),g.createElement(os.Provider,{value:d},e)};function Dd(){return new Map}function Ld(e){return g.useEffect(()=>()=>e(),[])}const We=e=>e.key||"";function Id(e,t){e.forEach(s=>{const n=We(s);t.set(n,s)})}function Fd(e){const t=[];return g.Children.forEach(e,s=>{g.isValidElement(s)&&t.push(s)}),t}const ve=({children:e,custom:t,initial:s=!0,onExitComplete:n,exitBeforeEnter:o,presenceAffectsLayout:i=!0,mode:a="sync"})=>{const l=g.useContext(Qs).forceRender||Ad()[0],c=ri(),d=Fd(e);let u=d;const h=g.useRef(new Map).current,p=g.useRef(u),x=g.useRef(new Map).current,j=g.useRef(!0);if(Ks(()=>{j.current=!1,Id(d,x),p.current=u}),Ld(()=>{j.current=!0,x.clear(),h.clear()}),j.current)return g.createElement(g.Fragment,null,u.map(k=>g.createElement(Ts,{key:We(k),isPresent:!0,initial:s?void 0:!1,presenceAffectsLayout:i,mode:a},k)));u=[...u];const b=p.current.map(We),w=d.map(We),A=b.length;for(let k=0;k<A;k++){const S=b[k];w.indexOf(S)===-1&&!h.has(S)&&h.set(S,void 0)}return a==="wait"&&h.size&&(u=[]),h.forEach((k,S)=>{if(w.indexOf(S)!==-1)return;const I=x.get(S);if(!I)return;const D=b.indexOf(S);let R=k;if(!R){const B=()=>{h.delete(S);const V=Array.from(x.keys()).filter(v=>!w.includes(v));if(V.forEach(v=>x.delete(v)),p.current=d.filter(v=>{const T=We(v);return T===S||V.includes(T)}),!h.size){if(c.current===!1)return;l(),n&&n()}};R=g.createElement(Ts,{key:We(I),isPresent:!1,onExitComplete:B,custom:t,presenceAffectsLayout:i,mode:a},I),h.set(S,R)}u.splice(D,0,R)}),u=u.map(k=>{const S=k.key;return h.has(S)?k:g.createElement(Ts,{key:We(k),isPresent:!0,presenceAffectsLayout:i,mode:a},k)}),g.createElement(g.Fragment,null,h.size?u:u.map(k=>g.cloneElement(k)))};function oi(e){var t,s,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(s=oi(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}function ie(){for(var e,t,s=0,n="",o=arguments.length;s<o;s++)(e=arguments[s])&&(t=oi(e))&&(n&&(n+=" "),n+=t);return n}const Bd=({game:e})=>{const t=e.status==="available",s=e.status==="coming-soon",n=e.status==="maintenance",o=r.jsxs(G.div,{whileHover:t?{scale:1.02}:{},whileTap:t?{scale:.98}:{},className:ie("relative h-full bg-gray-800 rounded-xl border-2 overflow-hidden transition-all duration-300",{"border-gray-700 hover:border-purple-500 cursor-pointer shadow-lg hover:shadow-purple-500/20":t,"border-gray-700 opacity-75 cursor-not-allowed":s,"border-orange-600 opacity-75 cursor-not-allowed":n}),children:[(s||n)&&r.jsx("div",{className:"absolute top-2 right-2 z-10",children:r.jsx("span",{className:ie("px-2 py-1 text-xs sm:px-3 sm:text-xs font-pixel rounded-full",{"bg-blue-600 text-white":s,"bg-orange-600 text-white":n}),children:s?"即将推出":"维护中"})}),r.jsx("div",{className:"h-24 sm:h-32 bg-gradient-to-br from-purple-900/50 to-pink-900/50 flex items-center justify-center",children:r.jsx("span",{className:"text-4xl sm:text-6xl",children:e.image})}),r.jsxs("div",{className:"p-3 sm:p-4 space-y-2 sm:space-y-3",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-game font-bold text-white",children:e.title}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400 line-clamp-2",children:e.description}),r.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:e.tags.map(i=>r.jsx("span",{className:"px-1.5 py-0.5 sm:px-2 sm:py-1 text-xs bg-gray-700 text-gray-300 rounded-md",children:i},i))}),r.jsxs("div",{className:"pt-2 sm:pt-3 border-t border-gray-700 grid grid-cols-3 gap-1 sm:gap-2 text-xs text-gray-500",children:[r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"难度"}),r.jsx("div",{className:ie("text-xs",{"text-green-400":e.difficulty==="简单","text-yellow-400":e.difficulty==="中等","text-red-400":e.difficulty==="困难"}),children:e.difficulty})]}),r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"玩家"}),r.jsx("div",{className:"text-xs",children:e.players})]}),r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"时长"}),r.jsx("div",{className:"text-xs",children:e.time})]})]}),t&&r.jsx("button",{className:"w-full mt-3 sm:mt-4 px-3 py-2 sm:px-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-game text-xs sm:text-sm rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all active:scale-95",children:"开始游戏"})]})]});return t?r.jsx(As,{to:e.path,children:o}):o},Od=()=>{const[e,t]=g.useState(0),[s,n]=g.useState(!1),[o,i]=g.useState(null);return g.useEffect(()=>{let a;a="http://socket.qingfengyueying.xyz/stats",console.log("[OnlineStats] 正在连接到:",a);const l=Xs(a,{transports:["websocket","polling"],upgrade:!0,timeout:1e4,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3});return l.on("connect",()=>{console.log("[OnlineStats] 连接成功, Socket ID:",l.id),n(!0),l.emit("get-online-count")}),l.on("online-count",c=>{console.log("[OnlineStats] 收到在线人数:",c.count),t(c.count||0)}),l.on("user-count-update",c=>{console.log("[OnlineStats] 在线人数更新:",c.count),t(c.count||0)}),l.on("connect_error",c=>{console.error("[OnlineStats] 连接错误:",c.message),n(!1)}),l.on("disconnect",c=>{console.log("[OnlineStats] 连接断开, 原因:",c),n(!1)}),l.on("reconnect",c=>{console.log("[OnlineStats] 重连成功, 尝试次数:",c),n(!0),l.emit("get-online-count")}),l.on("reconnect_failed",()=>{console.error("[OnlineStats] 重连失败"),n(!1),t(Math.floor(Math.random()*30)+5)}),i(l),()=>{console.log("[OnlineStats] 清理Socket连接"),l&&l.disconnect()}},[]),{onlineCount:e,isConnected:s,socket:o}},Nr=[{id:"gomoku",title:"五子棋",description:"经典双人对战游戏",image:"♟️",path:"/games/gomoku",tags:["双人","策略","PVP"],difficulty:"简单",players:"2人",time:"10-20分钟",status:"available"},{id:"2048",title:"2048",description:"数字合并益智游戏",image:"🔢",path:"/games/2048",tags:["单人","益智","策略"],difficulty:"中等",players:"1人",time:"10-30分钟",status:"available"},{id:"snake",title:"贪吃蛇",description:"经典贪吃蛇游戏",image:"🐍",path:"/games/snake",tags:["单人","休闲","经典"],difficulty:"简单",players:"1人",time:"5-10分钟",status:"available"},{id:"tetris",title:"俄罗斯方块",description:"经典方块消除游戏",image:"🎮",path:"/games/tetris",tags:["单人","休闲","经典"],difficulty:"中等",players:"1人",time:"无限",status:"available"},{id:"tictactoe",title:"井字棋",description:"简单有趣的对战游戏",image:"❌",path:"/games/tictactoe",tags:["双人","策略","PVP"],difficulty:"简单",players:"1-2人",time:"2-5分钟",status:"available"},{id:"memory",title:"记忆翻牌",description:"考验记忆力的配对游戏",image:"🎴",path:"/games/memory",tags:["单人","益智","记忆"],difficulty:"简单",players:"1人",time:"5-10分钟",status:"available"},{id:"sudoku",title:"数独",description:"经典数字填空游戏",image:"🔢",path:"/games/sudoku",tags:["单人","益智","逻辑"],difficulty:"困难",players:"1人",time:"15-30分钟",status:"available"},{id:"breakout",title:"打砖块",description:"经典弹球消除游戏",image:"🧱",path:"/games/breakout",tags:["单人","休闲","经典"],difficulty:"中等",players:"1人",time:"10-20分钟",status:"available"}],zd=()=>{const[e,t]=g.useState("全部"),{onlineCount:s,isConnected:n}=Od(),o=["全部","双人","单人","策略","休闲","益智"],i=g.useMemo(()=>e==="全部"?Nr:Nr.filter(l=>l.tags.includes(e)),[e]),a=g.useMemo(()=>({available:i.filter(l=>l.status==="available").length,comingSoon:i.filter(l=>l.status==="coming-soon").length,onlineUsers:s}),[i,s]);return r.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[r.jsxs(G.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center space-y-4 sm:space-y-6",children:[r.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-game font-bold",children:r.jsx("span",{className:"bg-gradient-to-r from-purple-400 via-pink-400 to-red-400 bg-clip-text text-transparent",children:"游戏合集"})}),r.jsx("p",{className:"text-base sm:text-xl text-gray-400 font-game px-4",children:"精选经典小游戏，随时随地享受游戏乐趣"}),r.jsxs("div",{className:"flex justify-center gap-3 sm:gap-8 mt-6 sm:mt-8 px-4",children:[r.jsxs(G.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsx("div",{className:"text-xl sm:text-3xl font-bold text-purple-400",children:a.available}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"可玩游戏"})]}),r.jsxs(G.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsx("div",{className:"text-xl sm:text-3xl font-bold text-pink-400",children:a.comingSoon}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"即将推出"})]}),r.jsxs(G.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsxs("div",{className:"text-xl sm:text-3xl font-bold text-blue-400 flex items-center justify-center gap-1",children:[a.onlineUsers,n&&r.jsx("span",{className:"inline-block w-2 h-2 bg-green-400 rounded-full animate-pulse"})]}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"在线玩家"})]})]})]}),r.jsx("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3 px-4",children:o.map((l,c)=>r.jsx(G.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:c*.1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(l),className:`px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all
              ${l===e?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white border border-gray-700"}`,children:l},l))}),r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:i.length>0?i.map((l,c)=>r.jsx(G.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:c*.1},children:r.jsx(Bd,{game:l})},l.id)):r.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},className:"col-span-full text-center py-12",children:[r.jsxs("p",{className:"text-gray-400 text-lg",children:['没有找到"',e,'"类型的游戏']}),r.jsx("button",{onClick:()=>t("全部"),className:"mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"查看全部游戏"})]})}),r.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-12 sm:mt-16 grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6",children:[r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"🎮"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-purple-400",children:"精选游戏"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"精心挑选的经典游戏，保证游戏质量和趣味性"})]}),r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"🌐"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-pink-400",children:"在线对战"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"支持实时在线对战，与好友一起享受游戏乐趣"})]}),r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"📱"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-blue-400",children:"跨平台"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"完美适配手机和电脑，随时随地开始游戏"})]})]})]})},Ws=13,Sr=["快乐的","聪明的","勇敢的","可爱的","厉害的","机智的","活泼的","霸气的","淡定的","优雅的","神秘的","幸运的","专注的","认真的","潇洒的","冷静的"],Cr=["熊猫","狐狸","老虎","狮子","兔子","猫咪","狗狗","猴子","企鹅","海豚","鲸鱼","老鹰","凤凰","龙龙","独角兽","考拉"],yt=()=>Array(Ws).fill(null).map(()=>Array(Ws).fill(0)),de=pi((e,t)=>({board:yt(),boardSize:Ws,currentPlayer:1,myColor:null,gameState:"waiting",winner:null,lastMove:null,winningLine:null,userRole:null,spectatorCount:0,myNickname:null,opponentNickname:null,history:[],canUndo:!1,score:{black:0,white:0},roundNumber:1,firstPlayer:1,roomId:null,isHost:!1,opponentName:null,notifications:[],initBoard:()=>{const{roundNumber:s}=t(),n=s%2===1?1:2;e({board:yt(),currentPlayer:n,winner:null,lastMove:null,winningLine:null,gameState:"waiting",history:[],canUndo:!1,firstPlayer:n})},makeMove:(s,n)=>{const{board:o,currentPlayer:i,gameState:a,myColor:l,boardSize:c,userRole:d}=t();if(a!=="playing"||d==="spectator"||i!==l||s<0||s>=c||n<0||n>=c||o[s][n]!==0)return!1;const u=o.map(x=>[...x]);u[s][n]=i;const h=t().checkWin(s,n,i),p=h!==null;return t().addHistory(i,{row:s,col:n}),e({board:u,lastMove:{row:s,col:n},currentPlayer:i===1?2:1,winner:p?i:null,winningLine:h,gameState:p?"finished":"playing",canUndo:!0}),p&&t().updateScore(i),!0},setPlayerColor:s=>{e({myColor:s})},setGameState:s=>{e({gameState:s})},setRoomInfo:(s,n)=>{e({roomId:s,isHost:n})},resetGame:()=>{e({board:yt(),currentPlayer:1,myColor:null,gameState:"waiting",winner:null,lastMove:null,winningLine:null,roomId:null,isHost:!1,history:[],canUndo:!1,opponentName:null,notifications:[],score:{black:0,white:0},roundNumber:1,firstPlayer:1,userRole:null,spectatorCount:0,myNickname:null,opponentNickname:null})},checkWin:(s,n,o)=>{const{board:i,boardSize:a}=t(),l=[[[0,1],[0,-1]],[[1,0],[-1,0]],[[1,1],[-1,-1]],[[1,-1],[-1,1]]];for(const c of l){const d=[{row:s,col:n}];for(const[u,h]of c){let p=s+u,x=n+h;for(;p>=0&&p<a&&x>=0&&x<a&&i[p][x]===o;)d.push({row:p,col:x}),p+=u,x+=h}if(d.length>=5)return d}return null},addNotification:(s,n)=>{const o={id:Math.random().toString(36).substr(2,9),type:s,message:n,timestamp:Date.now()};e(i=>({notifications:[...i.notifications,o]})),setTimeout(()=>{t().removeNotification(o.id)},5e3)},removeNotification:s=>{e(n=>({notifications:n.notifications.filter(o=>o.id!==s)}))},updateScore:s=>{e(n=>({score:{...n.score,[s===1?"black":"white"]:n.score[s===1?"black":"white"]+1}}))},nextRound:()=>{e(s=>{const n=s.roundNumber+1,o=n%2===1?1:2;return{board:yt(),currentPlayer:o,winner:null,lastMove:null,winningLine:null,gameState:"playing",history:[],canUndo:!1,roundNumber:n,firstPlayer:o}})},setOpponentName:s=>{e({opponentName:s})},addHistory:(s,n)=>{e(o=>({history:[...o.history,{player:s,position:n,timestamp:Date.now()}]}))},setCanUndo:s=>{e({canUndo:s})},undoMove:()=>{const{history:s}=t();if(s.length<2)return;const n=s.slice(0,-2),o=yt();n.forEach(l=>{o[l.position.row][l.position.col]=l.player});const i=n.length>0?n[n.length-1].player===1?2:1:t().firstPlayer,a=n.length>0?n[n.length-1].position:null;e({board:o,history:n,currentPlayer:i,lastMove:a,canUndo:!1,winningLine:null})},setWinningLine:s=>{e({winningLine:s})},setUserRole:s=>{e({userRole:s})},setSpectatorCount:s=>{e({spectatorCount:s})},canMakeMove:()=>{const{userRole:s,myColor:n,currentPlayer:o,gameState:i}=t();return s==="player"&&n===o&&i==="playing"},setMyNickname:s=>{e({myNickname:s})},setOpponentNickname:s=>{e({opponentNickname:s})},generateRandomNickname:()=>{const s=Sr[Math.floor(Math.random()*Sr.length)],n=Cr[Math.floor(Math.random()*Cr.length)],o=Math.floor(Math.random()*100);return`${s}${n}${o}`}}));let Z=null,He=!1;const hs=()=>{const[e,t]=g.useState(He),{setGameState:s,setPlayerColor:n,initBoard:o,addNotification:i,nextRound:a,undoMove:l,setCanUndo:c,setWinningLine:d,setUserRole:u,userRole:h,setOpponentNickname:p}=de();return g.useEffect(()=>{if(Z)t(He);else{let V;V="http://socket.qingfengyueying.xyz",console.log("Attempting to connect to:",V),Z=Xs(V,{transports:["websocket","polling"],upgrade:!0,path:"/socket.io/",timeout:1e4,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),Z.on("connect",()=>{console.log("Socket connected to:",V),He=!0,t(!0)}),Z.on("disconnect",()=>{console.log("Socket disconnected"),He=!1,t(!1),i("warning","与服务器断开连接")}),Z.on("connect_error",v=>{console.error("Socket connection error:",v),He=!1,t(!1)}),Z.on("reconnect",v=>{console.log("Socket reconnected after",v,"attempts"),He=!0,t(!0),i("success","重新连接成功")}),Z.on("reconnect_error",v=>{console.error("Socket reconnection error:",v),He=!1,t(!1)}),Z.on("game-start",v=>{console.log("Game started, my color:",v.playerColor,"opponent:",v.opponentId),console.log("Before state update - gameState:",de.getState().gameState),v.opponentNickname&&p(v.opponentNickname),n(v.playerColor),o(),s("playing"),i("success","🎯 游戏开始！"),console.log("After state update - gameState:",de.getState().gameState),console.log("After state update - myColor:",de.getState().myColor)}),Z.on("game-start-spectator",v=>{console.log("Game started for spectator, black:",v.blackPlayer,"white:",v.whitePlayer),v.blackNickname&&v.whiteNickname,o(),s("playing"),i("info","🎯 游戏已开始，你正在观战")}),Z.on("role-changed",v=>{console.log("Role changed to:",v.role),u(v.role),v.role==="spectator"?(n(null),i("info","👁️ 你现在是观众")):i("success","🎮  你现在是玩家")}),Z.on("user-role-changed",v=>{v.wasSurrender?i("info","🏳️ 一位玩家认输并成为观众"):v.role==="player"?i("info","👥 一位观众成为了玩家"):i("info","👁️ 一位玩家成为了观众")}),Z.on("role-change-error",v=>{console.error("Role change error:",v.message),i("error",`❌ ${v.message}`)}),Z.on("ready-prompt",()=>{console.log("Ready prompt received"),Z&&Z.emit("ready-to-play")}),Z.on("game-move",v=>{console.log("Game move for spectator:",v);const T=de.getState();if(T.userRole!=="spectator")return;const L=T.board.map(P=>[...P]);L[v.row][v.col]=T.currentPlayer;const N=T.checkWin(v.row,v.col,T.currentPlayer),M=N!==null;T.addHistory(T.currentPlayer,{row:v.row,col:v.col}),de.setState({board:L,lastMove:{row:v.row,col:v.col},currentPlayer:T.currentPlayer===1?2:1,winner:M?T.currentPlayer:null,winningLine:N,gameState:M?"finished":"playing"}),M&&T.updateScore(T.currentPlayer)}),Z.on("room-created",v=>{console.log("Room created:",v),i("success",`✅ 房间 ${v.roomId} 创建成功`)}),Z.on("room-joined",v=>{console.log("Room joined:",v),i("success",`✅ 已加入房间 ${v.roomId}`),Z&&(console.log("Auto-readying for game start..."),Z.emit("ready-to-play"))}),Z.on("spectator-joined",v=>{console.log("Joined as spectator:",v),i("info",`👁️ 已以观众身份加入房间 ${v.roomId}`)}),Z.on("room-error",v=>{console.error("Room error:",v.message),i("error",`❌ ${v.message}`)}),Z.on("room-list",v=>{console.log("Room list updated:",v)}),Z.on("opponent-move",v=>{console.log("Opponent made move:",v);const T=de.getState();if(T.userRole!=="player")return;const L=T.board.map(P=>[...P]);L[v.row][v.col]=T.currentPlayer;const N=T.checkWin(v.row,v.col,T.currentPlayer),M=N!==null;T.addHistory(T.currentPlayer,{row:v.row,col:v.col}),de.setState({board:L,lastMove:{row:v.row,col:v.col},currentPlayer:T.currentPlayer===1?2:1,winner:M?T.currentPlayer:null,winningLine:N,gameState:M?"finished":"playing",canUndo:!0}),M&&T.updateScore(T.currentPlayer)}),Z.on("game-restart",()=>{console.log("Game restart - both players agreed"),a(),s("playing"),i("success","🎮 游戏已重新开始")}),Z.on("undo-move",()=>{console.log("Undo move - both players agreed"),l(),i("info","↩️ 已悔棋")}),Z.on("opponent-nickname",v=>{console.log("Received opponent nickname:",v.nickname),p(v.nickname)})}return()=>{}},[s,n,o,i,a,l,c,d,u,h,p]),{socket:Z,connected:e,sendMove:(V,v,T)=>{Z&&(console.log("Sending move:",{roomId:V,row:v,col:T}),Z.emit("make-move",{roomId:V,row:v,col:T}))},requestRestart:V=>{Z&&(console.log("Requesting restart:",V),Z.emit("request-restart",{roomId:V}))},acceptRestart:V=>{Z&&(console.log("Accepting restart:",V),Z.emit("accept-restart",{roomId:V}))},rejectRestart:V=>{Z&&(console.log("Rejecting restart:",V),Z.emit("reject-restart",{roomId:V}))},requestUndo:V=>{Z&&(console.log("Requesting undo:",V),Z.emit("request-undo",{roomId:V}))},acceptUndo:V=>{Z&&(console.log("Accepting undo:",V),Z.emit("accept-undo",{roomId:V}))},rejectUndo:V=>{Z&&(console.log("Rejecting undo:",V),Z.emit("reject-undo",{roomId:V}))},surrender:(V,v)=>{Z&&(console.log("Surrendering:",V,"myColor:",v),Z.emit("surrender",{roomId:V,surrenderColor:v}))},sendChatMessage:(V,v)=>{Z&&(console.log("Sending chat message:",{roomId:V,message:v}),Z.emit("chat-message",{roomId:V,message:v}))},spectatorToPlayer:()=>{Z&&(console.log("Requesting to become player"),Z.emit("spectator-to-player"))},playerToSpectator:()=>{Z&&(console.log("Requesting to become spectator"),Z.emit("player-to-spectator"))}}},Tr=()=>{const e=g.useRef(null),t=g.useRef(null),s=g.useRef(null),[n,o]=g.useState(40),[i,a]=g.useState(520),[l,c]=g.useState(1),[d,u]=g.useState(null),{board:h,currentPlayer:p,gameState:x,makeMove:j,myColor:b,roomId:w,lastMove:A,winningLine:k}=de(),{sendMove:S}=hs(),I=h.length;g.useEffect(()=>{const m=()=>{const z=window.innerWidth,_=window.innerHeight,K=window.devicePixelRatio||1;if(z<640){const F=z-15,$=_-15-25-25-15,U=Math.min(F,$),W=Math.min(U,F*.95),Y=Math.floor(W/I),te=Y*I;o(Y),a(te),c(K),console.log("Mobile board size:",{viewport:{width:z,height:_},available:{width:F,height:$},target:W,cell:Y,board:te})}else{const E=_-30-35-30,F=Math.min(580,E*.9),$=180*2,U=z-$-60,W=Math.min(F,U,E*.9),Y=Math.floor(W/I),te=Y*I;o(Y),a(te),c(K),console.log("PC board size:",{viewport:{width:z,height:_},availableHeight:E,availableWidth:U,target:W,cell:Y,board:te})}};return m(),window.addEventListener("resize",m),window.addEventListener("orientationchange",m),()=>{window.removeEventListener("resize",m),window.removeEventListener("orientationchange",m)}},[I]);const D=(m,z)=>{const _=e.current,K=s.current;if(!_||!K)return null;const q=K.getBoundingClientRect(),y=window.getComputedStyle(K),f=parseInt(y.paddingLeft)||0,C=parseInt(y.paddingTop)||0,E=m-q.left-f,F=z-q.top-C,$=Math.floor(E/n),U=Math.floor(F/n);return U>=0&&U<I&&$>=0&&$<I?{row:U,col:$}:null},R=m=>{const z=i*l;m.clearRect(0,0,z,z),m.save(),m.scale(l,l);const _=m.createLinearGradient(0,0,i,i);_.addColorStop(0,"#D4A574"),_.addColorStop(.3,"#C19A6B"),_.addColorStop(.6,"#CD9B62"),_.addColorStop(1,"#B8956A"),m.fillStyle=_,m.fillRect(0,0,i,i),m.globalAlpha=.1;for(let q=0;q<50;q++){m.strokeStyle="#8B7355",m.lineWidth=Math.random()*2,m.beginPath();const y=Math.random()*i;m.moveTo(0,y),m.bezierCurveTo(i*.3,y+Math.random()*20-10,i*.7,y+Math.random()*20-10,i,y+Math.random()*10-5),m.stroke()}m.globalAlpha=1,m.shadowColor="rgba(0, 0, 0, 0.3)",m.shadowBlur=2,m.shadowOffsetX=1,m.shadowOffsetY=1,m.strokeStyle="#2C1810",m.lineWidth=1.5;for(let q=0;q<I;q++){const y=q*n+n/2;m.beginPath(),m.moveTo(n/2,y),m.lineTo(i-n/2,y),m.stroke(),m.beginPath(),m.moveTo(y,n/2),m.lineTo(y,i-n/2),m.stroke()}m.shadowColor="transparent",m.shadowBlur=0,m.shadowOffsetX=0,m.shadowOffsetY=0;const K=[{row:3,col:3},{row:3,col:9},{row:9,col:3},{row:9,col:9},{row:6,col:6}];m.fillStyle="#1A0E08",K.forEach(q=>{if(q.row<I&&q.col<I){const y=q.col*n+n/2,f=q.row*n+n/2;m.beginPath(),m.arc(y,f,5,0,Math.PI*2),m.fill(),m.fillStyle="#2C1810",m.beginPath(),m.arc(y,f,3,0,Math.PI*2),m.fill(),m.fillStyle="#1A0E08"}}),m.restore()},B=(m,z,_,K,q=!1)=>{const y=_*n+n/2,f=z*n+n/2,C=n*.42;if(m.save(),m.scale(l,l),K===1){const E=m.createRadialGradient(y-C/3,f-C/3,0,y,f,C);E.addColorStop(0,"#4A4A4A"),E.addColorStop(.5,"#2C2C2C"),E.addColorStop(.8,"#1A1A1A"),E.addColorStop(1,"#000000"),m.shadowColor="rgba(0, 0, 0, 0.5)",m.shadowBlur=5,m.shadowOffsetX=2,m.shadowOffsetY=2,m.fillStyle=E,m.beginPath(),m.arc(y,f,C,0,Math.PI*2),m.fill();const F=m.createRadialGradient(y-C/3,f-C/3,0,y-C/3,f-C/3,C/2);F.addColorStop(0,"rgba(255, 255, 255, 0.3)"),F.addColorStop(1,"rgba(255, 255, 255, 0)"),m.fillStyle=F,m.beginPath(),m.arc(y,f,C,0,Math.PI*2),m.fill()}else{const E=m.createRadialGradient(y-C/3,f-C/3,0,y,f,C);E.addColorStop(0,"#FFFFFF"),E.addColorStop(.3,"#F8F8F8"),E.addColorStop(.7,"#E8E8E8"),E.addColorStop(1,"#D0D0D0"),m.shadowColor="rgba(0, 0, 0, 0.3)",m.shadowBlur=4,m.shadowOffsetX=2,m.shadowOffsetY=2,m.fillStyle=E,m.beginPath(),m.arc(y,f,C,0,Math.PI*2),m.fill(),m.strokeStyle="#B0B0B0",m.lineWidth=1,m.stroke();const F=m.createRadialGradient(y-C/4,f-C/4,0,y-C/4,f-C/4,C/3);F.addColorStop(0,"rgba(255, 255, 255, 0.9)"),F.addColorStop(1,"rgba(255, 255, 255, 0)"),m.fillStyle=F,m.beginPath(),m.arc(y,f,C,0,Math.PI*2),m.fill()}q&&(m.shadowColor="#FFD700",m.shadowBlur=15,m.strokeStyle="#FFD700",m.lineWidth=3,m.beginPath(),m.arc(y,f,C+5,0,Math.PI*2),m.stroke()),m.restore()},V=m=>{if(!A)return;m.save(),m.scale(l,l);const z=A.col*n+n/2,_=A.row*n+n/2,K=n*.2,q=n*.35,y=Date.now()/1e3,f=Math.sin(y*3)*.1+.9;m.strokeStyle="#FF6B6B",m.lineWidth=3,m.lineCap="round",m.globalAlpha=f,[{dx:-1,dy:-1},{dx:1,dy:-1},{dx:1,dy:1},{dx:-1,dy:1}].forEach(E=>{m.beginPath(),m.moveTo(z+E.dx*q,_+E.dy*q),m.lineTo(z+E.dx*(q-K),_+E.dy*q),m.moveTo(z+E.dx*q,_+E.dy*q),m.lineTo(z+E.dx*q,_+E.dy*(q-K)),m.stroke()}),m.restore()},v=m=>{if(!k||k.length<5)return;m.save(),m.scale(l,l);const z=k[0],_=k[k.length-1],K=z.col*n+n/2,q=z.row*n+n/2,y=_.col*n+n/2,f=_.row*n+n/2,C=Date.now()/100,E=C%20;m.strokeStyle="#FFD700",m.lineWidth=4,m.lineCap="round",m.shadowColor="#FFD700",m.shadowBlur=20,m.setLineDash([10,10]),m.lineDashOffset=-E,m.beginPath(),m.moveTo(K,q),m.lineTo(y,f),m.stroke();const F=5;for(let $=0;$<F;$++){const U=(C/10+$*20)%100/100,W=K+(y-K)*U,Y=q+(f-q)*U;m.fillStyle="#FFD700",m.globalAlpha=1-U,m.beginPath(),m.arc(W,Y,3+U*5,0,Math.PI*2),m.fill()}m.restore()},T=m=>{if(!d||x!=="playing"||p!==b||h[d.row][d.col]!==0)return;const z=i*l;m.clearRect(0,0,z,z),m.save(),m.scale(l,l);const _=d.col*n+n/2,K=d.row*n+n/2,q=n*.42,y=Date.now()/1e3,f=Math.sin(y*4)*.1+.9;if(m.globalAlpha=.5,p===1){const C=m.createRadialGradient(_,K,0,_,K,q*f);C.addColorStop(0,"rgba(0, 0, 0, 0.8)"),C.addColorStop(1,"rgba(0, 0, 0, 0.4)"),m.fillStyle=C}else{const C=m.createRadialGradient(_,K,0,_,K,q*f);C.addColorStop(0,"rgba(255, 255, 255, 0.9)"),C.addColorStop(1,"rgba(255, 255, 255, 0.5)"),m.fillStyle=C}m.beginPath(),m.arc(_,K,q*f,0,Math.PI*2),m.fill(),m.strokeStyle=p===1?"rgba(0, 0, 0, 0.3)":"rgba(255, 255, 255, 0.5)",m.lineWidth=2,m.beginPath(),m.arc(_,K,q*f+5,0,Math.PI*2),m.stroke(),m.restore()};g.useEffect(()=>{const m=e.current,z=m==null?void 0:m.getContext("2d");if(!z||!m)return;m.width=i*l,m.height=i*l,R(z),h.forEach((q,y)=>{q.forEach((f,C)=>{if(f!==0){const E=(k==null?void 0:k.some(F=>F.row===y&&F.col===C))||!1;B(z,y,C,f,E)}})}),V(z),v(z);let _;const K=()=>{V(z),v(z),_=requestAnimationFrame(K)};return(A||k)&&K(),()=>{_&&cancelAnimationFrame(_)}},[h,n,i,A,k,l]),g.useEffect(()=>{const m=t.current,z=m==null?void 0:m.getContext("2d");if(!z||!m)return;m.width=i*l,m.height=i*l,T(z);let _;const K=()=>{T(z),_=requestAnimationFrame(K)};return K(),()=>{cancelAnimationFrame(_)}},[d,h,x,p,b,n,i,l]);const L=m=>{if(x!=="playing"||p!==b)return;const z="touches"in m?m.touches[0].clientX:m.clientX,_="touches"in m?m.touches[0].clientY:m.clientY,K=D(z,_);if(!K)return;const{row:q,col:y}=K;h[q][y]===0&&(j(q,y),S&&w&&S(w,q,y),u(null))},N=m=>{const z=D(m.clientX,m.clientY);u(z)},M=()=>{u(null)},P=m=>{L(m)};return r.jsx(G.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},className:"inline-block",children:r.jsxs("div",{ref:s,className:"relative pixel-container p-1 sm:p-2 bg-gradient-to-br from-amber-900/20 to-amber-800/20",onClick:L,onMouseMove:N,onMouseLeave:M,onTouchStart:P,style:{cursor:x==="playing"&&p===b?"pointer":"not-allowed"},children:[r.jsx("canvas",{ref:e,style:{width:`${i}px`,height:`${i}px`,display:"block",imageRendering:"crisp-edges"}}),r.jsx("canvas",{ref:t,className:"absolute top-1 left-1 sm:top-2 sm:left-2 pointer-events-none",style:{width:`${i}px`,height:`${i}px`,imageRendering:"crisp-edges"}})]})})},$d=({onJoinRoom:e})=>{const[t,s]=g.useState(""),[n,o]=g.useState([]),[i,a]=g.useState(!1),{socket:l,connected:c}=hs(),{setRoomInfo:d,setUserRole:u,generateRandomNickname:h,setMyNickname:p}=de();console.log("RoomManager - connected:",c,"socket:",l),g.useEffect(()=>{if(l)return l.on("room-list",w=>{o(w)}),l.on("room-created",w=>{const A=h();p(A),l.emit("set-nickname",{roomId:w.roomId,nickname:A}),d(w.roomId,w.isHost),u("player"),e(),a(!1)}),l.on("room-joined",w=>{const A=h();p(A),l.emit("set-nickname",{roomId:w.roomId,nickname:A}),d(w.roomId,w.isHost),u("player"),e(),a(!1)}),l.on("spectator-joined",w=>{const A=h();p(A),l.emit("set-nickname",{roomId:w.roomId,nickname:A}),d(w.roomId,!1),u("spectator"),e(),a(!1)}),l.on("room-error",w=>{alert(w.message),a(!1)}),l.emit("get-rooms"),()=>{l.off("room-list"),l.off("room-created"),l.off("room-joined"),l.off("spectator-joined"),l.off("room-error")}},[l,e,d,u,h,p]);const x=()=>{if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("create-room")},j=w=>{const A=w||t.trim();if(!A){alert("请输入房间ID");return}if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("join-room",{roomId:A})},b=w=>{const A=w||t.trim();if(!A){alert("请输入房间ID");return}if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("join-as-spectator",{roomId:A})};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs(G.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center",children:[r.jsx("h2",{className:"text-lg sm:text-xl font-game font-bold text-white",children:"五子棋房间管理"}),r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"创建新房间或加入现有房间开始游戏"})]}),r.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-gray-800 rounded-lg p-3 sm:p-4 space-y-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-purple-400",children:"创建新房间"}),r.jsx("button",{onClick:x,disabled:i||!c,className:"w-full pixel-btn bg-purple-600 hover:bg-purple-700 py-1.5 text-xs sm:text-sm",children:i?"创建中...":"创建房间"})]}),r.jsx("div",{className:"border-t border-gray-700"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-pink-400",children:"加入房间"}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("input",{type:"text",value:t,onChange:w=>s(w.target.value.toUpperCase()),onKeyPress:w=>w.key==="Enter"&&j(),placeholder:"输入房间ID",className:"w-full px-2 py-1 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-pink-400 focus:outline-none text-xs sm:text-sm",maxLength:6}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>j(),disabled:i||!c,className:"flex-1 pixel-btn bg-pink-600 hover:bg-pink-700 py-1 px-3 text-xs sm:text-sm",children:"加入游戏"}),r.jsx("button",{onClick:()=>b(),disabled:i||!c,className:"flex-1 pixel-btn bg-yellow-600 hover:bg-yellow-700 py-1 px-3 text-xs sm:text-sm",children:"观战"})]})]})]}),r.jsx("div",{className:"border-t border-gray-700"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-blue-400",children:"可用房间"}),r.jsx("div",{className:"space-y-1 max-h-32 sm:max-h-40 overflow-y-auto custom-scrollbar",children:n.length===0?r.jsx("p",{className:"text-gray-500 text-center py-2 text-xs sm:text-sm",children:"暂无可用房间"}):n.map(w=>r.jsxs(G.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between p-1.5 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-pixel text-yellow-400 text-xs sm:text-sm",children:w.id}),r.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:[w.playerCount,"/2 玩家"]})]}),r.jsxs("div",{className:"flex gap-1",children:[w.playerCount<2&&r.jsx("button",{onClick:()=>j(w.id),disabled:i,className:"px-2 py-0.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors",children:"加入"}),r.jsx("button",{onClick:()=>b(w.id),disabled:i,className:"px-2 py-0.5 bg-yellow-600 hover:bg-yellow-700 text-white text-xs rounded transition-colors",children:"观战"})]})]},w.id))})]})]}),r.jsx("div",{className:"text-center",children:r.jsx("span",{className:`text-xs ${c?"text-green-400":"text-red-400"}`,children:c?"✓ 已连接到服务器":"✗ 未连接到服务器"})})]})},wt=({color:e,size:t="medium",isActive:s=!1,className:n=""})=>{const o={small:"w-7 h-7 text-xs",medium:"w-10 h-10 text-sm",large:"w-12 h-12 text-base"},i=l=>l===1?"🐼":l===2?"🦊":"👤",a=l=>l===1?"bg-gradient-to-br from-gray-800 to-black text-white":l===2?"bg-gradient-to-br from-white to-gray-200 text-gray-800 border-2 border-gray-400":"bg-gray-600 text-gray-400";return r.jsxs(G.div,{className:ie(o[t],a(e),"rounded-full flex items-center justify-center shadow-lg font-bold relative",n),animate:s?{scale:[1,1.1,1]}:{},transition:s?{repeat:1/0,duration:2}:{},children:[r.jsx("span",{className:t==="small"?"text-sm":"text-lg",children:i(e)}),s&&r.jsx(G.div,{className:"absolute -bottom-1 -right-1 w-2.5 h-2.5 bg-green-400 rounded-full border-2 border-gray-900",animate:{scale:[.8,1.2,.8]},transition:{repeat:1/0,duration:1.5}}),r.jsx("div",{className:ie("absolute -top-1 -right-1 rounded-full shadow-md",t==="small"?"w-3 h-3":"w-4 h-4",e===1?"bg-gradient-to-br from-gray-700 to-black":e===2?"bg-gradient-to-br from-white to-gray-300 border border-gray-400":"hidden")})]})},Ps=({side:e})=>{const{currentPlayer:t,gameState:s,myColor:n,score:o,roundNumber:i,winner:a,userRole:l,myNickname:c,opponentNickname:d}=de(),u=l==="spectator",h=u?1:n,p=u||n===1?2:n===2?1:null;return e==="left"?r.jsx("div",{className:"pixel-container bg-gradient-to-b from-gray-800/50 to-gray-900/50 p-2 w-44",children:r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("div",{className:`text-xs font-bold text-white px-2 py-0.5 rounded ${u?"bg-gray-600/20":"bg-green-600/20"}`,children:u?"黑方":"你的棋子"}),r.jsx(wt,{color:h,size:"medium",isActive:s==="playing"&&t===h}),!u&&c&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:c}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:`w-4 h-4 rounded-full shadow-lg ${h===1?"bg-gradient-to-br from-gray-800 to-black":h===2?"bg-gradient-to-br from-white to-gray-200 border border-gray-400":"bg-gray-600"}`}),r.jsx("span",{className:"text-sm font-game text-white",children:h===1?"黑棋":h===2?"白棋":"未定"})]}),r.jsxs("div",{className:"text-xs text-gray-300",children:["得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:h===1?o.black:h===2?o.white:0})]}),!u&&s==="playing"&&t===n&&r.jsx(G.div,{className:"text-green-400 font-pixel text-xs bg-green-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"🎯 你的回合"}),u&&s==="playing"&&t===1&&r.jsx(G.div,{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"黑棋思考中"}),u&&s==="waiting"&&r.jsx(G.div,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待开局"}),u&&s==="finished"&&a===1&&r.jsx(G.div,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:"⚫ 黑棋获胜"})]})}):e==="right"?r.jsx("div",{className:"pixel-container bg-gradient-to-b from-gray-800/50 to-gray-900/50 p-2 w-44",children:r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("div",{className:"text-xs text-gray-400",children:u?"白方":"对手棋子"}),r.jsx(wt,{color:p,size:"medium",isActive:s==="playing"&&t===p}),!u&&d&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:d}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:`w-4 h-4 rounded-full shadow-lg ${p===1?"bg-gradient-to-br from-gray-800 to-black":p===2?"bg-gradient-to-br from-white to-gray-200 border border-gray-400":"bg-gray-600"}`}),r.jsx("span",{className:"text-sm font-game text-white",children:p===1?"黑棋":p===2?"白棋":"未定"})]}),r.jsxs("div",{className:"text-xs text-gray-300",children:["得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:p===1?o.black:p===2?o.white:0})]}),r.jsxs("div",{className:"text-gray-400 font-game bg-gray-800/50 px-2 py-0.5 rounded text-xs",children:["第 ",i," 回合"]}),s==="waiting"&&!u&&r.jsx(G.span,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待对手..."}),s==="waiting"&&u&&r.jsx(G.span,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待开局..."}),s==="playing"&&!u&&t!==n&&r.jsx("span",{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded",children:"对手思考中..."}),s==="playing"&&u&&t===2&&r.jsx(G.div,{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"白棋思考中"}),s==="finished"&&!u&&r.jsx(G.span,{className:`font-pixel text-xs px-2 py-0.5 rounded ${a===n?"text-yellow-400 bg-yellow-400/10 animate-glow":"text-gray-400 bg-gray-400/10"}`,initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:a===n?"🎉 你赢了！":"💪 再接再厉"}),s==="finished"&&u&&r.jsx(G.span,{className:"text-yellow-400 bg-yellow-400/10 font-pixel text-xs px-2 py-0.5 rounded",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:a===1?"⚫ 黑棋获胜":"⚪ 白棋获胜"})]})}):r.jsx(r.Fragment,{children:r.jsx("div",{className:"sm:hidden",children:r.jsxs("div",{className:"flex items-center justify-between px-1 py-0.5",children:[r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsx(wt,{color:u?1:n,size:"small",isActive:s==="playing"&&t===(u?1:n)}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[8px] text-gray-400",children:u?"黑方":"你"}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsx("span",{className:"font-game text-xs text-white",children:u||n===1?"黑":n===2?"白":"-"}),r.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",u||n===1?o.black:n===2?o.white:0,")"]})]})]})]}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:"text-[9px] text-gray-400 font-pixel",children:["第",i,"回合"]}),r.jsxs("div",{className:"text-[9px] mt-0",children:[s==="waiting"&&!u&&r.jsx("span",{className:"text-yellow-400 font-pixel animate-pulse",children:"等待对手"}),s==="waiting"&&u&&r.jsx("span",{className:"text-yellow-400 font-pixel animate-pulse",children:"等待开局"}),s==="playing"&&!u&&t===n&&r.jsx("span",{className:"text-green-400 font-pixel animate-pulse",children:"你的回合"}),s==="playing"&&!u&&t!==n&&r.jsx("span",{className:"text-blue-400 font-pixel",children:"对手思考"}),s==="playing"&&u&&r.jsx("span",{className:"text-blue-400 font-pixel",children:t===1?"黑棋思考":"白棋思考"}),s==="finished"&&r.jsx("span",{className:u||a===n?"text-yellow-400":"text-gray-400",children:u?a===1?"黑棋胜":"白棋胜":a===n?"你赢了":"再接再厉"})]})]}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[8px] text-gray-400",children:u?"白方":"对手"}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",u?o.white:p===1?o.black:p===2?o.white:0,")"]}),r.jsx("span",{className:"font-game text-xs text-white",children:u?"白":p===1?"黑":p===2?"白":"-"})]})]}),r.jsx(wt,{color:u?2:p,size:"small",isActive:s==="playing"&&t===(u?2:p)})]})]})})})},Ud=()=>{const{notifications:e,removeNotification:t}=de();return r.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 pointer-events-none",children:r.jsx(ve,{children:e.map(s=>r.jsx(G.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},transition:{duration:.3},className:ie("pixel-container p-3 min-w-[200px] max-w-[300px] pointer-events-auto cursor-pointer","backdrop-blur-sm shadow-lg",{"bg-blue-600/90 border-blue-400":s.type==="info","bg-green-600/90 border-green-400":s.type==="success","bg-yellow-600/90 border-yellow-400":s.type==="warning","bg-red-600/90 border-red-400":s.type==="error"}),onClick:()=>t(s.id),children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("div",{className:"text-white",children:[s.type==="info"&&"📢",s.type==="success"&&"✅",s.type==="warning"&&"⚠️",s.type==="error"&&"❌"]}),r.jsx("p",{className:"text-white text-sm font-game flex-1",children:s.message})]})},s.id))})})};var Et={};(function e(t,s,n,o){var i=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",l=function(){if(!t.OffscreenCanvas)return!1;var y=new OffscreenCanvas(1,1),f=y.getContext("2d");f.fillRect(0,0,1,1);var C=y.transferToImageBitmap();try{f.createPattern(C,"no-repeat")}catch{return!1}return!0}();function c(){}function d(y){var f=s.exports.Promise,C=f!==void 0?f:t.Promise;return typeof C=="function"?new C(y):(y(c,c),null)}var u=function(y,f){return{transform:function(C){if(y)return C;if(f.has(C))return f.get(C);var E=new OffscreenCanvas(C.width,C.height),F=E.getContext("2d");return F.drawImage(C,0,0),f.set(C,E),E},clear:function(){f.clear()}}}(l,new Map),h=function(){var y=Math.floor(16.666666666666668),f,C,E={},F=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(f=function($){var U=Math.random();return E[U]=requestAnimationFrame(function W(Y){F===Y||F+y-1<Y?(F=Y,delete E[U],$()):E[U]=requestAnimationFrame(W)}),U},C=function($){E[$]&&cancelAnimationFrame(E[$])}):(f=function($){return setTimeout($,y)},C=function($){return clearTimeout($)}),{frame:f,cancel:C}}(),p=function(){var y,f,C={};function E(F){function $(U,W){F.postMessage({options:U||{},callback:W})}F.init=function(W){var Y=W.transferControlToOffscreen();F.postMessage({canvas:Y},[Y])},F.fire=function(W,Y,te){if(f)return $(W,null),f;var O=Math.random().toString(36).slice(2);return f=d(function(X){function H(Q){Q.data.callback===O&&(delete C[O],F.removeEventListener("message",H),f=null,u.clear(),te(),X())}F.addEventListener("message",H),$(W,O),C[O]=H.bind(null,{data:{callback:O}})}),f},F.reset=function(){F.postMessage({reset:!0});for(var W in C)C[W](),delete C[W]}}return function(){if(y)return y;if(!n&&i){var F=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{y=new Worker(URL.createObjectURL(new Blob([F])))}catch($){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",$),null}E(y)}return y}}(),x={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function j(y,f){return f?f(y):y}function b(y){return y!=null}function w(y,f,C){return j(y&&b(y[f])?y[f]:x[f],C)}function A(y){return y<0?0:Math.floor(y)}function k(y,f){return Math.floor(Math.random()*(f-y))+y}function S(y){return parseInt(y,16)}function I(y){return y.map(D)}function D(y){var f=String(y).replace(/[^0-9a-f]/gi,"");return f.length<6&&(f=f[0]+f[0]+f[1]+f[1]+f[2]+f[2]),{r:S(f.substring(0,2)),g:S(f.substring(2,4)),b:S(f.substring(4,6))}}function R(y){var f=w(y,"origin",Object);return f.x=w(f,"x",Number),f.y=w(f,"y",Number),f}function B(y){y.width=document.documentElement.clientWidth,y.height=document.documentElement.clientHeight}function V(y){var f=y.getBoundingClientRect();y.width=f.width,y.height=f.height}function v(y){var f=document.createElement("canvas");return f.style.position="fixed",f.style.top="0px",f.style.left="0px",f.style.pointerEvents="none",f.style.zIndex=y,f}function T(y,f,C,E,F,$,U,W,Y){y.save(),y.translate(f,C),y.rotate($),y.scale(E,F),y.arc(0,0,1,U,W,Y),y.restore()}function L(y){var f=y.angle*(Math.PI/180),C=y.spread*(Math.PI/180);return{x:y.x,y:y.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:y.startVelocity*.5+Math.random()*y.startVelocity,angle2D:-f+(.5*C-Math.random()*C),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:y.color,shape:y.shape,tick:0,totalTicks:y.ticks,decay:y.decay,drift:y.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:y.gravity*3,ovalScalar:.6,scalar:y.scalar,flat:y.flat}}function N(y,f){f.x+=Math.cos(f.angle2D)*f.velocity+f.drift,f.y+=Math.sin(f.angle2D)*f.velocity+f.gravity,f.velocity*=f.decay,f.flat?(f.wobble=0,f.wobbleX=f.x+10*f.scalar,f.wobbleY=f.y+10*f.scalar,f.tiltSin=0,f.tiltCos=0,f.random=1):(f.wobble+=f.wobbleSpeed,f.wobbleX=f.x+10*f.scalar*Math.cos(f.wobble),f.wobbleY=f.y+10*f.scalar*Math.sin(f.wobble),f.tiltAngle+=.1,f.tiltSin=Math.sin(f.tiltAngle),f.tiltCos=Math.cos(f.tiltAngle),f.random=Math.random()+2);var C=f.tick++/f.totalTicks,E=f.x+f.random*f.tiltCos,F=f.y+f.random*f.tiltSin,$=f.wobbleX+f.random*f.tiltCos,U=f.wobbleY+f.random*f.tiltSin;if(y.fillStyle="rgba("+f.color.r+", "+f.color.g+", "+f.color.b+", "+(1-C)+")",y.beginPath(),a&&f.shape.type==="path"&&typeof f.shape.path=="string"&&Array.isArray(f.shape.matrix))y.fill(_(f.shape.path,f.shape.matrix,f.x,f.y,Math.abs($-E)*.1,Math.abs(U-F)*.1,Math.PI/10*f.wobble));else if(f.shape.type==="bitmap"){var W=Math.PI/10*f.wobble,Y=Math.abs($-E)*.1,te=Math.abs(U-F)*.1,O=f.shape.bitmap.width*f.scalar,X=f.shape.bitmap.height*f.scalar,H=new DOMMatrix([Math.cos(W)*Y,Math.sin(W)*Y,-Math.sin(W)*te,Math.cos(W)*te,f.x,f.y]);H.multiplySelf(new DOMMatrix(f.shape.matrix));var Q=y.createPattern(u.transform(f.shape.bitmap),"no-repeat");Q.setTransform(H),y.globalAlpha=1-C,y.fillStyle=Q,y.fillRect(f.x-O/2,f.y-X/2,O,X),y.globalAlpha=1}else if(f.shape==="circle")y.ellipse?y.ellipse(f.x,f.y,Math.abs($-E)*f.ovalScalar,Math.abs(U-F)*f.ovalScalar,Math.PI/10*f.wobble,0,2*Math.PI):T(y,f.x,f.y,Math.abs($-E)*f.ovalScalar,Math.abs(U-F)*f.ovalScalar,Math.PI/10*f.wobble,0,2*Math.PI);else if(f.shape==="star")for(var ee=Math.PI/2*3,re=4*f.scalar,he=8*f.scalar,ge=f.x,be=f.y,ke=5,we=Math.PI/ke;ke--;)ge=f.x+Math.cos(ee)*he,be=f.y+Math.sin(ee)*he,y.lineTo(ge,be),ee+=we,ge=f.x+Math.cos(ee)*re,be=f.y+Math.sin(ee)*re,y.lineTo(ge,be),ee+=we;else y.moveTo(Math.floor(f.x),Math.floor(f.y)),y.lineTo(Math.floor(f.wobbleX),Math.floor(F)),y.lineTo(Math.floor($),Math.floor(U)),y.lineTo(Math.floor(E),Math.floor(f.wobbleY));return y.closePath(),y.fill(),f.tick<f.totalTicks}function M(y,f,C,E,F){var $=f.slice(),U=y.getContext("2d"),W,Y,te=d(function(O){function X(){W=Y=null,U.clearRect(0,0,E.width,E.height),u.clear(),F(),O()}function H(){n&&!(E.width===o.width&&E.height===o.height)&&(E.width=y.width=o.width,E.height=y.height=o.height),!E.width&&!E.height&&(C(y),E.width=y.width,E.height=y.height),U.clearRect(0,0,E.width,E.height),$=$.filter(function(Q){return N(U,Q)}),$.length?W=h.frame(H):X()}W=h.frame(H),Y=X});return{addFettis:function(O){return $=$.concat(O),te},canvas:y,promise:te,reset:function(){W&&h.cancel(W),Y&&Y()}}}function P(y,f){var C=!y,E=!!w(f||{},"resize"),F=!1,$=w(f,"disableForReducedMotion",Boolean),U=i&&!!w(f||{},"useWorker"),W=U?p():null,Y=C?B:V,te=y&&W?!!y.__confetti_initialized:!1,O=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,X;function H(ee,re,he){for(var ge=w(ee,"particleCount",A),be=w(ee,"angle",Number),ke=w(ee,"spread",Number),we=w(ee,"startVelocity",Number),Lt=w(ee,"decay",Number),et=w(ee,"gravity",Number),ze=w(ee,"drift",Number),$e=w(ee,"colors",I),tt=w(ee,"ticks",Number),ft=w(ee,"shapes"),It=w(ee,"scalar"),Ft=!!w(ee,"flat"),mt=R(ee),pt=ge,st=[],me=y.width*mt.x,fs=y.height*mt.y;pt--;)st.push(L({x:me,y:fs,angle:be,spread:ke,startVelocity:we,color:$e[pt%$e.length],shape:ft[k(0,ft.length)],ticks:tt,decay:Lt,gravity:et,drift:ze,scalar:It,flat:Ft}));return X?X.addFettis(st):(X=M(y,st,Y,re,he),X.promise)}function Q(ee){var re=$||w(ee,"disableForReducedMotion",Boolean),he=w(ee,"zIndex",Number);if(re&&O)return d(function(we){we()});C&&X?y=X.canvas:C&&!y&&(y=v(he),document.body.appendChild(y)),E&&!te&&Y(y);var ge={width:y.width,height:y.height};W&&!te&&W.init(y),te=!0,W&&(y.__confetti_initialized=!0);function be(){if(W){var we={getBoundingClientRect:function(){if(!C)return y.getBoundingClientRect()}};Y(we),W.postMessage({resize:{width:we.width,height:we.height}});return}ge.width=ge.height=null}function ke(){X=null,E&&(F=!1,t.removeEventListener("resize",be)),C&&y&&(document.body.contains(y)&&document.body.removeChild(y),y=null,te=!1)}return E&&!F&&(F=!0,t.addEventListener("resize",be,!1)),W?W.fire(ee,ge,ke):H(ee,ge,ke)}return Q.reset=function(){W&&W.reset(),X&&X.reset()},Q}var m;function z(){return m||(m=P(null,{useWorker:!0,resize:!0})),m}function _(y,f,C,E,F,$,U){var W=new Path2D(y),Y=new Path2D;Y.addPath(W,new DOMMatrix(f));var te=new Path2D;return te.addPath(Y,new DOMMatrix([Math.cos(U)*F,Math.sin(U)*F,-Math.sin(U)*$,Math.cos(U)*$,C,E])),te}function K(y){if(!a)throw new Error("path confetti are not supported in this browser");var f,C;typeof y=="string"?f=y:(f=y.path,C=y.matrix);var E=new Path2D(f),F=document.createElement("canvas"),$=F.getContext("2d");if(!C){for(var U=1e3,W=U,Y=U,te=0,O=0,X,H,Q=0;Q<U;Q+=2)for(var ee=0;ee<U;ee+=2)$.isPointInPath(E,Q,ee,"nonzero")&&(W=Math.min(W,Q),Y=Math.min(Y,ee),te=Math.max(te,Q),O=Math.max(O,ee));X=te-W,H=O-Y;var re=10,he=Math.min(re/X,re/H);C=[he,0,0,he,-Math.round(X/2+W)*he,-Math.round(H/2+Y)*he]}return{type:"path",path:f,matrix:C}}function q(y){var f,C=1,E="#000000",F='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof y=="string"?f=y:(f=y.text,C="scalar"in y?y.scalar:C,F="fontFamily"in y?y.fontFamily:F,E="color"in y?y.color:E);var $=10*C,U=""+$+"px "+F,W=new OffscreenCanvas($,$),Y=W.getContext("2d");Y.font=U;var te=Y.measureText(f),O=Math.ceil(te.actualBoundingBoxRight+te.actualBoundingBoxLeft),X=Math.ceil(te.actualBoundingBoxAscent+te.actualBoundingBoxDescent),H=2,Q=te.actualBoundingBoxLeft+H,ee=te.actualBoundingBoxAscent+H;O+=H+H,X+=H+H,W=new OffscreenCanvas(O,X),Y=W.getContext("2d"),Y.font=U,Y.fillStyle=E,Y.fillText(f,Q,ee);var re=1/C;return{type:"bitmap",bitmap:W.transferToImageBitmap(),matrix:[re,0,0,re,-O*re/2,-X*re/2]}}s.exports=function(){return z().apply(this,arguments)},s.exports.reset=function(){z().reset()},s.exports.create=P,s.exports.shapeFromPath=K,s.exports.shapeFromText=q})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Et,!1);const Hd=Et.exports;Et.exports.create;const Gd=({isOpen:e,onRestart:t,onClose:s,waitingForOpponent:n=!1})=>{const{winner:o,myColor:i,score:a,userRole:l}=de(),c=o===i,d=l==="spectator";return console.log("GameOverModal - winner:",o,"myColor:",i,"isWinner:",c,"userRole:",l),g.useEffect(()=>{if(e&&c&&!n&&!d){const u=()=>{Hd({particleCount:100,spread:70,origin:{y:.6}})};u();const h=setTimeout(u,200),p=setTimeout(u,400);return()=>{clearTimeout(h),clearTimeout(p)}}},[e,c,n,d]),r.jsx(ve,{children:e&&r.jsxs(r.Fragment,{children:[r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",onClick:n?void 0:s}),r.jsx(G.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:400},className:"fixed inset-0 flex items-center justify-center z-50 p-4",onClick:u=>u.stopPropagation(),children:r.jsx("div",{className:"pixel-container bg-gray-900 p-6 sm:p-8 max-w-md w-full",children:n?r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-yellow-400 mx-auto"})}),r.jsx("h2",{className:"text-2xl font-game font-bold text-yellow-400 mb-4",children:"等待对手..."}),r.jsx("p",{className:"text-gray-300 mb-6",children:"已发送再来一局请求，等待对手同意"})]}):r.jsxs(r.Fragment,{children:[r.jsx(G.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"text-center mb-6",children:d?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-6xl mb-4",children:"🎮"}),r.jsx("h2",{className:"text-3xl font-game font-bold text-yellow-400 mb-2",children:"游戏结束"}),r.jsx("p",{className:"text-gray-300 text-xl",children:o===1?"黑棋获胜！":o===2?"白棋获胜！":"平局！"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-6xl mb-4",children:c?"🏆":"💪"}),r.jsx("h2",{className:ie("text-3xl font-game font-bold mb-2",c?"text-yellow-400 animate-glow":"text-gray-400"),children:c?"恭喜胜利！":"再接再厉！"}),r.jsx("p",{className:"text-gray-300",children:c?"你赢得了这局比赛！":"别灰心，下局再战！"})]})}),r.jsxs(G.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[r.jsx("div",{className:"text-center text-sm text-gray-400 mb-2",children:"当前比分"}),r.jsxs("div",{className:"flex items-center justify-center gap-6",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-800 to-black rounded-full shadow-lg"}),r.jsx("span",{className:"font-game text-2xl text-white",children:a.black})]}),r.jsx("div",{className:"text-gray-500 text-2xl",children:":"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-game text-2xl text-white",children:a.white}),r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-white to-gray-200 rounded-full border-2 border-gray-400 shadow-lg"})]})]}),r.jsx("div",{className:"text-center text-sm text-gray-400 mt-2",children:o===1?"黑棋获胜":o===2?"白棋获胜":"平局"})]}),r.jsxs("div",{className:"flex gap-3",children:[!d&&r.jsx(G.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"flex-1 pixel-btn bg-green-600 hover:bg-green-700 text-white py-3",children:"再来一局"}),r.jsx(G.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:s,className:ie("pixel-btn bg-gray-600 hover:bg-gray-700 text-white py-3",d?"w-full":"flex-1"),children:d?"关闭":"查看棋盘"})]})]})})})]})})},Ut=({isOpen:e,title:t,message:s,confirmText:n="同意",cancelText:o="拒绝",onConfirm:i,onCancel:a})=>r.jsx(ve,{children:e&&r.jsxs(r.Fragment,{children:[r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:a}),r.jsx(G.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",damping:25,stiffness:400},className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none px-4",children:r.jsxs("div",{className:"pixel-container bg-gray-900 p-4 sm:p-6 max-w-sm w-full pointer-events-auto",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-game font-bold text-yellow-400 mb-3",children:t}),r.jsx("p",{className:"text-gray-300 mb-6 text-sm sm:text-base",children:s}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:i,className:"flex-1 pixel-btn bg-green-600 hover:bg-green-700 text-white py-2 text-sm sm:text-base",children:n}),r.jsx("button",{onClick:a,className:"flex-1 pixel-btn bg-red-600 hover:bg-red-700 text-white py-2 text-sm sm:text-base",children:o})]})]})})]})}),Ht=({onSendMessage:e,userRole:t=null,className:s=""})=>{const[n,o]=g.useState(!1),[i,a]=g.useState("emoji"),l=["😊","😎","🤔","😅","😂","😭","👍","👎","👏","🙏","💪","✌️","🎉","🎯","💯","🔥","⚡","🌟","😤","😮","😲","🤯","😱","🙈"],u=t==="spectator"?["黑棋加油！你是最棒的！","白棋必胜！冲冲冲！","精彩！这局真是太精彩了！","黑棋这步棋下得妙啊！","白棋好厉害，学到了！","这是高手过招啊！","快看快看，要分胜负了！","黑棋稳住，马上就赢了！","白棋反击！还有机会！","太刺激了，我都紧张了！","这局势焦灼啊，谁都有机会","黑棋防守！要小心了！","白棋进攻！就是现在！","神仙打架，我等凡人观战","这棋局值得收藏学习","前排围观，吃瓜看戏🍿","支持黑棋，黑棋YYDS！","白棋粉丝团在此应援！","大家好，我是新来的观众","求解说，看不懂局势了"]:["你好呀！一起来玩吧～","承让承让，侥幸而已！","哇，这步棋真是绝了！","厉害厉害，我要认真了！","再来一局，刚才手滑了～","让你见识见识什么叫高手！","我等到花儿都谢了...","快点啊，我等到天都黑了","容我想想，这步很关键","这一步妙啊，学到了！","你是高手，我甘拜下风","加油加油，你可以的！","哎呀，失误了失误了","看我的绝杀！","友谊第一，比赛第二～","GG，精彩的对局！","别走，决战到天亮！","你这是在针对我吗？","稳住，我们能赢！","今天手感不太好啊..."],h=p=>{e(p),o(!1)};return r.jsxs("div",{className:"relative inline-flex items-center",children:[r.jsxs(G.button,{onClick:()=>o(!n),className:ie("pixel-btn bg-purple-600 hover:bg-purple-700 text-white",s||"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm"),whileHover:{scale:1.05},whileTap:{scale:.95},children:[r.jsx("span",{className:"hidden sm:inline",children:"💬 聊天"}),r.jsx("span",{className:"sm:hidden",children:"聊天"})]}),r.jsx(ve,{children:n&&r.jsxs(r.Fragment,{children:[r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 z-40 sm:hidden",onClick:()=>o(!1)}),r.jsxs(G.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{type:"spring",damping:25,stiffness:400},className:ie("z-50","sm:absolute sm:bottom-full sm:mb-2 sm:left-1/2 sm:transform sm:-translate-x-1/2 sm:w-80","fixed inset-x-4 top-1/2 -translate-y-1/2 sm:inset-auto sm:translate-y-0","pixel-container bg-gray-900/100 backdrop-blur-sm p-3 sm:p-4","max-h-[300px] max-w-sm mx-auto"),children:[r.jsxs("div",{className:"flex gap-2 mb-3",children:[r.jsx("button",{onClick:()=>a("emoji"),className:ie("flex-1 px-3 py-1 rounded text-sm font-pixel transition-all",i==="emoji"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"表情"}),r.jsx("button",{onClick:()=>a("phrase"),className:ie("flex-1 px-3 py-1 rounded text-sm font-pixel transition-all",i==="phrase"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"短语"})]}),r.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar",children:i==="emoji"?r.jsx("div",{className:"grid grid-cols-6 gap-2",children:l.map((p,x)=>r.jsx(G.button,{onClick:()=>h(p),className:"text-2xl p-2 hover:bg-gray-700 rounded transition-colors",whileHover:{scale:1.2},whileTap:{scale:.9},children:p},x))}):r.jsx("div",{className:"space-y-1",children:u.map((p,x)=>r.jsx(G.button,{onClick:()=>h(p),className:"w-full text-left px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 rounded transition-colors",whileHover:{x:5},whileTap:{scale:.98},children:p},x))})}),r.jsx("div",{className:`hidden sm:block absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-0 h-0 
                border-l-8 border-l-transparent 
                border-r-8 border-r-transparent 
                border-t-8 border-t-gray-900`})]})]})})]})},_d=({messages:e})=>{const[t,s]=g.useState([]),{myColor:n,gameState:o}=de();return g.useEffect(()=>{if(e.length>0){const i=e[e.length-1];s(a=>[...a,i]),setTimeout(()=>{s(a=>a.filter(l=>l.id!==i.id))},3e3)}},[e]),o==="waiting"?null:r.jsx(r.Fragment,{children:r.jsx(ve,{children:t.map((i,a)=>{const l=i.isOpponent?n===1?2:1:n,c=i.isOpponent;return r.jsx(G.div,{initial:{opacity:0,scale:.3,x:-50,y:0},animate:{opacity:1,scale:1,x:0,y:-a*80},exit:{opacity:0,scale:0,y:-a*80-50},transition:{type:"spring",damping:20,stiffness:300,duration:.5},className:"fixed",style:{top:"50%",left:"20px",transform:"translateY(-50%)",zIndex:40+a},children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(G.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:r.jsx(wt,{color:l,size:"small",className:"pointer-events-auto"})}),r.jsxs(G.div,{className:"relative",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:[r.jsx("div",{className:`
                      px-4 py-2 rounded-2xl shadow-lg pointer-events-auto
                      max-w-[200px] sm:max-w-[250px] break-words
                      ${c?"bg-gradient-to-r from-blue-500 to-blue-600 text-white":"bg-gradient-to-r from-green-500 to-green-600 text-white"}
                    `,children:i.content.match(/^[\u{1F300}-\u{1FAD6}]$/u)?r.jsx("span",{className:"text-3xl",children:i.content}):r.jsx("span",{className:"text-sm font-medium",children:i.content})}),r.jsx("div",{className:`
                      absolute w-0 h-0 
                      left-0 -ml-2 
                      border-t-8 border-t-transparent 
                      border-b-8 border-b-transparent 
                      border-r-8 
                      ${c?"border-r-blue-500":"border-r-green-500"}
                    `,style:{top:"50%",transform:"translateY(-50%)"}})]})]})},i.id)})})})},Wd=()=>{const[e,t]=g.useState(!1),[s,n]=g.useState(!0),[o,i]=g.useState(!0),[a,l]=g.useState("prompt"),[c,d]=g.useState(""),u=g.useRef(null),h=g.useRef(new Map),p=g.useRef(null),{socket:x}=hs(),{roomId:j}=de();g.useEffect(()=>{(()=>{const B=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="[::1]",V=window.location.protocol==="https:"||B;return!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia?(i(!1),d("浏览器不支持音频功能"),!1):V?!0:(d("⚠️ 由于安全限制，语音功能仅在HTTPS或本地环境可用。请使用localhost访问或部署HTTPS证书。"),i(!1),!1)})()},[]);const b=g.useCallback(async()=>{if(!o)return"denied";try{if(navigator.permissions&&navigator.permissions.query){const R=await navigator.permissions.query({name:"microphone"});return l(R.state),R.addEventListener("change",()=>{l(R.state)}),R.state}}catch(R){console.warn("无法查询麦克风权限:",R)}return"prompt"},[o]);g.useEffect(()=>{if(!p.current){const R=document.createElement("div");R.id="voice-chat-audio-container",R.style.display="none",document.body.appendChild(R),p.current=R}return()=>{p.current&&(p.current.remove(),p.current=null)}},[]);const w=g.useCallback(R=>{const B=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]});return u.current&&u.current.getTracks().forEach(V=>{u.current&&B.addTrack(V,u.current)}),B.ontrack=V=>{console.log("收到远程音频流:",R);const[v]=V.streams,T=document.createElement("audio");T.srcObject=v,T.autoplay=!0,T.muted=!s,p.current&&p.current.appendChild(T);const L=h.current.get(R);L&&(L.stream=v,L.audioElement=T)},B.onicecandidate=V=>{V.candidate&&x&&j&&x.emit("voice-ice-candidate",{roomId:j,candidate:V.candidate,targetPeerId:R})},B.onconnectionstatechange=()=>{console.log(`连接状态 [${R}]:`,B.connectionState),(B.connectionState==="failed"||B.connectionState==="disconnected")&&A(R)},B},[x,j,s]),A=g.useCallback(R=>{const B=h.current.get(R);B&&(B.audioElement&&p.current&&p.current.removeChild(B.audioElement),B.connection.close(),h.current.delete(R))},[]),k=g.useCallback(async()=>{if(!o)return d("当前环境不支持语音功能"),!1;try{const R=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return u.current=R,t(!0),l("granted"),n(!0),x&&j&&x.emit("join-voice-channel",{roomId:j}),!0}catch(R){return console.error("无法获取麦克风权限:",R),R.name==="NotAllowedError"?(l("denied"),d("麦克风权限被拒绝，请在浏览器设置中允许麦克风访问")):R.name==="NotFoundError"?d("未找到麦克风设备"):R.name==="NotReadableError"?d("麦克风被其他应用占用"):d("无法访问麦克风: "+R.message),!1}},[o,x,j]),S=g.useCallback(()=>{u.current&&(u.current.getTracks().forEach(R=>R.stop()),u.current=null),t(!1),x&&j&&x.emit("leave-voice-channel",{roomId:j}),h.current.forEach((R,B)=>{A(B)})},[x,j,A]),I=g.useCallback(async()=>{e?S():await k()},[e,k,S]),D=g.useCallback(()=>{const R=!s;n(R),h.current.forEach(B=>{B.audioElement&&(B.audioElement.muted=!R)})},[s]);return g.useEffect(()=>{if(!x||!j)return;const R=async L=>{if(console.log("用户加入语音频道:",L.userId),u.current){const N=w(L.userId);h.current.set(L.userId,{peerId:L.userId,connection:N});const M=await N.createOffer();await N.setLocalDescription(M),x.emit("voice-offer",{roomId:j,offer:M,targetPeerId:L.userId})}},B=async L=>{console.log("收到语音offer:",L.fromPeerId);const N=w(L.fromPeerId);h.current.set(L.fromPeerId,{peerId:L.fromPeerId,connection:N}),await N.setRemoteDescription(L.offer);const M=await N.createAnswer();await N.setLocalDescription(M),x.emit("voice-answer",{roomId:j,answer:M,targetPeerId:L.fromPeerId})},V=async L=>{console.log("收到语音answer:",L.fromPeerId);const N=h.current.get(L.fromPeerId);N&&await N.connection.setRemoteDescription(L.answer)},v=async L=>{const N=h.current.get(L.fromPeerId);N&&await N.connection.addIceCandidate(L.candidate)},T=L=>{console.log("用户离开语音频道:",L.userId),A(L.userId)};return x.on("user-joined-voice",R),x.on("voice-offer",B),x.on("voice-answer",V),x.on("voice-ice-candidate",v),x.on("user-left-voice",T),()=>{x.off("user-joined-voice",R),x.off("voice-offer",B),x.off("voice-answer",V),x.off("voice-ice-candidate",v),x.off("user-left-voice",T)}},[x,j,w,A]),g.useEffect(()=>()=>{S()},[S]),{isMicEnabled:e,isSpeakerEnabled:s,isSupported:o,permissionStatus:a,errorMessage:c,toggleMic:I,toggleSpeaker:D,checkPermission:b}},Gt=({className:e})=>{const{isMicEnabled:t,isSpeakerEnabled:s,isSupported:n,permissionStatus:o,errorMessage:i,toggleMic:a,toggleSpeaker:l,checkPermission:c}=Wd(),{addNotification:d}=de();g.useEffect(()=>{c()},[c]),g.useEffect(()=>{i&&d("warning",i)},[i,d]);const u=async()=>{if(!n){d("warning","⚠️ 当前环境不支持语音功能，请使用HTTPS或localhost访问");return}if(o==="denied"){d("warning","⚠️ 麦克风权限被拒绝，请在浏览器设置中允许");return}await a()},h=()=>{!s&&!t&&d("info","💡 提示：单独开启喇叭可以听到其他人说话"),l()};return r.jsxs("div",{className:ie("flex gap-1",e),children:[r.jsxs(G.button,{onClick:u,disabled:!n,className:ie("pixel-btn relative transition-all",t?"bg-green-600 hover:bg-green-700":"bg-gray-600 hover:bg-gray-700",!n&&"opacity-50 cursor-not-allowed"),whileHover:{scale:n?1.05:1},whileTap:{scale:n?.95:1},title:n?t?"关闭麦克风":"开启麦克风":"语音功能不可用",children:[t?r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z",clipRule:"evenodd"})}):r.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[r.jsx("path",{fillRule:"evenodd",d:"M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z",clipRule:"evenodd"}),r.jsx("path",{d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4z",opacity:"0.3"}),r.jsx("path",{d:"M11 14.93V17h3a1 1 0 110 2H6a1 1 0 110-2h3v-2.07A7.001 7.001 0 013 8a1 1 0 012 0 5 5 0 0010 0 1 1 0 112 0 7.001 7.001 0 01-6 6.93z",opacity:"0.3"})]}),t&&r.jsx(G.span,{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full",animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:2}})]}),r.jsx(G.button,{onClick:h,className:ie("pixel-btn relative transition-all",s?"bg-blue-600 hover:bg-blue-700":"bg-gray-600 hover:bg-gray-700"),whileHover:{scale:1.05},whileTap:{scale:.95},title:s?"关闭喇叭":"开启喇叭",children:s?r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}):r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),!n&&r.jsx("span",{className:"text-xs text-yellow-400 px-2 py-1",children:"⚠️ 需HTTPS"}),o==="denied"&&n&&r.jsx("span",{className:"text-xs text-red-400 px-2 py-1",children:"🚫 权限被拒"})]})},qd=()=>{const[e,t]=g.useState(!1),[s,n]=g.useState(!1),[o,i]=g.useState(!1),[a,l]=g.useState(!1),[c,d]=g.useState(!1),[u,h]=g.useState(!1),[p,x]=g.useState(!1),[j,b]=g.useState(!1),[w,A]=g.useState(!1),[k,S]=g.useState([]),{gameState:I,roomId:D,resetGame:R,setRoomInfo:B,myColor:V,currentPlayer:v,canUndo:T,winner:L,addNotification:N,history:M,userRole:P}=de(),{socket:m,connected:z,requestRestart:_,acceptRestart:K,rejectRestart:q,requestUndo:y,acceptUndo:f,rejectUndo:C,surrender:E,sendChatMessage:F,spectatorToPlayer:$,playerToSpectator:U}=hs();console.log("GomokuGame - connected:",z,"isInRoom:",e),g.useEffect(()=>{I==="finished"&&L&&setTimeout(()=>{n(!0)},1e3)},[I,L]),g.useEffect(()=>{if(!m)return;const ze=()=>{I==="finished"?(A(!1),n(!1),D&&K(D),N("info","双方同意，游戏即将重新开始")):(i(!0),d(!0))},$e=()=>{A(!1),i(!1),N("warning","❌ 对手拒绝了重新开始请求")},tt=()=>{l(!0),h(!0)},ft=()=>{l(!1),N("warning","❌ 对手拒绝了悔棋请求")},It=()=>{n(!1),A(!1),i(!1),d(!1),S([])},Ft=me=>{console.log("Player joined room:",me.playerId),N("success","🎮 对手已加入房间"),m&&(console.log("Auto-readying for game start..."),m.emit("ready-to-play"))},mt=me=>{console.log("Player left room:",me.playerId),de.setState({gameState:"waiting"}),N("warning","⚠️ 对手已离开房间")},pt=me=>{console.log("Opponent surrendered, winner:",me.winner,"myColor:",V),me.winner!==V&&console.error("Winner color mismatch! Expected:",V,"Got:",me.winner),de.setState({gameState:"finished",winner:me.winner}),de.getState().updateScore(me.winner),N("success","🏳️ 对手认输，你赢了！"),setTimeout(()=>{n(!0)},500)},st=me=>{console.log("Received chat message:",me);const fs={id:Math.random().toString(36).substr(2,9),content:me.message,isOpponent:!0,timestamp:Date.now()};S(li=>[...li,fs])};return m.on("restart-request",ze),m.on("restart-rejected",$e),m.on("undo-request",tt),m.on("undo-rejected",ft),m.on("game-restart",It),m.on("player-joined",Ft),m.on("player-left",mt),m.on("opponent-surrender",pt),m.on("chat-message",st),()=>{m.off("restart-request",ze),m.off("restart-rejected",$e),m.off("undo-request",tt),m.off("undo-rejected",ft),m.off("game-restart",It),m.off("player-joined",Ft),m.off("player-left",mt),m.off("opponent-surrender",pt),m.off("chat-message",st)}},[m,D,K,N,I,V]);const W=ze=>{if(!D)return;F(D,ze);const $e={id:Math.random().toString(36).substr(2,9),content:ze,isOpponent:!1,timestamp:Date.now()};S(tt=>[...tt,$e])},Y=()=>{D&&(K(D),i(!1),d(!1),N("success","✅ 已同意重新开始"))},te=()=>{D&&q(D),i(!1),d(!1),N("info","❌ 已拒绝重新开始请求")},O=()=>{D&&(f(D),l(!1),h(!1),N("success","✅ 已同意悔棋"))},X=()=>{D&&C(D),l(!1),h(!1),N("info","❌ 已拒绝悔棋请求")},H=()=>{m&&D&&m.emit("leave-room",{roomId:D}),t(!1),R(),B(null,!1),A(!1),S([]),N("info","👋 已离开房间")},Q=()=>{if(console.log("Restart requested, gameState:",I,"waitingForOpponentRestart:",w),w){N("info","⏳ 正在等待对手同意...");return}m&&D&&(I==="finished"?(A(!0),_(D),N("info","⏳ 等待对手同意再来一局...")):(_(D),N("info","📨 已发送重新开始请求")))},ee=()=>{if(!T||v!==V||M.length<2){N("warning","⚠️ 当前不能悔棋");return}m&&D&&(y(D),N("info","📨 已发送悔棋请求，等待对手确认..."))},re=()=>{if(P!=="player"){N("warning","⚠️ 你已经是观众了");return}x(!0)},he=()=>{U(),x(!1),N("info","👁️ 你已转为观众")},ge=()=>{x(!1)},be=()=>{if(I!=="playing"||P!=="player"){N("warning","⚠️ 当前不能认输");return}b(!0)},ke=()=>{D&&V&&(E(D,V),N("info","🏳️ 你已认输")),b(!1)},we=()=>{b(!1)},Lt=()=>{$()},et=!T||v!==V||I!=="playing"||a||M.length<2;return r.jsxs("div",{className:"relative",children:[r.jsx(Ud,{}),e&&r.jsx(_d,{messages:k}),r.jsx(Gd,{isOpen:s,onRestart:Q,onClose:()=>n(!1),waitingForOpponent:w}),r.jsx(Ut,{isOpen:c,title:"重新开始请求",message:"对手请求重新开始游戏，是否同意？",confirmText:"同意",cancelText:"拒绝",onConfirm:Y,onCancel:te}),r.jsx(Ut,{isOpen:u,title:"悔棋请求",message:"对手请求悔棋，是否同意？",confirmText:"同意",cancelText:"拒绝",onConfirm:O,onCancel:X}),r.jsx(Ut,{isOpen:p,title:"到观众席确认",message:"确定要到观众席吗？你将成为观众。",confirmText:"确认",cancelText:"取消",onConfirm:he,onCancel:ge}),r.jsx(Ut,{isOpen:j,title:"认输确认",message:"确定要认输吗？你将输掉当前游戏。",confirmText:"确认认输",cancelText:"取消",onConfirm:ke,onCancel:we}),r.jsx(ve,{mode:"wait",children:e?r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex flex-col",children:[r.jsxs("div",{className:"hidden sm:flex flex-col",children:[r.jsxs("div",{className:"text-center py-0.5",children:[r.jsxs("h1",{className:"text-base font-game font-bold bg-gradient-to-r from-yellow-400 via-pink-400 to-purple-400 bg-clip-text text-transparent inline-flex items-center gap-2",children:["五子棋对战",P==="spectator"&&r.jsx("span",{className:"text-sm font-normal text-yellow-400",children:"（观战模式）"})]}),r.jsxs("p",{className:"text-gray-300 text-xs",children:["房间: ",r.jsx("span",{className:"text-yellow-400 font-pixel",children:D})]})]}),r.jsxs("div",{className:"flex justify-center px-4 pt-1",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Ps,{side:"left"})}),r.jsxs("div",{className:"mx-3 flex flex-col",children:[r.jsx(Tr,{}),r.jsxs("div",{className:"flex justify-center gap-1.5 mt-1 pb-2",children:[P==="player"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Q,disabled:o||w,className:ie("pixel-btn text-xs px-2.5 py-1 transition-all",(o||w)&&"opacity-50 cursor-not-allowed"),children:w?"等待对手...":o?"等待确认...":"重新开始"}),r.jsx("button",{onClick:ee,disabled:et,className:ie("pixel-btn bg-blue-600 hover:bg-blue-700 text-xs px-2.5 py-1 transition-all",et&&"opacity-50 cursor-not-allowed hover:bg-blue-600"),children:a?"等待确认...":"悔棋"}),r.jsx(Ht,{onSendMessage:W,userRole:P,className:"text-xs px-2.5 py-1"}),r.jsx(Gt,{className:"text-xs px-2.5 py-1"}),r.jsx("button",{onClick:be,disabled:I!=="playing",className:ie("pixel-btn bg-red-600 hover:bg-red-700 text-xs px-2.5 py-1 transition-all",I!=="playing"&&"opacity-50 cursor-not-allowed hover:bg-red-600"),children:"认输"}),r.jsx("button",{onClick:re,className:"pixel-btn bg-yellow-600 hover:bg-yellow-700 text-xs px-2.5 py-1 transition-all",children:"到观众席"})]}):P==="spectator"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Lt,className:"pixel-btn bg-green-600 hover:bg-green-700 text-xs px-2.5 py-1 transition-all",children:"成为玩家"}),r.jsx(Ht,{onSendMessage:W,userRole:P,className:"text-xs px-2.5 py-1"}),r.jsx(Gt,{className:"text-xs px-2.5 py-1"}),r.jsx("span",{className:"text-yellow-400 text-xs px-2 py-1",children:"👁️ 观战模式"})]}):null,r.jsx("button",{onClick:H,className:"pixel-btn bg-red-600 hover:bg-red-700 text-xs px-2.5 py-1 transition-all",children:"离开房间"})]})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Ps,{side:"right"})})]})]}),r.jsxs("div",{className:"sm:hidden flex flex-col",children:[r.jsx("div",{className:"text-center py-0.5",children:r.jsxs("h1",{className:"text-xs font-game font-bold text-yellow-400",children:["五子棋",P==="spectator"&&"(观战)"," - ",D]})}),r.jsx("div",{className:"px-1",children:r.jsx(Ps,{})}),r.jsxs("div",{className:"flex flex-col items-center pt-0.5",children:[r.jsx(Tr,{}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-0.5 mt-0.5 px-1 pb-2",children:[P==="player"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Q,disabled:o||w,className:ie("pixel-btn text-[8px] px-1.5 py-0.5 transition-all",(o||w)&&"opacity-50 cursor-not-allowed"),children:w||o?"等待":"重开"}),r.jsx("button",{onClick:ee,disabled:et,className:ie("pixel-btn bg-blue-600 hover:bg-blue-700 text-[8px] px-1.5 py-0.5 transition-all",et&&"opacity-50 cursor-not-allowed hover:bg-blue-600"),children:a?"等待":"悔棋"}),r.jsx(Ht,{onSendMessage:W,userRole:P,className:"text-[8px] px-1.5 py-0.5"}),r.jsx(Gt,{className:"text-[8px] px-1.5 py-0.5"}),r.jsx("button",{onClick:be,disabled:I!=="playing",className:ie("pixel-btn bg-red-600 hover:bg-red-700 text-[8px] px-1.5 py-0.5 transition-all",I!=="playing"&&"opacity-50 cursor-not-allowed hover:bg-red-600"),children:"认输"}),r.jsx("button",{onClick:re,className:"pixel-btn bg-yellow-600 hover:bg-yellow-700 text-[8px] px-1.5 py-0.5 transition-all",children:"观众席"})]}):P==="spectator"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Lt,className:"pixel-btn bg-green-600 hover:bg-green-700 text-[8px] px-1.5 py-0.5 transition-all",children:"成玩家"}),r.jsx(Ht,{onSendMessage:W,userRole:P,className:"text-[8px] px-1.5 py-0.5"}),r.jsx(Gt,{className:"text-[8px] px-1.5 py-0.5"})]}):null,r.jsx("button",{onClick:H,className:"pixel-btn bg-red-600 hover:bg-red-700 text-[8px] px-1.5 py-0.5 transition-all",children:"离开"})]})]})]})]},"game"):r.jsx(G.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},className:"flex items-center justify-center px-4 py-2",children:r.jsx("div",{className:"w-full max-w-2xl",children:r.jsx($d,{onJoinRoom:()=>t(!0)})})},"room-manager")}),!z&&e&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed bottom-2 right-2 bg-orange-600 text-white px-2 py-1 rounded shadow-lg text-xs z-50",children:r.jsx("span",{className:"animate-pulse",children:"连接中..."})})]})};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Kd=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,s,n)=>n?n.toUpperCase():s.toLowerCase()),Pr=e=>{const t=Kd(e);return t.charAt(0).toUpperCase()+t.slice(1)},ii=(...e)=>e.filter((t,s,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===s).join(" ").trim(),Yd=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=g.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:o="",children:i,iconNode:a,...l},c)=>g.createElement("svg",{ref:c,...Zd,width:t,height:t,stroke:e,strokeWidth:n?Number(s)*24/Number(t):s,className:ii("lucide",o),...!i&&!Yd(l)&&{"aria-hidden":"true"},...l},[...a.map(([d,u])=>g.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=(e,t)=>{const s=g.forwardRef(({className:n,...o},i)=>g.createElement(Jd,{ref:i,iconNode:t,className:ii(`lucide-${Xd(Pr(e))}`,`lucide-${e}`,n),...o}));return s.displayName=Pr(e),s};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Je=le("arrow-left",Qd);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],tu=le("chevron-down",eu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],nu=le("chevron-left",su);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ou=le("chevron-right",ru);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],au=le("circle-alert",iu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ai=le("circle-check-big",lu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ks=le("circle",cu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],uu=le("copy",du);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],fu=le("eraser",hu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],pu=le("heart",mu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],kr=le("lightbulb",gu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],yu=le("monitor",xu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],yn=le("pause",vu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ht=le("play",bu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Qe=le("rotate-ccw",wu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Nu=le("rotate-cw",ju);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Cu=le("target",Su);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Pu=le("timer",Tu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Dt=le("trophy",ku);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ru=le("users",Mu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ms=le("x",Au),Vu=()=>{const e=Ke(),[t,s]=g.useState(()=>x()),[n,o]=g.useState(0),[i,a]=g.useState(()=>{const D=localStorage.getItem("2048-best-score");return D?parseInt(D):0}),[l,c]=g.useState(!1),[d,u]=g.useState(!1),[h,p]=g.useState(null);function x(){const D=Array(4).fill(null).map(()=>Array(4).fill(null));return j(D),j(D),D}function j(D){const R=[];for(let v=0;v<4;v++)for(let T=0;T<4;T++)D[v][T]===null&&R.push([v,T]);if(R.length===0)return!1;const[B,V]=R[Math.floor(Math.random()*R.length)];return D[B][V]=Math.random()<.9?2:4,!0}const b=g.useCallback(D=>{if(l||d)return;const R=t.map(T=>[...T]);let B=!1,V=0;const v=T=>{let L=T.filter(P=>P!==null),N=0,M=!1;for(let P=0;P<L.length-1;P++)L[P]===L[P+1]&&(L[P]=L[P]*2,N+=L[P],L.splice(P+1,1),M=!0);for(;L.length<4;)L.push(null);return JSON.stringify(T)!==JSON.stringify(L)&&(M=!0),[L,N,M]};if(D==="left")for(let T=0;T<4;T++){const[L,N,M]=v(R[T]);R[T]=L,V+=N,M&&(B=!0)}else if(D==="right")for(let T=0;T<4;T++){const L=[...R[T]].reverse(),[N,M,P]=v(L);R[T]=N.reverse(),V+=M,P&&(B=!0)}else if(D==="up")for(let T=0;T<4;T++){const L=[R[0][T],R[1][T],R[2][T],R[3][T]],[N,M,P]=v(L);for(let m=0;m<4;m++)R[m][T]=N[m];V+=M,P&&(B=!0)}else if(D==="down")for(let T=0;T<4;T++){const L=[R[3][T],R[2][T],R[1][T],R[0][T]],[N,M,P]=v(L);R[0][T]=N[3],R[1][T]=N[2],R[2][T]=N[1],R[3][T]=N[0],V+=M,P&&(B=!0)}if(B){j(R),s(R);const T=n+V;o(T),T>i&&(a(T),localStorage.setItem("2048-best-score",T.toString()));for(let L=0;L<4;L++)for(let N=0;N<4;N++)if(R[L][N]===2048){u(!0);return}w(R)||c(!0)}},[t,n,i,l,d]);function w(D){for(let R=0;R<4;R++)for(let B=0;B<4;B++)if(D[R][B]===null)return!0;for(let R=0;R<4;R++)for(let B=0;B<4;B++){const V=D[R][B];if(R<3&&V===D[R+1][B]||B<3&&V===D[R][B+1])return!0}return!1}g.useEffect(()=>{const D=R=>{R.key==="ArrowUp"?(R.preventDefault(),b("up")):R.key==="ArrowDown"?(R.preventDefault(),b("down")):R.key==="ArrowLeft"?(R.preventDefault(),b("left")):R.key==="ArrowRight"&&(R.preventDefault(),b("right"))};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[b]);const A=D=>{const R=D.touches[0];p({x:R.clientX,y:R.clientY})},k=D=>{if(!h)return;const R=D.changedTouches[0],B=R.clientX-h.x,V=R.clientY-h.y,v=50;Math.abs(B)>Math.abs(V)?Math.abs(B)>v&&(B>0?b("right"):b("left")):Math.abs(V)>v&&(V>0?b("down"):b("up")),p(null)},S=()=>{s(x()),o(0),c(!1),u(!1)},I=D=>D===null?"bg-gray-700":{2:"bg-gray-600",4:"bg-gray-500",8:"bg-orange-500",16:"bg-orange-600",32:"bg-red-500",64:"bg-red-600",128:"bg-yellow-500",256:"bg-yellow-600",512:"bg-green-500",1024:"bg-green-600",2048:"bg-purple-600"}[D]||"bg-purple-700";return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 p-4",children:r.jsxs("div",{className:"max-w-md mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("button",{onClick:()=>e("/"),className:"p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(Je,{size:24})}),r.jsx("h1",{className:"text-3xl font-bold text-white font-game",children:"2048"}),r.jsx("button",{onClick:S,className:"p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(Qe,{size:24})})]}),r.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[r.jsxs("div",{className:"bg-gray-800 px-4 py-2 rounded-lg",children:[r.jsx("div",{className:"text-gray-400 text-sm",children:"得分"}),r.jsx("div",{className:"text-white text-2xl font-bold",children:n})]}),r.jsxs("div",{className:"bg-gray-800 px-4 py-2 rounded-lg",children:[r.jsx("div",{className:"text-gray-400 text-sm",children:"最高分"}),r.jsx("div",{className:"text-white text-2xl font-bold",children:i})]})]}),r.jsx("div",{className:"relative bg-gray-800 p-2 rounded-lg select-none",onTouchStart:A,onTouchEnd:k,children:r.jsx("div",{className:"grid grid-cols-4 gap-2",children:t.map((D,R)=>D.map((B,V)=>r.jsxs("div",{className:"aspect-square relative",children:[r.jsx("div",{className:"absolute inset-0 bg-gray-700 rounded"}),r.jsx(ve,{mode:"popLayout",children:B!==null&&r.jsx(G.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:`absolute inset-0 ${I(B)} rounded flex items-center justify-center text-white font-bold ${B&&B>=128?"text-2xl":"text-3xl"} ${B&&B>=1024?"text-xl":""}`,children:B},`tile-${R}-${V}-${B}`)})]},`${R}-${V}`)))})}),r.jsxs("div",{className:"mt-6 text-center text-gray-400 text-sm",children:[r.jsx("p",{children:"使用方向键或滑动来移动方块"}),r.jsx("p",{children:"相同数字的方块会合并"})]}),r.jsx(ve,{children:(l||d)&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50",children:r.jsxs(G.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},className:"bg-gray-800 p-8 rounded-xl text-center max-w-sm w-full",children:[d?r.jsxs(r.Fragment,{children:[r.jsx(Dt,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"恭喜获胜！"}),r.jsx("p",{className:"text-gray-400 mb-6",children:"你达到了2048！"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"游戏结束"}),r.jsxs("p",{className:"text-gray-400 mb-6",children:["最终得分：",n]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:S,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"返回首页"})]})]})})})]})})},Ee=20,Mr=150,Eu=5,Du=()=>{const e=Ke(),t=g.useRef(null),[s,n]=g.useState([{x:10,y:10}]),[o,i]=g.useState({x:15,y:15}),[a,l]=g.useState("RIGHT"),[c,d]=g.useState(!1),[u,h]=g.useState(0),[p,x]=g.useState(()=>{const N=localStorage.getItem("snake-high-score");return N?parseInt(N):0}),[j,b]=g.useState(!1),[w,A]=g.useState(null),k=g.useRef(a),[S,I]=g.useState(Mr),D=g.useCallback(N=>{let M;do M={x:Math.floor(Math.random()*Ee),y:Math.floor(Math.random()*Ee)};while(N.some(P=>P.x===M.x&&P.y===M.y));return M},[]),R=g.useCallback((N,M)=>N.x<0||N.x>=Ee||N.y<0||N.y>=Ee?!0:M.some(P=>P.x===N.x&&P.y===N.y),[]),B=g.useCallback(()=>{c||!j||n(N=>{const M=[...N],P={...M[0]};switch(k.current){case"UP":P.y-=1;break;case"DOWN":P.y+=1;break;case"LEFT":P.x-=1;break;case"RIGHT":P.x+=1;break}return R(P,M)?(d(!0),b(!1),u>p&&(x(u),localStorage.setItem("snake-high-score",u.toString())),N):(M.unshift(P),P.x===o.x&&P.y===o.y?(h(m=>m+10),i(D(M)),I(m=>Math.max(50,m-Eu))):M.pop(),M)})},[c,j,o,R,D,u,p]);g.useEffect(()=>{const N=setInterval(B,S);return()=>clearInterval(N)},[B,S]),g.useEffect(()=>{const N=M=>{if(c||!j)return;const P=M.key;let m=k.current;switch(P){case"ArrowUp":case"w":case"W":k.current!=="DOWN"&&(m="UP");break;case"ArrowDown":case"s":case"S":k.current!=="UP"&&(m="DOWN");break;case"ArrowLeft":case"a":case"A":k.current!=="RIGHT"&&(m="LEFT");break;case"ArrowRight":case"d":case"D":k.current!=="LEFT"&&(m="RIGHT");break;case" ":M.preventDefault(),b(z=>!z);break}m!==k.current&&(k.current=m,l(m))};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[c,j]);const V=N=>{const M=N.touches[0];A({x:M.clientX,y:M.clientY})},v=N=>{if(!w||c||!j)return;const M=N.changedTouches[0],P=M.clientX-w.x,m=M.clientY-w.y;Math.abs(P)>Math.abs(m)?P>30&&k.current!=="LEFT"?(k.current="RIGHT",l("RIGHT")):P<-30&&k.current!=="RIGHT"&&(k.current="LEFT",l("LEFT")):m>30&&k.current!=="UP"?(k.current="DOWN",l("DOWN")):m<-30&&k.current!=="DOWN"&&(k.current="UP",l("UP")),A(null)},T=()=>{n([{x:10,y:10}]),i({x:15,y:15}),l("RIGHT"),k.current="RIGHT",d(!1),h(0),I(Mr),b(!1)},L=()=>{c?T():b(!0)};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-2xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"贪吃蛇"}),r.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重新开始"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"当前分数"}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:u})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Dt,{size:14}),"最高分数"]}),r.jsx("div",{className:"text-2xl font-bold text-yellow-400 font-game",children:p})]})]})]}),r.jsxs("div",{ref:t,className:"bg-gray-900 border border-gray-700 p-4 rounded-b-xl relative",onTouchStart:V,onTouchEnd:v,children:[r.jsxs("div",{className:"relative bg-gray-800 rounded-lg",style:{width:`${Ee*16}px`,height:`${Ee*16}px`,maxWidth:"100%",aspectRatio:"1/1"},children:[r.jsx("div",{className:"absolute inset-0 grid grid-cols-20 grid-rows-20",children:Array.from({length:Ee*Ee}).map((N,M)=>r.jsx("div",{className:"border border-gray-700/20"},M))}),r.jsx(ve,{children:s.map((N,M)=>r.jsx(G.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:`absolute ${M===0?"bg-gradient-to-br from-green-400 to-green-600 z-20":"bg-gradient-to-br from-green-500 to-green-700 z-10"} rounded-sm`,style:{left:`${N.x*16}px`,top:`${N.y*16}px`,width:"14px",height:"14px",margin:"1px"}},`${N.x}-${N.y}-${M}`))}),r.jsx(G.div,{initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{duration:.5,repeat:1/0},className:"absolute bg-gradient-to-br from-red-400 to-red-600 rounded-full z-30",style:{left:`${o.x*16}px`,top:`${o.y*16}px`,width:"14px",height:"14px",margin:"1px"}},`${o.x}-${o.y}`),(!j||c)&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center z-40",children:r.jsx("div",{className:"text-center",children:c?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-4",children:["得分: ",u]}),u>p&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新纪录!"}),r.jsx("button",{onClick:T,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:u===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:L,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(ht,{size:20}),u===0?"开始游戏":"继续游戏"]}),r.jsxs("div",{className:"mt-4 text-gray-400 text-sm font-game",children:[r.jsx("p",{children:"使用方向键或WASD控制"}),r.jsx("p",{children:"手机上滑动屏幕控制方向"}),r.jsx("p",{children:"空格键暂停/继续"})]})]})})})]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("button",{onClick:()=>b(N=>!N),className:`px-6 py-3 ${j?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center gap-2`,children:j?r.jsxs(r.Fragment,{children:[r.jsx(yn,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(ht,{size:20}),u===0?"开始":"继续"]})})})]})]})})},nt=10,vt=20,Lu=800,Iu=50,rt={I:{shape:[[1,1,1,1]],color:"from-cyan-400 to-cyan-600"},O:{shape:[[1,1],[1,1]],color:"from-yellow-400 to-yellow-600"},T:{shape:[[0,1,0],[1,1,1]],color:"from-purple-400 to-purple-600"},S:{shape:[[0,1,1],[1,1,0]],color:"from-green-400 to-green-600"},Z:{shape:[[1,1,0],[0,1,1]],color:"from-red-400 to-red-600"},J:{shape:[[1,0,0],[1,1,1]],color:"from-blue-400 to-blue-600"},L:{shape:[[0,0,1],[1,1,1]],color:"from-orange-400 to-orange-600"}},Fu=()=>{const e=Ke(),t=g.useRef(null),[s,n]=g.useState(()=>Array(vt).fill(null).map(()=>Array(nt).fill(null))),[o,i]=g.useState(null),[a,l]=g.useState("T"),[c,d]=g.useState(0),[u,h]=g.useState(0),[p,x]=g.useState(1),[j,b]=g.useState(!1),[w,A]=g.useState(!1),[k,S]=g.useState(()=>{const f=localStorage.getItem("tetris-high-score");return f?parseInt(f):0}),[I,D]=g.useState(null),R=g.useRef(0),B=()=>{const f=Object.keys(rt);return f[Math.floor(Math.random()*f.length)]},V=f=>{const C=f.length,E=f[0].length,F=Array(E).fill(null).map(()=>Array(C).fill(0));for(let $=0;$<C;$++)for(let U=0;U<E;U++)F[U][C-1-$]=f[$][U];return F},v=(f,C)=>{for(let E=0;E<C.shape.length;E++)for(let F=0;F<C.shape[E].length;F++)if(C.shape[E][F]){const $=C.position.x+F,U=C.position.y+E;if($<0||$>=nt||U>=vt||U>=0&&f[U][$])return!0}return!1},T=(f,C)=>{const E=f.map($=>[...$]),F=rt[C.type].color;for(let $=0;$<C.shape.length;$++)for(let U=0;U<C.shape[$].length;U++)if(C.shape[$][U]){const W=C.position.y+$,Y=C.position.x+U;W>=0&&(E[W][Y]=F)}return E},L=f=>{let C=[...f],E=0;for(let F=vt-1;F>=0;F--)C[F].every($=>$!==null)&&(C.splice(F,1),C.unshift(Array(nt).fill(null)),E++,F++);return{board:C,linesCleared:E}},N=f=>{const C=rt[f].shape;return{type:f,shape:C,position:{x:Math.floor((nt-C[0].length)/2),y:0}}},M=g.useCallback((f,C)=>{if(!o||!w||j)return!1;const E={x:o.position.x+f,y:o.position.y+C},F={...o,position:E};return v(s,F)?!1:(i(F),!0)},[o,s,w,j]),P=g.useCallback(()=>{if(!o||!w||j)return;const f=V(o.shape),C={...o,shape:f};if(!v(s,C))i(C);else for(const E of[1,-1,2,-2]){const F={...C,position:{...C.position,x:C.position.x+E}};if(!v(s,F)){i(F);break}}},[o,s,w,j]),m=g.useCallback(()=>{if(!o||!w||j)return;let f=0;for(;M(0,1);)f++;d(C=>C+f*2)},[o,w,j,M]);g.useEffect(()=>{if(!w||j||!o)return;const f=Math.max(100,Lu-(p-1)*Iu),C=setInterval(()=>{if(!M(0,1)){const E=T(s,o),{board:F,linesCleared:$}=L(E);n(F),$>0&&(h(W=>W+$),d(W=>W+$*100*p),x(Math.floor((u+$)/10)+1));const U=N(a);v(F,U)?(b(!0),A(!1),c>k&&(S(c),localStorage.setItem("tetris-high-score",c.toString()))):(i(U),l(B()))}},f);return()=>clearInterval(C)},[o,s,w,j,a,M,p,u,c,k]),g.useEffect(()=>{const f=C=>{if(!w||j){C.key===" "&&(C.preventDefault(),j?q():y());return}const E=Date.now(),F=E-R.current;switch(C.key){case"ArrowLeft":case"a":case"A":F>50&&(M(-1,0),R.current=E);break;case"ArrowRight":case"d":case"D":F>50&&(M(1,0),R.current=E);break;case"ArrowDown":case"s":case"S":M(0,1),d($=>$+1);break;case"ArrowUp":case"w":case"W":P();break;case" ":C.preventDefault(),m();break;case"p":case"P":A($=>!$);break}};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[w,j,M,P,m]);const z=f=>{const C=f.touches[0];D({x:C.clientX,y:C.clientY})},_=f=>{if(!I||!w||j)return;const C=f.changedTouches[0],E=C.clientX-I.x,F=C.clientY-I.y;Math.abs(E)>Math.abs(F)?Math.abs(E)>30&&(E>0?M(1,0):M(-1,0)):F>50?(M(0,1),d($=>$+1)):F<-30&&P(),D(null)},K=()=>{w&&!j&&P()},q=()=>{n(Array(vt).fill(null).map(()=>Array(nt).fill(null))),i(null),l(B()),d(0),h(0),x(1),b(!1),A(!1)},y=()=>{if(j&&q(),A(!0),!o){const f=N(a);i(f),l(B())}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsx("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"俄罗斯方块"}),r.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]})}),r.jsx("div",{className:"bg-gray-900 border border-gray-700 p-4 rounded-b-xl",children:r.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[r.jsxs("div",{ref:t,className:"relative bg-gray-800 rounded-lg p-2",onTouchStart:z,onTouchEnd:_,onClick:K,children:[r.jsxs("div",{className:"grid grid-cols-10 gap-px bg-gray-700",style:{width:"240px"},children:[s.map((f,C)=>f.map((E,F)=>r.jsx("div",{className:`w-6 h-6 ${E?`bg-gradient-to-br ${E}`:"bg-gray-900"} ${E?"border border-gray-600":""}`},`${C}-${F}`))),o&&o.shape.map((f,C)=>f.map((E,F)=>{if(!E)return null;const $=o.position.y+C,U=o.position.x+F;return $<0||$>=vt||U<0||U>=nt?null:r.jsx(G.div,{initial:{scale:0},animate:{scale:1},className:`absolute w-6 h-6 bg-gradient-to-br ${rt[o.type].color} border border-gray-600`,style:{left:`${U*24+U}px`,top:`${$*24+$}px`}},`current-${C}-${F}`)}))]}),(!w||j)&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/70 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-center p-4",children:j?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-2",children:["得分: ",c]}),c>k&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新纪录!"}),r.jsx("button",{onClick:q,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:c===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:y,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(ht,{size:20}),c===0?"开始游戏":"继续"]})]})})})]}),r.jsxs("div",{className:"flex-1 space-y-4",children:[r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[r.jsx("h3",{className:"text-sm font-game text-gray-400 mb-2",children:"下一个"}),r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"grid gap-px bg-gray-700 p-1",children:rt[a].shape.map((f,C)=>r.jsx("div",{className:"flex gap-px",children:f.map((E,F)=>r.jsx("div",{className:`w-5 h-5 ${E?`bg-gradient-to-br ${rt[a].color} border border-gray-600`:""}`},F))},C))})})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 space-y-3",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"分数"}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:c})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"行数"}),r.jsx("div",{className:"text-xl font-bold text-blue-400 font-game",children:u})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"等级"}),r.jsx("div",{className:"text-xl font-bold text-green-400 font-game",children:p})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center gap-1",children:[r.jsx(Dt,{size:14}),"最高分"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:k})]})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 text-xs text-gray-400 font-game space-y-1",children:[r.jsx("p",{children:"← → 或 A/D: 左右移动"}),r.jsx("p",{children:"↓ 或 S: 加速下落"}),r.jsx("p",{children:"↑ 或 W: 旋转"}),r.jsx("p",{children:"空格: 硬降"}),r.jsx("p",{children:"P: 暂停"}),r.jsx("p",{className:"text-purple-400",children:"手机: 滑动或点击旋转"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 lg:hidden",children:[r.jsx("button",{onClick:()=>M(-1,0),className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!w||j,children:r.jsx(nu,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:P,className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!w||j,children:r.jsx(Nu,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:()=>M(1,0),className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!w||j,children:r.jsx(ou,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:()=>{M(0,1),d(f=>f+1)},className:"col-span-3 p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!w||j,children:r.jsx(tu,{size:20,className:"mx-auto text-white"})})]}),r.jsx("button",{onClick:()=>w?A(!1):y(),className:`w-full px-6 py-3 ${w?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center justify-center gap-2`,children:w?r.jsxs(r.Fragment,{children:[r.jsx(yn,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(ht,{size:20}),j||c===0?"开始游戏":"继续"]})})]})]})})]})})};let se=null,_t=!1;const Bu=(e,t,s,n,o,i,a,l,c)=>{const[d,u]=g.useState(_t);return g.useEffect(()=>{if(se)u(_t);else{let k;k="http://socket.qingfengyueying.xyz",console.log("TicTacToe - Connecting to:",k),se=Xs(k,{transports:["websocket","polling"],upgrade:!0,path:"/socket.io/",timeout:1e4,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),se.on("connect",()=>{console.log("TicTacToe socket connected"),_t=!0,u(!0)}),se.on("disconnect",()=>{console.log("TicTacToe socket disconnected"),_t=!1,u(!1)}),se.on("ttt-game-start",S=>{console.log("TicTacToe game start:",S),e(S)}),se.on("ttt-opponent-move",S=>{console.log("TicTacToe opponent move:",S),t(S)}),se.on("ttt-game-end",S=>{console.log("TicTacToe game end:",S),s(S)}),se.on("ttt-room-joined",S=>{console.log("TicTacToe room joined:",S),n(S)}),se.on("ttt-room-created",S=>{console.log("TicTacToe room created:",S),n(S)}),se.on("ttt-player-joined",S=>{console.log("TicTacToe player joined:",S),o(S)}),se.on("ttt-player-left",S=>{console.log("TicTacToe player left:",S),i(S)}),se.on("ttt-restart-request",()=>{console.log("TicTacToe restart request"),a()}),se.on("ttt-game-restart",()=>{console.log("TicTacToe game restart"),l()}),se.on("ttt-error",S=>{console.error("TicTacToe error:",S.message),c(S.message)})}return()=>{}},[e,t,s,n,o,i,a,l,c]),{socket:se,connected:d,joinRoom:(k,S)=>{se&&S==="online"&&(console.log("Joining TicTacToe room:",k),se.emit("ttt-join-room",{roomId:k}))},createRoom:k=>{se&&k==="online"&&(console.log("Creating TicTacToe room"),se.emit("ttt-create-room"))},makeMove:(k,S,I)=>{se&&(console.log("Making TicTacToe move:",{roomId:k,row:S,col:I}),se.emit("ttt-make-move",{roomId:k,row:S,col:I}))},requestRestart:k=>{se&&(console.log("Requesting TicTacToe restart:",k),se.emit("ttt-request-restart",{roomId:k}))},acceptRestart:k=>{se&&(console.log("Accepting TicTacToe restart:",k),se.emit("ttt-accept-restart",{roomId:k}))},rejectRestart:k=>{se&&(console.log("Rejecting TicTacToe restart:",k),se.emit("ttt-reject-restart",{roomId:k}))},leaveRoom:k=>{se&&(console.log("Leaving TicTacToe room:",k),se.emit("ttt-leave-room",{roomId:k}))}}},Ou=()=>{const e=Ke(),[t,s]=g.useState(()=>Array(3).fill(null).map(()=>Array(3).fill(null))),[n,o]=g.useState("X"),[i,a]=g.useState(null),[l,c]=g.useState(null),[d,u]=g.useState("waiting"),[h,p]=g.useState(null),[x,j]=g.useState([]),[b,w]=g.useState(""),[A,k]=g.useState({X:0,O:0,draws:0}),[S,I]=g.useState(!1),[D,R]=g.useState(!1),[B,V]=g.useState(!1),[v,T]=g.useState(""),{connected:L,joinRoom:N,createRoom:M,makeMove:P,requestRestart:m,acceptRestart:z,rejectRestart:_,leaveRoom:K}=Bu(O=>{a(O.playerSymbol),u("playing"),o("X"),F(),T("游戏开始！你是 "+O.playerSymbol)},O=>{const X=[...t];X[O.row][O.col]=n,s(X);const H=q(X);H.winner?C(H.winner,H.line):o(n==="X"?"O":"X")},O=>{p(O.winner),u("finished"),E(O.winner)},O=>{w(O.roomId),R(!O.isHost),T(O.isHost?"房间创建成功，等待对手加入...":"成功加入房间")},()=>{R(!1),T("对手已加入，游戏即将开始")},()=>{T("对手已离开"),u("waiting"),R(!0)},()=>{I(!0),T("对手请求重新开始")},()=>{$(),T("游戏重新开始")},O=>{T(O)}),q=O=>{for(let H=0;H<3;H++)if(O[H][0]&&O[H][0]===O[H][1]&&O[H][1]===O[H][2])return{winner:O[H][0],line:[[H,0],[H,1],[H,2]]};for(let H=0;H<3;H++)if(O[0][H]&&O[0][H]===O[1][H]&&O[1][H]===O[2][H])return{winner:O[0][H],line:[[0,H],[1,H],[2,H]]};return O[0][0]&&O[0][0]===O[1][1]&&O[1][1]===O[2][2]?{winner:O[0][0],line:[[0,0],[1,1],[2,2]]}:O[0][2]&&O[0][2]===O[1][1]&&O[1][1]===O[2][0]?{winner:O[0][2],line:[[0,2],[1,1],[2,0]]}:O.every(H=>H.every(Q=>Q!==null))?{winner:"draw",line:[]}:{winner:null,line:[]}},y=g.useCallback(()=>{d!=="playing"||n!=="O"||setTimeout(()=>{const O=[];for(let H=0;H<3;H++)for(let Q=0;Q<3;Q++)t[H][Q]||O.push([H,Q]);if(O.length===0)return;let X=null;for(const[H,Q]of O){const ee=t.map(re=>[...re]);if(ee[H][Q]="O",q(ee).winner==="O"){X=[H,Q];break}}if(!X)for(const[H,Q]of O){const ee=t.map(re=>[...re]);if(ee[H][Q]="X",q(ee).winner==="X"){X=[H,Q];break}}if(!X&&!t[1][1]&&(X=[1,1]),!X){const Q=[[0,0],[0,2],[2,0],[2,2]].filter(([ee,re])=>!t[ee][re]);Q.length>0&&(X=Q[Math.floor(Math.random()*Q.length)])}X||(X=O[Math.floor(Math.random()*O.length)]),X&&f(X[0],X[1])},500)},[t,n,d]),f=(O,X)=>{if(d!=="playing"||t[O][X]||h||l==="online"&&n!==i)return;const H=[...t];H[O][X]=n,s(H),l==="online"&&b&&P(b,O,X);const Q=q(H);Q.winner?C(Q.winner,Q.line):o(n==="X"?"O":"X")},C=(O,X=[])=>{p(O),j(X),u("finished"),E(O),T(O==="draw"?"平局！":`${l==="single"?O==="X"?"你":"电脑":O===i?"你":"对手"}获胜！`)},E=O=>{O==="draw"?k(X=>({...X,draws:X.draws+1})):O&&k(X=>({...X,[O]:X[O]+1}))},F=()=>{s(Array(3).fill(null).map(()=>Array(3).fill(null))),p(null),j([])},$=()=>{F(),o("X"),u(l?"playing":"waiting"),I(!1)},U=O=>{c(O),$(),O==="single"?(a("X"),u("playing")):O==="online"&&M("online")},W=()=>{const O=prompt("请输入房间号:");O&&(w(O.toUpperCase()),N(O.toUpperCase(),"online"),c("online"))},Y=()=>{navigator.clipboard.writeText(b),V(!0),setTimeout(()=>V(!1),2e3)},te=()=>{l==="online"&&b&&K(b),c(null),u("waiting"),F(),w(""),a(null)};return g.useEffect(()=>{l==="single"&&d==="playing"&&n==="O"&&!h&&y()},[l,d,n,h,y]),g.useEffect(()=>{if(v){const O=setTimeout(()=>T(""),3e3);return()=>clearTimeout(O)}},[v]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-lg",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>l?te():e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:l?"菜单":"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"井字棋"}),d==="playing"&&r.jsxs("button",{onClick:$,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]}),l&&r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsxs("div",{className:"text-blue-400 font-game flex items-center justify-center gap-1",children:[r.jsx(Ms,{size:16}),l==="single"?"玩家":"X"]}),r.jsx("div",{className:"text-xl font-bold text-white",children:A.X})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsx("div",{className:"text-gray-400 font-game",children:"平局"}),r.jsx("div",{className:"text-xl font-bold text-white",children:A.draws})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsxs("div",{className:"text-red-400 font-game flex items-center justify-center gap-1",children:[r.jsx(ks,{size:16}),l==="single"?"电脑":"O"]}),r.jsx("div",{className:"text-xl font-bold text-white",children:A.O})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsx(ve,{children:v&&r.jsx(G.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-4 p-3 bg-blue-600/20 border border-blue-600 rounded-lg text-blue-400 text-center font-game",children:v})}),!l&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-game text-white text-center mb-6",children:"选择游戏模式"}),r.jsxs("button",{onClick:()=>U("single"),className:"w-full p-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all flex items-center justify-center gap-3",children:[r.jsx(yu,{size:24}),r.jsx("span",{className:"font-game text-lg",children:"单机对战"})]}),r.jsxs("button",{onClick:()=>U("online"),disabled:!L,className:`w-full p-4 ${L?"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800":"bg-gray-700 cursor-not-allowed opacity-50"} text-white rounded-lg transition-all flex items-center justify-center gap-3`,children:[r.jsx(Ru,{size:24}),r.jsx("span",{className:"font-game text-lg",children:"在线对战"}),!L&&r.jsx("span",{className:"text-xs",children:"(未连接)"})]}),r.jsx("button",{onClick:W,disabled:!L,className:`w-full p-4 ${L?"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800":"bg-gray-700 cursor-not-allowed opacity-50"} text-white rounded-lg transition-all flex items-center justify-center gap-3`,children:r.jsx("span",{className:"font-game text-lg",children:"加入房间"})})]}),l==="online"&&b&&r.jsxs("div",{className:"mb-4 p-3 bg-gray-800 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-gray-400 font-game",children:"房间号:"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-white font-game font-bold text-lg",children:b}),r.jsx("button",{onClick:Y,className:"p-1 hover:bg-gray-700 rounded transition-colors",children:B?r.jsx(ai,{size:16,className:"text-green-400"}):r.jsx(uu,{size:16,className:"text-gray-400"})})]})]}),D&&r.jsx("div",{className:"mt-2 text-yellow-400 text-sm font-game animate-pulse",children:"等待对手加入..."})]}),l&&r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-800 p-4 rounded-lg",children:t.map((O,X)=>O.map((H,Q)=>{const ee=x.some(([re,he])=>re===X&&he===Q);return r.jsx(G.button,{whileHover:{scale:H?1:1.05},whileTap:{scale:.95},onClick:()=>f(X,Q),disabled:!!H||d!=="playing"||l==="online"&&n!==i,className:`
                          h-24 sm:h-28 bg-gray-900 rounded-lg border-2 transition-all
                          ${H?"border-gray-600":"border-gray-700 hover:border-gray-500"}
                          ${ee?"bg-green-900/30 border-green-500":""}
                          ${!H&&d==="playing"&&(l==="single"||n===i)?"cursor-pointer":"cursor-not-allowed"}
                          flex items-center justify-center
                        `,children:r.jsx(ve,{children:H&&r.jsx(G.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},className:`text-5xl sm:text-6xl font-bold ${H==="X"?"text-blue-400":"text-red-400"}`,children:H==="X"?r.jsx(Ms,{size:48}):r.jsx(ks,{size:48})})})},`${X}-${Q}`)}))}),d==="playing"&&!h&&r.jsxs("div",{className:"mt-4 text-center",children:[r.jsx("span",{className:"text-gray-400 font-game",children:"当前回合: "}),r.jsx("span",{className:`font-game font-bold text-lg ${n==="X"?"text-blue-400":"text-red-400"}`,children:l==="single"?n==="X"?"你":"电脑":l==="online"&&n===i?"你":n})]}),d==="finished"&&h&&r.jsx(G.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsxs("div",{className:"text-center p-6",children:[h==="draw"?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-yellow-400 mb-4",children:"平局!"}),r.jsx("p",{className:"text-white font-game mb-4",children:"势均力敌"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:l==="single"?h==="X"?"你赢了!":"电脑赢了!":h===i?"你赢了!":"对手赢了!"}),r.jsx("div",{className:`text-5xl mb-4 ${h==="X"?"text-blue-400":"text-red-400"}`,children:h==="X"?r.jsx(Ms,{size:60}):r.jsx(ks,{size:60})})]}),r.jsx("button",{onClick:l==="online"?()=>m(b):$,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"再来一局"})]})})]}),S&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 max-w-sm",children:[r.jsx("h3",{className:"text-xl font-game text-white mb-4",children:"对手请求重新开始"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{z(b),I(!1)},className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"同意"}),r.jsx("button",{onClick:()=>{_(b),I(!1)},className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"拒绝"})]})]})})]})]})})},zu=["🎮","🎯","🎲","🎨","🎪","🎭","🎰","🎸","🏀","⚽","🏈","🎾","🎱","🏆","🎪","🎨"],$u=()=>{const e=Ke(),[t,s]=g.useState([]),[n,o]=g.useState([]),[i,a]=g.useState(0),[l,c]=g.useState(0),[d,u]=g.useState(!1),[h,p]=g.useState(!1),[x,j]=g.useState("medium"),[b,w]=g.useState(0),[A,k]=g.useState(0),[S,I]=g.useState(()=>{const P=localStorage.getItem("memory-best-scores");return P?JSON.parse(P):{easy:{moves:1/0,time:1/0},medium:{moves:1/0,time:1/0},hard:{moves:1/0,time:1/0}}}),D=P=>{switch(P){case"easy":return 8;case"medium":return 12;case"hard":return 16;default:return 12}},R=g.useCallback(()=>{const P=D(x),m=zu.slice(0,P/2),z=[];m.forEach((_,K)=>{z.push({id:K*2,emoji:_,isFlipped:!1,isMatched:!1},{id:K*2+1,emoji:_,isFlipped:!1,isMatched:!1})});for(let _=z.length-1;_>0;_--){const K=Math.floor(Math.random()*(_+1));[z[_],z[K]]=[z[K],z[_]]}s(z),o([]),a(0),c(0),p(!1),u(!1),k(0)},[x]),B=P=>{d||(u(!0),w(Date.now()));const m=t.find(K=>K.id===P);if(!m||m.isFlipped||m.isMatched||n.length>=2)return;const z=t.map(K=>K.id===P?{...K,isFlipped:!0}:K);s(z);const _=[...n,P];o(_),_.length===2&&(a(i+1),V(_))},V=P=>{const[m,z]=P,_=t.find(q=>q.id===m),K=t.find(q=>q.id===z);_&&K&&_.emoji===K.emoji?setTimeout(()=>{s(y=>y.map(f=>f.id===m||f.id===z?{...f,isMatched:!0}:f)),c(l+1),o([]);const q=D(x);l+1===q/2&&v()},500):setTimeout(()=>{s(q=>q.map(y=>y.id===m||y.id===z?{...y,isFlipped:!1}:y)),o([])},1e3)},v=()=>{const P=Date.now(),m=Math.floor((P-b)/1e3);k(m),p(!0);const z=S[x];if(i<z.moves||m<z.time){const _={...S,[x]:{moves:Math.min(i,z.moves),time:Math.min(m,z.time)}};I(_),localStorage.setItem("memory-best-scores",JSON.stringify(_))}},T=()=>{R()},L=P=>{j(P),u(!1),p(!1)};g.useEffect(()=>{let P;return d&&!h&&(P=setInterval(()=>{k(Math.floor((Date.now()-b)/1e3))},1e3)),()=>clearInterval(P)},[d,h,b]),g.useEffect(()=>{R()},[R]);const N=P=>{const m=Math.floor(P/60),z=P%60;return`${m}:${z.toString().padStart(2,"0")}`},M=()=>{switch(x){case"easy":return"grid-cols-4";case"medium":return"grid-cols-4";case"hard":return"grid-cols-4";default:return"grid-cols-4"}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"记忆翻牌"}),r.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重新开始"})]})]}),r.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["easy","medium","hard"].map(P=>r.jsx("button",{onClick:()=>L(P),className:`px-4 py-2 rounded-lg font-game transition-all ${x===P?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,children:P==="easy"?"简单":P==="medium"?"中等":"困难"},P))}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Cu,{size:14}),"步数"]}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:i})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Pu,{size:14}),"时间"]}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:N(A)})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"匹配"}),r.jsxs("div",{className:"text-2xl font-bold text-green-400 font-game",children:[l,"/",D(x)/2]})]})]}),S[x].moves!==1/0&&r.jsxs("div",{className:"mt-4 p-3 bg-gray-700/30 rounded-lg flex justify-center gap-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-gray-400 text-xs font-game",children:"最少步数"}),r.jsx("div",{className:"text-yellow-400 font-game font-bold",children:S[x].moves})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-gray-400 text-xs font-game flex items-center gap-1",children:[r.jsx(Dt,{size:12}),"最快时间"]}),r.jsx("div",{className:"text-yellow-400 font-game font-bold",children:N(S[x].time)})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsx("div",{className:`grid ${M()} gap-3 max-w-2xl mx-auto`,children:t.map(P=>r.jsx(G.div,{whileHover:{scale:P.isFlipped||P.isMatched?1:1.05},whileTap:{scale:.95},className:"aspect-square",children:r.jsxs("button",{onClick:()=>B(P.id),disabled:P.isFlipped||P.isMatched,className:"w-full h-full relative preserve-3d",style:{transformStyle:"preserve-3d",transform:P.isFlipped||P.isMatched?"rotateY(180deg)":"rotateY(0deg)",transition:"transform 0.6s"},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600 to-purple-800 rounded-lg border-2 border-purple-500 flex items-center justify-center backface-hidden",style:{backfaceVisibility:"hidden"},children:r.jsx("span",{className:"text-3xl sm:text-4xl",children:"❓"})}),r.jsx("div",{className:`absolute inset-0 ${P.isMatched?"bg-gradient-to-br from-green-600 to-green-800 border-green-500":"bg-gradient-to-br from-blue-600 to-blue-800 border-blue-500"} rounded-lg border-2 flex items-center justify-center`,style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:r.jsx(G.span,{className:"text-4xl sm:text-5xl",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:P.emoji})})]})},P.id))}),r.jsx(ve,{children:h&&r.jsx(G.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs(G.div,{initial:{y:50},animate:{y:0},className:"bg-gray-800 p-8 rounded-xl border border-gray-700 text-center max-w-md",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:"🎉 完成!"}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("p",{className:"text-white font-game",children:["用时: ",r.jsx("span",{className:"text-yellow-400",children:N(A)})]}),r.jsxs("p",{className:"text-white font-game",children:["步数: ",r.jsx("span",{className:"text-yellow-400",children:i})]}),i<=S[x].moves&&r.jsx("p",{className:"text-green-400 font-game",children:"🏆 新记录!"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:T,className:"flex-1 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-game rounded-lg transition-colors",children:"返回主页"})]})]})})})]})]})})},Rr=e=>{const t=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]],s=e==="easy"?30:e==="medium"?40:50,n=t.map(i=>i.map(a=>({value:a,isFixed:!0,isError:!1,notes:[]})));let o=0;for(;o<s;){const i=Math.floor(Math.random()*9),a=Math.floor(Math.random()*9);n[i][a].value!==null&&(n[i][a]={value:null,isFixed:!1,isError:!1,notes:[]},o++)}return n},Uu=()=>{const e=Ke(),[t,s]=g.useState(()=>Rr("easy")),[n,o]=g.useState(null),[i,a]=g.useState("easy"),[l,c]=g.useState(0),[d,u]=g.useState(3),[h,p]=g.useState(!1),[x,j]=g.useState(!1),[b]=g.useState(Date.now()),[w,A]=g.useState(0),k=(v,T,L,N)=>{for(let m=0;m<9;m++)if(m!==L&&v[T][m].value===N)return!1;for(let m=0;m<9;m++)if(m!==T&&v[m][L].value===N)return!1;const M=Math.floor(T/3)*3,P=Math.floor(L/3)*3;for(let m=0;m<3;m++)for(let z=0;z<3;z++)if((M+m!==T||P+z!==L)&&v[M+m][P+z].value===N)return!1;return!0},S=v=>{if(!n||t[n.row][n.col].isFixed)return;const T=t.map(N=>N.map(M=>({...M}))),L=T[n.row][n.col];if(h)L.notes.includes(v)?L.notes=L.notes.filter(N=>N!==v):L.notes.push(v),L.value=null;else{const N=k(T,n.row,n.col,v);L.value=v,L.notes=[],L.isError=!N,N||c(l+1)}s(T),R(T)},I=()=>{if(!n||t[n.row][n.col].isFixed)return;const v=t.map(T=>T.map(L=>({...L})));v[n.row][n.col]={value:null,isFixed:!1,isError:!1,notes:[]},s(v)},D=()=>{if(d<=0||!n||t[n.row][n.col].isFixed)return;const v=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]],T=t.map(L=>L.map(N=>({...N})));T[n.row][n.col]={value:v[n.row][n.col],isFixed:!1,isError:!1,notes:[]},s(T),u(d-1),R(T)},R=v=>{v.every((L,N)=>L.every((M,P)=>M.value!==null&&!M.isError&&k(v,N,P,M.value)))&&j(!0)},B=v=>{s(Rr(v||i)),o(null),c(0),u(3),p(!1),j(!1),v&&a(v)};g.useEffect(()=>{const v=setInterval(()=>{A(Math.floor((Date.now()-b)/1e3))},1e3);return()=>clearInterval(v)},[b]),g.useEffect(()=>{const v=T=>{T.key>="1"&&T.key<="9"?S(parseInt(T.key)):T.key==="Delete"||T.key==="Backspace"?I():(T.key==="n"||T.key==="N")&&p(!h)};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[n,h]);const V=v=>{const T=Math.floor(v/60),L=v%60;return`${T}:${L.toString().padStart(2,"0")}`};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"数独"}),r.jsxs("button",{onClick:()=>B(),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"新游戏"})]})]}),r.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["easy","medium","hard"].map(v=>r.jsx("button",{onClick:()=>B(v),className:`px-4 py-2 rounded-lg font-game transition-all ${i===v?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,children:v==="easy"?"简单":v==="medium"?"中等":"困难"},v))}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"时间"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:V(w)})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(au,{size:14}),"错误"]}),r.jsx("div",{className:"text-xl font-bold text-red-400 font-game",children:l})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(kr,{size:14}),"提示"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:d})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-center justify-center",children:[r.jsx("div",{className:"bg-gray-800 p-2 rounded-lg",children:r.jsx("div",{className:"grid grid-cols-9 gap-0",children:t.map((v,T)=>v.map((L,N)=>r.jsx("button",{onClick:()=>o({row:T,col:N}),className:`
                        w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center relative
                        ${L.isFixed?"bg-gray-700":"bg-gray-900 hover:bg-gray-800"}
                        ${(n==null?void 0:n.row)===T&&(n==null?void 0:n.col)===N?"bg-blue-900":""}
                        ${L.isError?"bg-red-900/50":""}
                        ${N%3===2&&N<8?"border-r-2 border-gray-600":"border-r border-gray-700"}
                        ${T%3===2&&T<8?"border-b-2 border-gray-600":"border-b border-gray-700"}
                        transition-colors
                      `,disabled:x,children:L.value?r.jsx("span",{className:`
                          text-lg sm:text-xl font-bold
                          ${L.isFixed?"text-gray-400":L.isError?"text-red-400":"text-white"}
                        `,children:L.value}):r.jsx("div",{className:"grid grid-cols-3 gap-0 text-xs text-blue-400",children:[1,2,3,4,5,6,7,8,9].map(M=>r.jsx("span",{className:"text-[8px]",children:L.notes.includes(M)?M:""},M))})},`${T}-${N}`)))})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9].map(v=>r.jsx("button",{onClick:()=>S(v),className:"w-14 h-14 bg-gray-700 hover:bg-gray-600 text-white text-xl font-bold rounded-lg transition-colors",disabled:x,children:v},v))}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("button",{onClick:()=>p(!h),className:`w-full p-3 ${h?"bg-blue-600 hover:bg-blue-700":"bg-gray-700 hover:bg-gray-600"} text-white rounded-lg transition-colors flex items-center justify-center gap-2`,disabled:x,children:[r.jsx("span",{className:"font-game",children:"笔记模式"}),h&&r.jsx(ai,{size:16})]}),r.jsxs("button",{onClick:I,className:"w-full p-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center justify-center gap-2",disabled:x,children:[r.jsx(fu,{size:16}),r.jsx("span",{className:"font-game",children:"清除"})]}),r.jsxs("button",{onClick:D,className:"w-full p-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors flex items-center justify-center gap-2",disabled:x||d<=0,children:[r.jsx(kr,{size:16}),r.jsxs("span",{className:"font-game",children:["提示 (",d,")"]})]})]})]})]}),x&&r.jsx(G.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-gray-800 p-8 rounded-xl border border-gray-700 text-center",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:"🎉 完成!"}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("p",{className:"text-white font-game",children:["用时: ",r.jsx("span",{className:"text-yellow-400",children:V(w)})]}),r.jsxs("p",{className:"text-white font-game",children:["错误: ",r.jsx("span",{className:"text-yellow-400",children:l})]})]}),r.jsx("button",{onClick:()=>B(),className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"新游戏"})]})})]})]})})},xe=600,Te=400,Se=100,ot=10,Wt=8,Ar=75,Vr=20,Er=10,Hu=60,Gu=35,_u=5,Wu=6,Rs=[{color:"#ef4444",points:50,hits:3},{color:"#f97316",points:40,hits:2},{color:"#eab308",points:30,hits:2},{color:"#22c55e",points:20,hits:1},{color:"#06b6d4",points:10,hits:1}],qu=()=>{const e=Ke(),t=g.useRef(null),s=g.useRef(),[n,o]=g.useState(!1),[i,a]=g.useState(!1),[l,c]=g.useState(0),[d,u]=g.useState(3),[h,p]=g.useState(1),[x,j]=g.useState(()=>{const N=localStorage.getItem("breakout-high-score");return N?parseInt(N):0}),[b,w]=g.useState({x:xe/2,y:Te-30,dx:3,dy:-3,radius:Wt}),[A,k]=g.useState({x:(xe-Se)/2,y:Te-ot-10,width:Se,height:ot}),[S,I]=g.useState([]),D=g.useCallback(()=>{const N=[];for(let M=0;M<_u;M++)for(let P=0;P<Wu;P++){const m=Rs[Math.min(M,Rs.length-1)];N.push({x:P*(Ar+Er)+Gu,y:M*(Vr+Er)+Hu,width:Ar,height:Vr,color:m.color,points:m.points,hits:m.hits,destroyed:!1})}I(N)},[]),R=()=>{w({x:xe/2,y:Te-30,dx:3+h*.5,dy:-(3+h*.5),radius:Wt}),k({x:(xe-Se)/2,y:Te-ot-10,width:Se,height:ot}),D(),c(0),u(3),p(1),a(!1),o(!1)},B=()=>{w({x:xe/2,y:Te-30,dx:3+h*.5,dy:-(3+h*.5),radius:Wt}),k({x:(xe-Se)/2,y:Te-ot-10,width:Se,height:ot})},V=()=>{p(N=>N+1),w({x:xe/2,y:Te-30,dx:3+(h+1)*.5,dy:-(3+(h+1)*.5),radius:Wt}),D()},v=g.useCallback(()=>{if((b.x+b.radius>xe||b.x-b.radius<0)&&(b.dx=-b.dx),b.y-b.radius<0&&(b.dy=-b.dy),b.y+b.radius>Te&&u(M=>{const P=M-1;return P<=0?(a(!0),o(!1),l>x&&(j(l),localStorage.setItem("breakout-high-score",l.toString()))):B(),P}),b.x>A.x&&b.x<A.x+A.width&&b.y+b.radius>A.y&&b.y-b.radius<A.y+A.height){const M=(b.x-A.x)/A.width;b.dx=8*(M-.5),b.dy=-b.dy}let N=!0;S.forEach(M=>{if(!M.destroyed&&(N=!1,b.x>M.x&&b.x<M.x+M.width&&b.y>M.y&&b.y<M.y+M.height))if(b.dy=-b.dy,M.hits--,M.hits<=0)M.destroyed=!0,c(P=>P+M.points);else{const P=M.hits/Rs.find(m=>m.color===M.color).hits;M.color=M.color+Math.floor(P*255).toString(16).padStart(2,"0")}}),N&&V()},[b,A,S,l,x]),T=g.useCallback(()=>{if(!n||i)return;const N=t.current;if(!N)return;const M=N.getContext("2d");if(!M)return;M.clearRect(0,0,xe,Te),S.forEach(m=>{m.destroyed||(M.fillStyle=m.color,M.fillRect(m.x,m.y,m.width,m.height),M.strokeStyle="#1f2937",M.strokeRect(m.x,m.y,m.width,m.height))});const P=M.createLinearGradient(A.x,A.y,A.x,A.y+A.height);P.addColorStop(0,"#8b5cf6"),P.addColorStop(1,"#7c3aed"),M.fillStyle=P,M.fillRect(A.x,A.y,A.width,A.height),M.beginPath(),M.arc(b.x,b.y,b.radius,0,Math.PI*2),M.fillStyle="#ffffff",M.fill(),M.closePath(),b.x+=b.dx,b.y+=b.dy,v(),s.current=requestAnimationFrame(T)},[n,i,b,A,S,v]);g.useEffect(()=>{const N=M=>{if(!t.current||!n)return;const P=t.current.getBoundingClientRect(),m=M.clientX-P.left;k(z=>({...z,x:Math.max(0,Math.min(xe-Se,m-Se/2))}))};return window.addEventListener("mousemove",N),()=>window.removeEventListener("mousemove",N)},[n]);const L=N=>{if(!t.current||!n)return;const M=t.current.getBoundingClientRect(),P=N.touches[0].clientX-M.left;k(m=>({...m,x:Math.max(0,Math.min(xe-Se,P-Se/2))}))};return g.useEffect(()=>{const N=M=>{if(!n){M.key===" "&&(M.preventDefault(),o(!0));return}switch(M.key){case"ArrowLeft":case"a":case"A":k(P=>({...P,x:Math.max(0,P.x-20)}));break;case"ArrowRight":case"d":case"D":k(P=>({...P,x:Math.min(xe-Se,P.x+20)}));break;case" ":case"p":case"P":M.preventDefault(),o(P=>!P);break}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[n]),g.useEffect(()=>(n&&!i&&(s.current=requestAnimationFrame(T)),()=>{s.current&&cancelAnimationFrame(s.current)}),[n,i,T]),g.useEffect(()=>{D()},[D]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"打砖块"}),r.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"分数"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:l})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(pu,{size:14}),"生命"]}),r.jsx("div",{className:"text-xl font-bold text-red-400 font-game",children:d})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"关卡"}),r.jsx("div",{className:"text-xl font-bold text-green-400 font-game",children:h})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Dt,{size:14}),"最高分"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:x})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsxs("div",{className:"relative flex justify-center",children:[r.jsx("canvas",{ref:t,width:xe,height:Te,className:"bg-gray-800 rounded-lg border-2 border-gray-700",onTouchMove:L,style:{maxWidth:"100%",height:"auto"}}),(!n||i)&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-center p-6",children:i?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-2",children:["得分: ",l]}),l>x&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新记录!"}),r.jsx("button",{onClick:R,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:l===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:()=>o(!0),className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(ht,{size:20}),l===0?"开始游戏":"继续"]}),r.jsxs("div",{className:"mt-4 text-gray-400 text-sm font-game",children:[r.jsx("p",{children:"使用鼠标或触摸控制挡板"}),r.jsx("p",{children:"← → 或 A/D 键盘控制"}),r.jsx("p",{children:"空格键暂停/继续"})]})]})})})]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("button",{onClick:()=>o(N=>!N),className:`px-6 py-3 ${n?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center gap-2`,children:n?r.jsxs(r.Fragment,{children:[r.jsx(yn,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(ht,{size:20}),l===0?"开始":"继续"]})})})]})]})})},Xu=()=>{const e=ui(),[t,s]=g.useState(new Date);g.useEffect(()=>{const o=setInterval(()=>s(new Date),1e3);return()=>clearInterval(o)},[]);const n=e.pathname==="/";return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900",children:[r.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none -z-10",children:[...Array(window.innerWidth<768?20:50)].map((o,i)=>r.jsx(G.div,{className:"absolute w-1 h-1 bg-white opacity-30",initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{y:[null,-window.innerHeight]},transition:{duration:Math.random()*20+10,repeat:1/0,ease:"linear",delay:Math.random()*10}},i))}),r.jsx("header",{className:"relative z-1",children:r.jsx("nav",{className:"container mx-auto px-3 sm:px-4 py-2 sm:py-3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(As,{to:"/",className:"flex items-center space-x-2 sm:space-x-3",children:[r.jsx(G.div,{whileHover:{rotate:360},whileTap:{scale:.95},transition:{duration:.5},className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-white font-bold text-lg sm:text-xl",children:"G"})}),r.jsxs("h1",{className:"text-base sm:text-xl font-game font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:[r.jsx("span",{className:"hidden sm:inline",children:"Game Collection"}),r.jsx("span",{className:"sm:hidden",children:"游戏合集"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-6",children:[!n&&r.jsx(G.div,{whileTap:{scale:.95},transition:{duration:.1},children:r.jsxs(As,{to:"/",className:"pixel-btn text-xs px-2 py-1 sm:px-3 sm:py-2 flex items-center justify-center",children:[r.jsx("span",{className:"hidden sm:inline",children:"返回首页"}),r.jsx("span",{className:"sm:hidden",children:"首页"})]})}),r.jsx("div",{className:"text-xs sm:text-sm font-pixel text-gray-400 hidden sm:block",children:t.toLocaleTimeString("zh-CN")})]})]})})}),r.jsx("main",{className:"relative z-1 container mx-auto px-3 sm:px-4 py-1 sm:py-2",children:r.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:r.jsx(hi,{})},e.pathname)}),r.jsx("footer",{className:"relative z-1",children:r.jsx("div",{className:"container mx-auto px-3 sm:px-4 py-2 sm:py-3",children:r.jsx("div",{className:"text-center text-xs sm:text-sm text-gray-500 font-pixel",children:"© 2024 Game Collection"})})})]})};function Ku(){return r.jsx(fi,{children:r.jsx(ve,{mode:"wait",children:r.jsx(mi,{children:r.jsxs(Ce,{path:"/",element:r.jsx(Xu,{}),children:[r.jsx(Ce,{index:!0,element:r.jsx(zd,{})}),r.jsx(Ce,{path:"games/gomoku",element:r.jsx(qd,{})}),r.jsx(Ce,{path:"games/2048",element:r.jsx(Vu,{})}),r.jsx(Ce,{path:"games/snake",element:r.jsx(Du,{})}),r.jsx(Ce,{path:"games/tetris",element:r.jsx(Fu,{})}),r.jsx(Ce,{path:"games/tictactoe",element:r.jsx(Ou,{})}),r.jsx(Ce,{path:"games/memory",element:r.jsx($u,{})}),r.jsx(Ce,{path:"games/sudoku",element:r.jsx(Uu,{})}),r.jsx(Ce,{path:"games/breakout",element:r.jsx(qu,{})})]})})})})}Vs.createRoot(document.getElementById("root")).render(r.jsx(qs.StrictMode,{children:r.jsx(Ku,{})}))});export default Yu();
//# sourceMappingURL=index-DRaaXxSC.js.map

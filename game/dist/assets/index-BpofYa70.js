var ci=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);import{r as g,a as di,R as qs,L as As,u as Ke,b as ui,O as hi,B as fi,c as mi,d as Ce}from"./react-vendor-RGTUMA6Z.js";import{l as Xs,c as pi}from"./game-vendor-B_MNHd1B.js";var Yu=ci((th,Vt)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();var Dr={exports:{}},ns={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gi=g,xi=Symbol.for("react.element"),yi=Symbol.for("react.fragment"),bi=Object.prototype.hasOwnProperty,vi=gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wi={key:!0,ref:!0,__self:!0,__source:!0};function Lr(e,t,s){var n,o={},i=null,a=null;s!==void 0&&(i=""+s),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)bi.call(t,n)&&!wi.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:xi,type:e,key:i,ref:a,props:o,_owner:vi.current}}ns.Fragment=yi;ns.jsx=Lr;ns.jsxs=Lr;Dr.exports=ns;var r=Dr.exports,Es={},bn=di;Es.createRoot=bn.createRoot,Es.hydrateRoot=bn.hydrateRoot;const Ir=g.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),rs=g.createContext({}),os=g.createContext(null),is=typeof document<"u",Ks=is?g.useLayoutEffect:g.useEffect,Fr=g.createContext({strict:!1}),Ys=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ji="framerAppearId",Br="data-"+Ys(ji);function Ni(e,t,s,n){const{visualElement:o}=g.useContext(rs),i=g.useContext(Fr),a=g.useContext(os),l=g.useContext(Ir).reducedMotion,c=g.useRef();n=n||i.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:o,props:s,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;g.useInsertionEffect(()=>{d&&d.update(s,a)});const u=g.useRef(!!(s[Br]&&!window.HandoffComplete));return Ks(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),g.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function it(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Si(e,t,s){return g.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),s&&(typeof s=="function"?s(n):it(s)&&(s.current=n))},[t])}function Tt(e){return typeof e=="string"||Array.isArray(e)}function as(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Zs=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Js=["initial",...Zs];function ls(e){return as(e.animate)||Js.some(t=>Tt(e[t]))}function Or(e){return!!(ls(e)||e.variants)}function Ci(e,t){if(ls(e)){const{initial:s,animate:n}=e;return{initial:s===!1||Tt(s)?s:void 0,animate:Tt(n)?n:void 0}}return e.inherit!==!1?t:{}}function Ti(e){const{initial:t,animate:s}=Ci(e,g.useContext(rs));return g.useMemo(()=>({initial:t,animate:s}),[vn(t),vn(s)])}function vn(e){return Array.isArray(e)?e.join(" "):e}const wn={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},kt={};for(const e in wn)kt[e]={isEnabled:t=>wn[e].some(s=>!!t[s])};function ki(e){for(const t in e)kt[t]={...kt[t],...e[t]}}const Qs=g.createContext({}),zr=g.createContext({}),Pi=Symbol.for("motionComponentSymbol");function Mi({preloadedFeatures:e,createVisualElement:t,useRender:s,useVisualState:n,Component:o}){e&&ki(e);function i(l,c){let d;const u={...g.useContext(Ir),...l,layoutId:Ri(l)},{isStatic:h}=u,p=Ti(l),x=n(l,h);if(!h&&is){p.visualElement=Ni(o,x,u,t);const w=g.useContext(zr),v=g.useContext(Fr).strict;p.visualElement&&(d=p.visualElement.loadFeatures(u,v,e,w))}return g.createElement(rs.Provider,{value:p},d&&p.visualElement?g.createElement(d,{visualElement:p.visualElement,...u}):null,s(o,l,Si(x,p.visualElement,c),x,h,p.visualElement))}const a=g.forwardRef(i);return a[Pi]=o,a}function Ri({layoutId:e}){const t=g.useContext(Qs).id;return t&&e!==void 0?t+"-"+e:e}function Ai(e){function t(n,o={}){return Mi(e(n,o))}if(typeof Proxy>"u")return t;const s=new Map;return new Proxy(t,{get:(n,o)=>(s.has(o)||s.set(o,t(o)),s.get(o))})}const Ei=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function en(e){return typeof e!="string"||e.includes("-")?!1:!!(Ei.indexOf(e)>-1||/[A-Z]/.test(e))}const Kt={};function Vi(e){Object.assign(Kt,e)}const Mt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ye=new Set(Mt);function $r(e,{layout:t,layoutId:s}){return Ye.has(e)||e.startsWith("origin")||(t||s!==void 0)&&(!!Kt[e]||e==="opacity")}const pe=e=>!!(e&&e.getVelocity),Di={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Li=Mt.length;function Ii(e,{enableHardwareAcceleration:t=!0,allowTransformNone:s=!0},n,o){let i="";for(let a=0;a<Li;a++){const l=Mt[a];if(e[l]!==void 0){const c=Di[l]||l;i+=`${c}(${e[l]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),o?i=o(e,n?"":i):s&&n&&(i="none"),i}const Ur=e=>t=>typeof t=="string"&&t.startsWith(e),Hr=Ur("--"),Vs=Ur("var(--"),Fi=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Bi=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Fe=(e,t,s)=>Math.min(Math.max(s,e),t),Ze={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},jt={...Ze,transform:e=>Fe(0,1,e)},Bt={...Ze,default:1},Nt=e=>Math.round(e*1e5)/1e5,cs=/(-)?([\d]*\.?[\d])+/g,Gr=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Oi=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Rt(e){return typeof e=="string"}const At=e=>({test:t=>Rt(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),De=At("deg"),ke=At("%"),J=At("px"),zi=At("vh"),$i=At("vw"),jn={...ke,parse:e=>ke.parse(e)/100,transform:e=>ke.transform(e*100)},Nn={...Ze,transform:Math.round},_r={borderWidth:J,borderTopWidth:J,borderRightWidth:J,borderBottomWidth:J,borderLeftWidth:J,borderRadius:J,radius:J,borderTopLeftRadius:J,borderTopRightRadius:J,borderBottomRightRadius:J,borderBottomLeftRadius:J,width:J,maxWidth:J,height:J,maxHeight:J,size:J,top:J,right:J,bottom:J,left:J,padding:J,paddingTop:J,paddingRight:J,paddingBottom:J,paddingLeft:J,margin:J,marginTop:J,marginRight:J,marginBottom:J,marginLeft:J,rotate:De,rotateX:De,rotateY:De,rotateZ:De,scale:Bt,scaleX:Bt,scaleY:Bt,scaleZ:Bt,skew:De,skewX:De,skewY:De,distance:J,translateX:J,translateY:J,translateZ:J,x:J,y:J,z:J,perspective:J,transformPerspective:J,opacity:jt,originX:jn,originY:jn,originZ:J,zIndex:Nn,fillOpacity:jt,strokeOpacity:jt,numOctaves:Nn};function tn(e,t,s,n){const{style:o,vars:i,transform:a,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const h in t){const p=t[h];if(Hr(h)){i[h]=p;continue}const x=_r[h],w=Bi(p,x);if(Ye.has(h)){if(c=!0,a[h]=w,!u)continue;p!==(x.default||0)&&(u=!1)}else h.startsWith("origin")?(d=!0,l[h]=w):o[h]=w}if(t.transform||(c||n?o.transform=Ii(e.transform,s,u,n):o.transform&&(o.transform="none")),d){const{originX:h="50%",originY:p="50%",originZ:x=0}=l;o.transformOrigin=`${h} ${p} ${x}`}}const sn=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Wr(e,t,s){for(const n in t)!pe(t[n])&&!$r(n,s)&&(e[n]=t[n])}function Ui({transformTemplate:e},t,s){return g.useMemo(()=>{const n=sn();return tn(n,t,{enableHardwareAcceleration:!s},e),Object.assign({},n.vars,n.style)},[t])}function Hi(e,t,s){const n=e.style||{},o={};return Wr(o,n,e),Object.assign(o,Ui(e,t,s)),e.transformValues?e.transformValues(o):o}function Gi(e,t,s){const n={},o=Hi(e,t,s);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=o,n}const _i=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Yt(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||_i.has(e)}let qr=e=>!Yt(e);function Wi(e){e&&(qr=t=>t.startsWith("on")?!Yt(t):e(t))}try{Wi(require("@emotion/is-prop-valid").default)}catch{}function qi(e,t,s){const n={};for(const o in e)o==="values"&&typeof e.values=="object"||(qr(o)||s===!0&&Yt(o)||!t&&!Yt(o)||e.draggable&&o.startsWith("onDrag"))&&(n[o]=e[o]);return n}function Sn(e,t,s){return typeof e=="string"?e:J.transform(t+s*e)}function Xi(e,t,s){const n=Sn(t,e.x,e.width),o=Sn(s,e.y,e.height);return`${n} ${o}`}const Ki={offset:"stroke-dashoffset",array:"stroke-dasharray"},Yi={offset:"strokeDashoffset",array:"strokeDasharray"};function Zi(e,t,s=1,n=0,o=!0){e.pathLength=1;const i=o?Ki:Yi;e[i.offset]=J.transform(-n);const a=J.transform(t),l=J.transform(s);e[i.array]=`${a} ${l}`}function nn(e,{attrX:t,attrY:s,attrScale:n,originX:o,originY:i,pathLength:a,pathSpacing:l=1,pathOffset:c=0,...d},u,h,p){if(tn(e,d,u,p),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:x,style:w,dimensions:v}=e;x.transform&&(v&&(w.transform=x.transform),delete x.transform),v&&(o!==void 0||i!==void 0||w.transform)&&(w.transformOrigin=Xi(v,o!==void 0?o:.5,i!==void 0?i:.5)),t!==void 0&&(x.x=t),s!==void 0&&(x.y=s),n!==void 0&&(x.scale=n),a!==void 0&&Zi(x,a,l,c,!1)}const Xr=()=>({...sn(),attrs:{}}),rn=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Ji(e,t,s,n){const o=g.useMemo(()=>{const i=Xr();return nn(i,t,{enableHardwareAcceleration:!1},rn(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};Wr(i,e.style,e),o.style={...i,...o.style}}return o}function Qi(e=!1){return(s,n,o,{latestValues:i},a)=>{const c=(en(s)?Ji:Gi)(n,i,a,s),u={...qi(n,typeof s=="string",e),...c,ref:o},{children:h}=n,p=g.useMemo(()=>pe(h)?h.get():h,[h]);return g.createElement(s,{...u,children:p})}}function Kr(e,{style:t,vars:s},n,o){Object.assign(e.style,t,o&&o.getProjectionStyles(n));for(const i in s)e.style.setProperty(i,s[i])}const Yr=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Zr(e,t,s,n){Kr(e,t,void 0,n);for(const o in t.attrs)e.setAttribute(Yr.has(o)?o:Ys(o),t.attrs[o])}function on(e,t){const{style:s}=e,n={};for(const o in s)(pe(s[o])||t.style&&pe(t.style[o])||$r(o,e))&&(n[o]=s[o]);return n}function Jr(e,t){const s=on(e,t);for(const n in e)if(pe(e[n])||pe(t[n])){const o=Mt.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;s[o]=e[n]}return s}function an(e,t,s,n={},o={}){return typeof t=="function"&&(t=t(s!==void 0?s:e.custom,n,o)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(s!==void 0?s:e.custom,n,o)),t}function Qr(e){const t=g.useRef(null);return t.current===null&&(t.current=e()),t.current}const Zt=e=>Array.isArray(e),ea=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),ta=e=>Zt(e)?e[e.length-1]||0:e;function qt(e){const t=pe(e)?e.get():e;return ea(t)?t.toValue():t}function sa({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:s},n,o,i){const a={latestValues:na(n,o,i,e),renderState:t()};return s&&(a.mount=l=>s(n,l,a)),a}const eo=e=>(t,s)=>{const n=g.useContext(rs),o=g.useContext(os),i=()=>sa(e,t,n,o);return s?i():Qr(i)};function na(e,t,s,n){const o={},i=n(e,{});for(const p in i)o[p]=qt(i[p]);let{initial:a,animate:l}=e;const c=ls(e),d=Or(e);t&&d&&!c&&e.inherit!==!1&&(a===void 0&&(a=t.initial),l===void 0&&(l=t.animate));let u=s?s.initial===!1:!1;u=u||a===!1;const h=u?l:a;return h&&typeof h!="boolean"&&!as(h)&&(Array.isArray(h)?h:[h]).forEach(x=>{const w=an(e,x);if(!w)return;const{transitionEnd:v,transition:j,...E}=w;for(const k in E){let C=E[k];if(Array.isArray(C)){const L=u?C.length-1:0;C=C[L]}C!==null&&(o[k]=C)}for(const k in v)o[k]=v[k]}),o}const le=e=>e;class Cn{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const s=this.order.indexOf(t);s!==-1&&(this.order.splice(s,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function ra(e){let t=new Cn,s=new Cn,n=0,o=!1,i=!1;const a=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const h=u&&o,p=h?t:s;return d&&a.add(c),p.add(c)&&h&&o&&(n=t.order.length),c},cancel:c=>{s.remove(c),a.delete(c)},process:c=>{if(o){i=!0;return}if(o=!0,[t,s]=[s,t],s.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),a.has(u)&&(l.schedule(u),e())}o=!1,i&&(i=!1,l.process(c))}};return l}const Ot=["prepare","read","update","preRender","render","postRender"],oa=40;function ia(e,t){let s=!1,n=!0;const o={delta:0,timestamp:0,isProcessing:!1},i=Ot.reduce((h,p)=>(h[p]=ra(()=>s=!0),h),{}),a=h=>i[h].process(o),l=()=>{const h=performance.now();s=!1,o.delta=n?1e3/60:Math.max(Math.min(h-o.timestamp,oa),1),o.timestamp=h,o.isProcessing=!0,Ot.forEach(a),o.isProcessing=!1,s&&t&&(n=!1,e(l))},c=()=>{s=!0,n=!0,o.isProcessing||e(l)};return{schedule:Ot.reduce((h,p)=>{const x=i[p];return h[p]=(w,v=!1,j=!1)=>(s||c(),x.schedule(w,v,j)),h},{}),cancel:h=>Ot.forEach(p=>i[p].cancel(h)),state:o,steps:i}}const{schedule:ne,cancel:Ee,state:ue,steps:ms}=ia(typeof requestAnimationFrame<"u"?requestAnimationFrame:le,!0),aa={useVisualState:eo({scrapeMotionValuesFromProps:Jr,createRenderState:Xr,onMount:(e,t,{renderState:s,latestValues:n})=>{ne.read(()=>{try{s.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}),ne.render(()=>{nn(s,n,{enableHardwareAcceleration:!1},rn(t.tagName),e.transformTemplate),Zr(t,s)})}})},la={useVisualState:eo({scrapeMotionValuesFromProps:on,createRenderState:sn})};function ca(e,{forwardMotionProps:t=!1},s,n){return{...en(e)?aa:la,preloadedFeatures:s,useRender:Qi(t),createVisualElement:n,Component:e}}function Me(e,t,s,n={passive:!0}){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s)}const to=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function ds(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const da=e=>t=>to(t)&&e(t,ds(t));function Re(e,t,s,n){return Me(e,t,da(s),n)}const ua=(e,t)=>s=>t(e(s)),Ie=(...e)=>e.reduce(ua);function so(e){let t=null;return()=>{const s=()=>{t=null};return t===null?(t=e,s):!1}}const Tn=so("dragHorizontal"),kn=so("dragVertical");function no(e){let t=!1;if(e==="y")t=kn();else if(e==="x")t=Tn();else{const s=Tn(),n=kn();s&&n?t=()=>{s(),n()}:(s&&s(),n&&n())}return t}function ro(){const e=no(!0);return e?(e(),!1):!0}class Oe{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Pn(e,t){const s="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),o=(i,a)=>{if(i.pointerType==="touch"||ro())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&ne.update(()=>l[n](i,a))};return Re(e.current,s,o,{passive:!e.getProps()[n]})}class ha extends Oe{mount(){this.unmount=Ie(Pn(this.node,!0),Pn(this.node,!1))}unmount(){}}class fa extends Oe{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ie(Me(this.node.current,"focus",()=>this.onFocus()),Me(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const oo=(e,t)=>t?e===t?!0:oo(e,t.parentElement):!1;function ps(e,t){if(!t)return;const s=new PointerEvent("pointer"+e);t(s,ds(s))}class ma extends Oe{constructor(){super(...arguments),this.removeStartListeners=le,this.removeEndListeners=le,this.removeAccessibleListeners=le,this.startPointerPress=(t,s)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Re(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:h}=this.node.getProps();ne.update(()=>{!h&&!oo(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),a=Re(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Ie(i,a),this.startPress(t,s)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const a=l=>{l.key!=="Enter"||!this.checkPressEnd()||ps("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&ne.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=Me(this.node.current,"keyup",a),ps("down",(l,c)=>{this.startPress(l,c)})},s=Me(this.node.current,"keydown",t),n=()=>{this.isPressing&&ps("cancel",(i,a)=>this.cancelPress(i,a))},o=Me(this.node.current,"blur",n);this.removeAccessibleListeners=Ie(s,o)}}startPress(t,s){this.isPressing=!0;const{onTapStart:n,whileTap:o}=this.node.getProps();o&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&ne.update(()=>n(t,s))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!ro()}cancelPress(t,s){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&ne.update(()=>n(t,s))}mount(){const t=this.node.getProps(),s=Re(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Me(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Ie(s,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Ds=new WeakMap,gs=new WeakMap,pa=e=>{const t=Ds.get(e.target);t&&t(e)},ga=e=>{e.forEach(pa)};function xa({root:e,...t}){const s=e||document;gs.has(s)||gs.set(s,{});const n=gs.get(s),o=JSON.stringify(t);return n[o]||(n[o]=new IntersectionObserver(ga,{root:e,...t})),n[o]}function ya(e,t,s){const n=xa(t);return Ds.set(e,s),n.observe(e),()=>{Ds.delete(e),n.unobserve(e)}}const ba={some:0,all:1};class va extends Oe{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:s,margin:n,amount:o="some",once:i}=t,a={root:s?s.current:void 0,rootMargin:n,threshold:typeof o=="number"?o:ba[o]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),p=d?u:h;p&&p(c)};return ya(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:s}=this.node;["amount","margin","root"].some(wa(t,s))&&this.startObserver()}unmount(){}}function wa({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}const ja={inView:{Feature:va},tap:{Feature:ma},focus:{Feature:fa},hover:{Feature:ha}};function io(e,t){if(!Array.isArray(t))return!1;const s=t.length;if(s!==e.length)return!1;for(let n=0;n<s;n++)if(t[n]!==e[n])return!1;return!0}function Na(e){const t={};return e.values.forEach((s,n)=>t[n]=s.get()),t}function Sa(e){const t={};return e.values.forEach((s,n)=>t[n]=s.getVelocity()),t}function us(e,t,s){const n=e.getProps();return an(n,t,s!==void 0?s:n.custom,Na(e),Sa(e))}let ln=le;const Xe=e=>e*1e3,Ae=e=>e/1e3,Ca={current:!1},ao=e=>Array.isArray(e)&&typeof e[0]=="number";function lo(e){return!!(!e||typeof e=="string"&&co[e]||ao(e)||Array.isArray(e)&&e.every(lo))}const vt=([e,t,s,n])=>`cubic-bezier(${e}, ${t}, ${s}, ${n})`,co={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vt([0,.65,.55,1]),circOut:vt([.55,0,1,.45]),backIn:vt([.31,.01,.66,-.59]),backOut:vt([.33,1.53,.69,.99])};function uo(e){if(e)return ao(e)?vt(e):Array.isArray(e)?e.map(uo):co[e]}function Ta(e,t,s,{delay:n=0,duration:o,repeat:i=0,repeatType:a="loop",ease:l,times:c}={}){const d={[t]:s};c&&(d.offset=c);const u=uo(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:o,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"})}function ka(e,{repeat:t,repeatType:s="loop"}){const n=t&&s!=="loop"&&t%2===1?0:e.length-1;return e[n]}const ho=(e,t,s)=>(((1-3*s+3*t)*e+(3*s-6*t))*e+3*t)*e,Pa=1e-7,Ma=12;function Ra(e,t,s,n,o){let i,a,l=0;do a=t+(s-t)/2,i=ho(a,n,o)-e,i>0?s=a:t=a;while(Math.abs(i)>Pa&&++l<Ma);return a}function Et(e,t,s,n){if(e===t&&s===n)return le;const o=i=>Ra(i,0,1,e,s);return i=>i===0||i===1?i:ho(o(i),t,n)}const Aa=Et(.42,0,1,1),Ea=Et(0,0,.58,1),fo=Et(.42,0,.58,1),Va=e=>Array.isArray(e)&&typeof e[0]!="number",mo=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,po=e=>t=>1-e(1-t),cn=e=>1-Math.sin(Math.acos(e)),go=po(cn),Da=mo(cn),xo=Et(.33,1.53,.69,.99),dn=po(xo),La=mo(dn),Ia=e=>(e*=2)<1?.5*dn(e):.5*(2-Math.pow(2,-10*(e-1))),Fa={linear:le,easeIn:Aa,easeInOut:fo,easeOut:Ea,circIn:cn,circInOut:Da,circOut:go,backIn:dn,backInOut:La,backOut:xo,anticipate:Ia},Mn=e=>{if(Array.isArray(e)){ln(e.length===4);const[t,s,n,o]=e;return Et(t,s,n,o)}else if(typeof e=="string")return Fa[e];return e},un=(e,t)=>s=>!!(Rt(s)&&Oi.test(s)&&s.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(s,t)),yo=(e,t,s)=>n=>{if(!Rt(n))return n;const[o,i,a,l]=n.match(cs);return{[e]:parseFloat(o),[t]:parseFloat(i),[s]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},Ba=e=>Fe(0,255,e),xs={...Ze,transform:e=>Math.round(Ba(e))},qe={test:un("rgb","red"),parse:yo("red","green","blue"),transform:({red:e,green:t,blue:s,alpha:n=1})=>"rgba("+xs.transform(e)+", "+xs.transform(t)+", "+xs.transform(s)+", "+Nt(jt.transform(n))+")"};function Oa(e){let t="",s="",n="",o="";return e.length>5?(t=e.substring(1,3),s=e.substring(3,5),n=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),s=e.substring(2,3),n=e.substring(3,4),o=e.substring(4,5),t+=t,s+=s,n+=n,o+=o),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:o?parseInt(o,16)/255:1}}const Ls={test:un("#"),parse:Oa,transform:qe.transform},at={test:un("hsl","hue"),parse:yo("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:s,alpha:n=1})=>"hsla("+Math.round(e)+", "+ke.transform(Nt(t))+", "+ke.transform(Nt(s))+", "+Nt(jt.transform(n))+")"},fe={test:e=>qe.test(e)||Ls.test(e)||at.test(e),parse:e=>qe.test(e)?qe.parse(e):at.test(e)?at.parse(e):Ls.parse(e),transform:e=>Rt(e)?e:e.hasOwnProperty("red")?qe.transform(e):at.transform(e)},ie=(e,t,s)=>-s*e+s*t+e;function ys(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(t-e)*6*s:s<1/2?t:s<2/3?e+(t-e)*(2/3-s)*6:e}function za({hue:e,saturation:t,lightness:s,alpha:n}){e/=360,t/=100,s/=100;let o=0,i=0,a=0;if(!t)o=i=a=s;else{const l=s<.5?s*(1+t):s+t-s*t,c=2*s-l;o=ys(c,l,e+1/3),i=ys(c,l,e),a=ys(c,l,e-1/3)}return{red:Math.round(o*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:n}}const bs=(e,t,s)=>{const n=e*e;return Math.sqrt(Math.max(0,s*(t*t-n)+n))},$a=[Ls,qe,at],Ua=e=>$a.find(t=>t.test(e));function Rn(e){const t=Ua(e);let s=t.parse(e);return t===at&&(s=za(s)),s}const bo=(e,t)=>{const s=Rn(e),n=Rn(t),o={...s};return i=>(o.red=bs(s.red,n.red,i),o.green=bs(s.green,n.green,i),o.blue=bs(s.blue,n.blue,i),o.alpha=ie(s.alpha,n.alpha,i),qe.transform(o))};function Ha(e){var t,s;return isNaN(e)&&Rt(e)&&(((t=e.match(cs))===null||t===void 0?void 0:t.length)||0)+(((s=e.match(Gr))===null||s===void 0?void 0:s.length)||0)>0}const vo={regex:Fi,countKey:"Vars",token:"${v}",parse:le},wo={regex:Gr,countKey:"Colors",token:"${c}",parse:fe.parse},jo={regex:cs,countKey:"Numbers",token:"${n}",parse:Ze.parse};function vs(e,{regex:t,countKey:s,token:n,parse:o}){const i=e.tokenised.match(t);i&&(e["num"+s]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(o)))}function Jt(e){const t=e.toString(),s={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return s.value.includes("var(--")&&vs(s,vo),vs(s,wo),vs(s,jo),s}function No(e){return Jt(e).values}function So(e){const{values:t,numColors:s,numVars:n,tokenised:o}=Jt(e),i=t.length;return a=>{let l=o;for(let c=0;c<i;c++)c<n?l=l.replace(vo.token,a[c]):c<n+s?l=l.replace(wo.token,fe.transform(a[c])):l=l.replace(jo.token,Nt(a[c]));return l}}const Ga=e=>typeof e=="number"?0:e;function _a(e){const t=No(e);return So(e)(t.map(Ga))}const Be={test:Ha,parse:No,createTransformer:So,getAnimatableNone:_a},Co=(e,t)=>s=>`${s>0?t:e}`;function To(e,t){return typeof e=="number"?s=>ie(e,t,s):fe.test(e)?bo(e,t):e.startsWith("var(")?Co(e,t):Po(e,t)}const ko=(e,t)=>{const s=[...e],n=s.length,o=e.map((i,a)=>To(i,t[a]));return i=>{for(let a=0;a<n;a++)s[a]=o[a](i);return s}},Wa=(e,t)=>{const s={...e,...t},n={};for(const o in s)e[o]!==void 0&&t[o]!==void 0&&(n[o]=To(e[o],t[o]));return o=>{for(const i in n)s[i]=n[i](o);return s}},Po=(e,t)=>{const s=Be.createTransformer(t),n=Jt(e),o=Jt(t);return n.numVars===o.numVars&&n.numColors===o.numColors&&n.numNumbers>=o.numNumbers?Ie(ko(n.values,o.values),s):Co(e,t)},Pt=(e,t,s)=>{const n=t-e;return n===0?1:(s-e)/n},An=(e,t)=>s=>ie(e,t,s);function qa(e){return typeof e=="number"?An:typeof e=="string"?fe.test(e)?bo:Po:Array.isArray(e)?ko:typeof e=="object"?Wa:An}function Xa(e,t,s){const n=[],o=s||qa(e[0]),i=e.length-1;for(let a=0;a<i;a++){let l=o(e[a],e[a+1]);if(t){const c=Array.isArray(t)?t[a]||le:t;l=Ie(c,l)}n.push(l)}return n}function Mo(e,t,{clamp:s=!0,ease:n,mixer:o}={}){const i=e.length;if(ln(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=Xa(t,n,o),l=a.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const h=Pt(e[u],e[u+1],d);return a[u](h)};return s?d=>c(Fe(e[0],e[i-1],d)):c}function Ka(e,t){const s=e[e.length-1];for(let n=1;n<=t;n++){const o=Pt(0,t,n);e.push(ie(s,1,o))}}function Ya(e){const t=[0];return Ka(t,e.length-1),t}function Za(e,t){return e.map(s=>s*t)}function Ja(e,t){return e.map(()=>t||fo).splice(0,e.length-1)}function Qt({duration:e=300,keyframes:t,times:s,ease:n="easeInOut"}){const o=Va(n)?n.map(Mn):Mn(n),i={done:!1,value:t[0]},a=Za(s&&s.length===t.length?s:Ya(t),e),l=Mo(a,t,{ease:Array.isArray(o)?o:Ja(t,o)});return{calculatedDuration:e,next:c=>(i.value=l(c),i.done=c>=e,i)}}function Ro(e,t){return t?e*(1e3/t):0}const Qa=5;function Ao(e,t,s){const n=Math.max(t-Qa,0);return Ro(s-e(n),t-n)}const ws=.001,el=.01,tl=10,sl=.05,nl=1;function rl({duration:e=800,bounce:t=.25,velocity:s=0,mass:n=1}){let o,i,a=1-t;a=Fe(sl,nl,a),e=Fe(el,tl,Ae(e)),a<1?(o=d=>{const u=d*a,h=u*e,p=u-s,x=Is(d,a),w=Math.exp(-h);return ws-p/x*w},i=d=>{const h=d*a*e,p=h*s+s,x=Math.pow(a,2)*Math.pow(d,2)*e,w=Math.exp(-h),v=Is(Math.pow(d,2),a);return(-o(d)+ws>0?-1:1)*((p-x)*w)/v}):(o=d=>{const u=Math.exp(-d*e),h=(d-s)*e+1;return-ws+u*h},i=d=>{const u=Math.exp(-d*e),h=(s-d)*(e*e);return u*h});const l=5/e,c=il(o,i,l);if(e=Xe(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:a*2*Math.sqrt(n*d),duration:e}}}const ol=12;function il(e,t,s){let n=s;for(let o=1;o<ol;o++)n=n-e(n)/t(n);return n}function Is(e,t){return e*Math.sqrt(1-t*t)}const al=["duration","bounce"],ll=["stiffness","damping","mass"];function En(e,t){return t.some(s=>e[s]!==void 0)}function cl(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!En(e,ll)&&En(e,al)){const s=rl(e);t={...t,...s,mass:1},t.isResolvedFromDuration=!0}return t}function Eo({keyframes:e,restDelta:t,restSpeed:s,...n}){const o=e[0],i=e[e.length-1],a={done:!1,value:o},{stiffness:l,damping:c,mass:d,duration:u,velocity:h,isResolvedFromDuration:p}=cl({...n,velocity:-Ae(n.velocity||0)}),x=h||0,w=c/(2*Math.sqrt(l*d)),v=i-o,j=Ae(Math.sqrt(l/d)),E=Math.abs(v)<5;s||(s=E?.01:2),t||(t=E?.005:.5);let k;if(w<1){const C=Is(j,w);k=L=>{const V=Math.exp(-w*j*L);return i-V*((x+w*j*v)/C*Math.sin(C*L)+v*Math.cos(C*L))}}else if(w===1)k=C=>i-Math.exp(-j*C)*(v+(x+j*v)*C);else{const C=j*Math.sqrt(w*w-1);k=L=>{const V=Math.exp(-w*j*L),M=Math.min(C*L,300);return i-V*((x+w*j*v)*Math.sinh(M)+C*v*Math.cosh(M))/C}}return{calculatedDuration:p&&u||null,next:C=>{const L=k(C);if(p)a.done=C>=u;else{let V=x;C!==0&&(w<1?V=Ao(k,C,L):V=0);const M=Math.abs(V)<=s,F=Math.abs(i-L)<=t;a.done=M&&F}return a.value=a.done?i:L,a}}}function Vn({keyframes:e,velocity:t=0,power:s=.8,timeConstant:n=325,bounceDamping:o=10,bounceStiffness:i=500,modifyTarget:a,min:l,max:c,restDelta:d=.5,restSpeed:u}){const h=e[0],p={done:!1,value:h},x=$=>l!==void 0&&$<l||c!==void 0&&$>c,w=$=>l===void 0?c:c===void 0||Math.abs(l-$)<Math.abs(c-$)?l:c;let v=s*t;const j=h+v,E=a===void 0?j:a(j);E!==j&&(v=E-h);const k=$=>-v*Math.exp(-$/n),C=$=>E+k($),L=$=>{const R=k($),y=C($);p.done=Math.abs(R)<=d,p.value=p.done?E:y};let V,M;const F=$=>{x(p.value)&&(V=$,M=Eo({keyframes:[p.value,w(p.value)],velocity:Ao(C,$,p.value),damping:o,stiffness:i,restDelta:d,restSpeed:u}))};return F(0),{calculatedDuration:null,next:$=>{let R=!1;return!M&&V===void 0&&(R=!0,L($),F($)),V!==void 0&&$>V?M.next($-V):(!R&&L($),p)}}}const dl=e=>{const t=({timestamp:s})=>e(s);return{start:()=>ne.update(t,!0),stop:()=>Ee(t),now:()=>ue.isProcessing?ue.timestamp:performance.now()}},Dn=2e4;function Ln(e){let t=0;const s=50;let n=e.next(t);for(;!n.done&&t<Dn;)t+=s,n=e.next(t);return t>=Dn?1/0:t}const ul={decay:Vn,inertia:Vn,tween:Qt,keyframes:Qt,spring:Eo};function es({autoplay:e=!0,delay:t=0,driver:s=dl,keyframes:n,type:o="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:h,...p}){let x=1,w=!1,v,j;const E=()=>{j=new Promise(m=>{v=m})};E();let k;const C=ul[o]||Qt;let L;C!==Qt&&typeof n[0]!="number"&&(L=Mo([0,100],n,{clamp:!1}),n=[0,100]);const V=C({...p,keyframes:n});let M;l==="mirror"&&(M=C({...p,keyframes:[...n].reverse(),velocity:-(p.velocity||0)}));let F="idle",$=null,R=null,y=null;V.calculatedDuration===null&&i&&(V.calculatedDuration=Ln(V));const{calculatedDuration:A}=V;let N=1/0,P=1/0;A!==null&&(N=A+a,P=N*(i+1)-a);let S=0;const f=m=>{if(R===null)return;x>0&&(R=Math.min(R,m)),x<0&&(R=Math.min(m-P/x,R)),$!==null?S=$:S=Math.round(m-R)*x;const T=S-t*(x>=0?1:-1),D=x>=0?T<0:T>P;S=Math.max(T,0),F==="finished"&&$===null&&(S=P);let I=S,z=V;if(i){const te=Math.min(S,P)/N;let B=Math.floor(te),X=te%1;!X&&te>=1&&(X=1),X===1&&B--,B=Math.min(B,i+1),!!(B%2)&&(l==="reverse"?(X=1-X,a&&(X-=a/N)):l==="mirror"&&(z=M)),I=Fe(0,1,X)*N}const U=D?{done:!1,value:n[0]}:z.next(I);L&&(U.value=L(U.value));let{done:W}=U;!D&&A!==null&&(W=x>=0?S>=P:S<=0);const Z=$===null&&(F==="finished"||F==="running"&&W);return h&&h(U.value),Z&&K(),U},O=()=>{k&&k.stop(),k=void 0},_=()=>{F="idle",O(),v(),E(),R=y=null},K=()=>{F="finished",u&&u(),O(),v()},q=()=>{if(w)return;k||(k=s(f));const m=k.now();c&&c(),$!==null?R=m-$:(!R||F==="finished")&&(R=m),F==="finished"&&E(),y=R,$=null,F="running",k.start()};e&&q();const b={then(m,T){return j.then(m,T)},get time(){return Ae(S)},set time(m){m=Xe(m),S=m,$!==null||!k||x===0?$=m:R=k.now()-m/x},get duration(){const m=V.calculatedDuration===null?Ln(V):V.calculatedDuration;return Ae(m)},get speed(){return x},set speed(m){m===x||!k||(x=m,b.time=Ae(S))},get state(){return F},play:q,pause:()=>{F="paused",$=S},stop:()=>{w=!0,F!=="idle"&&(F="idle",d&&d(),_())},cancel:()=>{y!==null&&f(y),_()},complete:()=>{F="finished"},sample:m=>(R=0,f(m))};return b}function hl(e){let t;return()=>(t===void 0&&(t=e()),t)}const fl=hl(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),ml=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),zt=10,pl=2e4,gl=(e,t)=>t.type==="spring"||e==="backgroundColor"||!lo(t.ease);function xl(e,t,{onUpdate:s,onComplete:n,...o}){if(!(fl()&&ml.has(t)&&!o.repeatDelay&&o.repeatType!=="mirror"&&o.damping!==0&&o.type!=="inertia"))return!1;let a=!1,l,c,d=!1;const u=()=>{c=new Promise(C=>{l=C})};u();let{keyframes:h,duration:p=300,ease:x,times:w}=o;if(gl(t,o)){const C=es({...o,repeat:0,delay:0});let L={done:!1,value:h[0]};const V=[];let M=0;for(;!L.done&&M<pl;)L=C.sample(M),V.push(L.value),M+=zt;w=void 0,h=V,p=M-zt,x="linear"}const v=Ta(e.owner.current,t,h,{...o,duration:p,ease:x,times:w}),j=()=>{d=!1,v.cancel()},E=()=>{d=!0,ne.update(j),l(),u()};return v.onfinish=()=>{d||(e.set(ka(h,o)),n&&n(),E())},{then(C,L){return c.then(C,L)},attachTimeline(C){return v.timeline=C,v.onfinish=null,le},get time(){return Ae(v.currentTime||0)},set time(C){v.currentTime=Xe(C)},get speed(){return v.playbackRate},set speed(C){v.playbackRate=C},get duration(){return Ae(p)},play:()=>{a||(v.play(),Ee(j))},pause:()=>v.pause(),stop:()=>{if(a=!0,v.playState==="idle")return;const{currentTime:C}=v;if(C){const L=es({...o,autoplay:!1});e.setWithVelocity(L.sample(C-zt).value,L.sample(C).value,zt)}E()},complete:()=>{d||v.finish()},cancel:E}}function yl({keyframes:e,delay:t,onUpdate:s,onComplete:n}){const o=()=>(s&&s(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:le,pause:le,stop:le,then:i=>(i(),Promise.resolve()),cancel:le,complete:le});return t?es({keyframes:[0,1],duration:0,delay:t,onComplete:o}):o()}const bl={type:"spring",stiffness:500,damping:25,restSpeed:10},vl=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),wl={type:"keyframes",duration:.8},jl={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Nl=(e,{keyframes:t})=>t.length>2?wl:Ye.has(e)?e.startsWith("scale")?vl(t[1]):bl:jl,Fs=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Be.test(t)||t==="0")&&!t.startsWith("url(")),Sl=new Set(["brightness","contrast","saturate","opacity"]);function Cl(e){const[t,s]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=s.match(cs)||[];if(!n)return e;const o=s.replace(n,"");let i=Sl.has(t)?1:0;return n!==s&&(i*=100),t+"("+i+o+")"}const Tl=/([a-z-]*)\(.*?\)/g,Bs={...Be,getAnimatableNone:e=>{const t=e.match(Tl);return t?t.map(Cl).join(" "):e}},kl={..._r,color:fe,backgroundColor:fe,outlineColor:fe,fill:fe,stroke:fe,borderColor:fe,borderTopColor:fe,borderRightColor:fe,borderBottomColor:fe,borderLeftColor:fe,filter:Bs,WebkitFilter:Bs},hn=e=>kl[e];function Vo(e,t){let s=hn(e);return s!==Bs&&(s=Be),s.getAnimatableNone?s.getAnimatableNone(t):void 0}const Do=e=>/^0[^.\s]+$/.test(e);function Pl(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Do(e)}function Ml(e,t,s,n){const o=Fs(t,s);let i;Array.isArray(s)?i=[...s]:i=[null,s];const a=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<i.length;d++)i[d]===null&&(i[d]=d===0?a:i[d-1]),Pl(i[d])&&c.push(d),typeof i[d]=="string"&&i[d]!=="none"&&i[d]!=="0"&&(l=i[d]);if(o&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];i[u]=Vo(t,l)}return i}function Rl({when:e,delay:t,delayChildren:s,staggerChildren:n,staggerDirection:o,repeat:i,repeatType:a,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function fn(e,t){return e[t]||e.default||e}const Al={skipAnimations:!1},mn=(e,t,s,n={})=>o=>{const i=fn(n,e)||{},a=i.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Xe(a);const c=Ml(t,e,s,i),d=c[0],u=c[c.length-1],h=Fs(e,d),p=Fs(e,u);let x={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:w=>{t.set(w),i.onUpdate&&i.onUpdate(w)},onComplete:()=>{o(),i.onComplete&&i.onComplete()}};if(Rl(i)||(x={...x,...Nl(e,x)}),x.duration&&(x.duration=Xe(x.duration)),x.repeatDelay&&(x.repeatDelay=Xe(x.repeatDelay)),!h||!p||Ca.current||i.type===!1||Al.skipAnimations)return yl(x);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const w=xl(t,e,x);if(w)return w}return es(x)};function ts(e){return!!(pe(e)&&e.add)}const Lo=e=>/^\-?\d*\.?\d+$/.test(e);function pn(e,t){e.indexOf(t)===-1&&e.push(t)}function gn(e,t){const s=e.indexOf(t);s>-1&&e.splice(s,1)}class xn{constructor(){this.subscriptions=[]}add(t){return pn(this.subscriptions,t),()=>gn(this.subscriptions,t)}notify(t,s,n){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,s,n);else for(let i=0;i<o;i++){const a=this.subscriptions[i];a&&a(t,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const El=e=>!isNaN(parseFloat(e));class Vl{constructor(t,s={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,o=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:a}=ue;this.lastUpdated!==a&&(this.timeDelta=i,this.lastUpdated=a,ne.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>ne.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=El(this.current),this.owner=s.owner}onChange(t){return this.on("change",t)}on(t,s){this.events[t]||(this.events[t]=new xn);const n=this.events[t].add(s);return t==="change"?()=>{n(),ne.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,s){this.passiveEffect=t,this.stopPassiveEffect=s}set(t,s=!0){!s||!this.passiveEffect?this.updateAndNotify(t,s):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,s,n){this.set(s),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Ro(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=t(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function dt(e,t){return new Vl(e,t)}const Io=e=>t=>t.test(e),Dl={test:e=>e==="auto",parse:e=>e},Fo=[Ze,J,ke,De,$i,zi,Dl],gt=e=>Fo.find(Io(e)),Ll=[...Fo,fe,Be],Il=e=>Ll.find(Io(e));function Fl(e,t,s){e.hasValue(t)?e.getValue(t).set(s):e.addValue(t,dt(s))}function Bl(e,t){const s=us(e,t);let{transitionEnd:n={},transition:o={},...i}=s?e.makeTargetAnimatable(s,!1):{};i={...i,...n};for(const a in i){const l=ta(i[a]);Fl(e,a,l)}}function Ol(e,t,s){var n,o;const i=Object.keys(t).filter(l=>!e.hasValue(l)),a=i.length;if(a)for(let l=0;l<a;l++){const c=i[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(o=(n=s[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&o!==void 0?o:t[c]),u!=null&&(typeof u=="string"&&(Lo(u)||Do(u))?u=parseFloat(u):!Il(u)&&Be.test(d)&&(u=Vo(c,d)),e.addValue(c,dt(u,{owner:e})),s[c]===void 0&&(s[c]=u),u!==null&&e.setBaseTarget(c,u))}}function zl(e,t){return t?(t[e]||t.default||t).from:void 0}function $l(e,t,s){const n={};for(const o in e){const i=zl(o,t);if(i!==void 0)n[o]=i;else{const a=s.getValue(o);a&&(n[o]=a.get())}}return n}function Ul({protectedKeys:e,needsAnimating:t},s){const n=e.hasOwnProperty(s)&&t[s]!==!0;return t[s]=!1,n}function Hl(e,t){const s=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==s)return!0}else return s!==t}function Bo(e,t,{delay:s=0,transitionOverride:n,type:o}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(i=n);const d=[],u=o&&e.animationState&&e.animationState.getState()[o];for(const h in l){const p=e.getValue(h),x=l[h];if(!p||x===void 0||u&&Ul(u,h))continue;const w={delay:s,elapsed:0,...fn(i||{},h)};if(window.HandoffAppearAnimations){const E=e.getProps()[Br];if(E){const k=window.HandoffAppearAnimations(E,h,p,ne);k!==null&&(w.elapsed=k,w.isHandoff=!0)}}let v=!w.isHandoff&&!Hl(p,x);if(w.type==="spring"&&(p.getVelocity()||w.velocity)&&(v=!1),p.animation&&(v=!1),v)continue;p.start(mn(h,p,x,e.shouldReduceMotion&&Ye.has(h)?{type:!1}:w));const j=p.animation;ts(c)&&(c.add(h),j.then(()=>c.remove(h))),d.push(j)}return a&&Promise.all(d).then(()=>{a&&Bl(e,a)}),d}function Os(e,t,s={}){const n=us(e,t,s.custom);let{transition:o=e.getDefaultTransition()||{}}=n||{};s.transitionOverride&&(o=s.transitionOverride);const i=n?()=>Promise.all(Bo(e,n,s)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:h}=o;return Gl(e,t,d+c,u,h,s)}:()=>Promise.resolve(),{when:l}=o;if(l){const[c,d]=l==="beforeChildren"?[i,a]:[a,i];return c().then(()=>d())}else return Promise.all([i(),a(s.delay)])}function Gl(e,t,s=0,n=0,o=1,i){const a=[],l=(e.variantChildren.size-1)*n,c=o===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(_l).forEach((d,u)=>{d.notify("AnimationStart",t),a.push(Os(d,t,{...i,delay:s+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(a)}function _l(e,t){return e.sortNodePosition(t)}function Wl(e,t,s={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const o=t.map(i=>Os(e,i,s));n=Promise.all(o)}else if(typeof t=="string")n=Os(e,t,s);else{const o=typeof t=="function"?us(e,t,s.custom):t;n=Promise.all(Bo(e,o,s))}return n.then(()=>e.notify("AnimationComplete",t))}const ql=[...Zs].reverse(),Xl=Zs.length;function Kl(e){return t=>Promise.all(t.map(({animation:s,options:n})=>Wl(e,s,n)))}function Yl(e){let t=Kl(e);const s=Jl();let n=!0;const o=(c,d)=>{const u=us(e,d);if(u){const{transition:h,transitionEnd:p,...x}=u;c={...c,...x,...p}}return c};function i(c){t=c(e)}function a(c,d){const u=e.getProps(),h=e.getVariantContext(!0)||{},p=[],x=new Set;let w={},v=1/0;for(let E=0;E<Xl;E++){const k=ql[E],C=s[k],L=u[k]!==void 0?u[k]:h[k],V=Tt(L),M=k===d?C.isActive:null;M===!1&&(v=E);let F=L===h[k]&&L!==u[k]&&V;if(F&&n&&e.manuallyAnimateOnMount&&(F=!1),C.protectedKeys={...w},!C.isActive&&M===null||!L&&!C.prevProp||as(L)||typeof L=="boolean")continue;let R=Zl(C.prevProp,L)||k===d&&C.isActive&&!F&&V||E>v&&V,y=!1;const A=Array.isArray(L)?L:[L];let N=A.reduce(o,{});M===!1&&(N={});const{prevResolvedValues:P={}}=C,S={...P,...N},f=O=>{R=!0,x.has(O)&&(y=!0,x.delete(O)),C.needsAnimating[O]=!0};for(const O in S){const _=N[O],K=P[O];if(w.hasOwnProperty(O))continue;let q=!1;Zt(_)&&Zt(K)?q=!io(_,K):q=_!==K,q?_!==void 0?f(O):x.add(O):_!==void 0&&x.has(O)?f(O):C.protectedKeys[O]=!0}C.prevProp=L,C.prevResolvedValues=N,C.isActive&&(w={...w,...N}),n&&e.blockInitialAnimation&&(R=!1),R&&(!F||y)&&p.push(...A.map(O=>({animation:O,options:{type:k,...c}})))}if(x.size){const E={};x.forEach(k=>{const C=e.getBaseTarget(k);C!==void 0&&(E[k]=C)}),p.push({animation:E})}let j=!!p.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(j=!1),n=!1,j?t(p):Promise.resolve()}function l(c,d,u){var h;if(s[c].isActive===d)return Promise.resolve();(h=e.variantChildren)===null||h===void 0||h.forEach(x=>{var w;return(w=x.animationState)===null||w===void 0?void 0:w.setActive(c,d)}),s[c].isActive=d;const p=a(u,c);for(const x in s)s[x].protectedKeys={};return p}return{animateChanges:a,setActive:l,setAnimateFunction:i,getState:()=>s}}function Zl(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!io(t,e):!1}function Ue(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Jl(){return{animate:Ue(!0),whileInView:Ue(),whileHover:Ue(),whileTap:Ue(),whileDrag:Ue(),whileFocus:Ue(),exit:Ue()}}class Ql extends Oe{constructor(t){super(t),t.animationState||(t.animationState=Yl(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),as(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:s}=this.node.prevProps||{};t!==s&&this.updateAnimationControlsSubscription()}unmount(){}}let ec=0;class tc extends Oe{constructor(){super(...arguments),this.id=ec++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:s,custom:n}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===o)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});s&&!t&&i.then(()=>s(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const sc={animation:{Feature:Ql},exit:{Feature:tc}},In=(e,t)=>Math.abs(e-t);function nc(e,t){const s=In(e.x,t.x),n=In(e.y,t.y);return Math.sqrt(s**2+n**2)}class Oo{constructor(t,s,{transformPagePoint:n,contextWindow:o,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Ns(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=nc(h.offset,{x:0,y:0})>=3;if(!p&&!x)return;const{point:w}=h,{timestamp:v}=ue;this.history.push({...w,timestamp:v});const{onStart:j,onMove:E}=this.handlers;p||(j&&j(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),E&&E(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=js(p,this.transformPagePoint),ne.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:x,onSessionEnd:w,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const j=Ns(h.type==="pointercancel"?this.lastMoveEventInfo:js(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,j),w&&w(h,j)},!to(t))return;this.dragSnapToOrigin=i,this.handlers=s,this.transformPagePoint=n,this.contextWindow=o||window;const a=ds(t),l=js(a,this.transformPagePoint),{point:c}=l,{timestamp:d}=ue;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=s;u&&u(t,Ns(l,this.history)),this.removeListeners=Ie(Re(this.contextWindow,"pointermove",this.handlePointerMove),Re(this.contextWindow,"pointerup",this.handlePointerUp),Re(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ee(this.updatePoint)}}function js(e,t){return t?{point:t(e.point)}:e}function Fn(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ns({point:e},t){return{point:e,delta:Fn(e,zo(t)),offset:Fn(e,rc(t)),velocity:oc(t,.1)}}function rc(e){return e[0]}function zo(e){return e[e.length-1]}function oc(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,n=null;const o=zo(e);for(;s>=0&&(n=e[s],!(o.timestamp-n.timestamp>Xe(t)));)s--;if(!n)return{x:0,y:0};const i=Ae(o.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const a={x:(o.x-n.x)/i,y:(o.y-n.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function ye(e){return e.max-e.min}function zs(e,t=0,s=.01){return Math.abs(e-t)<=s}function Bn(e,t,s,n=.5){e.origin=n,e.originPoint=ie(t.min,t.max,e.origin),e.scale=ye(s)/ye(t),(zs(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ie(s.min,s.max,e.origin)-e.originPoint,(zs(e.translate)||isNaN(e.translate))&&(e.translate=0)}function St(e,t,s,n){Bn(e.x,t.x,s.x,n?n.originX:void 0),Bn(e.y,t.y,s.y,n?n.originY:void 0)}function On(e,t,s){e.min=s.min+t.min,e.max=e.min+ye(t)}function ic(e,t,s){On(e.x,t.x,s.x),On(e.y,t.y,s.y)}function zn(e,t,s){e.min=t.min-s.min,e.max=e.min+ye(t)}function Ct(e,t,s){zn(e.x,t.x,s.x),zn(e.y,t.y,s.y)}function ac(e,{min:t,max:s},n){return t!==void 0&&e<t?e=n?ie(t,e,n.min):Math.max(e,t):s!==void 0&&e>s&&(e=n?ie(s,e,n.max):Math.min(e,s)),e}function $n(e,t,s){return{min:t!==void 0?e.min+t:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function lc(e,{top:t,left:s,bottom:n,right:o}){return{x:$n(e.x,s,o),y:$n(e.y,t,n)}}function Un(e,t){let s=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,n]=[n,s]),{min:s,max:n}}function cc(e,t){return{x:Un(e.x,t.x),y:Un(e.y,t.y)}}function dc(e,t){let s=.5;const n=ye(e),o=ye(t);return o>n?s=Pt(t.min,t.max-n,e.min):n>o&&(s=Pt(e.min,e.max-o,t.min)),Fe(0,1,s)}function uc(e,t){const s={};return t.min!==void 0&&(s.min=t.min-e.min),t.max!==void 0&&(s.max=t.max-e.min),s}const $s=.35;function hc(e=$s){return e===!1?e=0:e===!0&&(e=$s),{x:Hn(e,"left","right"),y:Hn(e,"top","bottom")}}function Hn(e,t,s){return{min:Gn(e,t),max:Gn(e,s)}}function Gn(e,t){return typeof e=="number"?e:e[t]||0}const _n=()=>({translate:0,scale:1,origin:0,originPoint:0}),lt=()=>({x:_n(),y:_n()}),Wn=()=>({min:0,max:0}),de=()=>({x:Wn(),y:Wn()});function Ne(e){return[e("x"),e("y")]}function $o({top:e,left:t,right:s,bottom:n}){return{x:{min:t,max:s},y:{min:e,max:n}}}function fc({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function mc(e,t){if(!t)return e;const s=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function Ss(e){return e===void 0||e===1}function Us({scale:e,scaleX:t,scaleY:s}){return!Ss(e)||!Ss(t)||!Ss(s)}function Ge(e){return Us(e)||Uo(e)||e.z||e.rotate||e.rotateX||e.rotateY}function Uo(e){return qn(e.x)||qn(e.y)}function qn(e){return e&&e!=="0%"}function ss(e,t,s){const n=e-s,o=t*n;return s+o}function Xn(e,t,s,n,o){return o!==void 0&&(e=ss(e,o,n)),ss(e,s,n)+t}function Hs(e,t=0,s=1,n,o){e.min=Xn(e.min,t,s,n,o),e.max=Xn(e.max,t,s,n,o)}function Ho(e,{x:t,y:s}){Hs(e.x,t.translate,t.scale,t.originPoint),Hs(e.y,s.translate,s.scale,s.originPoint)}function pc(e,t,s,n=!1){const o=s.length;if(!o)return;t.x=t.y=1;let i,a;for(let l=0;l<o;l++){i=s[l],a=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ct(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Ho(e,a)),n&&Ge(i.latestValues)&&ct(e,i.latestValues))}t.x=Kn(t.x),t.y=Kn(t.y)}function Kn(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Le(e,t){e.min=e.min+t,e.max=e.max+t}function Yn(e,t,[s,n,o]){const i=t[o]!==void 0?t[o]:.5,a=ie(e.min,e.max,i);Hs(e,t[s],t[n],a,t.scale)}const gc=["x","scaleX","originX"],xc=["y","scaleY","originY"];function ct(e,t){Yn(e.x,t,gc),Yn(e.y,t,xc)}function Go(e,t){return $o(mc(e.getBoundingClientRect(),t))}function yc(e,t,s){const n=Go(e,s),{scroll:o}=t;return o&&(Le(n.x,o.offset.x),Le(n.y,o.offset.y)),n}const _o=({current:e})=>e?e.ownerDocument.defaultView:null,bc=new WeakMap;class vc{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=de(),this.visualElement=t}start(t,{snapToCursor:s=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const o=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(ds(u,"page").point)},i=(u,h)=>{const{drag:p,dragPropagation:x,onDragStart:w}=this.getProps();if(p&&!x&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=no(p),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ne(j=>{let E=this.getAxisMotionValue(j).get()||0;if(ke.test(E)){const{projection:k}=this.visualElement;if(k&&k.layout){const C=k.layout.layoutBox[j];C&&(E=ye(C)*(parseFloat(E)/100))}}this.originPoint[j]=E}),w&&ne.update(()=>w(u,h),!1,!0);const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(u,h)=>{const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:w,onDrag:v}=this.getProps();if(!p&&!this.openGlobalLock)return;const{offset:j}=h;if(x&&this.currentDirection===null){this.currentDirection=wc(j),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",h.point,j),this.updateAxis("y",h.point,j),this.visualElement.render(),v&&v(u,h)},l=(u,h)=>this.stop(u,h),c=()=>Ne(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new Oo(t,{onSessionStart:o,onStart:i,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:_o(this.visualElement)})}stop(t,s){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:i}=this.getProps();i&&ne.update(()=>i(t,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:s}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(t,s,n){const{drag:o}=this.getProps();if(!n||!$t(t,o,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(a=ac(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var t;const{dragConstraints:s,dragElastic:n}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;s&&it(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&o?this.constraints=lc(o.layoutBox,s):this.constraints=!1,this.elastic=hc(n),i!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&Ne(a=>{this.getAxisMotionValue(a)&&(this.constraints[a]=uc(o.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:s}=this.getProps();if(!t||!it(t))return!1;const n=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const i=yc(n,o.root,this.visualElement.getTransformPagePoint());let a=cc(o.layout.layoutBox,i);if(s){const l=s(fc(a));this.hasMutatedConstraints=!!l,l&&(a=$o(l))}return a}startAnimation(t){const{drag:s,dragMomentum:n,dragElastic:o,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Ne(u=>{if(!$t(u,s,this.currentDirection))return;let h=c&&c[u]||{};a&&(h={min:0,max:0});const p=o?200:1e6,x=o?40:1e7,w={type:"inertia",velocity:n?t[u]:0,bounceStiffness:p,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,w)});return Promise.all(d).then(l)}startAxisValueAnimation(t,s){const n=this.getAxisMotionValue(t);return n.start(mn(t,n,0,s))}stopAnimation(){Ne(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ne(t=>{var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(t){var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(t){const s="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),o=n[s];return o||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Ne(s=>{const{drag:n}=this.getProps();if(!$t(s,n,this.currentDirection))return;const{projection:o}=this.visualElement,i=this.getAxisMotionValue(s);if(o&&o.layout){const{min:a,max:l}=o.layout.layoutBox[s];i.set(t[s]-ie(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!it(s)||!n||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Ne(a=>{const l=this.getAxisMotionValue(a);if(l){const c=l.get();o[a]=dc({min:c,max:c},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Ne(a=>{if(!$t(a,t,null))return;const l=this.getAxisMotionValue(a),{min:c,max:d}=this.constraints[a];l.set(ie(c,d,o[a]))})}addListeners(){if(!this.visualElement.current)return;bc.set(this.visualElement,this);const t=this.visualElement.current,s=Re(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();it(c)&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,i=o.addEventListener("measure",n);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),n();const a=Me(window,"resize",()=>this.scalePositionWithinConstraints()),l=o.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Ne(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=c[u].translate,h.set(h.get()+c[u].translate))}),this.visualElement.render())});return()=>{a(),s(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:o=!1,dragConstraints:i=!1,dragElastic:a=$s,dragMomentum:l=!0}=t;return{...t,drag:s,dragDirectionLock:n,dragPropagation:o,dragConstraints:i,dragElastic:a,dragMomentum:l}}}function $t(e,t,s){return(t===!0||t===e)&&(s===null||s===e)}function wc(e,t=10){let s=null;return Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x"),s}class jc extends Oe{constructor(t){super(t),this.removeGroupControls=le,this.removeListeners=le,this.controls=new vc(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||le}unmount(){this.removeGroupControls(),this.removeListeners()}}const Zn=e=>(t,s)=>{e&&ne.update(()=>e(t,s))};class Nc extends Oe{constructor(){super(...arguments),this.removePointerDownListener=le}onPointerDown(t){this.session=new Oo(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:_o(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:s,onPan:n,onPanEnd:o}=this.node.getProps();return{onSessionStart:Zn(t),onStart:Zn(s),onMove:n,onEnd:(i,a)=>{delete this.session,o&&ne.update(()=>o(i,a))}}}mount(){this.removePointerDownListener=Re(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Sc(){const e=g.useContext(os);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:s,register:n}=e,o=g.useId();return g.useEffect(()=>n(o),[]),!t&&s?[!1,()=>s&&s(o)]:[!0]}const Xt={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Jn(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const xt={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(J.test(e))e=parseFloat(e);else return e;const s=Jn(e,t.target.x),n=Jn(e,t.target.y);return`${s}% ${n}%`}},Cc={correct:(e,{treeScale:t,projectionDelta:s})=>{const n=e,o=Be.parse(e);if(o.length>5)return n;const i=Be.createTransformer(e),a=typeof o[0]!="number"?1:0,l=s.x.scale*t.x,c=s.y.scale*t.y;o[0+a]/=l,o[1+a]/=c;const d=ie(l,c,.5);return typeof o[2+a]=="number"&&(o[2+a]/=d),typeof o[3+a]=="number"&&(o[3+a]/=d),i(o)}};class Tc extends qs.Component{componentDidMount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n,layoutId:o}=this.props,{projection:i}=t;Vi(kc),i&&(s.group&&s.group.add(i),n&&n.register&&o&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Xt.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:s,visualElement:n,drag:o,isPresent:i}=this.props,a=n.projection;return a&&(a.isPresent=i,o||t.layoutDependency!==s||s===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ne.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:o}=t;o&&(o.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(o),n&&n.deregister&&n.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Wo(e){const[t,s]=Sc(),n=g.useContext(Qs);return qs.createElement(Tc,{...e,layoutGroup:n,switchLayoutGroup:g.useContext(zr),isPresent:t,safeToRemove:s})}const kc={borderRadius:{...xt,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:xt,borderTopRightRadius:xt,borderBottomLeftRadius:xt,borderBottomRightRadius:xt,boxShadow:Cc},qo=["TopLeft","TopRight","BottomLeft","BottomRight"],Pc=qo.length,Qn=e=>typeof e=="string"?parseFloat(e):e,er=e=>typeof e=="number"||J.test(e);function Mc(e,t,s,n,o,i){o?(e.opacity=ie(0,s.opacity!==void 0?s.opacity:1,Rc(n)),e.opacityExit=ie(t.opacity!==void 0?t.opacity:1,0,Ac(n))):i&&(e.opacity=ie(t.opacity!==void 0?t.opacity:1,s.opacity!==void 0?s.opacity:1,n));for(let a=0;a<Pc;a++){const l=`border${qo[a]}Radius`;let c=tr(t,l),d=tr(s,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||er(c)===er(d)?(e[l]=Math.max(ie(Qn(c),Qn(d),n),0),(ke.test(d)||ke.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||s.rotate)&&(e.rotate=ie(t.rotate||0,s.rotate||0,n))}function tr(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Rc=Xo(0,.5,go),Ac=Xo(.5,.95,le);function Xo(e,t,s){return n=>n<e?0:n>t?1:s(Pt(e,t,n))}function sr(e,t){e.min=t.min,e.max=t.max}function je(e,t){sr(e.x,t.x),sr(e.y,t.y)}function nr(e,t,s,n,o){return e-=t,e=ss(e,1/s,n),o!==void 0&&(e=ss(e,1/o,n)),e}function Ec(e,t=0,s=1,n=.5,o,i=e,a=e){if(ke.test(t)&&(t=parseFloat(t),t=ie(a.min,a.max,t/100)-a.min),typeof t!="number")return;let l=ie(i.min,i.max,n);e===i&&(l-=t),e.min=nr(e.min,t,s,l,o),e.max=nr(e.max,t,s,l,o)}function rr(e,t,[s,n,o],i,a){Ec(e,t[s],t[n],t[o],t.scale,i,a)}const Vc=["x","scaleX","originX"],Dc=["y","scaleY","originY"];function or(e,t,s,n){rr(e.x,t,Vc,s?s.x:void 0,n?n.x:void 0),rr(e.y,t,Dc,s?s.y:void 0,n?n.y:void 0)}function ir(e){return e.translate===0&&e.scale===1}function Ko(e){return ir(e.x)&&ir(e.y)}function Lc(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function Yo(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function ar(e){return ye(e.x)/ye(e.y)}class Ic{constructor(){this.members=[]}add(t){pn(this.members,t),t.scheduleRender()}remove(t){if(gn(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(t){const s=this.members.findIndex(o=>t===o);if(s===0)return!1;let n;for(let o=s;o>=0;o--){const i=this.members[o];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,s){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,s&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:s,resumingFrom:n}=t;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function lr(e,t,s){let n="";const o=e.x.translate/t.x,i=e.y.translate/t.y;if((o||i)&&(n=`translate3d(${o}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),s){const{rotate:c,rotateX:d,rotateY:u}=s;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const Fc=(e,t)=>e.depth-t.depth;class Bc{constructor(){this.children=[],this.isDirty=!1}add(t){pn(this.children,t),this.isDirty=!0}remove(t){gn(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Fc),this.isDirty=!1,this.children.forEach(t)}}function Oc(e,t){const s=performance.now(),n=({timestamp:o})=>{const i=o-s;i>=t&&(Ee(n),e(i-t))};return ne.read(n,!0),()=>Ee(n)}function zc(e){window.MotionDebug&&window.MotionDebug.record(e)}function $c(e){return e instanceof SVGElement&&e.tagName!=="svg"}function Uc(e,t,s){const n=pe(e)?e:dt(e);return n.start(mn("",n,t,s)),n.animation}const cr=["","X","Y","Z"],Hc={visibility:"hidden"},dr=1e3;let Gc=0;const _e={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Zo({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:n,resetTransform:o}){return class{constructor(a={},l=t==null?void 0:t()){this.id=Gc++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,_e.totalNodes=_e.resolvedTargetDeltas=_e.recalculatedProjection=0,this.nodes.forEach(qc),this.nodes.forEach(Jc),this.nodes.forEach(Qc),this.nodes.forEach(Xc),zc(_e)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Bc)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new xn),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=$c(a),this.instance=a;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let h;const p=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=Oc(p,250),Xt.hasAnimatedSinceResize&&(Xt.hasAnimatedSinceResize=!1,this.nodes.forEach(hr))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeTargetChanged:x,layout:w})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||u.getDefaultTransition()||rd,{onLayoutAnimationStart:j,onLayoutAnimationComplete:E}=u.getProps(),k=!this.targetLayout||!Yo(this.targetLayout,w)||x,C=!p&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||C||p&&(k||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,C);const L={...fn(v,"layout"),onPlay:j,onComplete:E};(u.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else p||hr(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=w})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ee(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ed),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ur);return}this.isUpdating||this.nodes.forEach(Yc),this.isUpdating=!1,this.nodes.forEach(Zc),this.nodes.forEach(_c),this.nodes.forEach(Wc),this.clearAllSnapshots();const l=performance.now();ue.delta=Fe(0,1e3/60,l-ue.timestamp),ue.timestamp=l,ue.isProcessing=!0,ms.update.process(ue),ms.preRender.process(ue),ms.render.process(ue),ue.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Kc),this.sharedNodes.forEach(td)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ne.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ne.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=de(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:n(this.instance),offset:s(this.instance)})}resetTransform(){if(!o)return;const a=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!Ko(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;a&&(l||Ge(this.latestValues)||u)&&(o(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),od(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return de();const l=a.measureViewportBox(),{scroll:c}=this.root;return c&&(Le(l.x,c.offset.x),Le(l.y,c.offset.y)),l}removeElementScroll(a){const l=de();je(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:h}=d;if(d!==this.root&&u&&h.layoutScroll){if(u.isRoot){je(l,a);const{scroll:p}=this.root;p&&(Le(l.x,-p.offset.x),Le(l.y,-p.offset.y))}Le(l.x,u.offset.x),Le(l.y,u.offset.y)}}return l}applyTransform(a,l=!1){const c=de();je(c,a);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&ct(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Ge(u.latestValues)&&ct(c,u.latestValues)}return Ge(this.latestValues)&&ct(c,this.latestValues),c}removeTransform(a){const l=de();je(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Ge(d.latestValues))continue;Us(d.latestValues)&&d.updateSnapshot();const u=de(),h=d.measurePageBox();je(u,h),or(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Ge(this.latestValues)&&or(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ue.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=ue.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=de(),this.relativeTargetOrigin=de(),Ct(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),je(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=de(),this.targetWithTransforms=de()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ic(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):je(this.target,this.layout.layoutBox),Ho(this.target,this.targetDelta)):je(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=de(),this.relativeTargetOrigin=de(),Ct(this.relativeTargetOrigin,this.target,x.target),je(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}_e.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Us(this.parent.latestValues)||Uo(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===ue.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;je(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,x=this.treeScale.y;pc(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:w}=l;if(!w){this.projectionTransform&&(this.projectionDelta=lt(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=lt(),this.projectionDeltaWithTransform=lt());const v=this.projectionTransform;St(this.projectionDelta,this.layoutCorrected,w,this.latestValues),this.projectionTransform=lr(this.projectionDelta,this.treeScale),(this.projectionTransform!==v||this.treeScale.x!==p||this.treeScale.y!==x)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",w)),_e.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},h=lt();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const p=de(),x=c?c.source:void 0,w=this.layout?this.layout.source:void 0,v=x!==w,j=this.getStack(),E=!j||j.members.length<=1,k=!!(v&&!E&&this.options.crossfade===!0&&!this.path.some(nd));this.animationProgress=0;let C;this.mixTargetDelta=L=>{const V=L/1e3;fr(h.x,a.x,V),fr(h.y,a.y,V),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ct(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),sd(this.relativeTarget,this.relativeTargetOrigin,p,V),C&&Lc(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=de()),je(C,this.relativeTarget)),v&&(this.animationValues=u,Mc(u,d,this.latestValues,V,k,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=V},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ee(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ne.update(()=>{Xt.hasAnimatedSinceResize=!0,this.currentAnimation=Uc(0,dr,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(dr),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=a;if(!(!l||!c||!d)){if(this!==a&&this.layout&&d&&Jo(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||de();const h=ye(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+h;const p=ye(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+p}je(l,c),ct(l,u),St(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Ic),this.sharedNodes.get(a).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<cr.length;u++){const h="rotate"+cr[u];c[h]&&(d[h]=c[h],a.setStaticValue(h,0))}a.render();for(const u in d)a.setStaticValue(u,d[u]);a.scheduleRender()}getProjectionStyles(a){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Hc;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=qt(a==null?void 0:a.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=qt(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Ge(this.latestValues)&&(v.transform=u?u({},""):"none",this.hasProjected=!1),v}const p=h.animationValues||h.latestValues;this.applyTransformsToTarget(),d.transform=lr(this.projectionDeltaWithTransform,this.treeScale,p),u&&(d.transform=u(p,d.transform));const{x,y:w}=this.projectionDelta;d.transformOrigin=`${x.origin*100}% ${w.origin*100}% 0`,h.animationValues?d.opacity=h===this?(c=(l=p.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:d.opacity=h===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const v in Kt){if(p[v]===void 0)continue;const{correct:j,applyTo:E}=Kt[v],k=d.transform==="none"?p[v]:j(p[v],h);if(E){const C=E.length;for(let L=0;L<C;L++)d[E[L]]=k}else d[v]=k}return this.options.layoutId&&(d.pointerEvents=h===this?qt(a==null?void 0:a.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(ur),this.root.sharedNodes.clear()}}}function _c(e){e.updateLayout()}function Wc(e){var t;const s=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:o}=e.layout,{animationType:i}=e.options,a=s.source!==e.layout.source;i==="size"?Ne(h=>{const p=a?s.measuredBox[h]:s.layoutBox[h],x=ye(p);p.min=n[h].min,p.max=p.min+x}):Jo(i,s.layoutBox,n)&&Ne(h=>{const p=a?s.measuredBox[h]:s.layoutBox[h],x=ye(n[h]);p.max=p.min+x,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+x)});const l=lt();St(l,n,s.layoutBox);const c=lt();a?St(c,e.applyTransform(o,!0),s.measuredBox):St(c,n,s.layoutBox);const d=!Ko(l);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:x}=h;if(p&&x){const w=de();Ct(w,s.layoutBox,p.layoutBox);const v=de();Ct(v,n,x.layoutBox),Yo(w,v)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=w,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function qc(e){_e.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Xc(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Kc(e){e.clearSnapshot()}function ur(e){e.clearMeasurements()}function Yc(e){e.isLayoutDirty=!1}function Zc(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function hr(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Jc(e){e.resolveTargetDelta()}function Qc(e){e.calcProjection()}function ed(e){e.resetRotation()}function td(e){e.removeLeadSnapshot()}function fr(e,t,s){e.translate=ie(t.translate,0,s),e.scale=ie(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function mr(e,t,s,n){e.min=ie(t.min,s.min,n),e.max=ie(t.max,s.max,n)}function sd(e,t,s,n){mr(e.x,t.x,s.x,n),mr(e.y,t.y,s.y,n)}function nd(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const rd={duration:.45,ease:[.4,0,.1,1]},pr=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),gr=pr("applewebkit/")&&!pr("chrome/")?Math.round:le;function xr(e){e.min=gr(e.min),e.max=gr(e.max)}function od(e){xr(e.x),xr(e.y)}function Jo(e,t,s){return e==="position"||e==="preserve-aspect"&&!zs(ar(t),ar(s),.2)}const id=Zo({attachResizeListener:(e,t)=>Me(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Cs={current:void 0},Qo=Zo({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Cs.current){const e=new id({});e.mount(window),e.setOptions({layoutScroll:!0}),Cs.current=e}return Cs.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),ad={pan:{Feature:Nc},drag:{Feature:jc,ProjectionNode:Qo,MeasureLayout:Wo}},ld=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function cd(e){const t=ld.exec(e);if(!t)return[,];const[,s,n]=t;return[s,n]}function Gs(e,t,s=1){const[n,o]=cd(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const a=i.trim();return Lo(a)?parseFloat(a):a}else return Vs(o)?Gs(o,t,s+1):o}function dd(e,{...t},s){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:s};s&&(s={...s}),e.values.forEach(o=>{const i=o.get();if(!Vs(i))return;const a=Gs(i,n);a&&o.set(a)});for(const o in t){const i=t[o];if(!Vs(i))continue;const a=Gs(i,n);a&&(t[o]=a,s||(s={}),s[o]===void 0&&(s[o]=i))}return{target:t,transitionEnd:s}}const ud=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),ei=e=>ud.has(e),hd=e=>Object.keys(e).some(ei),yr=e=>e===Ze||e===J,br=(e,t)=>parseFloat(e.split(", ")[t]),vr=(e,t)=>(s,{transform:n})=>{if(n==="none"||!n)return 0;const o=n.match(/^matrix3d\((.+)\)$/);if(o)return br(o[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?br(i[1],e):0}},fd=new Set(["x","y","z"]),md=Mt.filter(e=>!fd.has(e));function pd(e){const t=[];return md.forEach(s=>{const n=e.getValue(s);n!==void 0&&(t.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),t.length&&e.render(),t}const ut={width:({x:e},{paddingLeft:t="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),height:({y:e},{paddingTop:t="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:vr(4,13),y:vr(5,14)};ut.translateX=ut.x;ut.translateY=ut.y;const gd=(e,t,s)=>{const n=t.measureViewportBox(),o=t.current,i=getComputedStyle(o),{display:a}=i,l={};a==="none"&&t.setStaticValue("display",e.display||"block"),s.forEach(d=>{l[d]=ut[d](n,i)}),t.render();const c=t.measureViewportBox();return s.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=ut[d](c,i)}),e},xd=(e,t,s={},n={})=>{t={...t},n={...n};const o=Object.keys(t).filter(ei);let i=[],a=!1;const l=[];if(o.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=s[c],h=gt(u);const p=t[c];let x;if(Zt(p)){const w=p.length,v=p[0]===null?1:0;u=p[v],h=gt(u);for(let j=v;j<w&&p[j]!==null;j++)x?ln(gt(p[j])===x):x=gt(p[j])}else x=gt(p);if(h!==x)if(yr(h)&&yr(x)){const w=d.get();typeof w=="string"&&d.set(parseFloat(w)),typeof p=="string"?t[c]=parseFloat(p):Array.isArray(p)&&x===J&&(t[c]=p.map(parseFloat))}else h!=null&&h.transform&&(x!=null&&x.transform)&&(u===0||p===0)?u===0?d.set(x.transform(u)):t[c]=h.transform(p):(a||(i=pd(e),a=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(p))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=gd(t,e,l);return i.length&&i.forEach(([u,h])=>{e.getValue(u).set(h)}),e.render(),is&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function yd(e,t,s,n){return hd(t)?xd(e,t,s,n):{target:t,transitionEnd:n}}const bd=(e,t,s,n)=>{const o=dd(e,t,n);return t=o.target,n=o.transitionEnd,yd(e,t,s,n)},_s={current:null},ti={current:!1};function vd(){if(ti.current=!0,!!is)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>_s.current=e.matches;e.addListener(t),t()}else _s.current=!1}function wd(e,t,s){const{willChange:n}=t;for(const o in t){const i=t[o],a=s[o];if(pe(i))e.addValue(o,i),ts(n)&&n.add(o);else if(pe(a))e.addValue(o,dt(i,{owner:e})),ts(n)&&n.remove(o);else if(a!==i)if(e.hasValue(o)){const l=e.getValue(o);!l.hasAnimated&&l.set(i)}else{const l=e.getStaticValue(o);e.addValue(o,dt(l!==void 0?l:i,{owner:e}))}}for(const o in s)t[o]===void 0&&e.removeValue(o);return t}const wr=new WeakMap,si=Object.keys(kt),jd=si.length,jr=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Nd=Js.length;class Sd{constructor({parent:t,props:s,presenceContext:n,reducedMotionConfig:o,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ne.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=s.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=s,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=a,this.isControllingVariants=ls(s),this.isVariantNode=Or(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(s,{});for(const h in u){const p=u[h];l[h]!==void 0&&pe(p)&&(p.set(l[h],!1),ts(d)&&d.add(h))}}scrapeMotionValuesFromProps(t,s){return{}}mount(t){this.current=t,wr.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),ti.current||vd(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:_s.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){wr.delete(this.current),this.projection&&this.projection.unmount(),Ee(this.notifyUpdate),Ee(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,s){const n=Ye.has(t),o=s.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&ne.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=s.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{o(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...s},n,o,i){let a,l;for(let c=0;c<jd;c++){const d=si[c],{isEnabled:u,Feature:h,ProjectionNode:p,MeasureLayout:x}=kt[d];p&&(a=p),u(s)&&(!this.features[d]&&h&&(this.features[d]=new h(this)),x&&(l=x))}if((this.type==="html"||this.type==="svg")&&!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:h,layoutScroll:p,layoutRoot:x}=s;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||h&&it(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:i,layoutScroll:p,layoutRoot:x})}return l}updateFeatures(){for(const t in this.features){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):de()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,s){this.latestValues[t]=s}makeTargetAnimatable(t,s=!0){return this.makeTargetAnimatableFromInstance(t,this.props,s)}update(t,s){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<jr.length;n++){const o=jr[n];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const i=t["on"+o];i&&(this.propEventSubscriptions[o]=this.on(o,i))}this.prevMotionValues=wd(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const s={};for(let n=0;n<Nd;n++){const o=Js[n],i=this.props[o];(Tt(i)||i===!1)&&(s[o]=i)}return s}addVariantChild(t){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(t),()=>s.variantChildren.delete(t)}addValue(t,s){s!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,s)),this.values.set(t,s),this.latestValues[t]=s.get()}removeValue(t){this.values.delete(t);const s=this.valueSubscriptions.get(t);s&&(s(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,s){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&s!==void 0&&(n=dt(s,{owner:this}),this.addValue(t,n)),n}readValue(t){var s;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(s=this.getBaseTargetFromProps(this.props,t))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,s){this.baseTarget[t]=s}getBaseTarget(t){var s;const{initial:n}=this.props,o=typeof n=="string"||typeof n=="object"?(s=an(this.props,n))===null||s===void 0?void 0:s[t]:void 0;if(n&&o!==void 0)return o;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!pe(i)?i:this.initialValues[t]!==void 0&&o===void 0?void 0:this.baseTarget[t]}on(t,s){return this.events[t]||(this.events[t]=new xn),this.events[t].add(s)}notify(t,...s){this.events[t]&&this.events[t].notify(...s)}}class ni extends Sd{sortInstanceNodePosition(t,s){return t.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(t,s){return t.style?t.style[s]:void 0}removeValueFromRenderState(t,{vars:s,style:n}){delete s[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:s,...n},{transformValues:o},i){let a=$l(n,t||{},this);if(o&&(s&&(s=o(s)),n&&(n=o(n)),a&&(a=o(a))),i){Ol(this,n,a);const l=bd(this,n,a,s);s=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:s,...n}}}function Cd(e){return window.getComputedStyle(e)}class Td extends ni{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,s){if(Ye.has(s)){const n=hn(s);return n&&n.default||0}else{const n=Cd(t),o=(Hr(s)?n.getPropertyValue(s):n[s])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(t,{transformPagePoint:s}){return Go(t,s)}build(t,s,n,o){tn(t,s,n,o.transformTemplate)}scrapeMotionValuesFromProps(t,s){return on(t,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;pe(t)&&(this.childSubscription=t.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}renderInstance(t,s,n,o){Kr(t,s,n,o)}}class kd extends ni{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,s){return t[s]}readValueFromInstance(t,s){if(Ye.has(s)){const n=hn(s);return n&&n.default||0}return s=Yr.has(s)?s:Ys(s),t.getAttribute(s)}measureInstanceViewportBox(){return de()}scrapeMotionValuesFromProps(t,s){return Jr(t,s)}build(t,s,n,o){nn(t,s,n,this.isSVGTag,o.transformTemplate)}renderInstance(t,s,n,o){Zr(t,s,n,o)}mount(t){this.isSVGTag=rn(t.tagName),super.mount(t)}}const Pd=(e,t)=>en(e)?new kd(t,{enableHardwareAcceleration:!1}):new Td(t,{enableHardwareAcceleration:!0}),Md={layout:{ProjectionNode:Qo,MeasureLayout:Wo}},Rd={...sc,...ja,...ad,...Md},G=Ai((e,t)=>ca(e,t,Rd,Pd));function ri(){const e=g.useRef(!1);return Ks(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Ad(){const e=ri(),[t,s]=g.useState(0),n=g.useCallback(()=>{e.current&&s(t+1)},[t]);return[g.useCallback(()=>ne.postRender(n),[n]),t]}class Ed extends g.Component{getSnapshotBeforeUpdate(t){const s=this.props.childRef.current;if(s&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=s.offsetHeight||0,n.width=s.offsetWidth||0,n.top=s.offsetTop,n.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Vd({children:e,isPresent:t}){const s=g.useId(),n=g.useRef(null),o=g.useRef({width:0,height:0,top:0,left:0});return g.useInsertionEffect(()=>{const{width:i,height:a,top:l,left:c}=o.current;if(t||!n.current||!i||!a)return;n.current.dataset.motionPopId=s;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),g.createElement(Ed,{isPresent:t,childRef:n,sizeRef:o},g.cloneElement(e,{ref:n}))}const Ts=({children:e,initial:t,isPresent:s,onExitComplete:n,custom:o,presenceAffectsLayout:i,mode:a})=>{const l=Qr(Dd),c=g.useId(),d=g.useMemo(()=>({id:c,initial:t,isPresent:s,custom:o,onExitComplete:u=>{l.set(u,!0);for(const h of l.values())if(!h)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),i?void 0:[s]);return g.useMemo(()=>{l.forEach((u,h)=>l.set(h,!1))},[s]),g.useEffect(()=>{!s&&!l.size&&n&&n()},[s]),a==="popLayout"&&(e=g.createElement(Vd,{isPresent:s},e)),g.createElement(os.Provider,{value:d},e)};function Dd(){return new Map}function Ld(e){return g.useEffect(()=>()=>e(),[])}const We=e=>e.key||"";function Id(e,t){e.forEach(s=>{const n=We(s);t.set(n,s)})}function Fd(e){const t=[];return g.Children.forEach(e,s=>{g.isValidElement(s)&&t.push(s)}),t}const be=({children:e,custom:t,initial:s=!0,onExitComplete:n,exitBeforeEnter:o,presenceAffectsLayout:i=!0,mode:a="sync"})=>{const l=g.useContext(Qs).forceRender||Ad()[0],c=ri(),d=Fd(e);let u=d;const h=g.useRef(new Map).current,p=g.useRef(u),x=g.useRef(new Map).current,w=g.useRef(!0);if(Ks(()=>{w.current=!1,Id(d,x),p.current=u}),Ld(()=>{w.current=!0,x.clear(),h.clear()}),w.current)return g.createElement(g.Fragment,null,u.map(k=>g.createElement(Ts,{key:We(k),isPresent:!0,initial:s?void 0:!1,presenceAffectsLayout:i,mode:a},k)));u=[...u];const v=p.current.map(We),j=d.map(We),E=v.length;for(let k=0;k<E;k++){const C=v[k];j.indexOf(C)===-1&&!h.has(C)&&h.set(C,void 0)}return a==="wait"&&h.size&&(u=[]),h.forEach((k,C)=>{if(j.indexOf(C)!==-1)return;const L=x.get(C);if(!L)return;const V=v.indexOf(C);let M=k;if(!M){const F=()=>{h.delete(C);const $=Array.from(x.keys()).filter(R=>!j.includes(R));if($.forEach(R=>x.delete(R)),p.current=d.filter(R=>{const y=We(R);return y===C||$.includes(y)}),!h.size){if(c.current===!1)return;l(),n&&n()}};M=g.createElement(Ts,{key:We(L),isPresent:!1,onExitComplete:F,custom:t,presenceAffectsLayout:i,mode:a},L),h.set(C,M)}u.splice(V,0,M)}),u=u.map(k=>{const C=k.key;return h.has(C)?k:g.createElement(Ts,{key:We(k),isPresent:!0,presenceAffectsLayout:i,mode:a},k)}),g.createElement(g.Fragment,null,h.size?u:u.map(k=>g.cloneElement(k)))};function oi(e){var t,s,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(s=oi(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}function ae(){for(var e,t,s=0,n="",o=arguments.length;s<o;s++)(e=arguments[s])&&(t=oi(e))&&(n&&(n+=" "),n+=t);return n}const Bd=({game:e})=>{const t=e.status==="available",s=e.status==="coming-soon",n=e.status==="maintenance",o=r.jsxs(G.div,{whileHover:t?{scale:1.02}:{},whileTap:t?{scale:.98}:{},className:ae("relative h-full bg-gray-800 rounded-xl border-2 overflow-hidden transition-all duration-300",{"border-gray-700 hover:border-purple-500 cursor-pointer shadow-lg hover:shadow-purple-500/20":t,"border-gray-700 opacity-75 cursor-not-allowed":s,"border-orange-600 opacity-75 cursor-not-allowed":n}),children:[(s||n)&&r.jsx("div",{className:"absolute top-2 right-2 z-10",children:r.jsx("span",{className:ae("px-2 py-1 text-xs sm:px-3 sm:text-xs font-pixel rounded-full",{"bg-blue-600 text-white":s,"bg-orange-600 text-white":n}),children:s?"即将推出":"维护中"})}),r.jsx("div",{className:"h-24 sm:h-32 bg-gradient-to-br from-purple-900/50 to-pink-900/50 flex items-center justify-center",children:r.jsx("span",{className:"text-4xl sm:text-6xl",children:e.image})}),r.jsxs("div",{className:"p-3 sm:p-4 space-y-2 sm:space-y-3",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-game font-bold text-white",children:e.title}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400 line-clamp-2",children:e.description}),r.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:e.tags.map(i=>r.jsx("span",{className:"px-1.5 py-0.5 sm:px-2 sm:py-1 text-xs bg-gray-700 text-gray-300 rounded-md",children:i},i))}),r.jsxs("div",{className:"pt-2 sm:pt-3 border-t border-gray-700 grid grid-cols-3 gap-1 sm:gap-2 text-xs text-gray-500",children:[r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"难度"}),r.jsx("div",{className:ae("text-xs",{"text-green-400":e.difficulty==="简单","text-yellow-400":e.difficulty==="中等","text-red-400":e.difficulty==="困难"}),children:e.difficulty})]}),r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"玩家"}),r.jsx("div",{className:"text-xs",children:e.players})]}),r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"时长"}),r.jsx("div",{className:"text-xs",children:e.time})]})]}),t&&r.jsx("button",{className:"w-full mt-3 sm:mt-4 px-3 py-2 sm:px-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-game text-xs sm:text-sm rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all active:scale-95",children:"开始游戏"})]})]});return t?r.jsx(As,{to:e.path,children:o}):o},Od=()=>{const[e,t]=g.useState(0),[s,n]=g.useState(!1),[o,i]=g.useState(null);return g.useEffect(()=>{let a;a="http://socket.qingfengyueying.xyz/stats",console.log("[OnlineStats] 正在连接到:",a);const l=Xs(a,{transports:["websocket","polling"],upgrade:!0,timeout:1e4,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3});return l.on("connect",()=>{console.log("[OnlineStats] 连接成功, Socket ID:",l.id),n(!0),l.emit("get-online-count")}),l.on("online-count",c=>{console.log("[OnlineStats] 收到在线人数:",c.count),t(c.count||0)}),l.on("user-count-update",c=>{console.log("[OnlineStats] 在线人数更新:",c.count),t(c.count||0)}),l.on("connect_error",c=>{console.error("[OnlineStats] 连接错误:",c.message),n(!1)}),l.on("disconnect",c=>{console.log("[OnlineStats] 连接断开, 原因:",c),n(!1)}),l.on("reconnect",c=>{console.log("[OnlineStats] 重连成功, 尝试次数:",c),n(!0),l.emit("get-online-count")}),l.on("reconnect_failed",()=>{console.error("[OnlineStats] 重连失败"),n(!1),t(Math.floor(Math.random()*30)+5)}),i(l),()=>{console.log("[OnlineStats] 清理Socket连接"),l&&l.disconnect()}},[]),{onlineCount:e,isConnected:s,socket:o}},Nr=[{id:"gomoku",title:"五子棋",description:"经典双人对战游戏",image:"♟️",path:"/games/gomoku",tags:["双人","策略","PVP"],difficulty:"简单",players:"2人",time:"10-20分钟",status:"available"},{id:"2048",title:"2048",description:"数字合并益智游戏",image:"🔢",path:"/games/2048",tags:["单人","益智","策略"],difficulty:"中等",players:"1人",time:"10-30分钟",status:"available"},{id:"snake",title:"贪吃蛇",description:"经典贪吃蛇游戏",image:"🐍",path:"/games/snake",tags:["单人","休闲","经典"],difficulty:"简单",players:"1人",time:"5-10分钟",status:"available"},{id:"tetris",title:"俄罗斯方块",description:"经典方块消除游戏",image:"🎮",path:"/games/tetris",tags:["单人","休闲","经典"],difficulty:"中等",players:"1人",time:"无限",status:"available"},{id:"tictactoe",title:"井字棋",description:"简单有趣的对战游戏",image:"❌",path:"/games/tictactoe",tags:["双人","策略","PVP"],difficulty:"简单",players:"1-2人",time:"2-5分钟",status:"available"},{id:"memory",title:"记忆翻牌",description:"考验记忆力的配对游戏",image:"🎴",path:"/games/memory",tags:["单人","益智","记忆"],difficulty:"简单",players:"1人",time:"5-10分钟",status:"available"},{id:"sudoku",title:"数独",description:"经典数字填空游戏",image:"🔢",path:"/games/sudoku",tags:["单人","益智","逻辑"],difficulty:"困难",players:"1人",time:"15-30分钟",status:"available"},{id:"breakout",title:"打砖块",description:"经典弹球消除游戏",image:"🧱",path:"/games/breakout",tags:["单人","休闲","经典"],difficulty:"中等",players:"1人",time:"10-20分钟",status:"available"}],zd=()=>{const[e,t]=g.useState("全部"),{onlineCount:s,isConnected:n}=Od(),o=["全部","双人","单人","策略","休闲","益智"],i=g.useMemo(()=>e==="全部"?Nr:Nr.filter(l=>l.tags.includes(e)),[e]),a=g.useMemo(()=>({available:i.filter(l=>l.status==="available").length,comingSoon:i.filter(l=>l.status==="coming-soon").length,onlineUsers:s}),[i,s]);return r.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[r.jsxs(G.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center space-y-4 sm:space-y-6",children:[r.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-game font-bold",children:r.jsx("span",{className:"bg-gradient-to-r from-purple-400 via-pink-400 to-red-400 bg-clip-text text-transparent",children:"游戏合集"})}),r.jsx("p",{className:"text-base sm:text-xl text-gray-400 font-game px-4",children:"精选经典小游戏，随时随地享受游戏乐趣"}),r.jsxs("div",{className:"flex justify-center gap-3 sm:gap-8 mt-6 sm:mt-8 px-4",children:[r.jsxs(G.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsx("div",{className:"text-xl sm:text-3xl font-bold text-purple-400",children:a.available}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"可玩游戏"})]}),r.jsxs(G.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsx("div",{className:"text-xl sm:text-3xl font-bold text-pink-400",children:a.comingSoon}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"即将推出"})]}),r.jsxs(G.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsxs("div",{className:"text-xl sm:text-3xl font-bold text-blue-400 flex items-center justify-center gap-1",children:[a.onlineUsers,n&&r.jsx("span",{className:"inline-block w-2 h-2 bg-green-400 rounded-full animate-pulse"})]}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"在线玩家"})]})]})]}),r.jsx("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3 px-4",children:o.map((l,c)=>r.jsx(G.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:c*.1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(l),className:`px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all
              ${l===e?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white border border-gray-700"}`,children:l},l))}),r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:i.length>0?i.map((l,c)=>r.jsx(G.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:c*.1},children:r.jsx(Bd,{game:l})},l.id)):r.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},className:"col-span-full text-center py-12",children:[r.jsxs("p",{className:"text-gray-400 text-lg",children:['没有找到"',e,'"类型的游戏']}),r.jsx("button",{onClick:()=>t("全部"),className:"mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"查看全部游戏"})]})}),r.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-12 sm:mt-16 grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6",children:[r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"🎮"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-purple-400",children:"精选游戏"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"精心挑选的经典游戏，保证游戏质量和趣味性"})]}),r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"🌐"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-pink-400",children:"在线对战"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"支持实时在线对战，与好友一起享受游戏乐趣"})]}),r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"📱"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-blue-400",children:"跨平台"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"完美适配手机和电脑，随时随地开始游戏"})]})]})]})},Ws=13,Sr=["快乐的","聪明的","勇敢的","可爱的","厉害的","机智的","活泼的","霸气的","淡定的","优雅的","神秘的","幸运的","专注的","认真的","潇洒的","冷静的"],Cr=["熊猫","狐狸","老虎","狮子","兔子","猫咪","狗狗","猴子","企鹅","海豚","鲸鱼","老鹰","凤凰","龙龙","独角兽","考拉"],yt=()=>Array(Ws).fill(null).map(()=>Array(Ws).fill(0)),oe=pi((e,t)=>({board:yt(),boardSize:Ws,currentPlayer:1,myColor:null,gameState:"waiting",winner:null,lastMove:null,winningLine:null,userRole:null,spectatorCount:0,myNickname:null,opponentNickname:null,blackNickname:null,whiteNickname:null,history:[],canUndo:!1,score:{black:0,white:0},roundNumber:1,firstPlayer:1,roomId:null,isHost:!1,opponentName:null,notifications:[],initBoard:()=>{const{roundNumber:s}=t(),n=s%2===1?1:2;e({board:yt(),currentPlayer:n,winner:null,lastMove:null,winningLine:null,gameState:"waiting",history:[],canUndo:!1,firstPlayer:n})},makeMove:(s,n)=>{const{board:o,currentPlayer:i,gameState:a,myColor:l,boardSize:c,userRole:d}=t();if(a!=="playing"||d==="spectator"||i!==l||s<0||s>=c||n<0||n>=c||o[s][n]!==0)return!1;const u=o.map(x=>[...x]);u[s][n]=i;const h=t().checkWin(s,n,i),p=h!==null;return t().addHistory(i,{row:s,col:n}),e({board:u,lastMove:{row:s,col:n},currentPlayer:i===1?2:1,winner:p?i:null,winningLine:h,gameState:p?"finished":"playing",canUndo:!0}),p&&t().updateScore(i),!0},setPlayerColor:s=>{e({myColor:s})},setGameState:s=>{e({gameState:s})},setRoomInfo:(s,n)=>{e({roomId:s,isHost:n})},resetGame:()=>{e({board:yt(),currentPlayer:1,myColor:null,gameState:"waiting",winner:null,lastMove:null,winningLine:null,roomId:null,isHost:!1,history:[],canUndo:!1,opponentName:null,notifications:[],score:{black:0,white:0},roundNumber:1,firstPlayer:1,userRole:null,spectatorCount:0,myNickname:null,opponentNickname:null,blackNickname:null,whiteNickname:null})},checkWin:(s,n,o)=>{const{board:i,boardSize:a}=t(),l=[[[0,1],[0,-1]],[[1,0],[-1,0]],[[1,1],[-1,-1]],[[1,-1],[-1,1]]];for(const c of l){const d=[{row:s,col:n}];for(const[u,h]of c){let p=s+u,x=n+h;for(;p>=0&&p<a&&x>=0&&x<a&&i[p][x]===o;)d.push({row:p,col:x}),p+=u,x+=h}if(d.length>=5)return d}return null},addNotification:(s,n)=>{const o={id:Math.random().toString(36).substr(2,9),type:s,message:n,timestamp:Date.now()};e(i=>({notifications:[...i.notifications,o]})),setTimeout(()=>{t().removeNotification(o.id)},5e3)},removeNotification:s=>{e(n=>({notifications:n.notifications.filter(o=>o.id!==s)}))},updateScore:s=>{e(n=>({score:{...n.score,[s===1?"black":"white"]:n.score[s===1?"black":"white"]+1}}))},nextRound:()=>{e(s=>{const n=s.roundNumber+1,o=n%2===1?1:2;return{board:yt(),currentPlayer:o,winner:null,lastMove:null,winningLine:null,gameState:"playing",history:[],canUndo:!1,roundNumber:n,firstPlayer:o}})},setOpponentName:s=>{e({opponentName:s})},addHistory:(s,n)=>{e(o=>({history:[...o.history,{player:s,position:n,timestamp:Date.now()}]}))},setCanUndo:s=>{e({canUndo:s})},undoMove:()=>{const{history:s}=t();if(s.length<2)return;const n=s.slice(0,-2),o=yt();n.forEach(l=>{o[l.position.row][l.position.col]=l.player});const i=n.length>0?n[n.length-1].player===1?2:1:t().firstPlayer,a=n.length>0?n[n.length-1].position:null;e({board:o,history:n,currentPlayer:i,lastMove:a,canUndo:!1,winningLine:null})},setWinningLine:s=>{e({winningLine:s})},setUserRole:s=>{e({userRole:s})},setSpectatorCount:s=>{e({spectatorCount:s})},canMakeMove:()=>{const{userRole:s,myColor:n,currentPlayer:o,gameState:i}=t();return s==="player"&&n===o&&i==="playing"},setMyNickname:s=>{e({myNickname:s})},setOpponentNickname:s=>{e({opponentNickname:s})},setBlackWhiteNicknames:(s,n)=>{e({blackNickname:s,whiteNickname:n})},generateRandomNickname:()=>{const s=Sr[Math.floor(Math.random()*Sr.length)],n=Cr[Math.floor(Math.random()*Cr.length)],o=Math.floor(Math.random()*100);return`${s}${n}${o}`}}));let Y=null,He=!1;const hs=()=>{const[e,t]=g.useState(He),{setGameState:s,setPlayerColor:n,initBoard:o,addNotification:i,nextRound:a,undoMove:l,setCanUndo:c,setWinningLine:d,setUserRole:u,userRole:h,setOpponentNickname:p,setBlackWhiteNicknames:x}=oe();return g.useEffect(()=>{if(Y)t(He);else{let R;R="http://socket.qingfengyueying.xyz",console.log("Attempting to connect to:",R),Y=Xs(R,{transports:["websocket","polling"],upgrade:!0,path:"/socket.io/",timeout:1e4,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),Y.on("connect",()=>{console.log("Socket connected to:",R),He=!0,t(!0)}),Y.on("disconnect",()=>{console.log("Socket disconnected"),He=!1,t(!1),i("warning","与服务器断开连接")}),Y.on("connect_error",y=>{console.error("Socket connection error:",y),He=!1,t(!1)}),Y.on("reconnect",y=>{console.log("Socket reconnected after",y,"attempts"),He=!0,t(!0),i("success","重新连接成功")}),Y.on("reconnect_error",y=>{console.error("Socket reconnection error:",y),He=!1,t(!1)}),Y.on("game-start",y=>{console.log("Game started, my color:",y.playerColor,"opponent:",y.opponentId),console.log("Before state update - gameState:",oe.getState().gameState),y.opponentNickname&&p(y.opponentNickname),n(y.playerColor),o(),s("playing"),i("success","🎯 游戏开始！"),console.log("After state update - gameState:",oe.getState().gameState),console.log("After state update - myColor:",oe.getState().myColor)}),Y.on("game-start-spectator",y=>{console.log("Game started for spectator, black:",y.blackPlayer,"white:",y.whitePlayer),(y.blackNickname||y.whiteNickname)&&x(y.blackNickname||null,y.whiteNickname||null),o(),s("playing"),i("info","🎯 游戏已开始，你正在观战")}),Y.on("role-changed",y=>{console.log("Role changed to:",y.role),u(y.role),y.role==="spectator"?(n(null),i("info","👁️ 你现在是观众")):i("success","🎮  你现在是玩家")}),Y.on("user-role-changed",y=>{y.wasSurrender?i("info","🏳️ 一位玩家认输并成为观众"):y.role==="player"?i("info","👥 一位观众成为了玩家"):i("info","👁️ 一位玩家成为了观众")}),Y.on("role-change-error",y=>{console.error("Role change error:",y.message),i("error",`❌ ${y.message}`)}),Y.on("ready-prompt",()=>{console.log("Ready prompt received"),Y&&Y.emit("ready-to-play")}),Y.on("game-move",y=>{console.log("Game move for spectator:",y);const A=oe.getState();if(A.userRole!=="spectator")return;const N=A.board.map(f=>[...f]);N[y.row][y.col]=A.currentPlayer;const P=A.checkWin(y.row,y.col,A.currentPlayer),S=P!==null;A.addHistory(A.currentPlayer,{row:y.row,col:y.col}),oe.setState({board:N,lastMove:{row:y.row,col:y.col},currentPlayer:A.currentPlayer===1?2:1,winner:S?A.currentPlayer:null,winningLine:P,gameState:S?"finished":"playing"}),S&&A.updateScore(A.currentPlayer)}),Y.on("room-created",y=>{console.log("Room created:",y),i("success",`✅ 房间 ${y.roomId} 创建成功`)}),Y.on("room-joined",y=>{console.log("Room joined:",y),i("success",`✅ 已加入房间 ${y.roomId}`),Y&&(console.log("Auto-readying for game start..."),Y.emit("ready-to-play"))}),Y.on("spectator-joined",y=>{console.log("Joined as spectator:",y),i("info",`👁️ 已以观众身份加入房间 ${y.roomId}`)}),Y.on("room-error",y=>{console.error("Room error:",y.message),i("error",`❌ ${y.message}`)}),Y.on("room-list",y=>{console.log("Room list updated:",y)}),Y.on("opponent-move",y=>{console.log("Opponent made move:",y);const A=oe.getState();if(A.userRole!=="player")return;const N=A.board.map(f=>[...f]);N[y.row][y.col]=A.currentPlayer;const P=A.checkWin(y.row,y.col,A.currentPlayer),S=P!==null;A.addHistory(A.currentPlayer,{row:y.row,col:y.col}),oe.setState({board:N,lastMove:{row:y.row,col:y.col},currentPlayer:A.currentPlayer===1?2:1,winner:S?A.currentPlayer:null,winningLine:P,gameState:S?"finished":"playing",canUndo:!0}),S&&A.updateScore(A.currentPlayer)}),Y.on("game-restart",()=>{console.log("Game restart - both players agreed"),a(),s("playing"),i("success","🎮 游戏已重新开始")}),Y.on("undo-move",()=>{console.log("Undo move - both players agreed"),l(),i("info","↩️ 已悔棋")}),Y.on("opponent-nickname",y=>{console.log("Received opponent nickname:",y.nickname),p(y.nickname)}),Y.on("all-nicknames",y=>{console.log("Received all nicknames:",y);const A=Y==null?void 0:Y.id;if(!A)return;if(oe.getState().userRole==="player"){for(const[P,S]of Object.entries(y))if(P!==A){p(S);break}}}),Y.on("user-nickname-update",y=>{console.log("User nickname updated:",y.userId,y.nickname);const A=Y==null?void 0:Y.id;if(!A)return;oe.getState().userRole==="player"&&y.userId!==A&&p(y.nickname)}),Y.on("sync-game-state",y=>{console.log("Syncing game state for spectator:",y);const A=oe.getState();if(A.userRole==="spectator"){if(x(y.blackNickname,y.whiteNickname),y.gameState&&y.gameState.board){const N=y.gameState.board,P=y.gameState.currentPlayer;oe.setState({board:N,currentPlayer:P,lastMove:y.gameState.lastMove,gameState:"playing"}),y.gameState.history.forEach(S=>{const f=N[S.row][S.col];(f===1||f===2)&&A.addHistory(f,{row:S.row,col:S.col})})}console.log(`黑棋: ${y.blackNickname}, 白棋: ${y.whiteNickname}`)}})}return()=>{}},[s,n,o,i,a,l,c,d,u,h,p,x]),{socket:Y,connected:e,sendMove:(R,y,A)=>{Y&&(console.log("Sending move:",{roomId:R,row:y,col:A}),Y.emit("make-move",{roomId:R,row:y,col:A}))},requestRestart:R=>{Y&&(console.log("Requesting restart:",R),Y.emit("request-restart",{roomId:R}))},acceptRestart:R=>{Y&&(console.log("Accepting restart:",R),Y.emit("accept-restart",{roomId:R}))},rejectRestart:R=>{Y&&(console.log("Rejecting restart:",R),Y.emit("reject-restart",{roomId:R}))},requestUndo:R=>{Y&&(console.log("Requesting undo:",R),Y.emit("request-undo",{roomId:R}))},acceptUndo:R=>{Y&&(console.log("Accepting undo:",R),Y.emit("accept-undo",{roomId:R}))},rejectUndo:R=>{Y&&(console.log("Rejecting undo:",R),Y.emit("reject-undo",{roomId:R}))},surrender:(R,y)=>{Y&&(console.log("Surrendering:",R,"myColor:",y),Y.emit("surrender",{roomId:R,surrenderColor:y}))},sendChatMessage:(R,y)=>{Y&&(console.log("Sending chat message:",{roomId:R,message:y}),Y.emit("chat-message",{roomId:R,message:y}))},spectatorToPlayer:()=>{Y&&(console.log("Requesting to become player"),Y.emit("spectator-to-player"))},playerToSpectator:()=>{Y&&(console.log("Requesting to become spectator"),Y.emit("player-to-spectator"))}}},Tr=()=>{const e=g.useRef(null),t=g.useRef(null),s=g.useRef(null),[n,o]=g.useState(40),[i,a]=g.useState(520),[l,c]=g.useState(1),[d,u]=g.useState(null),{board:h,currentPlayer:p,gameState:x,makeMove:w,myColor:v,roomId:j,lastMove:E,winningLine:k}=oe(),{sendMove:C}=hs(),L=h.length;g.useEffect(()=>{const f=()=>{const O=window.innerWidth,_=window.innerHeight,K=window.devicePixelRatio||1;if(O<640){const I=O-15,z=_-15-25-25-15,U=Math.min(I,z),W=Math.min(U,I*.95),Z=Math.floor(W/L),te=Z*L;o(Z),a(te),c(K),console.log("Mobile board size:",{viewport:{width:O,height:_},available:{width:I,height:z},target:W,cell:Z,board:te})}else{const D=_-30-35-30,I=Math.min(580,D*.9),z=180*2,U=O-z-60,W=Math.min(I,U,D*.9),Z=Math.floor(W/L),te=Z*L;o(Z),a(te),c(K),console.log("PC board size:",{viewport:{width:O,height:_},availableHeight:D,availableWidth:U,target:W,cell:Z,board:te})}};return f(),window.addEventListener("resize",f),window.addEventListener("orientationchange",f),()=>{window.removeEventListener("resize",f),window.removeEventListener("orientationchange",f)}},[L]);const V=(f,O)=>{const _=e.current,K=s.current;if(!_||!K)return null;const q=K.getBoundingClientRect(),b=window.getComputedStyle(K),m=parseInt(b.paddingLeft)||0,T=parseInt(b.paddingTop)||0,D=f-q.left-m,I=O-q.top-T,z=Math.floor(D/n),U=Math.floor(I/n);return U>=0&&U<L&&z>=0&&z<L?{row:U,col:z}:null},M=f=>{const O=i*l;f.clearRect(0,0,O,O),f.save(),f.scale(l,l);const _=f.createLinearGradient(0,0,i,i);_.addColorStop(0,"#D4A574"),_.addColorStop(.3,"#C19A6B"),_.addColorStop(.6,"#CD9B62"),_.addColorStop(1,"#B8956A"),f.fillStyle=_,f.fillRect(0,0,i,i),f.globalAlpha=.1;for(let q=0;q<50;q++){f.strokeStyle="#8B7355",f.lineWidth=Math.random()*2,f.beginPath();const b=Math.random()*i;f.moveTo(0,b),f.bezierCurveTo(i*.3,b+Math.random()*20-10,i*.7,b+Math.random()*20-10,i,b+Math.random()*10-5),f.stroke()}f.globalAlpha=1,f.shadowColor="rgba(0, 0, 0, 0.3)",f.shadowBlur=2,f.shadowOffsetX=1,f.shadowOffsetY=1,f.strokeStyle="#2C1810",f.lineWidth=1.5;for(let q=0;q<L;q++){const b=q*n+n/2;f.beginPath(),f.moveTo(n/2,b),f.lineTo(i-n/2,b),f.stroke(),f.beginPath(),f.moveTo(b,n/2),f.lineTo(b,i-n/2),f.stroke()}f.shadowColor="transparent",f.shadowBlur=0,f.shadowOffsetX=0,f.shadowOffsetY=0;const K=[{row:3,col:3},{row:3,col:9},{row:9,col:3},{row:9,col:9},{row:6,col:6}];f.fillStyle="#1A0E08",K.forEach(q=>{if(q.row<L&&q.col<L){const b=q.col*n+n/2,m=q.row*n+n/2;f.beginPath(),f.arc(b,m,5,0,Math.PI*2),f.fill(),f.fillStyle="#2C1810",f.beginPath(),f.arc(b,m,3,0,Math.PI*2),f.fill(),f.fillStyle="#1A0E08"}}),f.restore()},F=(f,O,_,K,q=!1)=>{const b=_*n+n/2,m=O*n+n/2,T=n*.42;if(f.save(),f.scale(l,l),K===1){const D=f.createRadialGradient(b-T/3,m-T/3,0,b,m,T);D.addColorStop(0,"#4A4A4A"),D.addColorStop(.5,"#2C2C2C"),D.addColorStop(.8,"#1A1A1A"),D.addColorStop(1,"#000000"),f.shadowColor="rgba(0, 0, 0, 0.5)",f.shadowBlur=5,f.shadowOffsetX=2,f.shadowOffsetY=2,f.fillStyle=D,f.beginPath(),f.arc(b,m,T,0,Math.PI*2),f.fill();const I=f.createRadialGradient(b-T/3,m-T/3,0,b-T/3,m-T/3,T/2);I.addColorStop(0,"rgba(255, 255, 255, 0.3)"),I.addColorStop(1,"rgba(255, 255, 255, 0)"),f.fillStyle=I,f.beginPath(),f.arc(b,m,T,0,Math.PI*2),f.fill()}else{const D=f.createRadialGradient(b-T/3,m-T/3,0,b,m,T);D.addColorStop(0,"#FFFFFF"),D.addColorStop(.3,"#F8F8F8"),D.addColorStop(.7,"#E8E8E8"),D.addColorStop(1,"#D0D0D0"),f.shadowColor="rgba(0, 0, 0, 0.3)",f.shadowBlur=4,f.shadowOffsetX=2,f.shadowOffsetY=2,f.fillStyle=D,f.beginPath(),f.arc(b,m,T,0,Math.PI*2),f.fill(),f.strokeStyle="#B0B0B0",f.lineWidth=1,f.stroke();const I=f.createRadialGradient(b-T/4,m-T/4,0,b-T/4,m-T/4,T/3);I.addColorStop(0,"rgba(255, 255, 255, 0.9)"),I.addColorStop(1,"rgba(255, 255, 255, 0)"),f.fillStyle=I,f.beginPath(),f.arc(b,m,T,0,Math.PI*2),f.fill()}q&&(f.shadowColor="#FFD700",f.shadowBlur=15,f.strokeStyle="#FFD700",f.lineWidth=3,f.beginPath(),f.arc(b,m,T+5,0,Math.PI*2),f.stroke()),f.restore()},$=f=>{if(!E)return;f.save(),f.scale(l,l);const O=E.col*n+n/2,_=E.row*n+n/2,K=n*.2,q=n*.35,b=Date.now()/1e3,m=Math.sin(b*3)*.1+.9;f.strokeStyle="#FF6B6B",f.lineWidth=3,f.lineCap="round",f.globalAlpha=m,[{dx:-1,dy:-1},{dx:1,dy:-1},{dx:1,dy:1},{dx:-1,dy:1}].forEach(D=>{f.beginPath(),f.moveTo(O+D.dx*q,_+D.dy*q),f.lineTo(O+D.dx*(q-K),_+D.dy*q),f.moveTo(O+D.dx*q,_+D.dy*q),f.lineTo(O+D.dx*q,_+D.dy*(q-K)),f.stroke()}),f.restore()},R=f=>{if(!k||k.length<5)return;f.save(),f.scale(l,l);const O=k[0],_=k[k.length-1],K=O.col*n+n/2,q=O.row*n+n/2,b=_.col*n+n/2,m=_.row*n+n/2,T=Date.now()/100,D=T%20;f.strokeStyle="#FFD700",f.lineWidth=4,f.lineCap="round",f.shadowColor="#FFD700",f.shadowBlur=20,f.setLineDash([10,10]),f.lineDashOffset=-D,f.beginPath(),f.moveTo(K,q),f.lineTo(b,m),f.stroke();const I=5;for(let z=0;z<I;z++){const U=(T/10+z*20)%100/100,W=K+(b-K)*U,Z=q+(m-q)*U;f.fillStyle="#FFD700",f.globalAlpha=1-U,f.beginPath(),f.arc(W,Z,3+U*5,0,Math.PI*2),f.fill()}f.restore()},y=f=>{if(!d||x!=="playing"||p!==v||h[d.row][d.col]!==0)return;const O=i*l;f.clearRect(0,0,O,O),f.save(),f.scale(l,l);const _=d.col*n+n/2,K=d.row*n+n/2,q=n*.42,b=Date.now()/1e3,m=Math.sin(b*4)*.1+.9;if(f.globalAlpha=.5,p===1){const T=f.createRadialGradient(_,K,0,_,K,q*m);T.addColorStop(0,"rgba(0, 0, 0, 0.8)"),T.addColorStop(1,"rgba(0, 0, 0, 0.4)"),f.fillStyle=T}else{const T=f.createRadialGradient(_,K,0,_,K,q*m);T.addColorStop(0,"rgba(255, 255, 255, 0.9)"),T.addColorStop(1,"rgba(255, 255, 255, 0.5)"),f.fillStyle=T}f.beginPath(),f.arc(_,K,q*m,0,Math.PI*2),f.fill(),f.strokeStyle=p===1?"rgba(0, 0, 0, 0.3)":"rgba(255, 255, 255, 0.5)",f.lineWidth=2,f.beginPath(),f.arc(_,K,q*m+5,0,Math.PI*2),f.stroke(),f.restore()};g.useEffect(()=>{const f=e.current,O=f==null?void 0:f.getContext("2d");if(!O||!f)return;f.width=i*l,f.height=i*l,M(O),h.forEach((q,b)=>{q.forEach((m,T)=>{if(m!==0){const D=(k==null?void 0:k.some(I=>I.row===b&&I.col===T))||!1;F(O,b,T,m,D)}})}),$(O),R(O);let _;const K=()=>{$(O),R(O),_=requestAnimationFrame(K)};return(E||k)&&K(),()=>{_&&cancelAnimationFrame(_)}},[h,n,i,E,k,l]),g.useEffect(()=>{const f=t.current,O=f==null?void 0:f.getContext("2d");if(!O||!f)return;f.width=i*l,f.height=i*l,y(O);let _;const K=()=>{y(O),_=requestAnimationFrame(K)};return K(),()=>{cancelAnimationFrame(_)}},[d,h,x,p,v,n,i,l]);const A=f=>{if(x!=="playing"||p!==v)return;const O="touches"in f?f.touches[0].clientX:f.clientX,_="touches"in f?f.touches[0].clientY:f.clientY,K=V(O,_);if(!K)return;const{row:q,col:b}=K;h[q][b]===0&&(w(q,b),C&&j&&C(j,q,b),u(null))},N=f=>{const O=V(f.clientX,f.clientY);u(O)},P=()=>{u(null)},S=f=>{A(f)};return r.jsx(G.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},className:"inline-block",children:r.jsxs("div",{ref:s,className:"relative pixel-container p-1 sm:p-2 bg-gradient-to-br from-amber-900/20 to-amber-800/20",onClick:A,onMouseMove:N,onMouseLeave:P,onTouchStart:S,style:{cursor:x==="playing"&&p===v?"pointer":"not-allowed"},children:[r.jsx("canvas",{ref:e,style:{width:`${i}px`,height:`${i}px`,display:"block",imageRendering:"crisp-edges"}}),r.jsx("canvas",{ref:t,className:"absolute top-1 left-1 sm:top-2 sm:left-2 pointer-events-none",style:{width:`${i}px`,height:`${i}px`,imageRendering:"crisp-edges"}})]})})},$d=({onJoinRoom:e})=>{const[t,s]=g.useState(""),[n,o]=g.useState([]),[i,a]=g.useState(!1),{socket:l,connected:c}=hs(),{setRoomInfo:d,setUserRole:u,generateRandomNickname:h,setMyNickname:p}=oe();console.log("RoomManager - connected:",c,"socket:",l),g.useEffect(()=>{if(l)return l.on("room-list",j=>{o(j)}),l.on("room-created",j=>{const E=h();p(E),l.emit("set-nickname",{roomId:j.roomId,nickname:E}),d(j.roomId,j.isHost),u("player"),e(),a(!1)}),l.on("room-joined",j=>{const E=h();p(E),l.emit("set-nickname",{roomId:j.roomId,nickname:E}),d(j.roomId,j.isHost),u("player"),e(),a(!1)}),l.on("spectator-joined",j=>{const E=h();p(E),l.emit("set-nickname",{roomId:j.roomId,nickname:E}),d(j.roomId,!1),u("spectator"),e(),a(!1)}),l.on("room-error",j=>{console.error("房间操作错误:",j.message);const{addNotification:E}=oe.getState();E("error",`❌ ${j.message}`),a(!1)}),l.emit("get-rooms"),()=>{l.off("room-list"),l.off("room-created"),l.off("room-joined"),l.off("spectator-joined"),l.off("room-error")}},[l,e,d,u,h,p]);const x=()=>{if(!l||!c){alert("未连接到服务器");return}if(i){console.log("操作进行中，请稍候");return}a(!0),l.emit("create-room")},w=j=>{const E=j||t.trim();if(!E){alert("请输入房间ID");return}if(!l||!c){alert("未连接到服务器");return}if(i){console.log("操作进行中，请稍候");return}a(!0),l.emit("join-room",{roomId:E})},v=j=>{const E=j||t.trim();if(!E){alert("请输入房间ID");return}if(!l||!c){alert("未连接到服务器");return}if(i){console.log("操作进行中，请稍候");return}a(!0),l.emit("join-as-spectator",{roomId:E})};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs(G.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center",children:[r.jsx("h2",{className:"text-lg sm:text-xl font-game font-bold text-white",children:"五子棋房间管理"}),r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"创建新房间或加入现有房间开始游戏"})]}),r.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-gray-800 rounded-lg p-3 sm:p-4 space-y-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-purple-400",children:"创建新房间"}),r.jsx("button",{onClick:x,disabled:i||!c,className:"w-full pixel-btn bg-purple-600 hover:bg-purple-700 py-1.5 text-xs sm:text-sm",children:i?"创建中...":"创建房间"})]}),r.jsx("div",{className:"border-t border-gray-700"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-pink-400",children:"加入房间"}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("input",{type:"text",value:t,onChange:j=>s(j.target.value.toUpperCase()),onKeyPress:j=>j.key==="Enter"&&w(),placeholder:"输入房间ID",className:"w-full px-2 py-1 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-pink-400 focus:outline-none text-xs sm:text-sm",maxLength:6}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>w(),disabled:i||!c,className:"flex-1 pixel-btn bg-pink-600 hover:bg-pink-700 py-1 px-3 text-xs sm:text-sm",children:"加入游戏"}),r.jsx("button",{onClick:()=>v(),disabled:i||!c,className:"flex-1 pixel-btn bg-yellow-600 hover:bg-yellow-700 py-1 px-3 text-xs sm:text-sm",children:"观战"})]})]})]}),r.jsx("div",{className:"border-t border-gray-700"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-blue-400",children:"可用房间"}),r.jsx("div",{className:"space-y-1 max-h-32 sm:max-h-40 overflow-y-auto custom-scrollbar",children:n.length===0?r.jsx("p",{className:"text-gray-500 text-center py-2 text-xs sm:text-sm",children:"暂无可用房间"}):n.map(j=>r.jsxs(G.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between p-1.5 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-pixel text-yellow-400 text-xs sm:text-sm",children:j.id}),r.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:[j.playerCount,"/2 玩家"]})]}),r.jsxs("div",{className:"flex gap-1",children:[j.playerCount<2&&r.jsx("button",{onClick:()=>w(j.id),disabled:i,className:"px-2 py-0.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors",children:"加入"}),r.jsx("button",{onClick:()=>v(j.id),disabled:i,className:"px-2 py-0.5 bg-yellow-600 hover:bg-yellow-700 text-white text-xs rounded transition-colors",children:"观战"})]})]},j.id))})]})]}),r.jsx("div",{className:"text-center",children:r.jsx("span",{className:`text-xs ${c?"text-green-400":"text-red-400"}`,children:c?"✓ 已连接到服务器":"✗ 未连接到服务器"})})]})},wt=({color:e,size:t="medium",isActive:s=!1,className:n=""})=>{const o={small:"w-7 h-7 text-xs",medium:"w-10 h-10 text-sm",large:"w-12 h-12 text-base"},i=l=>l===1?"🐼":l===2?"🦊":"👤",a=l=>l===1?"bg-gradient-to-br from-gray-800 to-black text-white":l===2?"bg-gradient-to-br from-white to-gray-200 text-gray-800 border-2 border-gray-400":"bg-gray-600 text-gray-400";return r.jsxs(G.div,{className:ae(o[t],a(e),"rounded-full flex items-center justify-center shadow-lg font-bold relative",n),animate:s?{scale:[1,1.1,1]}:{},transition:s?{repeat:1/0,duration:2}:{},children:[r.jsx("span",{className:t==="small"?"text-sm":"text-lg",children:i(e)}),s&&r.jsx(G.div,{className:"absolute -bottom-1 -right-1 w-2.5 h-2.5 bg-green-400 rounded-full border-2 border-gray-900",animate:{scale:[.8,1.2,.8]},transition:{repeat:1/0,duration:1.5}}),r.jsx("div",{className:ae("absolute -top-1 -right-1 rounded-full shadow-md",t==="small"?"w-3 h-3":"w-4 h-4",e===1?"bg-gradient-to-br from-gray-700 to-black":e===2?"bg-gradient-to-br from-white to-gray-300 border border-gray-400":"hidden")})]})},ks=({side:e})=>{const{currentPlayer:t,gameState:s,myColor:n,score:o,roundNumber:i,winner:a,userRole:l,myNickname:c,opponentNickname:d,blackNickname:u,whiteNickname:h}=oe(),p=l==="spectator",x=p?1:n,w=p||n===1?2:n===2?1:null;return e==="left"?r.jsx("div",{className:"pixel-container bg-gradient-to-b from-gray-800/50 to-gray-900/50 p-2 w-44",children:r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("div",{className:`text-xs font-bold text-white px-2 py-0.5 rounded ${p?"bg-gray-600/20":"bg-green-600/20"}`,children:p?"黑方":"你的棋子"}),r.jsx(wt,{color:x,size:"medium",isActive:s==="playing"&&t===x}),!p&&c&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:c}),p&&u&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:u}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:`w-4 h-4 rounded-full shadow-lg ${x===1?"bg-gradient-to-br from-gray-800 to-black":x===2?"bg-gradient-to-br from-white to-gray-200 border border-gray-400":"bg-gray-600"}`}),r.jsx("span",{className:"text-sm font-game text-white",children:x===1?"黑棋":x===2?"白棋":"未定"})]}),r.jsxs("div",{className:"text-xs text-gray-300",children:["得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:x===1?o.black:x===2?o.white:0})]}),!p&&s==="playing"&&t===n&&r.jsx(G.div,{className:"text-green-400 font-pixel text-xs bg-green-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"🎯 你的回合"}),p&&s==="playing"&&t===1&&r.jsx(G.div,{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"黑棋思考中"}),p&&s==="waiting"&&r.jsx(G.div,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待开局"}),p&&s==="finished"&&a===1&&r.jsx(G.div,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:"⚫ 黑棋获胜"})]})}):e==="right"?r.jsx("div",{className:"pixel-container bg-gradient-to-b from-gray-800/50 to-gray-900/50 p-2 w-44",children:r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("div",{className:"text-xs text-gray-400",children:p?"白方":"对手棋子"}),r.jsx(wt,{color:w,size:"medium",isActive:s==="playing"&&t===w}),!p&&d&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:d}),p&&h&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:h}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:`w-4 h-4 rounded-full shadow-lg ${w===1?"bg-gradient-to-br from-gray-800 to-black":w===2?"bg-gradient-to-br from-white to-gray-200 border border-gray-400":"bg-gray-600"}`}),r.jsx("span",{className:"text-sm font-game text-white",children:w===1?"黑棋":w===2?"白棋":"未定"})]}),r.jsxs("div",{className:"text-xs text-gray-300",children:["得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:w===1?o.black:w===2?o.white:0})]}),r.jsxs("div",{className:"text-gray-400 font-game bg-gray-800/50 px-2 py-0.5 rounded text-xs",children:["第 ",i," 回合"]}),s==="waiting"&&!p&&r.jsx(G.span,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待对手..."}),s==="waiting"&&p&&r.jsx(G.span,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待开局..."}),s==="playing"&&!p&&t!==n&&r.jsx("span",{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded",children:"对手思考中..."}),s==="playing"&&p&&t===2&&r.jsx(G.div,{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"白棋思考中"}),s==="finished"&&!p&&r.jsx(G.span,{className:`font-pixel text-xs px-2 py-0.5 rounded ${a===n?"text-yellow-400 bg-yellow-400/10 animate-glow":"text-gray-400 bg-gray-400/10"}`,initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:a===n?"🎉 你赢了！":"💪 再接再厉"}),s==="finished"&&p&&r.jsx(G.span,{className:"text-yellow-400 bg-yellow-400/10 font-pixel text-xs px-2 py-0.5 rounded",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:a===1?"⚫ 黑棋获胜":"⚪ 白棋获胜"})]})}):r.jsx(r.Fragment,{children:r.jsx("div",{className:"sm:hidden",children:r.jsxs("div",{className:"flex items-center justify-between px-1 py-0.5",children:[r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsx(wt,{color:p?1:n,size:"small",isActive:s==="playing"&&t===(p?1:n)}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[8px] text-gray-400",children:p?u||"黑方":c||"你"}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsx("span",{className:"font-game text-xs text-white",children:p||n===1?"黑":n===2?"白":"-"}),r.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",p||n===1?o.black:n===2?o.white:0,")"]})]})]})]}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:"text-[9px] text-gray-400 font-pixel",children:["第",i,"回合"]}),r.jsxs("div",{className:"text-[9px] mt-0",children:[s==="waiting"&&!p&&r.jsx("span",{className:"text-yellow-400 font-pixel animate-pulse",children:"等待对手"}),s==="waiting"&&p&&r.jsx("span",{className:"text-yellow-400 font-pixel animate-pulse",children:"等待开局"}),s==="playing"&&!p&&t===n&&r.jsx("span",{className:"text-green-400 font-pixel animate-pulse",children:"你的回合"}),s==="playing"&&!p&&t!==n&&r.jsx("span",{className:"text-blue-400 font-pixel",children:"对手思考"}),s==="playing"&&p&&r.jsx("span",{className:"text-blue-400 font-pixel",children:t===1?"黑棋思考":"白棋思考"}),s==="finished"&&r.jsx("span",{className:p||a===n?"text-yellow-400":"text-gray-400",children:p?a===1?"黑棋胜":"白棋胜":a===n?"你赢了":"再接再厉"})]})]}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[8px] text-gray-400",children:p?h||"白方":d||"对手"}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",p?o.white:w===1?o.black:w===2?o.white:0,")"]}),r.jsx("span",{className:"font-game text-xs text-white",children:p?"白":w===1?"黑":w===2?"白":"-"})]})]}),r.jsx(wt,{color:p?2:w,size:"small",isActive:s==="playing"&&t===(p?2:w)})]})]})})})},Ud=()=>{const{notifications:e,removeNotification:t}=oe();return r.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 pointer-events-none",children:r.jsx(be,{children:e.map(s=>r.jsx(G.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},transition:{duration:.3},className:ae("pixel-container p-3 min-w-[200px] max-w-[300px] pointer-events-auto cursor-pointer","backdrop-blur-sm shadow-lg",{"bg-blue-600/90 border-blue-400":s.type==="info","bg-green-600/90 border-green-400":s.type==="success","bg-yellow-600/90 border-yellow-400":s.type==="warning","bg-red-600/90 border-red-400":s.type==="error"}),onClick:()=>t(s.id),children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("div",{className:"text-white",children:[s.type==="info"&&"📢",s.type==="success"&&"✅",s.type==="warning"&&"⚠️",s.type==="error"&&"❌"]}),r.jsx("p",{className:"text-white text-sm font-game flex-1",children:s.message})]})},s.id))})})};var Vt={};(function e(t,s,n,o){var i=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",l=function(){if(!t.OffscreenCanvas)return!1;var b=new OffscreenCanvas(1,1),m=b.getContext("2d");m.fillRect(0,0,1,1);var T=b.transferToImageBitmap();try{m.createPattern(T,"no-repeat")}catch{return!1}return!0}();function c(){}function d(b){var m=s.exports.Promise,T=m!==void 0?m:t.Promise;return typeof T=="function"?new T(b):(b(c,c),null)}var u=function(b,m){return{transform:function(T){if(b)return T;if(m.has(T))return m.get(T);var D=new OffscreenCanvas(T.width,T.height),I=D.getContext("2d");return I.drawImage(T,0,0),m.set(T,D),D},clear:function(){m.clear()}}}(l,new Map),h=function(){var b=Math.floor(16.666666666666668),m,T,D={},I=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(m=function(z){var U=Math.random();return D[U]=requestAnimationFrame(function W(Z){I===Z||I+b-1<Z?(I=Z,delete D[U],z()):D[U]=requestAnimationFrame(W)}),U},T=function(z){D[z]&&cancelAnimationFrame(D[z])}):(m=function(z){return setTimeout(z,b)},T=function(z){return clearTimeout(z)}),{frame:m,cancel:T}}(),p=function(){var b,m,T={};function D(I){function z(U,W){I.postMessage({options:U||{},callback:W})}I.init=function(W){var Z=W.transferControlToOffscreen();I.postMessage({canvas:Z},[Z])},I.fire=function(W,Z,te){if(m)return z(W,null),m;var B=Math.random().toString(36).slice(2);return m=d(function(X){function H(Q){Q.data.callback===B&&(delete T[B],I.removeEventListener("message",H),m=null,u.clear(),te(),X())}I.addEventListener("message",H),z(W,B),T[B]=H.bind(null,{data:{callback:B}})}),m},I.reset=function(){I.postMessage({reset:!0});for(var W in T)T[W](),delete T[W]}}return function(){if(b)return b;if(!n&&i){var I=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{b=new Worker(URL.createObjectURL(new Blob([I])))}catch(z){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",z),null}D(b)}return b}}(),x={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function w(b,m){return m?m(b):b}function v(b){return b!=null}function j(b,m,T){return w(b&&v(b[m])?b[m]:x[m],T)}function E(b){return b<0?0:Math.floor(b)}function k(b,m){return Math.floor(Math.random()*(m-b))+b}function C(b){return parseInt(b,16)}function L(b){return b.map(V)}function V(b){var m=String(b).replace(/[^0-9a-f]/gi,"");return m.length<6&&(m=m[0]+m[0]+m[1]+m[1]+m[2]+m[2]),{r:C(m.substring(0,2)),g:C(m.substring(2,4)),b:C(m.substring(4,6))}}function M(b){var m=j(b,"origin",Object);return m.x=j(m,"x",Number),m.y=j(m,"y",Number),m}function F(b){b.width=document.documentElement.clientWidth,b.height=document.documentElement.clientHeight}function $(b){var m=b.getBoundingClientRect();b.width=m.width,b.height=m.height}function R(b){var m=document.createElement("canvas");return m.style.position="fixed",m.style.top="0px",m.style.left="0px",m.style.pointerEvents="none",m.style.zIndex=b,m}function y(b,m,T,D,I,z,U,W,Z){b.save(),b.translate(m,T),b.rotate(z),b.scale(D,I),b.arc(0,0,1,U,W,Z),b.restore()}function A(b){var m=b.angle*(Math.PI/180),T=b.spread*(Math.PI/180);return{x:b.x,y:b.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:b.startVelocity*.5+Math.random()*b.startVelocity,angle2D:-m+(.5*T-Math.random()*T),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:b.color,shape:b.shape,tick:0,totalTicks:b.ticks,decay:b.decay,drift:b.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:b.gravity*3,ovalScalar:.6,scalar:b.scalar,flat:b.flat}}function N(b,m){m.x+=Math.cos(m.angle2D)*m.velocity+m.drift,m.y+=Math.sin(m.angle2D)*m.velocity+m.gravity,m.velocity*=m.decay,m.flat?(m.wobble=0,m.wobbleX=m.x+10*m.scalar,m.wobbleY=m.y+10*m.scalar,m.tiltSin=0,m.tiltCos=0,m.random=1):(m.wobble+=m.wobbleSpeed,m.wobbleX=m.x+10*m.scalar*Math.cos(m.wobble),m.wobbleY=m.y+10*m.scalar*Math.sin(m.wobble),m.tiltAngle+=.1,m.tiltSin=Math.sin(m.tiltAngle),m.tiltCos=Math.cos(m.tiltAngle),m.random=Math.random()+2);var T=m.tick++/m.totalTicks,D=m.x+m.random*m.tiltCos,I=m.y+m.random*m.tiltSin,z=m.wobbleX+m.random*m.tiltCos,U=m.wobbleY+m.random*m.tiltSin;if(b.fillStyle="rgba("+m.color.r+", "+m.color.g+", "+m.color.b+", "+(1-T)+")",b.beginPath(),a&&m.shape.type==="path"&&typeof m.shape.path=="string"&&Array.isArray(m.shape.matrix))b.fill(_(m.shape.path,m.shape.matrix,m.x,m.y,Math.abs(z-D)*.1,Math.abs(U-I)*.1,Math.PI/10*m.wobble));else if(m.shape.type==="bitmap"){var W=Math.PI/10*m.wobble,Z=Math.abs(z-D)*.1,te=Math.abs(U-I)*.1,B=m.shape.bitmap.width*m.scalar,X=m.shape.bitmap.height*m.scalar,H=new DOMMatrix([Math.cos(W)*Z,Math.sin(W)*Z,-Math.sin(W)*te,Math.cos(W)*te,m.x,m.y]);H.multiplySelf(new DOMMatrix(m.shape.matrix));var Q=b.createPattern(u.transform(m.shape.bitmap),"no-repeat");Q.setTransform(H),b.globalAlpha=1-T,b.fillStyle=Q,b.fillRect(m.x-B/2,m.y-X/2,B,X),b.globalAlpha=1}else if(m.shape==="circle")b.ellipse?b.ellipse(m.x,m.y,Math.abs(z-D)*m.ovalScalar,Math.abs(U-I)*m.ovalScalar,Math.PI/10*m.wobble,0,2*Math.PI):y(b,m.x,m.y,Math.abs(z-D)*m.ovalScalar,Math.abs(U-I)*m.ovalScalar,Math.PI/10*m.wobble,0,2*Math.PI);else if(m.shape==="star")for(var ee=Math.PI/2*3,re=4*m.scalar,he=8*m.scalar,ge=m.x,ve=m.y,Pe=5,we=Math.PI/Pe;Pe--;)ge=m.x+Math.cos(ee)*he,ve=m.y+Math.sin(ee)*he,b.lineTo(ge,ve),ee+=we,ge=m.x+Math.cos(ee)*re,ve=m.y+Math.sin(ee)*re,b.lineTo(ge,ve),ee+=we;else b.moveTo(Math.floor(m.x),Math.floor(m.y)),b.lineTo(Math.floor(m.wobbleX),Math.floor(I)),b.lineTo(Math.floor(z),Math.floor(U)),b.lineTo(Math.floor(D),Math.floor(m.wobbleY));return b.closePath(),b.fill(),m.tick<m.totalTicks}function P(b,m,T,D,I){var z=m.slice(),U=b.getContext("2d"),W,Z,te=d(function(B){function X(){W=Z=null,U.clearRect(0,0,D.width,D.height),u.clear(),I(),B()}function H(){n&&!(D.width===o.width&&D.height===o.height)&&(D.width=b.width=o.width,D.height=b.height=o.height),!D.width&&!D.height&&(T(b),D.width=b.width,D.height=b.height),U.clearRect(0,0,D.width,D.height),z=z.filter(function(Q){return N(U,Q)}),z.length?W=h.frame(H):X()}W=h.frame(H),Z=X});return{addFettis:function(B){return z=z.concat(B),te},canvas:b,promise:te,reset:function(){W&&h.cancel(W),Z&&Z()}}}function S(b,m){var T=!b,D=!!j(m||{},"resize"),I=!1,z=j(m,"disableForReducedMotion",Boolean),U=i&&!!j(m||{},"useWorker"),W=U?p():null,Z=T?F:$,te=b&&W?!!b.__confetti_initialized:!1,B=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,X;function H(ee,re,he){for(var ge=j(ee,"particleCount",E),ve=j(ee,"angle",Number),Pe=j(ee,"spread",Number),we=j(ee,"startVelocity",Number),Lt=j(ee,"decay",Number),et=j(ee,"gravity",Number),ze=j(ee,"drift",Number),$e=j(ee,"colors",L),tt=j(ee,"ticks",Number),ft=j(ee,"shapes"),It=j(ee,"scalar"),Ft=!!j(ee,"flat"),mt=M(ee),pt=ge,st=[],me=b.width*mt.x,fs=b.height*mt.y;pt--;)st.push(A({x:me,y:fs,angle:ve,spread:Pe,startVelocity:we,color:$e[pt%$e.length],shape:ft[k(0,ft.length)],ticks:tt,decay:Lt,gravity:et,drift:ze,scalar:It,flat:Ft}));return X?X.addFettis(st):(X=P(b,st,Z,re,he),X.promise)}function Q(ee){var re=z||j(ee,"disableForReducedMotion",Boolean),he=j(ee,"zIndex",Number);if(re&&B)return d(function(we){we()});T&&X?b=X.canvas:T&&!b&&(b=R(he),document.body.appendChild(b)),D&&!te&&Z(b);var ge={width:b.width,height:b.height};W&&!te&&W.init(b),te=!0,W&&(b.__confetti_initialized=!0);function ve(){if(W){var we={getBoundingClientRect:function(){if(!T)return b.getBoundingClientRect()}};Z(we),W.postMessage({resize:{width:we.width,height:we.height}});return}ge.width=ge.height=null}function Pe(){X=null,D&&(I=!1,t.removeEventListener("resize",ve)),T&&b&&(document.body.contains(b)&&document.body.removeChild(b),b=null,te=!1)}return D&&!I&&(I=!0,t.addEventListener("resize",ve,!1)),W?W.fire(ee,ge,Pe):H(ee,ge,Pe)}return Q.reset=function(){W&&W.reset(),X&&X.reset()},Q}var f;function O(){return f||(f=S(null,{useWorker:!0,resize:!0})),f}function _(b,m,T,D,I,z,U){var W=new Path2D(b),Z=new Path2D;Z.addPath(W,new DOMMatrix(m));var te=new Path2D;return te.addPath(Z,new DOMMatrix([Math.cos(U)*I,Math.sin(U)*I,-Math.sin(U)*z,Math.cos(U)*z,T,D])),te}function K(b){if(!a)throw new Error("path confetti are not supported in this browser");var m,T;typeof b=="string"?m=b:(m=b.path,T=b.matrix);var D=new Path2D(m),I=document.createElement("canvas"),z=I.getContext("2d");if(!T){for(var U=1e3,W=U,Z=U,te=0,B=0,X,H,Q=0;Q<U;Q+=2)for(var ee=0;ee<U;ee+=2)z.isPointInPath(D,Q,ee,"nonzero")&&(W=Math.min(W,Q),Z=Math.min(Z,ee),te=Math.max(te,Q),B=Math.max(B,ee));X=te-W,H=B-Z;var re=10,he=Math.min(re/X,re/H);T=[he,0,0,he,-Math.round(X/2+W)*he,-Math.round(H/2+Z)*he]}return{type:"path",path:m,matrix:T}}function q(b){var m,T=1,D="#000000",I='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof b=="string"?m=b:(m=b.text,T="scalar"in b?b.scalar:T,I="fontFamily"in b?b.fontFamily:I,D="color"in b?b.color:D);var z=10*T,U=""+z+"px "+I,W=new OffscreenCanvas(z,z),Z=W.getContext("2d");Z.font=U;var te=Z.measureText(m),B=Math.ceil(te.actualBoundingBoxRight+te.actualBoundingBoxLeft),X=Math.ceil(te.actualBoundingBoxAscent+te.actualBoundingBoxDescent),H=2,Q=te.actualBoundingBoxLeft+H,ee=te.actualBoundingBoxAscent+H;B+=H+H,X+=H+H,W=new OffscreenCanvas(B,X),Z=W.getContext("2d"),Z.font=U,Z.fillStyle=D,Z.fillText(m,Q,ee);var re=1/T;return{type:"bitmap",bitmap:W.transferToImageBitmap(),matrix:[re,0,0,re,-B*re/2,-X*re/2]}}s.exports=function(){return O().apply(this,arguments)},s.exports.reset=function(){O().reset()},s.exports.create=S,s.exports.shapeFromPath=K,s.exports.shapeFromText=q})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Vt,!1);const Hd=Vt.exports;Vt.exports.create;const Gd=({isOpen:e,onRestart:t,onClose:s,waitingForOpponent:n=!1})=>{const{winner:o,myColor:i,score:a,userRole:l}=oe(),c=o===i,d=l==="spectator";return console.log("GameOverModal - winner:",o,"myColor:",i,"isWinner:",c,"userRole:",l),g.useEffect(()=>{if(e&&c&&!n&&!d){const u=()=>{Hd({particleCount:100,spread:70,origin:{y:.6}})};u();const h=setTimeout(u,200),p=setTimeout(u,400);return()=>{clearTimeout(h),clearTimeout(p)}}},[e,c,n,d]),r.jsx(be,{children:e&&r.jsxs(r.Fragment,{children:[r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",onClick:n?void 0:s}),r.jsx(G.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:400},className:"fixed inset-0 flex items-center justify-center z-50 p-4",onClick:u=>u.stopPropagation(),children:r.jsx("div",{className:"pixel-container bg-gray-900 p-6 sm:p-8 max-w-md w-full",children:n?r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-yellow-400 mx-auto"})}),r.jsx("h2",{className:"text-2xl font-game font-bold text-yellow-400 mb-4",children:"等待对手..."}),r.jsx("p",{className:"text-gray-300 mb-6",children:"已发送再来一局请求，等待对手同意"})]}):r.jsxs(r.Fragment,{children:[r.jsx(G.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"text-center mb-6",children:d?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-6xl mb-4",children:"🎮"}),r.jsx("h2",{className:"text-3xl font-game font-bold text-yellow-400 mb-2",children:"游戏结束"}),r.jsx("p",{className:"text-gray-300 text-xl",children:o===1?"黑棋获胜！":o===2?"白棋获胜！":"平局！"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-6xl mb-4",children:c?"🏆":"💪"}),r.jsx("h2",{className:ae("text-3xl font-game font-bold mb-2",c?"text-yellow-400 animate-glow":"text-gray-400"),children:c?"恭喜胜利！":"再接再厉！"}),r.jsx("p",{className:"text-gray-300",children:c?"你赢得了这局比赛！":"别灰心，下局再战！"})]})}),r.jsxs(G.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[r.jsx("div",{className:"text-center text-sm text-gray-400 mb-2",children:"当前比分"}),r.jsxs("div",{className:"flex items-center justify-center gap-6",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-800 to-black rounded-full shadow-lg"}),r.jsx("span",{className:"font-game text-2xl text-white",children:a.black})]}),r.jsx("div",{className:"text-gray-500 text-2xl",children:":"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-game text-2xl text-white",children:a.white}),r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-white to-gray-200 rounded-full border-2 border-gray-400 shadow-lg"})]})]}),r.jsx("div",{className:"text-center text-sm text-gray-400 mt-2",children:o===1?"黑棋获胜":o===2?"白棋获胜":"平局"})]}),r.jsxs("div",{className:"flex gap-3",children:[!d&&r.jsx(G.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"flex-1 pixel-btn bg-green-600 hover:bg-green-700 text-white py-3",children:"再来一局"}),r.jsx(G.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:s,className:ae("pixel-btn bg-gray-600 hover:bg-gray-700 text-white py-3",d?"w-full":"flex-1"),children:d?"关闭":"查看棋盘"})]})]})})})]})})},Ut=({isOpen:e,title:t,message:s,confirmText:n="同意",cancelText:o="拒绝",onConfirm:i,onCancel:a})=>r.jsx(be,{children:e&&r.jsxs(r.Fragment,{children:[r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50"}),r.jsx(G.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",damping:25,stiffness:400},className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none px-4",children:r.jsxs("div",{className:"pixel-container bg-gray-900 p-4 sm:p-6 max-w-sm w-full pointer-events-auto",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-game font-bold text-yellow-400 mb-3",children:t}),r.jsx("p",{className:"text-gray-300 mb-6 text-sm sm:text-base",children:s}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:i,className:"flex-1 pixel-btn bg-green-600 hover:bg-green-700 text-white py-2 text-sm sm:text-base",children:n}),r.jsx("button",{onClick:a,className:"flex-1 pixel-btn bg-red-600 hover:bg-red-700 text-white py-2 text-sm sm:text-base",children:o})]})]})})]})}),Ht=({onSendMessage:e,userRole:t=null,className:s=""})=>{const[n,o]=g.useState(!1),[i,a]=g.useState("emoji"),l=["😊","😎","🤔","😅","😂","😭","👍","👎","👏","🙏","💪","✌️","🎉","🎯","💯","🔥","⚡","🌟","😤","😮","😲","🤯","😱","🙈"],u=t==="spectator"?["黑棋加油！你是最棒的！","白棋必胜！冲冲冲！","精彩！这局真是太精彩了！","黑棋这步棋下得妙啊！","白棋好厉害，学到了！","这是高手过招啊！","快看快看，要分胜负了！","黑棋稳住，马上就赢了！","白棋反击！还有机会！","太刺激了，我都紧张了！","这局势焦灼啊，谁都有机会","黑棋防守！要小心了！","白棋进攻！就是现在！","神仙打架，我等凡人观战","这棋局值得收藏学习","前排围观，吃瓜看戏🍿","支持黑棋，黑棋YYDS！","白棋粉丝团在此应援！","大家好，我是新来的观众","求解说，看不懂局势了"]:["你好呀！一起来玩吧～","承让承让，侥幸而已！","哇，这步棋真是绝了！","厉害厉害，我要认真了！","再来一局，刚才手滑了～","让你见识见识什么叫高手！","我等到花儿都谢了...","快点啊，我等到天都黑了","容我想想，这步很关键","这一步妙啊，学到了！","你是高手，我甘拜下风","加油加油，你可以的！","哎呀，失误了失误了","看我的绝杀！","友谊第一，比赛第二～","GG，精彩的对局！","别走，决战到天亮！","你这是在针对我吗？","稳住，我们能赢！","今天手感不太好啊..."],h=p=>{e(p),o(!1)};return r.jsxs("div",{className:"relative inline-flex items-center",children:[r.jsxs(G.button,{onClick:()=>o(!n),className:ae("pixel-btn bg-purple-600 hover:bg-purple-700 text-white","px-2 py-1 sm:px-3 sm:py-2","text-[10px] sm:text-sm",s),whileHover:{scale:1.05},whileTap:{scale:.95},children:[r.jsx("span",{className:"hidden sm:inline",children:"💬 聊天"}),r.jsx("span",{className:"sm:hidden",children:"💬"})]}),r.jsx(be,{children:n&&r.jsxs(r.Fragment,{children:[r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 z-40 sm:hidden",onClick:()=>o(!1)}),r.jsxs(G.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{type:"spring",damping:25,stiffness:400},className:ae("z-50","sm:absolute sm:bottom-full sm:mb-2 sm:left-1/2 sm:transform sm:-translate-x-1/2 sm:w-80","fixed inset-x-4 top-1/2 -translate-y-1/2 sm:inset-auto sm:translate-y-0","pixel-container bg-gray-900/100 backdrop-blur-sm p-3 sm:p-4","max-h-[300px] max-w-sm mx-auto"),children:[r.jsxs("div",{className:"flex gap-2 mb-3",children:[r.jsx("button",{onClick:()=>a("emoji"),className:ae("flex-1 px-3 py-1 rounded text-sm font-pixel transition-all",i==="emoji"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"表情"}),r.jsx("button",{onClick:()=>a("phrase"),className:ae("flex-1 px-3 py-1 rounded text-sm font-pixel transition-all",i==="phrase"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"短语"})]}),r.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar",children:i==="emoji"?r.jsx("div",{className:"grid grid-cols-6 gap-2",children:l.map((p,x)=>r.jsx(G.button,{onClick:()=>h(p),className:"text-2xl p-2 hover:bg-gray-700 rounded transition-colors",whileHover:{scale:1.2},whileTap:{scale:.9},children:p},x))}):r.jsx("div",{className:"space-y-1",children:u.map((p,x)=>r.jsx(G.button,{onClick:()=>h(p),className:"w-full text-left px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 rounded transition-colors",whileHover:{x:5},whileTap:{scale:.98},children:p},x))})}),r.jsx("div",{className:`hidden sm:block absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-0 h-0 
                border-l-8 border-l-transparent 
                border-r-8 border-r-transparent 
                border-t-8 border-t-gray-900`})]})]})})]})},_d=({messages:e})=>{const[t,s]=g.useState([]),{myColor:n,gameState:o}=oe();return g.useEffect(()=>{if(e.length>0){const i=e[e.length-1];s(a=>[...a,i]),setTimeout(()=>{s(a=>a.filter(l=>l.id!==i.id))},3e3)}},[e]),o==="waiting"?null:r.jsx(r.Fragment,{children:r.jsx(be,{children:t.map((i,a)=>{const l=i.isOpponent?n===1?2:1:n,c=i.isOpponent;return r.jsx(G.div,{initial:{opacity:0,scale:.3,x:-50,y:0},animate:{opacity:1,scale:1,x:0,y:-a*80},exit:{opacity:0,scale:0,y:-a*80-50},transition:{type:"spring",damping:20,stiffness:300,duration:.5},className:"fixed",style:{top:"50%",left:"20px",transform:"translateY(-50%)",zIndex:40+a},children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(G.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:r.jsx(wt,{color:l,size:"small",className:"pointer-events-auto"})}),r.jsxs(G.div,{className:"relative",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:[r.jsx("div",{className:`
                      px-4 py-2 rounded-2xl shadow-lg pointer-events-auto
                      max-w-[200px] sm:max-w-[250px] break-words
                      ${c?"bg-gradient-to-r from-blue-500 to-blue-600 text-white":"bg-gradient-to-r from-green-500 to-green-600 text-white"}
                    `,children:i.content.match(/^[\u{1F300}-\u{1FAD6}]$/u)?r.jsx("span",{className:"text-3xl",children:i.content}):r.jsx("span",{className:"text-sm font-medium",children:i.content})}),r.jsx("div",{className:`
                      absolute w-0 h-0 
                      left-0 -ml-2 
                      border-t-8 border-t-transparent 
                      border-b-8 border-b-transparent 
                      border-r-8 
                      ${c?"border-r-blue-500":"border-r-green-500"}
                    `,style:{top:"50%",transform:"translateY(-50%)"}})]})]})},i.id)})})})},Wd=()=>{const[e,t]=g.useState(!1),[s,n]=g.useState(!0),[o,i]=g.useState(!0),[a,l]=g.useState("prompt"),[c,d]=g.useState(""),u=g.useRef(null),h=g.useRef(new Map),p=g.useRef(null),{socket:x}=hs(),{roomId:w}=oe();g.useEffect(()=>{(()=>{const F=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="[::1]",$=window.location.protocol==="https:"||F;return!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia?(i(!1),d("浏览器不支持音频功能"),!1):$?!0:(d(`💡 语音功能需要安全连接

解决方案：
1. 使用 localhost 访问
2. 部署HTTPS证书
3. 使用文字聊天功能代替`),i(!1),!1)})()},[]);const v=g.useCallback(async()=>{if(!o)return"denied";try{if(navigator.permissions&&navigator.permissions.query){const M=await navigator.permissions.query({name:"microphone"});return l(M.state),M.addEventListener("change",()=>{l(M.state)}),M.state}}catch(M){console.warn("无法查询麦克风权限:",M)}return"prompt"},[o]);g.useEffect(()=>{if(!p.current){const M=document.createElement("div");M.id="voice-chat-audio-container",M.style.display="none",document.body.appendChild(M),p.current=M}return()=>{p.current&&(p.current.remove(),p.current=null)}},[]);const j=g.useCallback(M=>{const F=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]});return u.current&&u.current.getTracks().forEach($=>{u.current&&F.addTrack($,u.current)}),F.ontrack=$=>{console.log("收到远程音频流:",M);const[R]=$.streams,y=document.createElement("audio");y.srcObject=R,y.autoplay=!0,y.muted=!s,p.current&&p.current.appendChild(y);const A=h.current.get(M);A&&(A.stream=R,A.audioElement=y)},F.onicecandidate=$=>{$.candidate&&x&&w&&x.emit("voice-ice-candidate",{roomId:w,candidate:$.candidate,targetPeerId:M})},F.onconnectionstatechange=()=>{console.log(`连接状态 [${M}]:`,F.connectionState),(F.connectionState==="failed"||F.connectionState==="disconnected")&&E(M)},F},[x,w,s]),E=g.useCallback(M=>{const F=h.current.get(M);F&&(F.audioElement&&p.current&&p.current.removeChild(F.audioElement),F.connection.close(),h.current.delete(M))},[]),k=g.useCallback(async()=>{if(!o)return d("当前环境不支持语音功能"),!1;try{const M=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return u.current=M,t(!0),l("granted"),n(!0),x&&w&&x.emit("join-voice-channel",{roomId:w}),!0}catch(M){return console.error("无法获取麦克风权限:",M),M.name==="NotAllowedError"?(l("denied"),d("麦克风权限被拒绝，请在浏览器设置中允许麦克风访问")):M.name==="NotFoundError"?d("未找到麦克风设备"):M.name==="NotReadableError"?d("麦克风被其他应用占用"):d("无法访问麦克风: "+M.message),!1}},[o,x,w]),C=g.useCallback(()=>{u.current&&(u.current.getTracks().forEach(M=>M.stop()),u.current=null),t(!1),x&&w&&x.emit("leave-voice-channel",{roomId:w}),h.current.forEach((M,F)=>{E(F)})},[x,w,E]),L=g.useCallback(async()=>{e?C():await k()},[e,k,C]),V=g.useCallback(()=>{const M=!s;n(M),h.current.forEach(F=>{F.audioElement&&(F.audioElement.muted=!M)})},[s]);return g.useEffect(()=>{if(!x||!w)return;const M=async A=>{if(console.log("用户加入语音频道:",A.userId),u.current){const N=j(A.userId);h.current.set(A.userId,{peerId:A.userId,connection:N});const P=await N.createOffer();await N.setLocalDescription(P),x.emit("voice-offer",{roomId:w,offer:P,targetPeerId:A.userId})}},F=async A=>{console.log("收到语音offer:",A.fromPeerId);const N=j(A.fromPeerId);h.current.set(A.fromPeerId,{peerId:A.fromPeerId,connection:N}),await N.setRemoteDescription(A.offer);const P=await N.createAnswer();await N.setLocalDescription(P),x.emit("voice-answer",{roomId:w,answer:P,targetPeerId:A.fromPeerId})},$=async A=>{console.log("收到语音answer:",A.fromPeerId);const N=h.current.get(A.fromPeerId);N&&await N.connection.setRemoteDescription(A.answer)},R=async A=>{const N=h.current.get(A.fromPeerId);N&&await N.connection.addIceCandidate(A.candidate)},y=A=>{console.log("用户离开语音频道:",A.userId),E(A.userId)};return x.on("user-joined-voice",M),x.on("voice-offer",F),x.on("voice-answer",$),x.on("voice-ice-candidate",R),x.on("user-left-voice",y),()=>{x.off("user-joined-voice",M),x.off("voice-offer",F),x.off("voice-answer",$),x.off("voice-ice-candidate",R),x.off("user-left-voice",y)}},[x,w,j,E]),g.useEffect(()=>()=>{C()},[C]),{isMicEnabled:e,isSpeakerEnabled:s,isSupported:o,permissionStatus:a,errorMessage:c,toggleMic:L,toggleSpeaker:V,checkPermission:v}},Gt=({className:e})=>{const{isMicEnabled:t,isSpeakerEnabled:s,isSupported:n,permissionStatus:o,errorMessage:i,toggleMic:a,toggleSpeaker:l,checkPermission:c}=Wd(),{addNotification:d}=oe();g.useEffect(()=>{c()},[c]),g.useEffect(()=>{i&&d("warning",i)},[i,d]);const u=async()=>{if(!n){d("warning","⚠️ 当前环境不支持语音功能，请使用HTTPS或localhost访问");return}if(o==="denied"){d("warning","⚠️ 麦克风权限被拒绝，请在浏览器设置中允许");return}await a()},h=()=>{!s&&!t&&d("info","💡 提示：单独开启喇叭可以听到其他人说话"),l()};return r.jsxs("div",{className:ae("inline-flex gap-1",e),children:[r.jsxs(G.button,{onClick:u,disabled:!n,className:ae("pixel-btn relative transition-all","px-2 py-1 sm:px-3 sm:py-2","text-[10px] sm:text-sm",t?"bg-green-600 hover:bg-green-700":"bg-gray-600 hover:bg-gray-700",!n&&"opacity-50 cursor-not-allowed"),whileHover:{scale:n?1.05:1},whileTap:{scale:n?.95:1},title:n?t?"关闭麦克风":"开启麦克风":"语音功能需要HTTPS或localhost环境",children:[r.jsx("span",{className:"text-base sm:text-lg",children:t?"🎤":"🔇"}),t&&r.jsx(G.span,{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full",animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:2}})]}),r.jsx(G.button,{onClick:h,className:ae("pixel-btn relative transition-all","px-2 py-1 sm:px-3 sm:py-2","text-[10px] sm:text-sm",s?"bg-blue-600 hover:bg-blue-700":"bg-gray-600 hover:bg-gray-700"),whileHover:{scale:1.05},whileTap:{scale:.95},title:s?"关闭喇叭":"开启喇叭",children:r.jsx("span",{className:"text-base sm:text-lg",children:s?"🔊":"🔈"})})]})},qd=()=>{const[e,t]=g.useState(!1),[s,n]=g.useState(!1),[o,i]=g.useState(!1),[a,l]=g.useState(!1),[c,d]=g.useState(!1),[u,h]=g.useState(!1),[p,x]=g.useState(!1),[w,v]=g.useState(!1),[j,E]=g.useState(!1),[k,C]=g.useState([]),{gameState:L,roomId:V,resetGame:M,setRoomInfo:F,myColor:$,currentPlayer:R,canUndo:y,winner:A,addNotification:N,history:P,userRole:S}=oe(),{socket:f,connected:O,requestRestart:_,acceptRestart:K,rejectRestart:q,requestUndo:b,acceptUndo:m,rejectUndo:T,surrender:D,sendChatMessage:I,spectatorToPlayer:z,playerToSpectator:U}=hs();console.log("GomokuGame - connected:",O,"isInRoom:",e),g.useEffect(()=>{L==="finished"&&A&&setTimeout(()=>{n(!0)},1e3)},[L,A]),g.useEffect(()=>{if(!f)return;const ze=()=>{L==="finished"?(E(!1),n(!1),V&&K(V),N("info","双方同意，游戏即将重新开始")):(i(!0),d(!0))},$e=()=>{E(!1),i(!1),N("warning","❌ 对手拒绝了重新开始请求")},tt=()=>{l(!0),h(!0)},ft=()=>{l(!1),N("warning","❌ 对手拒绝了悔棋请求")},It=()=>{n(!1),E(!1),i(!1),d(!1),C([])},Ft=me=>{console.log("Player joined room:",me.playerId),N("success","🎮 对手已加入房间"),f&&(console.log("Auto-readying for game start..."),f.emit("ready-to-play"))},mt=me=>{console.log("Player left room:",me.playerId),oe.setState({gameState:"waiting"}),N("warning","⚠️ 对手已离开房间")},pt=me=>{console.log("Opponent surrendered, winner:",me.winner,"myColor:",$),me.winner!==$&&console.error("Winner color mismatch! Expected:",$,"Got:",me.winner),oe.setState({gameState:"finished",winner:me.winner}),oe.getState().updateScore(me.winner),N("success","🏳️ 对手认输，你赢了！"),setTimeout(()=>{n(!0)},500)},st=me=>{console.log("Received chat message:",me);const fs={id:Math.random().toString(36).substr(2,9),content:me.message,isOpponent:!0,timestamp:Date.now()};C(li=>[...li,fs])};return f.on("restart-request",ze),f.on("restart-rejected",$e),f.on("undo-request",tt),f.on("undo-rejected",ft),f.on("game-restart",It),f.on("player-joined",Ft),f.on("player-left",mt),f.on("opponent-surrender",pt),f.on("chat-message",st),()=>{f.off("restart-request",ze),f.off("restart-rejected",$e),f.off("undo-request",tt),f.off("undo-rejected",ft),f.off("game-restart",It),f.off("player-joined",Ft),f.off("player-left",mt),f.off("opponent-surrender",pt),f.off("chat-message",st)}},[f,V,K,N,L,$]);const W=ze=>{if(!V)return;I(V,ze);const $e={id:Math.random().toString(36).substr(2,9),content:ze,isOpponent:!1,timestamp:Date.now()};C(tt=>[...tt,$e])},Z=()=>{V&&(K(V),i(!1),d(!1),N("success","✅ 已同意重新开始"))},te=()=>{V&&q(V),i(!1),d(!1),N("info","❌ 已拒绝重新开始请求")},B=()=>{V&&(m(V),l(!1),h(!1),N("success","✅ 已同意悔棋"))},X=()=>{V&&T(V),l(!1),h(!1),N("info","❌ 已拒绝悔棋请求")},H=()=>{console.log("Leaving room:",V),f&&V&&(f.emit("leave-room",{roomId:V}),f.emit("socket-leave-room",{roomId:V})),t(!1),n(!1),i(!1),l(!1),d(!1),h(!1),x(!1),v(!1),E(!1),C([]),M(),F(null,!1),N("info","👋 已离开房间")},Q=()=>{if(console.log("Restart requested, gameState:",L,"waitingForOpponentRestart:",j),j){N("info","⏳ 正在等待对手同意...");return}f&&V&&(L==="finished"?(E(!0),_(V),N("info","⏳ 等待对手同意再来一局...")):(_(V),N("info","📨 已发送重新开始请求")))},ee=()=>{if(!y||R===$||P.length<2){N("warning","⚠️ 当前不能悔棋");return}f&&V&&(b(V),N("info","📨 已发送悔棋请求，等待对手确认..."))},re=()=>{if(S!=="player"){N("warning","⚠️ 你已经是观众了");return}x(!0)},he=()=>{U(),x(!1),N("info","👁️ 你已转为观众")},ge=()=>{x(!1)},ve=()=>{if(L!=="playing"||S!=="player"){N("warning","⚠️ 当前不能认输");return}v(!0)},Pe=()=>{V&&$&&(D(V,$),N("info","🏳️ 你已认输")),v(!1)},we=()=>{v(!1)},Lt=()=>{z()},et=!y||R===$||L!=="playing"||a||P.length<2;return r.jsxs("div",{className:"relative",children:[r.jsx(Ud,{}),e&&r.jsx(_d,{messages:k}),r.jsx(Gd,{isOpen:s,onRestart:Q,onClose:()=>n(!1),waitingForOpponent:j}),r.jsx(Ut,{isOpen:c,title:"重新开始请求",message:"对手请求重新开始游戏，是否同意？",confirmText:"同意",cancelText:"拒绝",onConfirm:Z,onCancel:te}),r.jsx(Ut,{isOpen:u,title:"悔棋请求",message:"对手请求悔棋，是否同意？",confirmText:"同意",cancelText:"拒绝",onConfirm:B,onCancel:X}),r.jsx(Ut,{isOpen:p,title:"到观众席确认",message:"确定要到观众席吗？你将成为观众。",confirmText:"确认",cancelText:"取消",onConfirm:he,onCancel:ge}),r.jsx(Ut,{isOpen:w,title:"认输确认",message:"确定要认输吗？你将输掉当前游戏。",confirmText:"确认认输",cancelText:"取消",onConfirm:Pe,onCancel:we}),r.jsx(be,{mode:"wait",children:e?r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex flex-col",children:[r.jsxs("div",{className:"hidden sm:flex flex-col",children:[r.jsxs("div",{className:"text-center py-0.5",children:[r.jsxs("h1",{className:"text-base font-game font-bold bg-gradient-to-r from-yellow-400 via-pink-400 to-purple-400 bg-clip-text text-transparent inline-flex items-center gap-2",children:["五子棋对战",S==="spectator"&&r.jsx("span",{className:"text-sm font-normal text-yellow-400",children:"（观战模式）"})]}),r.jsxs("p",{className:"text-gray-300 text-xs",children:["房间: ",r.jsx("span",{className:"text-yellow-400 font-pixel",children:V})]})]}),r.jsxs("div",{className:"flex justify-center px-4 pt-1",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(ks,{side:"left"})}),r.jsxs("div",{className:"mx-3 flex flex-col",children:[r.jsx(Tr,{}),r.jsx("div",{className:"flex flex-col gap-2 mt-2 pb-2",children:S==="player"?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-center gap-2",children:[r.jsx("button",{onClick:Q,disabled:o||j,className:ae("pixel-btn bg-green-600 hover:bg-green-700 transition-all",(o||j)&&"opacity-50 cursor-not-allowed"),children:j?"⏳ 等待对手...":o?"⏳ 等待确认...":"🔄 重新开始"}),r.jsx("button",{onClick:ee,disabled:et,className:ae("pixel-btn bg-blue-600 hover:bg-blue-700 transition-all",et&&"opacity-50 cursor-not-allowed hover:bg-blue-600"),children:a?"⏳ 等待确认...":"↩️ 悔棋"}),r.jsx("button",{onClick:ve,disabled:L!=="playing",className:ae("pixel-btn bg-red-600 hover:bg-red-700 transition-all",L!=="playing"&&"opacity-50 cursor-not-allowed hover:bg-red-600"),children:"🏳️ 认输"})]}),r.jsxs("div",{className:"flex justify-center gap-2",children:[r.jsx(Ht,{onSendMessage:W,userRole:S}),r.jsx(Gt,{}),r.jsx("div",{className:"border-l-2 border-gray-600 mx-1"}),r.jsx("button",{onClick:re,className:"pixel-btn bg-yellow-600 hover:bg-yellow-700 transition-all",children:"👁️ 到观众席"}),r.jsx("button",{onClick:H,className:"pixel-btn bg-gray-600 hover:bg-gray-700 transition-all",children:"🚪 离开房间"})]})]}):S==="spectator"?r.jsxs("div",{className:"flex justify-center gap-2",children:[r.jsx("button",{onClick:Lt,className:"pixel-btn bg-green-600 hover:bg-green-700 transition-all",children:"🎮 成为玩家"}),r.jsx(Ht,{onSendMessage:W,userRole:S}),r.jsx(Gt,{}),r.jsx("span",{className:"text-yellow-400 px-3 py-2 flex items-center",children:"👁️ 观战模式"}),r.jsx("button",{onClick:H,className:"pixel-btn bg-gray-600 hover:bg-gray-700 transition-all",children:"🚪 离开房间"})]}):null})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx(ks,{side:"right"})})]})]}),r.jsxs("div",{className:"sm:hidden flex flex-col",children:[r.jsx("div",{className:"text-center py-0.5",children:r.jsxs("h1",{className:"text-xs font-game font-bold text-yellow-400",children:["五子棋",S==="spectator"&&"(观战)"," - ",V]})}),r.jsx("div",{className:"px-1",children:r.jsx(ks,{})}),r.jsxs("div",{className:"flex flex-col items-center pt-0.5",children:[r.jsx(Tr,{}),r.jsx("div",{className:"flex flex-col gap-1 mt-1 px-2 pb-2",children:S==="player"?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-center gap-1",children:[r.jsxs("button",{onClick:Q,disabled:o||j,className:ae("pixel-btn bg-green-600 text-[10px] px-2 py-1 transition-all",(o||j)&&"opacity-50 cursor-not-allowed"),children:[j||o?"⏳":"🔄"," 重开"]}),r.jsxs("button",{onClick:ee,disabled:et,className:ae("pixel-btn bg-blue-600 text-[10px] px-2 py-1 transition-all",et&&"opacity-50 cursor-not-allowed"),children:[a?"⏳":"↩️"," 悔棋"]}),r.jsx("button",{onClick:ve,disabled:L!=="playing",className:ae("pixel-btn bg-red-600 text-[10px] px-2 py-1 transition-all",L!=="playing"&&"opacity-50 cursor-not-allowed"),children:"🏳️ 认输"})]}),r.jsxs("div",{className:"flex justify-center gap-1",children:[r.jsx(Ht,{onSendMessage:W,userRole:S}),r.jsx(Gt,{}),r.jsx("button",{onClick:re,className:"pixel-btn bg-yellow-600 text-[10px] px-2 py-1 transition-all",children:"👁️ 观战"}),r.jsx("button",{onClick:H,className:"pixel-btn bg-gray-600 text-[10px] px-2 py-1 transition-all",children:"🚪 离开"})]})]}):S==="spectator"?r.jsxs("div",{className:"flex justify-center gap-1",children:[r.jsx("button",{onClick:Lt,className:"pixel-btn bg-green-600 text-[10px] px-2 py-1 transition-all",children:"🎮 玩家"}),r.jsx(Ht,{onSendMessage:W,userRole:S}),r.jsx(Gt,{}),r.jsx("button",{onClick:H,className:"pixel-btn bg-gray-600 text-[10px] px-2 py-1 transition-all",children:"🚪 离开"})]}):null})]})]})]},"game"):r.jsx(G.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},className:"flex items-center justify-center px-4 py-2",children:r.jsx("div",{className:"w-full max-w-2xl",children:r.jsx($d,{onJoinRoom:()=>t(!0)})})},"room-manager")}),!O&&e&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed bottom-2 right-2 bg-orange-600 text-white px-2 py-1 rounded shadow-lg text-xs z-50",children:r.jsx("span",{className:"animate-pulse",children:"连接中..."})})]})};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Kd=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,s,n)=>n?n.toUpperCase():s.toLowerCase()),kr=e=>{const t=Kd(e);return t.charAt(0).toUpperCase()+t.slice(1)},ii=(...e)=>e.filter((t,s,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===s).join(" ").trim(),Yd=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=g.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:o="",children:i,iconNode:a,...l},c)=>g.createElement("svg",{ref:c,...Zd,width:t,height:t,stroke:e,strokeWidth:n?Number(s)*24/Number(t):s,className:ii("lucide",o),...!i&&!Yd(l)&&{"aria-hidden":"true"},...l},[...a.map(([d,u])=>g.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=(e,t)=>{const s=g.forwardRef(({className:n,...o},i)=>g.createElement(Jd,{ref:i,iconNode:t,className:ii(`lucide-${Xd(kr(e))}`,`lucide-${e}`,n),...o}));return s.displayName=kr(e),s};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Je=ce("arrow-left",Qd);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],tu=ce("chevron-down",eu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],nu=ce("chevron-left",su);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ou=ce("chevron-right",ru);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],au=ce("circle-alert",iu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ai=ce("circle-check-big",lu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ps=ce("circle",cu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],uu=ce("copy",du);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],fu=ce("eraser",hu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],pu=ce("heart",mu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Pr=ce("lightbulb",gu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],yu=ce("monitor",xu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],yn=ce("pause",bu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ht=ce("play",vu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Qe=ce("rotate-ccw",wu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Nu=ce("rotate-cw",ju);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Cu=ce("target",Su);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],ku=ce("timer",Tu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Dt=ce("trophy",Pu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ru=ce("users",Mu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ms=ce("x",Au),Eu=()=>{const e=Ke(),[t,s]=g.useState(()=>x()),[n,o]=g.useState(0),[i,a]=g.useState(()=>{const V=localStorage.getItem("2048-best-score");return V?parseInt(V):0}),[l,c]=g.useState(!1),[d,u]=g.useState(!1),[h,p]=g.useState(null);function x(){const V=Array(4).fill(null).map(()=>Array(4).fill(null));return w(V),w(V),V}function w(V){const M=[];for(let R=0;R<4;R++)for(let y=0;y<4;y++)V[R][y]===null&&M.push([R,y]);if(M.length===0)return!1;const[F,$]=M[Math.floor(Math.random()*M.length)];return V[F][$]=Math.random()<.9?2:4,!0}const v=g.useCallback(V=>{if(l||d)return;const M=t.map(y=>[...y]);let F=!1,$=0;const R=y=>{let A=y.filter(S=>S!==null),N=0,P=!1;for(let S=0;S<A.length-1;S++)A[S]===A[S+1]&&(A[S]=A[S]*2,N+=A[S],A.splice(S+1,1),P=!0);for(;A.length<4;)A.push(null);return JSON.stringify(y)!==JSON.stringify(A)&&(P=!0),[A,N,P]};if(V==="left")for(let y=0;y<4;y++){const[A,N,P]=R(M[y]);M[y]=A,$+=N,P&&(F=!0)}else if(V==="right")for(let y=0;y<4;y++){const A=[...M[y]].reverse(),[N,P,S]=R(A);M[y]=N.reverse(),$+=P,S&&(F=!0)}else if(V==="up")for(let y=0;y<4;y++){const A=[M[0][y],M[1][y],M[2][y],M[3][y]],[N,P,S]=R(A);for(let f=0;f<4;f++)M[f][y]=N[f];$+=P,S&&(F=!0)}else if(V==="down")for(let y=0;y<4;y++){const A=[M[3][y],M[2][y],M[1][y],M[0][y]],[N,P,S]=R(A);M[0][y]=N[3],M[1][y]=N[2],M[2][y]=N[1],M[3][y]=N[0],$+=P,S&&(F=!0)}if(F){w(M),s(M);const y=n+$;o(y),y>i&&(a(y),localStorage.setItem("2048-best-score",y.toString()));for(let A=0;A<4;A++)for(let N=0;N<4;N++)if(M[A][N]===2048){u(!0);return}j(M)||c(!0)}},[t,n,i,l,d]);function j(V){for(let M=0;M<4;M++)for(let F=0;F<4;F++)if(V[M][F]===null)return!0;for(let M=0;M<4;M++)for(let F=0;F<4;F++){const $=V[M][F];if(M<3&&$===V[M+1][F]||F<3&&$===V[M][F+1])return!0}return!1}g.useEffect(()=>{const V=M=>{M.key==="ArrowUp"?(M.preventDefault(),v("up")):M.key==="ArrowDown"?(M.preventDefault(),v("down")):M.key==="ArrowLeft"?(M.preventDefault(),v("left")):M.key==="ArrowRight"&&(M.preventDefault(),v("right"))};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[v]);const E=V=>{const M=V.touches[0];p({x:M.clientX,y:M.clientY})},k=V=>{if(!h)return;const M=V.changedTouches[0],F=M.clientX-h.x,$=M.clientY-h.y,R=50;Math.abs(F)>Math.abs($)?Math.abs(F)>R&&(F>0?v("right"):v("left")):Math.abs($)>R&&($>0?v("down"):v("up")),p(null)},C=()=>{s(x()),o(0),c(!1),u(!1)},L=V=>V===null?"bg-gray-700":{2:"bg-gray-600",4:"bg-gray-500",8:"bg-orange-500",16:"bg-orange-600",32:"bg-red-500",64:"bg-red-600",128:"bg-yellow-500",256:"bg-yellow-600",512:"bg-green-500",1024:"bg-green-600",2048:"bg-purple-600"}[V]||"bg-purple-700";return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 p-4",children:r.jsxs("div",{className:"max-w-md mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("button",{onClick:()=>e("/"),className:"p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(Je,{size:24})}),r.jsx("h1",{className:"text-3xl font-bold text-white font-game",children:"2048"}),r.jsx("button",{onClick:C,className:"p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(Qe,{size:24})})]}),r.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[r.jsxs("div",{className:"bg-gray-800 px-4 py-2 rounded-lg",children:[r.jsx("div",{className:"text-gray-400 text-sm",children:"得分"}),r.jsx("div",{className:"text-white text-2xl font-bold",children:n})]}),r.jsxs("div",{className:"bg-gray-800 px-4 py-2 rounded-lg",children:[r.jsx("div",{className:"text-gray-400 text-sm",children:"最高分"}),r.jsx("div",{className:"text-white text-2xl font-bold",children:i})]})]}),r.jsx("div",{className:"relative bg-gray-800 p-2 rounded-lg select-none",onTouchStart:E,onTouchEnd:k,children:r.jsx("div",{className:"grid grid-cols-4 gap-2",children:t.map((V,M)=>V.map((F,$)=>r.jsxs("div",{className:"aspect-square relative",children:[r.jsx("div",{className:"absolute inset-0 bg-gray-700 rounded"}),r.jsx(be,{mode:"popLayout",children:F!==null&&r.jsx(G.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:`absolute inset-0 ${L(F)} rounded flex items-center justify-center text-white font-bold ${F&&F>=128?"text-2xl":"text-3xl"} ${F&&F>=1024?"text-xl":""}`,children:F},`tile-${M}-${$}-${F}`)})]},`${M}-${$}`)))})}),r.jsxs("div",{className:"mt-6 text-center text-gray-400 text-sm",children:[r.jsx("p",{children:"使用方向键或滑动来移动方块"}),r.jsx("p",{children:"相同数字的方块会合并"})]}),r.jsx(be,{children:(l||d)&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50",children:r.jsxs(G.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},className:"bg-gray-800 p-8 rounded-xl text-center max-w-sm w-full",children:[d?r.jsxs(r.Fragment,{children:[r.jsx(Dt,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"恭喜获胜！"}),r.jsx("p",{className:"text-gray-400 mb-6",children:"你达到了2048！"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"游戏结束"}),r.jsxs("p",{className:"text-gray-400 mb-6",children:["最终得分：",n]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:C,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"返回首页"})]})]})})})]})})},Ve=20,Mr=150,Vu=5,Du=()=>{const e=Ke(),t=g.useRef(null),[s,n]=g.useState([{x:10,y:10}]),[o,i]=g.useState({x:15,y:15}),[a,l]=g.useState("RIGHT"),[c,d]=g.useState(!1),[u,h]=g.useState(0),[p,x]=g.useState(()=>{const N=localStorage.getItem("snake-high-score");return N?parseInt(N):0}),[w,v]=g.useState(!1),[j,E]=g.useState(null),k=g.useRef(a),[C,L]=g.useState(Mr),V=g.useCallback(N=>{let P;do P={x:Math.floor(Math.random()*Ve),y:Math.floor(Math.random()*Ve)};while(N.some(S=>S.x===P.x&&S.y===P.y));return P},[]),M=g.useCallback((N,P)=>N.x<0||N.x>=Ve||N.y<0||N.y>=Ve?!0:P.some(S=>S.x===N.x&&S.y===N.y),[]),F=g.useCallback(()=>{c||!w||n(N=>{const P=[...N],S={...P[0]};switch(k.current){case"UP":S.y-=1;break;case"DOWN":S.y+=1;break;case"LEFT":S.x-=1;break;case"RIGHT":S.x+=1;break}return M(S,P)?(d(!0),v(!1),u>p&&(x(u),localStorage.setItem("snake-high-score",u.toString())),N):(P.unshift(S),S.x===o.x&&S.y===o.y?(h(f=>f+10),i(V(P)),L(f=>Math.max(50,f-Vu))):P.pop(),P)})},[c,w,o,M,V,u,p]);g.useEffect(()=>{const N=setInterval(F,C);return()=>clearInterval(N)},[F,C]),g.useEffect(()=>{const N=P=>{if(c||!w)return;const S=P.key;let f=k.current;switch(S){case"ArrowUp":case"w":case"W":k.current!=="DOWN"&&(f="UP");break;case"ArrowDown":case"s":case"S":k.current!=="UP"&&(f="DOWN");break;case"ArrowLeft":case"a":case"A":k.current!=="RIGHT"&&(f="LEFT");break;case"ArrowRight":case"d":case"D":k.current!=="LEFT"&&(f="RIGHT");break;case" ":P.preventDefault(),v(O=>!O);break}f!==k.current&&(k.current=f,l(f))};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[c,w]);const $=N=>{const P=N.touches[0];E({x:P.clientX,y:P.clientY})},R=N=>{if(!j||c||!w)return;const P=N.changedTouches[0],S=P.clientX-j.x,f=P.clientY-j.y;Math.abs(S)>Math.abs(f)?S>30&&k.current!=="LEFT"?(k.current="RIGHT",l("RIGHT")):S<-30&&k.current!=="RIGHT"&&(k.current="LEFT",l("LEFT")):f>30&&k.current!=="UP"?(k.current="DOWN",l("DOWN")):f<-30&&k.current!=="DOWN"&&(k.current="UP",l("UP")),E(null)},y=()=>{n([{x:10,y:10}]),i({x:15,y:15}),l("RIGHT"),k.current="RIGHT",d(!1),h(0),L(Mr),v(!1)},A=()=>{c?y():v(!0)};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-2xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"贪吃蛇"}),r.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重新开始"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"当前分数"}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:u})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Dt,{size:14}),"最高分数"]}),r.jsx("div",{className:"text-2xl font-bold text-yellow-400 font-game",children:p})]})]})]}),r.jsxs("div",{ref:t,className:"bg-gray-900 border border-gray-700 p-4 rounded-b-xl relative",onTouchStart:$,onTouchEnd:R,children:[r.jsxs("div",{className:"relative bg-gray-800 rounded-lg",style:{width:`${Ve*16}px`,height:`${Ve*16}px`,maxWidth:"100%",aspectRatio:"1/1"},children:[r.jsx("div",{className:"absolute inset-0 grid grid-cols-20 grid-rows-20",children:Array.from({length:Ve*Ve}).map((N,P)=>r.jsx("div",{className:"border border-gray-700/20"},P))}),r.jsx(be,{children:s.map((N,P)=>r.jsx(G.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:`absolute ${P===0?"bg-gradient-to-br from-green-400 to-green-600 z-20":"bg-gradient-to-br from-green-500 to-green-700 z-10"} rounded-sm`,style:{left:`${N.x*16}px`,top:`${N.y*16}px`,width:"14px",height:"14px",margin:"1px"}},`${N.x}-${N.y}-${P}`))}),r.jsx(G.div,{initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{duration:.5,repeat:1/0},className:"absolute bg-gradient-to-br from-red-400 to-red-600 rounded-full z-30",style:{left:`${o.x*16}px`,top:`${o.y*16}px`,width:"14px",height:"14px",margin:"1px"}},`${o.x}-${o.y}`),(!w||c)&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center z-40",children:r.jsx("div",{className:"text-center",children:c?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-4",children:["得分: ",u]}),u>p&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新纪录!"}),r.jsx("button",{onClick:y,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:u===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:A,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(ht,{size:20}),u===0?"开始游戏":"继续游戏"]}),r.jsxs("div",{className:"mt-4 text-gray-400 text-sm font-game",children:[r.jsx("p",{children:"使用方向键或WASD控制"}),r.jsx("p",{children:"手机上滑动屏幕控制方向"}),r.jsx("p",{children:"空格键暂停/继续"})]})]})})})]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("button",{onClick:()=>v(N=>!N),className:`px-6 py-3 ${w?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center gap-2`,children:w?r.jsxs(r.Fragment,{children:[r.jsx(yn,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(ht,{size:20}),u===0?"开始":"继续"]})})})]})]})})},nt=10,bt=20,Lu=800,Iu=50,rt={I:{shape:[[1,1,1,1]],color:"from-cyan-400 to-cyan-600"},O:{shape:[[1,1],[1,1]],color:"from-yellow-400 to-yellow-600"},T:{shape:[[0,1,0],[1,1,1]],color:"from-purple-400 to-purple-600"},S:{shape:[[0,1,1],[1,1,0]],color:"from-green-400 to-green-600"},Z:{shape:[[1,1,0],[0,1,1]],color:"from-red-400 to-red-600"},J:{shape:[[1,0,0],[1,1,1]],color:"from-blue-400 to-blue-600"},L:{shape:[[0,0,1],[1,1,1]],color:"from-orange-400 to-orange-600"}},Fu=()=>{const e=Ke(),t=g.useRef(null),[s,n]=g.useState(()=>Array(bt).fill(null).map(()=>Array(nt).fill(null))),[o,i]=g.useState(null),[a,l]=g.useState("T"),[c,d]=g.useState(0),[u,h]=g.useState(0),[p,x]=g.useState(1),[w,v]=g.useState(!1),[j,E]=g.useState(!1),[k,C]=g.useState(()=>{const m=localStorage.getItem("tetris-high-score");return m?parseInt(m):0}),[L,V]=g.useState(null),M=g.useRef(0),F=()=>{const m=Object.keys(rt);return m[Math.floor(Math.random()*m.length)]},$=m=>{const T=m.length,D=m[0].length,I=Array(D).fill(null).map(()=>Array(T).fill(0));for(let z=0;z<T;z++)for(let U=0;U<D;U++)I[U][T-1-z]=m[z][U];return I},R=(m,T)=>{for(let D=0;D<T.shape.length;D++)for(let I=0;I<T.shape[D].length;I++)if(T.shape[D][I]){const z=T.position.x+I,U=T.position.y+D;if(z<0||z>=nt||U>=bt||U>=0&&m[U][z])return!0}return!1},y=(m,T)=>{const D=m.map(z=>[...z]),I=rt[T.type].color;for(let z=0;z<T.shape.length;z++)for(let U=0;U<T.shape[z].length;U++)if(T.shape[z][U]){const W=T.position.y+z,Z=T.position.x+U;W>=0&&(D[W][Z]=I)}return D},A=m=>{let T=[...m],D=0;for(let I=bt-1;I>=0;I--)T[I].every(z=>z!==null)&&(T.splice(I,1),T.unshift(Array(nt).fill(null)),D++,I++);return{board:T,linesCleared:D}},N=m=>{const T=rt[m].shape;return{type:m,shape:T,position:{x:Math.floor((nt-T[0].length)/2),y:0}}},P=g.useCallback((m,T)=>{if(!o||!j||w)return!1;const D={x:o.position.x+m,y:o.position.y+T},I={...o,position:D};return R(s,I)?!1:(i(I),!0)},[o,s,j,w]),S=g.useCallback(()=>{if(!o||!j||w)return;const m=$(o.shape),T={...o,shape:m};if(!R(s,T))i(T);else for(const D of[1,-1,2,-2]){const I={...T,position:{...T.position,x:T.position.x+D}};if(!R(s,I)){i(I);break}}},[o,s,j,w]),f=g.useCallback(()=>{if(!o||!j||w)return;let m=0;for(;P(0,1);)m++;d(T=>T+m*2)},[o,j,w,P]);g.useEffect(()=>{if(!j||w||!o)return;const m=Math.max(100,Lu-(p-1)*Iu),T=setInterval(()=>{if(!P(0,1)){const D=y(s,o),{board:I,linesCleared:z}=A(D);n(I),z>0&&(h(W=>W+z),d(W=>W+z*100*p),x(Math.floor((u+z)/10)+1));const U=N(a);R(I,U)?(v(!0),E(!1),c>k&&(C(c),localStorage.setItem("tetris-high-score",c.toString()))):(i(U),l(F()))}},m);return()=>clearInterval(T)},[o,s,j,w,a,P,p,u,c,k]),g.useEffect(()=>{const m=T=>{if(!j||w){T.key===" "&&(T.preventDefault(),w?q():b());return}const D=Date.now(),I=D-M.current;switch(T.key){case"ArrowLeft":case"a":case"A":I>50&&(P(-1,0),M.current=D);break;case"ArrowRight":case"d":case"D":I>50&&(P(1,0),M.current=D);break;case"ArrowDown":case"s":case"S":P(0,1),d(z=>z+1);break;case"ArrowUp":case"w":case"W":S();break;case" ":T.preventDefault(),f();break;case"p":case"P":E(z=>!z);break}};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[j,w,P,S,f]);const O=m=>{const T=m.touches[0];V({x:T.clientX,y:T.clientY})},_=m=>{if(!L||!j||w)return;const T=m.changedTouches[0],D=T.clientX-L.x,I=T.clientY-L.y;Math.abs(D)>Math.abs(I)?Math.abs(D)>30&&(D>0?P(1,0):P(-1,0)):I>50?(P(0,1),d(z=>z+1)):I<-30&&S(),V(null)},K=()=>{j&&!w&&S()},q=()=>{n(Array(bt).fill(null).map(()=>Array(nt).fill(null))),i(null),l(F()),d(0),h(0),x(1),v(!1),E(!1)},b=()=>{if(w&&q(),E(!0),!o){const m=N(a);i(m),l(F())}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsx("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"俄罗斯方块"}),r.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]})}),r.jsx("div",{className:"bg-gray-900 border border-gray-700 p-4 rounded-b-xl",children:r.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[r.jsxs("div",{ref:t,className:"relative bg-gray-800 rounded-lg p-2",onTouchStart:O,onTouchEnd:_,onClick:K,children:[r.jsxs("div",{className:"grid grid-cols-10 gap-px bg-gray-700",style:{width:"240px"},children:[s.map((m,T)=>m.map((D,I)=>r.jsx("div",{className:`w-6 h-6 ${D?`bg-gradient-to-br ${D}`:"bg-gray-900"} ${D?"border border-gray-600":""}`},`${T}-${I}`))),o&&o.shape.map((m,T)=>m.map((D,I)=>{if(!D)return null;const z=o.position.y+T,U=o.position.x+I;return z<0||z>=bt||U<0||U>=nt?null:r.jsx(G.div,{initial:{scale:0},animate:{scale:1},className:`absolute w-6 h-6 bg-gradient-to-br ${rt[o.type].color} border border-gray-600`,style:{left:`${U*24+U}px`,top:`${z*24+z}px`}},`current-${T}-${I}`)}))]}),(!j||w)&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/70 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-center p-4",children:w?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-2",children:["得分: ",c]}),c>k&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新纪录!"}),r.jsx("button",{onClick:q,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:c===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:b,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(ht,{size:20}),c===0?"开始游戏":"继续"]})]})})})]}),r.jsxs("div",{className:"flex-1 space-y-4",children:[r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[r.jsx("h3",{className:"text-sm font-game text-gray-400 mb-2",children:"下一个"}),r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"grid gap-px bg-gray-700 p-1",children:rt[a].shape.map((m,T)=>r.jsx("div",{className:"flex gap-px",children:m.map((D,I)=>r.jsx("div",{className:`w-5 h-5 ${D?`bg-gradient-to-br ${rt[a].color} border border-gray-600`:""}`},I))},T))})})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 space-y-3",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"分数"}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:c})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"行数"}),r.jsx("div",{className:"text-xl font-bold text-blue-400 font-game",children:u})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"等级"}),r.jsx("div",{className:"text-xl font-bold text-green-400 font-game",children:p})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center gap-1",children:[r.jsx(Dt,{size:14}),"最高分"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:k})]})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 text-xs text-gray-400 font-game space-y-1",children:[r.jsx("p",{children:"← → 或 A/D: 左右移动"}),r.jsx("p",{children:"↓ 或 S: 加速下落"}),r.jsx("p",{children:"↑ 或 W: 旋转"}),r.jsx("p",{children:"空格: 硬降"}),r.jsx("p",{children:"P: 暂停"}),r.jsx("p",{className:"text-purple-400",children:"手机: 滑动或点击旋转"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 lg:hidden",children:[r.jsx("button",{onClick:()=>P(-1,0),className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!j||w,children:r.jsx(nu,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:S,className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!j||w,children:r.jsx(Nu,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:()=>P(1,0),className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!j||w,children:r.jsx(ou,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:()=>{P(0,1),d(m=>m+1)},className:"col-span-3 p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!j||w,children:r.jsx(tu,{size:20,className:"mx-auto text-white"})})]}),r.jsx("button",{onClick:()=>j?E(!1):b(),className:`w-full px-6 py-3 ${j?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center justify-center gap-2`,children:j?r.jsxs(r.Fragment,{children:[r.jsx(yn,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(ht,{size:20}),w||c===0?"开始游戏":"继续"]})})]})]})})]})})};let se=null,_t=!1;const Bu=(e,t,s,n,o,i,a,l,c)=>{const[d,u]=g.useState(_t);return g.useEffect(()=>{if(se)u(_t);else{let k;k="http://socket.qingfengyueying.xyz",console.log("TicTacToe - Connecting to:",k),se=Xs(k,{transports:["websocket","polling"],upgrade:!0,path:"/socket.io/",timeout:1e4,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),se.on("connect",()=>{console.log("TicTacToe socket connected"),_t=!0,u(!0)}),se.on("disconnect",()=>{console.log("TicTacToe socket disconnected"),_t=!1,u(!1)}),se.on("ttt-game-start",C=>{console.log("TicTacToe game start:",C),e(C)}),se.on("ttt-opponent-move",C=>{console.log("TicTacToe opponent move:",C),t(C)}),se.on("ttt-game-end",C=>{console.log("TicTacToe game end:",C),s(C)}),se.on("ttt-room-joined",C=>{console.log("TicTacToe room joined:",C),n(C)}),se.on("ttt-room-created",C=>{console.log("TicTacToe room created:",C),n(C)}),se.on("ttt-player-joined",C=>{console.log("TicTacToe player joined:",C),o(C)}),se.on("ttt-player-left",C=>{console.log("TicTacToe player left:",C),i(C)}),se.on("ttt-restart-request",()=>{console.log("TicTacToe restart request"),a()}),se.on("ttt-game-restart",()=>{console.log("TicTacToe game restart"),l()}),se.on("ttt-error",C=>{console.error("TicTacToe error:",C.message),c(C.message)})}return()=>{}},[e,t,s,n,o,i,a,l,c]),{socket:se,connected:d,joinRoom:(k,C)=>{se&&C==="online"&&(console.log("Joining TicTacToe room:",k),se.emit("ttt-join-room",{roomId:k}))},createRoom:k=>{se&&k==="online"&&(console.log("Creating TicTacToe room"),se.emit("ttt-create-room"))},makeMove:(k,C,L)=>{se&&(console.log("Making TicTacToe move:",{roomId:k,row:C,col:L}),se.emit("ttt-make-move",{roomId:k,row:C,col:L}))},requestRestart:k=>{se&&(console.log("Requesting TicTacToe restart:",k),se.emit("ttt-request-restart",{roomId:k}))},acceptRestart:k=>{se&&(console.log("Accepting TicTacToe restart:",k),se.emit("ttt-accept-restart",{roomId:k}))},rejectRestart:k=>{se&&(console.log("Rejecting TicTacToe restart:",k),se.emit("ttt-reject-restart",{roomId:k}))},leaveRoom:k=>{se&&(console.log("Leaving TicTacToe room:",k),se.emit("ttt-leave-room",{roomId:k}))}}},Ou=()=>{const e=Ke(),[t,s]=g.useState(()=>Array(3).fill(null).map(()=>Array(3).fill(null))),[n,o]=g.useState("X"),[i,a]=g.useState(null),[l,c]=g.useState(null),[d,u]=g.useState("waiting"),[h,p]=g.useState(null),[x,w]=g.useState([]),[v,j]=g.useState(""),[E,k]=g.useState({X:0,O:0,draws:0}),[C,L]=g.useState(!1),[V,M]=g.useState(!1),[F,$]=g.useState(!1),[R,y]=g.useState(""),{connected:A,joinRoom:N,createRoom:P,makeMove:S,requestRestart:f,acceptRestart:O,rejectRestart:_,leaveRoom:K}=Bu(B=>{a(B.playerSymbol),u("playing"),o("X"),I(),y("游戏开始！你是 "+B.playerSymbol)},B=>{const X=[...t];X[B.row][B.col]=n,s(X);const H=q(X);H.winner?T(H.winner,H.line):o(n==="X"?"O":"X")},B=>{p(B.winner),u("finished"),D(B.winner)},B=>{j(B.roomId),M(!B.isHost),y(B.isHost?"房间创建成功，等待对手加入...":"成功加入房间")},()=>{M(!1),y("对手已加入，游戏即将开始")},()=>{y("对手已离开"),u("waiting"),M(!0)},()=>{L(!0),y("对手请求重新开始")},()=>{z(),y("游戏重新开始")},B=>{y(B)}),q=B=>{for(let H=0;H<3;H++)if(B[H][0]&&B[H][0]===B[H][1]&&B[H][1]===B[H][2])return{winner:B[H][0],line:[[H,0],[H,1],[H,2]]};for(let H=0;H<3;H++)if(B[0][H]&&B[0][H]===B[1][H]&&B[1][H]===B[2][H])return{winner:B[0][H],line:[[0,H],[1,H],[2,H]]};return B[0][0]&&B[0][0]===B[1][1]&&B[1][1]===B[2][2]?{winner:B[0][0],line:[[0,0],[1,1],[2,2]]}:B[0][2]&&B[0][2]===B[1][1]&&B[1][1]===B[2][0]?{winner:B[0][2],line:[[0,2],[1,1],[2,0]]}:B.every(H=>H.every(Q=>Q!==null))?{winner:"draw",line:[]}:{winner:null,line:[]}},b=g.useCallback(()=>{d!=="playing"||n!=="O"||setTimeout(()=>{const B=[];for(let H=0;H<3;H++)for(let Q=0;Q<3;Q++)t[H][Q]||B.push([H,Q]);if(B.length===0)return;let X=null;for(const[H,Q]of B){const ee=t.map(re=>[...re]);if(ee[H][Q]="O",q(ee).winner==="O"){X=[H,Q];break}}if(!X)for(const[H,Q]of B){const ee=t.map(re=>[...re]);if(ee[H][Q]="X",q(ee).winner==="X"){X=[H,Q];break}}if(!X&&!t[1][1]&&(X=[1,1]),!X){const Q=[[0,0],[0,2],[2,0],[2,2]].filter(([ee,re])=>!t[ee][re]);Q.length>0&&(X=Q[Math.floor(Math.random()*Q.length)])}X||(X=B[Math.floor(Math.random()*B.length)]),X&&m(X[0],X[1])},500)},[t,n,d]),m=(B,X)=>{if(d!=="playing"||t[B][X]||h||l==="online"&&n!==i)return;const H=[...t];H[B][X]=n,s(H),l==="online"&&v&&S(v,B,X);const Q=q(H);Q.winner?T(Q.winner,Q.line):o(n==="X"?"O":"X")},T=(B,X=[])=>{p(B),w(X),u("finished"),D(B),y(B==="draw"?"平局！":`${l==="single"?B==="X"?"你":"电脑":B===i?"你":"对手"}获胜！`)},D=B=>{B==="draw"?k(X=>({...X,draws:X.draws+1})):B&&k(X=>({...X,[B]:X[B]+1}))},I=()=>{s(Array(3).fill(null).map(()=>Array(3).fill(null))),p(null),w([])},z=()=>{I(),o("X"),u(l?"playing":"waiting"),L(!1)},U=B=>{c(B),z(),B==="single"?(a("X"),u("playing")):B==="online"&&P("online")},W=()=>{const B=prompt("请输入房间号:");B&&(j(B.toUpperCase()),N(B.toUpperCase(),"online"),c("online"))},Z=()=>{navigator.clipboard.writeText(v),$(!0),setTimeout(()=>$(!1),2e3)},te=()=>{l==="online"&&v&&K(v),c(null),u("waiting"),I(),j(""),a(null)};return g.useEffect(()=>{l==="single"&&d==="playing"&&n==="O"&&!h&&b()},[l,d,n,h,b]),g.useEffect(()=>{if(R){const B=setTimeout(()=>y(""),3e3);return()=>clearTimeout(B)}},[R]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-lg",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>l?te():e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:l?"菜单":"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"井字棋"}),d==="playing"&&r.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]}),l&&r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsxs("div",{className:"text-blue-400 font-game flex items-center justify-center gap-1",children:[r.jsx(Ms,{size:16}),l==="single"?"玩家":"X"]}),r.jsx("div",{className:"text-xl font-bold text-white",children:E.X})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsx("div",{className:"text-gray-400 font-game",children:"平局"}),r.jsx("div",{className:"text-xl font-bold text-white",children:E.draws})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsxs("div",{className:"text-red-400 font-game flex items-center justify-center gap-1",children:[r.jsx(Ps,{size:16}),l==="single"?"电脑":"O"]}),r.jsx("div",{className:"text-xl font-bold text-white",children:E.O})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsx(be,{children:R&&r.jsx(G.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-4 p-3 bg-blue-600/20 border border-blue-600 rounded-lg text-blue-400 text-center font-game",children:R})}),!l&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-game text-white text-center mb-6",children:"选择游戏模式"}),r.jsxs("button",{onClick:()=>U("single"),className:"w-full p-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all flex items-center justify-center gap-3",children:[r.jsx(yu,{size:24}),r.jsx("span",{className:"font-game text-lg",children:"单机对战"})]}),r.jsxs("button",{onClick:()=>U("online"),disabled:!A,className:`w-full p-4 ${A?"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800":"bg-gray-700 cursor-not-allowed opacity-50"} text-white rounded-lg transition-all flex items-center justify-center gap-3`,children:[r.jsx(Ru,{size:24}),r.jsx("span",{className:"font-game text-lg",children:"在线对战"}),!A&&r.jsx("span",{className:"text-xs",children:"(未连接)"})]}),r.jsx("button",{onClick:W,disabled:!A,className:`w-full p-4 ${A?"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800":"bg-gray-700 cursor-not-allowed opacity-50"} text-white rounded-lg transition-all flex items-center justify-center gap-3`,children:r.jsx("span",{className:"font-game text-lg",children:"加入房间"})})]}),l==="online"&&v&&r.jsxs("div",{className:"mb-4 p-3 bg-gray-800 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-gray-400 font-game",children:"房间号:"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-white font-game font-bold text-lg",children:v}),r.jsx("button",{onClick:Z,className:"p-1 hover:bg-gray-700 rounded transition-colors",children:F?r.jsx(ai,{size:16,className:"text-green-400"}):r.jsx(uu,{size:16,className:"text-gray-400"})})]})]}),V&&r.jsx("div",{className:"mt-2 text-yellow-400 text-sm font-game animate-pulse",children:"等待对手加入..."})]}),l&&r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-800 p-4 rounded-lg",children:t.map((B,X)=>B.map((H,Q)=>{const ee=x.some(([re,he])=>re===X&&he===Q);return r.jsx(G.button,{whileHover:{scale:H?1:1.05},whileTap:{scale:.95},onClick:()=>m(X,Q),disabled:!!H||d!=="playing"||l==="online"&&n!==i,className:`
                          h-24 sm:h-28 bg-gray-900 rounded-lg border-2 transition-all
                          ${H?"border-gray-600":"border-gray-700 hover:border-gray-500"}
                          ${ee?"bg-green-900/30 border-green-500":""}
                          ${!H&&d==="playing"&&(l==="single"||n===i)?"cursor-pointer":"cursor-not-allowed"}
                          flex items-center justify-center
                        `,children:r.jsx(be,{children:H&&r.jsx(G.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},className:`text-5xl sm:text-6xl font-bold ${H==="X"?"text-blue-400":"text-red-400"}`,children:H==="X"?r.jsx(Ms,{size:48}):r.jsx(Ps,{size:48})})})},`${X}-${Q}`)}))}),d==="playing"&&!h&&r.jsxs("div",{className:"mt-4 text-center",children:[r.jsx("span",{className:"text-gray-400 font-game",children:"当前回合: "}),r.jsx("span",{className:`font-game font-bold text-lg ${n==="X"?"text-blue-400":"text-red-400"}`,children:l==="single"?n==="X"?"你":"电脑":l==="online"&&n===i?"你":n})]}),d==="finished"&&h&&r.jsx(G.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsxs("div",{className:"text-center p-6",children:[h==="draw"?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-yellow-400 mb-4",children:"平局!"}),r.jsx("p",{className:"text-white font-game mb-4",children:"势均力敌"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:l==="single"?h==="X"?"你赢了!":"电脑赢了!":h===i?"你赢了!":"对手赢了!"}),r.jsx("div",{className:`text-5xl mb-4 ${h==="X"?"text-blue-400":"text-red-400"}`,children:h==="X"?r.jsx(Ms,{size:60}):r.jsx(Ps,{size:60})})]}),r.jsx("button",{onClick:l==="online"?()=>f(v):z,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"再来一局"})]})})]}),C&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 max-w-sm",children:[r.jsx("h3",{className:"text-xl font-game text-white mb-4",children:"对手请求重新开始"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{O(v),L(!1)},className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"同意"}),r.jsx("button",{onClick:()=>{_(v),L(!1)},className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"拒绝"})]})]})})]})]})})},zu=["🎮","🎯","🎲","🎨","🎪","🎭","🎰","🎸","🏀","⚽","🏈","🎾","🎱","🏆","🎪","🎨"],$u=()=>{const e=Ke(),[t,s]=g.useState([]),[n,o]=g.useState([]),[i,a]=g.useState(0),[l,c]=g.useState(0),[d,u]=g.useState(!1),[h,p]=g.useState(!1),[x,w]=g.useState("medium"),[v,j]=g.useState(0),[E,k]=g.useState(0),[C,L]=g.useState(()=>{const S=localStorage.getItem("memory-best-scores");return S?JSON.parse(S):{easy:{moves:1/0,time:1/0},medium:{moves:1/0,time:1/0},hard:{moves:1/0,time:1/0}}}),V=S=>{switch(S){case"easy":return 8;case"medium":return 12;case"hard":return 16;default:return 12}},M=g.useCallback(()=>{const S=V(x),f=zu.slice(0,S/2),O=[];f.forEach((_,K)=>{O.push({id:K*2,emoji:_,isFlipped:!1,isMatched:!1},{id:K*2+1,emoji:_,isFlipped:!1,isMatched:!1})});for(let _=O.length-1;_>0;_--){const K=Math.floor(Math.random()*(_+1));[O[_],O[K]]=[O[K],O[_]]}s(O),o([]),a(0),c(0),p(!1),u(!1),k(0)},[x]),F=S=>{d||(u(!0),j(Date.now()));const f=t.find(K=>K.id===S);if(!f||f.isFlipped||f.isMatched||n.length>=2)return;const O=t.map(K=>K.id===S?{...K,isFlipped:!0}:K);s(O);const _=[...n,S];o(_),_.length===2&&(a(i+1),$(_))},$=S=>{const[f,O]=S,_=t.find(q=>q.id===f),K=t.find(q=>q.id===O);_&&K&&_.emoji===K.emoji?setTimeout(()=>{s(b=>b.map(m=>m.id===f||m.id===O?{...m,isMatched:!0}:m)),c(l+1),o([]);const q=V(x);l+1===q/2&&R()},500):setTimeout(()=>{s(q=>q.map(b=>b.id===f||b.id===O?{...b,isFlipped:!1}:b)),o([])},1e3)},R=()=>{const S=Date.now(),f=Math.floor((S-v)/1e3);k(f),p(!0);const O=C[x];if(i<O.moves||f<O.time){const _={...C,[x]:{moves:Math.min(i,O.moves),time:Math.min(f,O.time)}};L(_),localStorage.setItem("memory-best-scores",JSON.stringify(_))}},y=()=>{M()},A=S=>{w(S),u(!1),p(!1)};g.useEffect(()=>{let S;return d&&!h&&(S=setInterval(()=>{k(Math.floor((Date.now()-v)/1e3))},1e3)),()=>clearInterval(S)},[d,h,v]),g.useEffect(()=>{M()},[M]);const N=S=>{const f=Math.floor(S/60),O=S%60;return`${f}:${O.toString().padStart(2,"0")}`},P=()=>{switch(x){case"easy":return"grid-cols-4";case"medium":return"grid-cols-4";case"hard":return"grid-cols-4";default:return"grid-cols-4"}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"记忆翻牌"}),r.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重新开始"})]})]}),r.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["easy","medium","hard"].map(S=>r.jsx("button",{onClick:()=>A(S),className:`px-4 py-2 rounded-lg font-game transition-all ${x===S?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,children:S==="easy"?"简单":S==="medium"?"中等":"困难"},S))}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Cu,{size:14}),"步数"]}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:i})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(ku,{size:14}),"时间"]}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:N(E)})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"匹配"}),r.jsxs("div",{className:"text-2xl font-bold text-green-400 font-game",children:[l,"/",V(x)/2]})]})]}),C[x].moves!==1/0&&r.jsxs("div",{className:"mt-4 p-3 bg-gray-700/30 rounded-lg flex justify-center gap-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-gray-400 text-xs font-game",children:"最少步数"}),r.jsx("div",{className:"text-yellow-400 font-game font-bold",children:C[x].moves})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-gray-400 text-xs font-game flex items-center gap-1",children:[r.jsx(Dt,{size:12}),"最快时间"]}),r.jsx("div",{className:"text-yellow-400 font-game font-bold",children:N(C[x].time)})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsx("div",{className:`grid ${P()} gap-3 max-w-2xl mx-auto`,children:t.map(S=>r.jsx(G.div,{whileHover:{scale:S.isFlipped||S.isMatched?1:1.05},whileTap:{scale:.95},className:"aspect-square",children:r.jsxs("button",{onClick:()=>F(S.id),disabled:S.isFlipped||S.isMatched,className:"w-full h-full relative preserve-3d",style:{transformStyle:"preserve-3d",transform:S.isFlipped||S.isMatched?"rotateY(180deg)":"rotateY(0deg)",transition:"transform 0.6s"},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600 to-purple-800 rounded-lg border-2 border-purple-500 flex items-center justify-center backface-hidden",style:{backfaceVisibility:"hidden"},children:r.jsx("span",{className:"text-3xl sm:text-4xl",children:"❓"})}),r.jsx("div",{className:`absolute inset-0 ${S.isMatched?"bg-gradient-to-br from-green-600 to-green-800 border-green-500":"bg-gradient-to-br from-blue-600 to-blue-800 border-blue-500"} rounded-lg border-2 flex items-center justify-center`,style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:r.jsx(G.span,{className:"text-4xl sm:text-5xl",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:S.emoji})})]})},S.id))}),r.jsx(be,{children:h&&r.jsx(G.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs(G.div,{initial:{y:50},animate:{y:0},className:"bg-gray-800 p-8 rounded-xl border border-gray-700 text-center max-w-md",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:"🎉 完成!"}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("p",{className:"text-white font-game",children:["用时: ",r.jsx("span",{className:"text-yellow-400",children:N(E)})]}),r.jsxs("p",{className:"text-white font-game",children:["步数: ",r.jsx("span",{className:"text-yellow-400",children:i})]}),i<=C[x].moves&&r.jsx("p",{className:"text-green-400 font-game",children:"🏆 新记录!"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:y,className:"flex-1 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-game rounded-lg transition-colors",children:"返回主页"})]})]})})})]})]})})},Rr=e=>{const t=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]],s=e==="easy"?30:e==="medium"?40:50,n=t.map(i=>i.map(a=>({value:a,isFixed:!0,isError:!1,notes:[]})));let o=0;for(;o<s;){const i=Math.floor(Math.random()*9),a=Math.floor(Math.random()*9);n[i][a].value!==null&&(n[i][a]={value:null,isFixed:!1,isError:!1,notes:[]},o++)}return n},Uu=()=>{const e=Ke(),[t,s]=g.useState(()=>Rr("easy")),[n,o]=g.useState(null),[i,a]=g.useState("easy"),[l,c]=g.useState(0),[d,u]=g.useState(3),[h,p]=g.useState(!1),[x,w]=g.useState(!1),[v]=g.useState(Date.now()),[j,E]=g.useState(0),k=(R,y,A,N)=>{for(let f=0;f<9;f++)if(f!==A&&R[y][f].value===N)return!1;for(let f=0;f<9;f++)if(f!==y&&R[f][A].value===N)return!1;const P=Math.floor(y/3)*3,S=Math.floor(A/3)*3;for(let f=0;f<3;f++)for(let O=0;O<3;O++)if((P+f!==y||S+O!==A)&&R[P+f][S+O].value===N)return!1;return!0},C=R=>{if(!n||t[n.row][n.col].isFixed)return;const y=t.map(N=>N.map(P=>({...P}))),A=y[n.row][n.col];if(h)A.notes.includes(R)?A.notes=A.notes.filter(N=>N!==R):A.notes.push(R),A.value=null;else{const N=k(y,n.row,n.col,R);A.value=R,A.notes=[],A.isError=!N,N||c(l+1)}s(y),M(y)},L=()=>{if(!n||t[n.row][n.col].isFixed)return;const R=t.map(y=>y.map(A=>({...A})));R[n.row][n.col]={value:null,isFixed:!1,isError:!1,notes:[]},s(R)},V=()=>{if(d<=0||!n||t[n.row][n.col].isFixed)return;const R=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]],y=t.map(A=>A.map(N=>({...N})));y[n.row][n.col]={value:R[n.row][n.col],isFixed:!1,isError:!1,notes:[]},s(y),u(d-1),M(y)},M=R=>{R.every((A,N)=>A.every((P,S)=>P.value!==null&&!P.isError&&k(R,N,S,P.value)))&&w(!0)},F=R=>{s(Rr(R||i)),o(null),c(0),u(3),p(!1),w(!1),R&&a(R)};g.useEffect(()=>{const R=setInterval(()=>{E(Math.floor((Date.now()-v)/1e3))},1e3);return()=>clearInterval(R)},[v]),g.useEffect(()=>{const R=y=>{y.key>="1"&&y.key<="9"?C(parseInt(y.key)):y.key==="Delete"||y.key==="Backspace"?L():(y.key==="n"||y.key==="N")&&p(!h)};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[n,h]);const $=R=>{const y=Math.floor(R/60),A=R%60;return`${y}:${A.toString().padStart(2,"0")}`};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"数独"}),r.jsxs("button",{onClick:()=>F(),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"新游戏"})]})]}),r.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["easy","medium","hard"].map(R=>r.jsx("button",{onClick:()=>F(R),className:`px-4 py-2 rounded-lg font-game transition-all ${i===R?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,children:R==="easy"?"简单":R==="medium"?"中等":"困难"},R))}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"时间"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:$(j)})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(au,{size:14}),"错误"]}),r.jsx("div",{className:"text-xl font-bold text-red-400 font-game",children:l})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Pr,{size:14}),"提示"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:d})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-center justify-center",children:[r.jsx("div",{className:"bg-gray-800 p-2 rounded-lg",children:r.jsx("div",{className:"grid grid-cols-9 gap-0",children:t.map((R,y)=>R.map((A,N)=>r.jsx("button",{onClick:()=>o({row:y,col:N}),className:`
                        w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center relative
                        ${A.isFixed?"bg-gray-700":"bg-gray-900 hover:bg-gray-800"}
                        ${(n==null?void 0:n.row)===y&&(n==null?void 0:n.col)===N?"bg-blue-900":""}
                        ${A.isError?"bg-red-900/50":""}
                        ${N%3===2&&N<8?"border-r-2 border-gray-600":"border-r border-gray-700"}
                        ${y%3===2&&y<8?"border-b-2 border-gray-600":"border-b border-gray-700"}
                        transition-colors
                      `,disabled:x,children:A.value?r.jsx("span",{className:`
                          text-lg sm:text-xl font-bold
                          ${A.isFixed?"text-gray-400":A.isError?"text-red-400":"text-white"}
                        `,children:A.value}):r.jsx("div",{className:"grid grid-cols-3 gap-0 text-xs text-blue-400",children:[1,2,3,4,5,6,7,8,9].map(P=>r.jsx("span",{className:"text-[8px]",children:A.notes.includes(P)?P:""},P))})},`${y}-${N}`)))})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9].map(R=>r.jsx("button",{onClick:()=>C(R),className:"w-14 h-14 bg-gray-700 hover:bg-gray-600 text-white text-xl font-bold rounded-lg transition-colors",disabled:x,children:R},R))}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("button",{onClick:()=>p(!h),className:`w-full p-3 ${h?"bg-blue-600 hover:bg-blue-700":"bg-gray-700 hover:bg-gray-600"} text-white rounded-lg transition-colors flex items-center justify-center gap-2`,disabled:x,children:[r.jsx("span",{className:"font-game",children:"笔记模式"}),h&&r.jsx(ai,{size:16})]}),r.jsxs("button",{onClick:L,className:"w-full p-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center justify-center gap-2",disabled:x,children:[r.jsx(fu,{size:16}),r.jsx("span",{className:"font-game",children:"清除"})]}),r.jsxs("button",{onClick:V,className:"w-full p-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors flex items-center justify-center gap-2",disabled:x||d<=0,children:[r.jsx(Pr,{size:16}),r.jsxs("span",{className:"font-game",children:["提示 (",d,")"]})]})]})]})]}),x&&r.jsx(G.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-gray-800 p-8 rounded-xl border border-gray-700 text-center",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:"🎉 完成!"}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("p",{className:"text-white font-game",children:["用时: ",r.jsx("span",{className:"text-yellow-400",children:$(j)})]}),r.jsxs("p",{className:"text-white font-game",children:["错误: ",r.jsx("span",{className:"text-yellow-400",children:l})]})]}),r.jsx("button",{onClick:()=>F(),className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"新游戏"})]})})]})]})})},xe=600,Te=400,Se=100,ot=10,Wt=8,Ar=75,Er=20,Vr=10,Hu=60,Gu=35,_u=5,Wu=6,Rs=[{color:"#ef4444",points:50,hits:3},{color:"#f97316",points:40,hits:2},{color:"#eab308",points:30,hits:2},{color:"#22c55e",points:20,hits:1},{color:"#06b6d4",points:10,hits:1}],qu=()=>{const e=Ke(),t=g.useRef(null),s=g.useRef(),[n,o]=g.useState(!1),[i,a]=g.useState(!1),[l,c]=g.useState(0),[d,u]=g.useState(3),[h,p]=g.useState(1),[x,w]=g.useState(()=>{const N=localStorage.getItem("breakout-high-score");return N?parseInt(N):0}),[v,j]=g.useState({x:xe/2,y:Te-30,dx:3,dy:-3,radius:Wt}),[E,k]=g.useState({x:(xe-Se)/2,y:Te-ot-10,width:Se,height:ot}),[C,L]=g.useState([]),V=g.useCallback(()=>{const N=[];for(let P=0;P<_u;P++)for(let S=0;S<Wu;S++){const f=Rs[Math.min(P,Rs.length-1)];N.push({x:S*(Ar+Vr)+Gu,y:P*(Er+Vr)+Hu,width:Ar,height:Er,color:f.color,points:f.points,hits:f.hits,destroyed:!1})}L(N)},[]),M=()=>{j({x:xe/2,y:Te-30,dx:3+h*.5,dy:-(3+h*.5),radius:Wt}),k({x:(xe-Se)/2,y:Te-ot-10,width:Se,height:ot}),V(),c(0),u(3),p(1),a(!1),o(!1)},F=()=>{j({x:xe/2,y:Te-30,dx:3+h*.5,dy:-(3+h*.5),radius:Wt}),k({x:(xe-Se)/2,y:Te-ot-10,width:Se,height:ot})},$=()=>{p(N=>N+1),j({x:xe/2,y:Te-30,dx:3+(h+1)*.5,dy:-(3+(h+1)*.5),radius:Wt}),V()},R=g.useCallback(()=>{if((v.x+v.radius>xe||v.x-v.radius<0)&&(v.dx=-v.dx),v.y-v.radius<0&&(v.dy=-v.dy),v.y+v.radius>Te&&u(P=>{const S=P-1;return S<=0?(a(!0),o(!1),l>x&&(w(l),localStorage.setItem("breakout-high-score",l.toString()))):F(),S}),v.x>E.x&&v.x<E.x+E.width&&v.y+v.radius>E.y&&v.y-v.radius<E.y+E.height){const P=(v.x-E.x)/E.width;v.dx=8*(P-.5),v.dy=-v.dy}let N=!0;C.forEach(P=>{if(!P.destroyed&&(N=!1,v.x>P.x&&v.x<P.x+P.width&&v.y>P.y&&v.y<P.y+P.height))if(v.dy=-v.dy,P.hits--,P.hits<=0)P.destroyed=!0,c(S=>S+P.points);else{const S=P.hits/Rs.find(f=>f.color===P.color).hits;P.color=P.color+Math.floor(S*255).toString(16).padStart(2,"0")}}),N&&$()},[v,E,C,l,x]),y=g.useCallback(()=>{if(!n||i)return;const N=t.current;if(!N)return;const P=N.getContext("2d");if(!P)return;P.clearRect(0,0,xe,Te),C.forEach(f=>{f.destroyed||(P.fillStyle=f.color,P.fillRect(f.x,f.y,f.width,f.height),P.strokeStyle="#1f2937",P.strokeRect(f.x,f.y,f.width,f.height))});const S=P.createLinearGradient(E.x,E.y,E.x,E.y+E.height);S.addColorStop(0,"#8b5cf6"),S.addColorStop(1,"#7c3aed"),P.fillStyle=S,P.fillRect(E.x,E.y,E.width,E.height),P.beginPath(),P.arc(v.x,v.y,v.radius,0,Math.PI*2),P.fillStyle="#ffffff",P.fill(),P.closePath(),v.x+=v.dx,v.y+=v.dy,R(),s.current=requestAnimationFrame(y)},[n,i,v,E,C,R]);g.useEffect(()=>{const N=P=>{if(!t.current||!n)return;const S=t.current.getBoundingClientRect(),f=P.clientX-S.left;k(O=>({...O,x:Math.max(0,Math.min(xe-Se,f-Se/2))}))};return window.addEventListener("mousemove",N),()=>window.removeEventListener("mousemove",N)},[n]);const A=N=>{if(!t.current||!n)return;const P=t.current.getBoundingClientRect(),S=N.touches[0].clientX-P.left;k(f=>({...f,x:Math.max(0,Math.min(xe-Se,S-Se/2))}))};return g.useEffect(()=>{const N=P=>{if(!n){P.key===" "&&(P.preventDefault(),o(!0));return}switch(P.key){case"ArrowLeft":case"a":case"A":k(S=>({...S,x:Math.max(0,S.x-20)}));break;case"ArrowRight":case"d":case"D":k(S=>({...S,x:Math.min(xe-Se,S.x+20)}));break;case" ":case"p":case"P":P.preventDefault(),o(S=>!S);break}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[n]),g.useEffect(()=>(n&&!i&&(s.current=requestAnimationFrame(y)),()=>{s.current&&cancelAnimationFrame(s.current)}),[n,i,y]),g.useEffect(()=>{V()},[V]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"打砖块"}),r.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"分数"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:l})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(pu,{size:14}),"生命"]}),r.jsx("div",{className:"text-xl font-bold text-red-400 font-game",children:d})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"关卡"}),r.jsx("div",{className:"text-xl font-bold text-green-400 font-game",children:h})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Dt,{size:14}),"最高分"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:x})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsxs("div",{className:"relative flex justify-center",children:[r.jsx("canvas",{ref:t,width:xe,height:Te,className:"bg-gray-800 rounded-lg border-2 border-gray-700",onTouchMove:A,style:{maxWidth:"100%",height:"auto"}}),(!n||i)&&r.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-center p-6",children:i?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-2",children:["得分: ",l]}),l>x&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新记录!"}),r.jsx("button",{onClick:M,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:l===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:()=>o(!0),className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(ht,{size:20}),l===0?"开始游戏":"继续"]}),r.jsxs("div",{className:"mt-4 text-gray-400 text-sm font-game",children:[r.jsx("p",{children:"使用鼠标或触摸控制挡板"}),r.jsx("p",{children:"← → 或 A/D 键盘控制"}),r.jsx("p",{children:"空格键暂停/继续"})]})]})})})]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("button",{onClick:()=>o(N=>!N),className:`px-6 py-3 ${n?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center gap-2`,children:n?r.jsxs(r.Fragment,{children:[r.jsx(yn,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(ht,{size:20}),l===0?"开始":"继续"]})})})]})]})})},Xu=()=>{const e=ui(),[t,s]=g.useState(new Date);g.useEffect(()=>{const o=setInterval(()=>s(new Date),1e3);return()=>clearInterval(o)},[]);const n=e.pathname==="/";return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900",children:[r.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none -z-10",children:[...Array(window.innerWidth<768?20:50)].map((o,i)=>r.jsx(G.div,{className:"absolute w-1 h-1 bg-white opacity-30",initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{y:[null,-window.innerHeight]},transition:{duration:Math.random()*20+10,repeat:1/0,ease:"linear",delay:Math.random()*10}},i))}),r.jsx("header",{className:"relative z-1",children:r.jsx("nav",{className:"container mx-auto px-3 sm:px-4 py-2 sm:py-3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(As,{to:"/",className:"flex items-center space-x-2 sm:space-x-3",children:[r.jsx(G.div,{whileHover:{rotate:360},whileTap:{scale:.95},transition:{duration:.5},className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-white font-bold text-lg sm:text-xl",children:"G"})}),r.jsxs("h1",{className:"text-base sm:text-xl font-game font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:[r.jsx("span",{className:"hidden sm:inline",children:"Game Collection"}),r.jsx("span",{className:"sm:hidden",children:"游戏合集"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-6",children:[!n&&r.jsx(G.div,{whileTap:{scale:.95},transition:{duration:.1},children:r.jsxs(As,{to:"/",className:"pixel-btn text-xs px-2 py-1 sm:px-3 sm:py-2 flex items-center justify-center",children:[r.jsx("span",{className:"hidden sm:inline",children:"返回首页"}),r.jsx("span",{className:"sm:hidden",children:"首页"})]})}),r.jsx("div",{className:"text-xs sm:text-sm font-pixel text-gray-400 hidden sm:block",children:t.toLocaleTimeString("zh-CN")})]})]})})}),r.jsx("main",{className:"relative z-1 container mx-auto px-3 sm:px-4 py-1 sm:py-2",children:r.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:r.jsx(hi,{})},e.pathname)}),r.jsx("footer",{className:"relative z-1",children:r.jsx("div",{className:"container mx-auto px-3 sm:px-4 py-2 sm:py-3",children:r.jsx("div",{className:"text-center text-xs sm:text-sm text-gray-500 font-pixel",children:"© 2024 Game Collection"})})})]})};function Ku(){return r.jsx(fi,{children:r.jsx(be,{mode:"wait",children:r.jsx(mi,{children:r.jsxs(Ce,{path:"/",element:r.jsx(Xu,{}),children:[r.jsx(Ce,{index:!0,element:r.jsx(zd,{})}),r.jsx(Ce,{path:"games/gomoku",element:r.jsx(qd,{})}),r.jsx(Ce,{path:"games/2048",element:r.jsx(Eu,{})}),r.jsx(Ce,{path:"games/snake",element:r.jsx(Du,{})}),r.jsx(Ce,{path:"games/tetris",element:r.jsx(Fu,{})}),r.jsx(Ce,{path:"games/tictactoe",element:r.jsx(Ou,{})}),r.jsx(Ce,{path:"games/memory",element:r.jsx($u,{})}),r.jsx(Ce,{path:"games/sudoku",element:r.jsx(Uu,{})}),r.jsx(Ce,{path:"games/breakout",element:r.jsx(qu,{})})]})})})})}Es.createRoot(document.getElementById("root")).render(r.jsx(qs.StrictMode,{children:r.jsx(Ku,{})}))});export default Yu();
//# sourceMappingURL=index-BpofYa70.js.map

var ao=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);import{r as g,a as lo,R as _s,L as Ms,u as Ye,b as co,O as uo,B as ho,c as fo,d as Te}from"./react-vendor-RGTUMA6Z.js";import{l as Ws,c as mo}from"./game-vendor-B_MNHd1B.js";var Gu=ao((Ku,Rt)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();var Vr={exports:{}},ts={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var po=g,go=Symbol.for("react.element"),xo=Symbol.for("react.fragment"),yo=Object.prototype.hasOwnProperty,vo=po.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bo={key:!0,ref:!0,__self:!0,__source:!0};function Er(e,t,s){var n,i={},o=null,a=null;s!==void 0&&(o=""+s),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)yo.call(t,n)&&!bo.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:go,type:e,key:o,ref:a,props:i,_owner:vo.current}}ts.Fragment=xo;ts.jsx=Er;ts.jsxs=Er;Vr.exports=ts;var r=Vr.exports,Rs={},gn=lo;Rs.createRoot=gn.createRoot,Rs.hydrateRoot=gn.hydrateRoot;const Dr=g.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),ss=g.createContext({}),ns=g.createContext(null),rs=typeof document<"u",qs=rs?g.useLayoutEffect:g.useEffect,Lr=g.createContext({strict:!1}),Xs=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),wo="framerAppearId",Ir="data-"+Xs(wo);function jo(e,t,s,n){const{visualElement:i}=g.useContext(ss),o=g.useContext(Lr),a=g.useContext(ns),l=g.useContext(Dr).reducedMotion,c=g.useRef();n=n||o.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:i,props:s,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;g.useInsertionEffect(()=>{d&&d.update(s,a)});const u=g.useRef(!!(s[Ir]&&!window.HandoffComplete));return qs(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),g.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function it(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function No(e,t,s){return g.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),s&&(typeof s=="function"?s(n):it(s)&&(s.current=n))},[t])}function Nt(e){return typeof e=="string"||Array.isArray(e)}function is(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Ks=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Ys=["initial",...Ks];function os(e){return is(e.animate)||Ys.some(t=>Nt(e[t]))}function Fr(e){return!!(os(e)||e.variants)}function So(e,t){if(os(e)){const{initial:s,animate:n}=e;return{initial:s===!1||Nt(s)?s:void 0,animate:Nt(n)?n:void 0}}return e.inherit!==!1?t:{}}function Co(e){const{initial:t,animate:s}=So(e,g.useContext(ss));return g.useMemo(()=>({initial:t,animate:s}),[xn(t),xn(s)])}function xn(e){return Array.isArray(e)?e.join(" "):e}const yn={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},St={};for(const e in yn)St[e]={isEnabled:t=>yn[e].some(s=>!!t[s])};function To(e){for(const t in e)St[t]={...St[t],...e[t]}}const Zs=g.createContext({}),Br=g.createContext({}),Po=Symbol.for("motionComponentSymbol");function ko({preloadedFeatures:e,createVisualElement:t,useRender:s,useVisualState:n,Component:i}){e&&To(e);function o(l,c){let d;const u={...g.useContext(Dr),...l,layoutId:Mo(l)},{isStatic:f}=u,m=Co(l),x=n(l,f);if(!f&&rs){m.visualElement=jo(i,x,u,t);const k=g.useContext(Br),v=g.useContext(Lr).strict;m.visualElement&&(d=m.visualElement.loadFeatures(u,v,e,k))}return g.createElement(ss.Provider,{value:m},d&&m.visualElement?g.createElement(d,{visualElement:m.visualElement,...u}):null,s(i,l,No(x,m.visualElement,c),x,f,m.visualElement))}const a=g.forwardRef(o);return a[Po]=i,a}function Mo({layoutId:e}){const t=g.useContext(Zs).id;return t&&e!==void 0?t+"-"+e:e}function Ro(e){function t(n,i={}){return ko(e(n,i))}if(typeof Proxy>"u")return t;const s=new Map;return new Proxy(t,{get:(n,i)=>(s.has(i)||s.set(i,t(i)),s.get(i))})}const Ao=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Js(e){return typeof e!="string"||e.includes("-")?!1:!!(Ao.indexOf(e)>-1||/[A-Z]/.test(e))}const Wt={};function Vo(e){Object.assign(Wt,e)}const Tt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ze=new Set(Tt);function Or(e,{layout:t,layoutId:s}){return Ze.has(e)||e.startsWith("origin")||(t||s!==void 0)&&(!!Wt[e]||e==="opacity")}const xe=e=>!!(e&&e.getVelocity),Eo={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Do=Tt.length;function Lo(e,{enableHardwareAcceleration:t=!0,allowTransformNone:s=!0},n,i){let o="";for(let a=0;a<Do;a++){const l=Tt[a];if(e[l]!==void 0){const c=Eo[l]||l;o+=`${c}(${e[l]}) `}}return t&&!e.z&&(o+="translateZ(0)"),o=o.trim(),i?o=i(e,n?"":o):s&&n&&(o="none"),o}const zr=e=>t=>typeof t=="string"&&t.startsWith(e),$r=zr("--"),As=zr("var(--"),Io=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Fo=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Be=(e,t,s)=>Math.min(Math.max(s,e),t),Je={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},vt={...Je,transform:e=>Be(0,1,e)},Lt={...Je,default:1},bt=e=>Math.round(e*1e5)/1e5,as=/(-)?([\d]*\.?[\d])+/g,Ur=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Bo=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Pt(e){return typeof e=="string"}const kt=e=>({test:t=>Pt(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Le=kt("deg"),ke=kt("%"),J=kt("px"),Oo=kt("vh"),zo=kt("vw"),vn={...ke,parse:e=>ke.parse(e)/100,transform:e=>ke.transform(e*100)},bn={...Je,transform:Math.round},Hr={borderWidth:J,borderTopWidth:J,borderRightWidth:J,borderBottomWidth:J,borderLeftWidth:J,borderRadius:J,radius:J,borderTopLeftRadius:J,borderTopRightRadius:J,borderBottomRightRadius:J,borderBottomLeftRadius:J,width:J,maxWidth:J,height:J,maxHeight:J,size:J,top:J,right:J,bottom:J,left:J,padding:J,paddingTop:J,paddingRight:J,paddingBottom:J,paddingLeft:J,margin:J,marginTop:J,marginRight:J,marginBottom:J,marginLeft:J,rotate:Le,rotateX:Le,rotateY:Le,rotateZ:Le,scale:Lt,scaleX:Lt,scaleY:Lt,scaleZ:Lt,skew:Le,skewX:Le,skewY:Le,distance:J,translateX:J,translateY:J,translateZ:J,x:J,y:J,z:J,perspective:J,transformPerspective:J,opacity:vt,originX:vn,originY:vn,originZ:J,zIndex:bn,fillOpacity:vt,strokeOpacity:vt,numOctaves:bn};function Qs(e,t,s,n){const{style:i,vars:o,transform:a,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const f in t){const m=t[f];if($r(f)){o[f]=m;continue}const x=Hr[f],k=Fo(m,x);if(Ze.has(f)){if(c=!0,a[f]=k,!u)continue;m!==(x.default||0)&&(u=!1)}else f.startsWith("origin")?(d=!0,l[f]=k):i[f]=k}if(t.transform||(c||n?i.transform=Lo(e.transform,s,u,n):i.transform&&(i.transform="none")),d){const{originX:f="50%",originY:m="50%",originZ:x=0}=l;i.transformOrigin=`${f} ${m} ${x}`}}const en=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Gr(e,t,s){for(const n in t)!xe(t[n])&&!Or(n,s)&&(e[n]=t[n])}function $o({transformTemplate:e},t,s){return g.useMemo(()=>{const n=en();return Qs(n,t,{enableHardwareAcceleration:!s},e),Object.assign({},n.vars,n.style)},[t])}function Uo(e,t,s){const n=e.style||{},i={};return Gr(i,n,e),Object.assign(i,$o(e,t,s)),e.transformValues?e.transformValues(i):i}function Ho(e,t,s){const n={},i=Uo(e,t,s);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const Go=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function qt(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Go.has(e)}let _r=e=>!qt(e);function _o(e){e&&(_r=t=>t.startsWith("on")?!qt(t):e(t))}try{_o(require("@emotion/is-prop-valid").default)}catch{}function Wo(e,t,s){const n={};for(const i in e)i==="values"&&typeof e.values=="object"||(_r(i)||s===!0&&qt(i)||!t&&!qt(i)||e.draggable&&i.startsWith("onDrag"))&&(n[i]=e[i]);return n}function wn(e,t,s){return typeof e=="string"?e:J.transform(t+s*e)}function qo(e,t,s){const n=wn(t,e.x,e.width),i=wn(s,e.y,e.height);return`${n} ${i}`}const Xo={offset:"stroke-dashoffset",array:"stroke-dasharray"},Ko={offset:"strokeDashoffset",array:"strokeDasharray"};function Yo(e,t,s=1,n=0,i=!0){e.pathLength=1;const o=i?Xo:Ko;e[o.offset]=J.transform(-n);const a=J.transform(t),l=J.transform(s);e[o.array]=`${a} ${l}`}function tn(e,{attrX:t,attrY:s,attrScale:n,originX:i,originY:o,pathLength:a,pathSpacing:l=1,pathOffset:c=0,...d},u,f,m){if(Qs(e,d,u,m),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:x,style:k,dimensions:v}=e;x.transform&&(v&&(k.transform=x.transform),delete x.transform),v&&(i!==void 0||o!==void 0||k.transform)&&(k.transformOrigin=qo(v,i!==void 0?i:.5,o!==void 0?o:.5)),t!==void 0&&(x.x=t),s!==void 0&&(x.y=s),n!==void 0&&(x.scale=n),a!==void 0&&Yo(x,a,l,c,!1)}const Wr=()=>({...en(),attrs:{}}),sn=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Zo(e,t,s,n){const i=g.useMemo(()=>{const o=Wr();return tn(o,t,{enableHardwareAcceleration:!1},sn(n),e.transformTemplate),{...o.attrs,style:{...o.style}}},[t]);if(e.style){const o={};Gr(o,e.style,e),i.style={...o,...i.style}}return i}function Jo(e=!1){return(s,n,i,{latestValues:o},a)=>{const c=(Js(s)?Zo:Ho)(n,o,a,s),u={...Wo(n,typeof s=="string",e),...c,ref:i},{children:f}=n,m=g.useMemo(()=>xe(f)?f.get():f,[f]);return g.createElement(s,{...u,children:m})}}function qr(e,{style:t,vars:s},n,i){Object.assign(e.style,t,i&&i.getProjectionStyles(n));for(const o in s)e.style.setProperty(o,s[o])}const Xr=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Kr(e,t,s,n){qr(e,t,void 0,n);for(const i in t.attrs)e.setAttribute(Xr.has(i)?i:Xs(i),t.attrs[i])}function nn(e,t){const{style:s}=e,n={};for(const i in s)(xe(s[i])||t.style&&xe(t.style[i])||Or(i,e))&&(n[i]=s[i]);return n}function Yr(e,t){const s=nn(e,t);for(const n in e)if(xe(e[n])||xe(t[n])){const i=Tt.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;s[i]=e[n]}return s}function rn(e,t,s,n={},i={}){return typeof t=="function"&&(t=t(s!==void 0?s:e.custom,n,i)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(s!==void 0?s:e.custom,n,i)),t}function Zr(e){const t=g.useRef(null);return t.current===null&&(t.current=e()),t.current}const Xt=e=>Array.isArray(e),Qo=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),ea=e=>Xt(e)?e[e.length-1]||0:e;function Gt(e){const t=xe(e)?e.get():e;return Qo(t)?t.toValue():t}function ta({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:s},n,i,o){const a={latestValues:sa(n,i,o,e),renderState:t()};return s&&(a.mount=l=>s(n,l,a)),a}const Jr=e=>(t,s)=>{const n=g.useContext(ss),i=g.useContext(ns),o=()=>ta(e,t,n,i);return s?o():Zr(o)};function sa(e,t,s,n){const i={},o=n(e,{});for(const m in o)i[m]=Gt(o[m]);let{initial:a,animate:l}=e;const c=os(e),d=Fr(e);t&&d&&!c&&e.inherit!==!1&&(a===void 0&&(a=t.initial),l===void 0&&(l=t.animate));let u=s?s.initial===!1:!1;u=u||a===!1;const f=u?l:a;return f&&typeof f!="boolean"&&!is(f)&&(Array.isArray(f)?f:[f]).forEach(x=>{const k=rn(e,x);if(!k)return;const{transitionEnd:v,transition:P,...V}=k;for(const T in V){let S=V[T];if(Array.isArray(S)){const L=u?S.length-1:0;S=S[L]}S!==null&&(i[T]=S)}for(const T in v)i[T]=v[T]}),i}const ae=e=>e;class jn{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const s=this.order.indexOf(t);s!==-1&&(this.order.splice(s,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function na(e){let t=new jn,s=new jn,n=0,i=!1,o=!1;const a=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const f=u&&i,m=f?t:s;return d&&a.add(c),m.add(c)&&f&&i&&(n=t.order.length),c},cancel:c=>{s.remove(c),a.delete(c)},process:c=>{if(i){o=!0;return}if(i=!0,[t,s]=[s,t],s.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),a.has(u)&&(l.schedule(u),e())}i=!1,o&&(o=!1,l.process(c))}};return l}const It=["prepare","read","update","preRender","render","postRender"],ra=40;function ia(e,t){let s=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=It.reduce((f,m)=>(f[m]=na(()=>s=!0),f),{}),a=f=>o[f].process(i),l=()=>{const f=performance.now();s=!1,i.delta=n?1e3/60:Math.max(Math.min(f-i.timestamp,ra),1),i.timestamp=f,i.isProcessing=!0,It.forEach(a),i.isProcessing=!1,s&&t&&(n=!1,e(l))},c=()=>{s=!0,n=!0,i.isProcessing||e(l)};return{schedule:It.reduce((f,m)=>{const x=o[m];return f[m]=(k,v=!1,P=!1)=>(s||c(),x.schedule(k,v,P)),f},{}),cancel:f=>It.forEach(m=>o[m].cancel(f)),state:i,steps:o}}const{schedule:ne,cancel:Ee,state:ue,steps:hs}=ia(typeof requestAnimationFrame<"u"?requestAnimationFrame:ae,!0),oa={useVisualState:Jr({scrapeMotionValuesFromProps:Yr,createRenderState:Wr,onMount:(e,t,{renderState:s,latestValues:n})=>{ne.read(()=>{try{s.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}),ne.render(()=>{tn(s,n,{enableHardwareAcceleration:!1},sn(t.tagName),e.transformTemplate),Kr(t,s)})}})},aa={useVisualState:Jr({scrapeMotionValuesFromProps:nn,createRenderState:en})};function la(e,{forwardMotionProps:t=!1},s,n){return{...Js(e)?oa:aa,preloadedFeatures:s,useRender:Jo(t),createVisualElement:n,Component:e}}function Re(e,t,s,n={passive:!0}){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s)}const Qr=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function ls(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const ca=e=>t=>Qr(t)&&e(t,ls(t));function Ae(e,t,s,n){return Re(e,t,ca(s),n)}const da=(e,t)=>s=>t(e(s)),Fe=(...e)=>e.reduce(da);function ei(e){let t=null;return()=>{const s=()=>{t=null};return t===null?(t=e,s):!1}}const Nn=ei("dragHorizontal"),Sn=ei("dragVertical");function ti(e){let t=!1;if(e==="y")t=Sn();else if(e==="x")t=Nn();else{const s=Nn(),n=Sn();s&&n?t=()=>{s(),n()}:(s&&s(),n&&n())}return t}function si(){const e=ti(!0);return e?(e(),!1):!0}class ze{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Cn(e,t){const s="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),i=(o,a)=>{if(o.pointerType==="touch"||si())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&ne.update(()=>l[n](o,a))};return Ae(e.current,s,i,{passive:!e.getProps()[n]})}class ua extends ze{mount(){this.unmount=Fe(Cn(this.node,!0),Cn(this.node,!1))}unmount(){}}class ha extends ze{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Fe(Re(this.node.current,"focus",()=>this.onFocus()),Re(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const ni=(e,t)=>t?e===t?!0:ni(e,t.parentElement):!1;function fs(e,t){if(!t)return;const s=new PointerEvent("pointer"+e);t(s,ls(s))}class fa extends ze{constructor(){super(...arguments),this.removeStartListeners=ae,this.removeEndListeners=ae,this.removeAccessibleListeners=ae,this.startPointerPress=(t,s)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),o=Ae(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:f}=this.node.getProps();ne.update(()=>{!f&&!ni(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),a=Ae(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Fe(o,a),this.startPress(t,s)},this.startAccessiblePress=()=>{const t=o=>{if(o.key!=="Enter"||this.isPressing)return;const a=l=>{l.key!=="Enter"||!this.checkPressEnd()||fs("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&ne.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=Re(this.node.current,"keyup",a),fs("down",(l,c)=>{this.startPress(l,c)})},s=Re(this.node.current,"keydown",t),n=()=>{this.isPressing&&fs("cancel",(o,a)=>this.cancelPress(o,a))},i=Re(this.node.current,"blur",n);this.removeAccessibleListeners=Fe(s,i)}}startPress(t,s){this.isPressing=!0;const{onTapStart:n,whileTap:i}=this.node.getProps();i&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&ne.update(()=>n(t,s))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!si()}cancelPress(t,s){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&ne.update(()=>n(t,s))}mount(){const t=this.node.getProps(),s=Ae(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Re(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Fe(s,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Vs=new WeakMap,ms=new WeakMap,ma=e=>{const t=Vs.get(e.target);t&&t(e)},pa=e=>{e.forEach(ma)};function ga({root:e,...t}){const s=e||document;ms.has(s)||ms.set(s,{});const n=ms.get(s),i=JSON.stringify(t);return n[i]||(n[i]=new IntersectionObserver(pa,{root:e,...t})),n[i]}function xa(e,t,s){const n=ga(t);return Vs.set(e,s),n.observe(e),()=>{Vs.delete(e),n.unobserve(e)}}const ya={some:0,all:1};class va extends ze{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:s,margin:n,amount:i="some",once:o}=t,a={root:s?s.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:ya[i]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,o&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),m=d?u:f;m&&m(c)};return xa(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:s}=this.node;["amount","margin","root"].some(ba(t,s))&&this.startObserver()}unmount(){}}function ba({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}const wa={inView:{Feature:va},tap:{Feature:fa},focus:{Feature:ha},hover:{Feature:ua}};function ri(e,t){if(!Array.isArray(t))return!1;const s=t.length;if(s!==e.length)return!1;for(let n=0;n<s;n++)if(t[n]!==e[n])return!1;return!0}function ja(e){const t={};return e.values.forEach((s,n)=>t[n]=s.get()),t}function Na(e){const t={};return e.values.forEach((s,n)=>t[n]=s.getVelocity()),t}function cs(e,t,s){const n=e.getProps();return rn(n,t,s!==void 0?s:n.custom,ja(e),Na(e))}let on=ae;const Ke=e=>e*1e3,Ve=e=>e/1e3,Sa={current:!1},ii=e=>Array.isArray(e)&&typeof e[0]=="number";function oi(e){return!!(!e||typeof e=="string"&&ai[e]||ii(e)||Array.isArray(e)&&e.every(oi))}const xt=([e,t,s,n])=>`cubic-bezier(${e}, ${t}, ${s}, ${n})`,ai={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:xt([0,.65,.55,1]),circOut:xt([.55,0,1,.45]),backIn:xt([.31,.01,.66,-.59]),backOut:xt([.33,1.53,.69,.99])};function li(e){if(e)return ii(e)?xt(e):Array.isArray(e)?e.map(li):ai[e]}function Ca(e,t,s,{delay:n=0,duration:i,repeat:o=0,repeatType:a="loop",ease:l,times:c}={}){const d={[t]:s};c&&(d.offset=c);const u=li(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:a==="reverse"?"alternate":"normal"})}function Ta(e,{repeat:t,repeatType:s="loop"}){const n=t&&s!=="loop"&&t%2===1?0:e.length-1;return e[n]}const ci=(e,t,s)=>(((1-3*s+3*t)*e+(3*s-6*t))*e+3*t)*e,Pa=1e-7,ka=12;function Ma(e,t,s,n,i){let o,a,l=0;do a=t+(s-t)/2,o=ci(a,n,i)-e,o>0?s=a:t=a;while(Math.abs(o)>Pa&&++l<ka);return a}function Mt(e,t,s,n){if(e===t&&s===n)return ae;const i=o=>Ma(o,0,1,e,s);return o=>o===0||o===1?o:ci(i(o),t,n)}const Ra=Mt(.42,0,1,1),Aa=Mt(0,0,.58,1),di=Mt(.42,0,.58,1),Va=e=>Array.isArray(e)&&typeof e[0]!="number",ui=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,hi=e=>t=>1-e(1-t),an=e=>1-Math.sin(Math.acos(e)),fi=hi(an),Ea=ui(an),mi=Mt(.33,1.53,.69,.99),ln=hi(mi),Da=ui(ln),La=e=>(e*=2)<1?.5*ln(e):.5*(2-Math.pow(2,-10*(e-1))),Ia={linear:ae,easeIn:Ra,easeInOut:di,easeOut:Aa,circIn:an,circInOut:Ea,circOut:fi,backIn:ln,backInOut:Da,backOut:mi,anticipate:La},Tn=e=>{if(Array.isArray(e)){on(e.length===4);const[t,s,n,i]=e;return Mt(t,s,n,i)}else if(typeof e=="string")return Ia[e];return e},cn=(e,t)=>s=>!!(Pt(s)&&Bo.test(s)&&s.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(s,t)),pi=(e,t,s)=>n=>{if(!Pt(n))return n;const[i,o,a,l]=n.match(as);return{[e]:parseFloat(i),[t]:parseFloat(o),[s]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},Fa=e=>Be(0,255,e),ps={...Je,transform:e=>Math.round(Fa(e))},Xe={test:cn("rgb","red"),parse:pi("red","green","blue"),transform:({red:e,green:t,blue:s,alpha:n=1})=>"rgba("+ps.transform(e)+", "+ps.transform(t)+", "+ps.transform(s)+", "+bt(vt.transform(n))+")"};function Ba(e){let t="",s="",n="",i="";return e.length>5?(t=e.substring(1,3),s=e.substring(3,5),n=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),s=e.substring(2,3),n=e.substring(3,4),i=e.substring(4,5),t+=t,s+=s,n+=n,i+=i),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const Es={test:cn("#"),parse:Ba,transform:Xe.transform},ot={test:cn("hsl","hue"),parse:pi("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:s,alpha:n=1})=>"hsla("+Math.round(e)+", "+ke.transform(bt(t))+", "+ke.transform(bt(s))+", "+bt(vt.transform(n))+")"},me={test:e=>Xe.test(e)||Es.test(e)||ot.test(e),parse:e=>Xe.test(e)?Xe.parse(e):ot.test(e)?ot.parse(e):Es.parse(e),transform:e=>Pt(e)?e:e.hasOwnProperty("red")?Xe.transform(e):ot.transform(e)},ie=(e,t,s)=>-s*e+s*t+e;function gs(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(t-e)*6*s:s<1/2?t:s<2/3?e+(t-e)*(2/3-s)*6:e}function Oa({hue:e,saturation:t,lightness:s,alpha:n}){e/=360,t/=100,s/=100;let i=0,o=0,a=0;if(!t)i=o=a=s;else{const l=s<.5?s*(1+t):s+t-s*t,c=2*s-l;i=gs(c,l,e+1/3),o=gs(c,l,e),a=gs(c,l,e-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(a*255),alpha:n}}const xs=(e,t,s)=>{const n=e*e;return Math.sqrt(Math.max(0,s*(t*t-n)+n))},za=[Es,Xe,ot],$a=e=>za.find(t=>t.test(e));function Pn(e){const t=$a(e);let s=t.parse(e);return t===ot&&(s=Oa(s)),s}const gi=(e,t)=>{const s=Pn(e),n=Pn(t),i={...s};return o=>(i.red=xs(s.red,n.red,o),i.green=xs(s.green,n.green,o),i.blue=xs(s.blue,n.blue,o),i.alpha=ie(s.alpha,n.alpha,o),Xe.transform(i))};function Ua(e){var t,s;return isNaN(e)&&Pt(e)&&(((t=e.match(as))===null||t===void 0?void 0:t.length)||0)+(((s=e.match(Ur))===null||s===void 0?void 0:s.length)||0)>0}const xi={regex:Io,countKey:"Vars",token:"${v}",parse:ae},yi={regex:Ur,countKey:"Colors",token:"${c}",parse:me.parse},vi={regex:as,countKey:"Numbers",token:"${n}",parse:Je.parse};function ys(e,{regex:t,countKey:s,token:n,parse:i}){const o=e.tokenised.match(t);o&&(e["num"+s]=o.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...o.map(i)))}function Kt(e){const t=e.toString(),s={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return s.value.includes("var(--")&&ys(s,xi),ys(s,yi),ys(s,vi),s}function bi(e){return Kt(e).values}function wi(e){const{values:t,numColors:s,numVars:n,tokenised:i}=Kt(e),o=t.length;return a=>{let l=i;for(let c=0;c<o;c++)c<n?l=l.replace(xi.token,a[c]):c<n+s?l=l.replace(yi.token,me.transform(a[c])):l=l.replace(vi.token,bt(a[c]));return l}}const Ha=e=>typeof e=="number"?0:e;function Ga(e){const t=bi(e);return wi(e)(t.map(Ha))}const Oe={test:Ua,parse:bi,createTransformer:wi,getAnimatableNone:Ga},ji=(e,t)=>s=>`${s>0?t:e}`;function Ni(e,t){return typeof e=="number"?s=>ie(e,t,s):me.test(e)?gi(e,t):e.startsWith("var(")?ji(e,t):Ci(e,t)}const Si=(e,t)=>{const s=[...e],n=s.length,i=e.map((o,a)=>Ni(o,t[a]));return o=>{for(let a=0;a<n;a++)s[a]=i[a](o);return s}},_a=(e,t)=>{const s={...e,...t},n={};for(const i in s)e[i]!==void 0&&t[i]!==void 0&&(n[i]=Ni(e[i],t[i]));return i=>{for(const o in n)s[o]=n[o](i);return s}},Ci=(e,t)=>{const s=Oe.createTransformer(t),n=Kt(e),i=Kt(t);return n.numVars===i.numVars&&n.numColors===i.numColors&&n.numNumbers>=i.numNumbers?Fe(Si(n.values,i.values),s):ji(e,t)},Ct=(e,t,s)=>{const n=t-e;return n===0?1:(s-e)/n},kn=(e,t)=>s=>ie(e,t,s);function Wa(e){return typeof e=="number"?kn:typeof e=="string"?me.test(e)?gi:Ci:Array.isArray(e)?Si:typeof e=="object"?_a:kn}function qa(e,t,s){const n=[],i=s||Wa(e[0]),o=e.length-1;for(let a=0;a<o;a++){let l=i(e[a],e[a+1]);if(t){const c=Array.isArray(t)?t[a]||ae:t;l=Fe(c,l)}n.push(l)}return n}function Ti(e,t,{clamp:s=!0,ease:n,mixer:i}={}){const o=e.length;if(on(o===t.length),o===1)return()=>t[0];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=qa(t,n,i),l=a.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const f=Ct(e[u],e[u+1],d);return a[u](f)};return s?d=>c(Be(e[0],e[o-1],d)):c}function Xa(e,t){const s=e[e.length-1];for(let n=1;n<=t;n++){const i=Ct(0,t,n);e.push(ie(s,1,i))}}function Ka(e){const t=[0];return Xa(t,e.length-1),t}function Ya(e,t){return e.map(s=>s*t)}function Za(e,t){return e.map(()=>t||di).splice(0,e.length-1)}function Yt({duration:e=300,keyframes:t,times:s,ease:n="easeInOut"}){const i=Va(n)?n.map(Tn):Tn(n),o={done:!1,value:t[0]},a=Ya(s&&s.length===t.length?s:Ka(t),e),l=Ti(a,t,{ease:Array.isArray(i)?i:Za(t,i)});return{calculatedDuration:e,next:c=>(o.value=l(c),o.done=c>=e,o)}}function Pi(e,t){return t?e*(1e3/t):0}const Ja=5;function ki(e,t,s){const n=Math.max(t-Ja,0);return Pi(s-e(n),t-n)}const vs=.001,Qa=.01,el=10,tl=.05,sl=1;function nl({duration:e=800,bounce:t=.25,velocity:s=0,mass:n=1}){let i,o,a=1-t;a=Be(tl,sl,a),e=Be(Qa,el,Ve(e)),a<1?(i=d=>{const u=d*a,f=u*e,m=u-s,x=Ds(d,a),k=Math.exp(-f);return vs-m/x*k},o=d=>{const f=d*a*e,m=f*s+s,x=Math.pow(a,2)*Math.pow(d,2)*e,k=Math.exp(-f),v=Ds(Math.pow(d,2),a);return(-i(d)+vs>0?-1:1)*((m-x)*k)/v}):(i=d=>{const u=Math.exp(-d*e),f=(d-s)*e+1;return-vs+u*f},o=d=>{const u=Math.exp(-d*e),f=(s-d)*(e*e);return u*f});const l=5/e,c=il(i,o,l);if(e=Ke(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:a*2*Math.sqrt(n*d),duration:e}}}const rl=12;function il(e,t,s){let n=s;for(let i=1;i<rl;i++)n=n-e(n)/t(n);return n}function Ds(e,t){return e*Math.sqrt(1-t*t)}const ol=["duration","bounce"],al=["stiffness","damping","mass"];function Mn(e,t){return t.some(s=>e[s]!==void 0)}function ll(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!Mn(e,al)&&Mn(e,ol)){const s=nl(e);t={...t,...s,mass:1},t.isResolvedFromDuration=!0}return t}function Mi({keyframes:e,restDelta:t,restSpeed:s,...n}){const i=e[0],o=e[e.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:d,duration:u,velocity:f,isResolvedFromDuration:m}=ll({...n,velocity:-Ve(n.velocity||0)}),x=f||0,k=c/(2*Math.sqrt(l*d)),v=o-i,P=Ve(Math.sqrt(l/d)),V=Math.abs(v)<5;s||(s=V?.01:2),t||(t=V?.005:.5);let T;if(k<1){const S=Ds(P,k);T=L=>{const E=Math.exp(-k*P*L);return o-E*((x+k*P*v)/S*Math.sin(S*L)+v*Math.cos(S*L))}}else if(k===1)T=S=>o-Math.exp(-P*S)*(v+(x+P*v)*S);else{const S=P*Math.sqrt(k*k-1);T=L=>{const E=Math.exp(-k*P*L),M=Math.min(S*L,300);return o-E*((x+k*P*v)*Math.sinh(M)+S*v*Math.cosh(M))/S}}return{calculatedDuration:m&&u||null,next:S=>{const L=T(S);if(m)a.done=S>=u;else{let E=x;S!==0&&(k<1?E=ki(T,S,L):E=0);const M=Math.abs(E)<=s,I=Math.abs(o-L)<=t;a.done=M&&I}return a.value=a.done?o:L,a}}}function Rn({keyframes:e,velocity:t=0,power:s=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:a,min:l,max:c,restDelta:d=.5,restSpeed:u}){const f=e[0],m={done:!1,value:f},x=A=>l!==void 0&&A<l||c!==void 0&&A>c,k=A=>l===void 0?c:c===void 0||Math.abs(l-A)<Math.abs(c-A)?l:c;let v=s*t;const P=f+v,V=a===void 0?P:a(P);V!==P&&(v=V-f);const T=A=>-v*Math.exp(-A/n),S=A=>V+T(A),L=A=>{const w=T(A),C=S(A);m.done=Math.abs(w)<=d,m.value=m.done?V:C};let E,M;const I=A=>{x(m.value)&&(E=A,M=Mi({keyframes:[m.value,k(m.value)],velocity:ki(S,A,m.value),damping:i,stiffness:o,restDelta:d,restSpeed:u}))};return I(0),{calculatedDuration:null,next:A=>{let w=!1;return!M&&E===void 0&&(w=!0,L(A),I(A)),E!==void 0&&A>E?M.next(A-E):(!w&&L(A),m)}}}const cl=e=>{const t=({timestamp:s})=>e(s);return{start:()=>ne.update(t,!0),stop:()=>Ee(t),now:()=>ue.isProcessing?ue.timestamp:performance.now()}},An=2e4;function Vn(e){let t=0;const s=50;let n=e.next(t);for(;!n.done&&t<An;)t+=s,n=e.next(t);return t>=An?1/0:t}const dl={decay:Rn,inertia:Rn,tween:Yt,keyframes:Yt,spring:Mi};function Zt({autoplay:e=!0,delay:t=0,driver:s=cl,keyframes:n,type:i="keyframes",repeat:o=0,repeatDelay:a=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:f,...m}){let x=1,k=!1,v,P;const V=()=>{P=new Promise(p=>{v=p})};V();let T;const S=dl[i]||Yt;let L;S!==Yt&&typeof n[0]!="number"&&(L=Ti([0,100],n,{clamp:!1}),n=[0,100]);const E=S({...m,keyframes:n});let M;l==="mirror"&&(M=S({...m,keyframes:[...n].reverse(),velocity:-(m.velocity||0)}));let I="idle",A=null,w=null,C=null;E.calculatedDuration===null&&o&&(E.calculatedDuration=Vn(E));const{calculatedDuration:R}=E;let b=1/0,j=1/0;R!==null&&(b=R+a,j=b*(o+1)-a);let N=0;const h=p=>{if(w===null)return;x>0&&(w=Math.min(w,p)),x<0&&(w=Math.min(p-j/x,w)),A!==null?N=A:N=Math.round(p-w)*x;const B=N-t*(x>=0?1:-1),z=x>=0?B<0:B>j;N=Math.max(B,0),I==="finished"&&A===null&&(N=j);let _=N,X=E;if(o){const te=Math.min(N,j)/b;let O=Math.floor(te),W=te%1;!W&&te>=1&&(W=1),W===1&&O--,O=Math.min(O,o+1),!!(O%2)&&(l==="reverse"?(W=1-W,a&&(W-=a/b)):l==="mirror"&&(X=M)),_=Be(0,1,W)*b}const K=z?{done:!1,value:n[0]}:X.next(_);L&&(K.value=L(K.value));let{done:q}=K;!z&&R!==null&&(q=x>=0?N>=j:N<=0);const Y=A===null&&(I==="finished"||I==="running"&&q);return f&&f(K.value),Y&&G(),K},D=()=>{T&&T.stop(),T=void 0},F=()=>{I="idle",D(),v(),V(),w=C=null},G=()=>{I="finished",u&&u(),D(),v()},H=()=>{if(k)return;T||(T=s(h));const p=T.now();c&&c(),A!==null?w=p-A:(!w||I==="finished")&&(w=p),I==="finished"&&V(),C=w,A=null,I="running",T.start()};e&&H();const y={then(p,B){return P.then(p,B)},get time(){return Ve(N)},set time(p){p=Ke(p),N=p,A!==null||!T||x===0?A=p:w=T.now()-p/x},get duration(){const p=E.calculatedDuration===null?Vn(E):E.calculatedDuration;return Ve(p)},get speed(){return x},set speed(p){p===x||!T||(x=p,y.time=Ve(N))},get state(){return I},play:H,pause:()=>{I="paused",A=N},stop:()=>{k=!0,I!=="idle"&&(I="idle",d&&d(),F())},cancel:()=>{C!==null&&h(C),F()},complete:()=>{I="finished"},sample:p=>(w=0,h(p))};return y}function ul(e){let t;return()=>(t===void 0&&(t=e()),t)}const hl=ul(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),fl=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Ft=10,ml=2e4,pl=(e,t)=>t.type==="spring"||e==="backgroundColor"||!oi(t.ease);function gl(e,t,{onUpdate:s,onComplete:n,...i}){if(!(hl()&&fl.has(t)&&!i.repeatDelay&&i.repeatType!=="mirror"&&i.damping!==0&&i.type!=="inertia"))return!1;let a=!1,l,c,d=!1;const u=()=>{c=new Promise(S=>{l=S})};u();let{keyframes:f,duration:m=300,ease:x,times:k}=i;if(pl(t,i)){const S=Zt({...i,repeat:0,delay:0});let L={done:!1,value:f[0]};const E=[];let M=0;for(;!L.done&&M<ml;)L=S.sample(M),E.push(L.value),M+=Ft;k=void 0,f=E,m=M-Ft,x="linear"}const v=Ca(e.owner.current,t,f,{...i,duration:m,ease:x,times:k}),P=()=>{d=!1,v.cancel()},V=()=>{d=!0,ne.update(P),l(),u()};return v.onfinish=()=>{d||(e.set(Ta(f,i)),n&&n(),V())},{then(S,L){return c.then(S,L)},attachTimeline(S){return v.timeline=S,v.onfinish=null,ae},get time(){return Ve(v.currentTime||0)},set time(S){v.currentTime=Ke(S)},get speed(){return v.playbackRate},set speed(S){v.playbackRate=S},get duration(){return Ve(m)},play:()=>{a||(v.play(),Ee(P))},pause:()=>v.pause(),stop:()=>{if(a=!0,v.playState==="idle")return;const{currentTime:S}=v;if(S){const L=Zt({...i,autoplay:!1});e.setWithVelocity(L.sample(S-Ft).value,L.sample(S).value,Ft)}V()},complete:()=>{d||v.finish()},cancel:V}}function xl({keyframes:e,delay:t,onUpdate:s,onComplete:n}){const i=()=>(s&&s(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:ae,pause:ae,stop:ae,then:o=>(o(),Promise.resolve()),cancel:ae,complete:ae});return t?Zt({keyframes:[0,1],duration:0,delay:t,onComplete:i}):i()}const yl={type:"spring",stiffness:500,damping:25,restSpeed:10},vl=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),bl={type:"keyframes",duration:.8},wl={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},jl=(e,{keyframes:t})=>t.length>2?bl:Ze.has(e)?e.startsWith("scale")?vl(t[1]):yl:wl,Ls=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Oe.test(t)||t==="0")&&!t.startsWith("url(")),Nl=new Set(["brightness","contrast","saturate","opacity"]);function Sl(e){const[t,s]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=s.match(as)||[];if(!n)return e;const i=s.replace(n,"");let o=Nl.has(t)?1:0;return n!==s&&(o*=100),t+"("+o+i+")"}const Cl=/([a-z-]*)\(.*?\)/g,Is={...Oe,getAnimatableNone:e=>{const t=e.match(Cl);return t?t.map(Sl).join(" "):e}},Tl={...Hr,color:me,backgroundColor:me,outlineColor:me,fill:me,stroke:me,borderColor:me,borderTopColor:me,borderRightColor:me,borderBottomColor:me,borderLeftColor:me,filter:Is,WebkitFilter:Is},dn=e=>Tl[e];function Ri(e,t){let s=dn(e);return s!==Is&&(s=Oe),s.getAnimatableNone?s.getAnimatableNone(t):void 0}const Ai=e=>/^0[^.\s]+$/.test(e);function Pl(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Ai(e)}function kl(e,t,s,n){const i=Ls(t,s);let o;Array.isArray(s)?o=[...s]:o=[null,s];const a=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<o.length;d++)o[d]===null&&(o[d]=d===0?a:o[d-1]),Pl(o[d])&&c.push(d),typeof o[d]=="string"&&o[d]!=="none"&&o[d]!=="0"&&(l=o[d]);if(i&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];o[u]=Ri(t,l)}return o}function Ml({when:e,delay:t,delayChildren:s,staggerChildren:n,staggerDirection:i,repeat:o,repeatType:a,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function un(e,t){return e[t]||e.default||e}const Rl={skipAnimations:!1},hn=(e,t,s,n={})=>i=>{const o=un(n,e)||{},a=o.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Ke(a);const c=kl(t,e,s,o),d=c[0],u=c[c.length-1],f=Ls(e,d),m=Ls(e,u);let x={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...o,delay:-l,onUpdate:k=>{t.set(k),o.onUpdate&&o.onUpdate(k)},onComplete:()=>{i(),o.onComplete&&o.onComplete()}};if(Ml(o)||(x={...x,...jl(e,x)}),x.duration&&(x.duration=Ke(x.duration)),x.repeatDelay&&(x.repeatDelay=Ke(x.repeatDelay)),!f||!m||Sa.current||o.type===!1||Rl.skipAnimations)return xl(x);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const k=gl(t,e,x);if(k)return k}return Zt(x)};function Jt(e){return!!(xe(e)&&e.add)}const Vi=e=>/^\-?\d*\.?\d+$/.test(e);function fn(e,t){e.indexOf(t)===-1&&e.push(t)}function mn(e,t){const s=e.indexOf(t);s>-1&&e.splice(s,1)}class pn{constructor(){this.subscriptions=[]}add(t){return fn(this.subscriptions,t),()=>mn(this.subscriptions,t)}notify(t,s,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,s,n);else for(let o=0;o<i;o++){const a=this.subscriptions[o];a&&a(t,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Al=e=>!isNaN(parseFloat(e));class Vl{constructor(t,s={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,i=!0)=>{this.prev=this.current,this.current=n;const{delta:o,timestamp:a}=ue;this.lastUpdated!==a&&(this.timeDelta=o,this.lastUpdated=a,ne.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>ne.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=Al(this.current),this.owner=s.owner}onChange(t){return this.on("change",t)}on(t,s){this.events[t]||(this.events[t]=new pn);const n=this.events[t].add(s);return t==="change"?()=>{n(),ne.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,s){this.passiveEffect=t,this.stopPassiveEffect=s}set(t,s=!0){!s||!this.passiveEffect?this.updateAndNotify(t,s):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,s,n){this.set(s),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Pi(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=t(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ct(e,t){return new Vl(e,t)}const Ei=e=>t=>t.test(e),El={test:e=>e==="auto",parse:e=>e},Di=[Je,J,ke,Le,zo,Oo,El],mt=e=>Di.find(Ei(e)),Dl=[...Di,me,Oe],Ll=e=>Dl.find(Ei(e));function Il(e,t,s){e.hasValue(t)?e.getValue(t).set(s):e.addValue(t,ct(s))}function Fl(e,t){const s=cs(e,t);let{transitionEnd:n={},transition:i={},...o}=s?e.makeTargetAnimatable(s,!1):{};o={...o,...n};for(const a in o){const l=ea(o[a]);Il(e,a,l)}}function Bl(e,t,s){var n,i;const o=Object.keys(t).filter(l=>!e.hasValue(l)),a=o.length;if(a)for(let l=0;l<a;l++){const c=o[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(i=(n=s[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&i!==void 0?i:t[c]),u!=null&&(typeof u=="string"&&(Vi(u)||Ai(u))?u=parseFloat(u):!Ll(u)&&Oe.test(d)&&(u=Ri(c,d)),e.addValue(c,ct(u,{owner:e})),s[c]===void 0&&(s[c]=u),u!==null&&e.setBaseTarget(c,u))}}function Ol(e,t){return t?(t[e]||t.default||t).from:void 0}function zl(e,t,s){const n={};for(const i in e){const o=Ol(i,t);if(o!==void 0)n[i]=o;else{const a=s.getValue(i);a&&(n[i]=a.get())}}return n}function $l({protectedKeys:e,needsAnimating:t},s){const n=e.hasOwnProperty(s)&&t[s]!==!0;return t[s]=!1,n}function Ul(e,t){const s=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==s)return!0}else return s!==t}function Li(e,t,{delay:s=0,transitionOverride:n,type:i}={}){let{transition:o=e.getDefaultTransition(),transitionEnd:a,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(o=n);const d=[],u=i&&e.animationState&&e.animationState.getState()[i];for(const f in l){const m=e.getValue(f),x=l[f];if(!m||x===void 0||u&&$l(u,f))continue;const k={delay:s,elapsed:0,...un(o||{},f)};if(window.HandoffAppearAnimations){const V=e.getProps()[Ir];if(V){const T=window.HandoffAppearAnimations(V,f,m,ne);T!==null&&(k.elapsed=T,k.isHandoff=!0)}}let v=!k.isHandoff&&!Ul(m,x);if(k.type==="spring"&&(m.getVelocity()||k.velocity)&&(v=!1),m.animation&&(v=!1),v)continue;m.start(hn(f,m,x,e.shouldReduceMotion&&Ze.has(f)?{type:!1}:k));const P=m.animation;Jt(c)&&(c.add(f),P.then(()=>c.remove(f))),d.push(P)}return a&&Promise.all(d).then(()=>{a&&Fl(e,a)}),d}function Fs(e,t,s={}){const n=cs(e,t,s.custom);let{transition:i=e.getDefaultTransition()||{}}=n||{};s.transitionOverride&&(i=s.transitionOverride);const o=n?()=>Promise.all(Li(e,n,s)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:f}=i;return Hl(e,t,d+c,u,f,s)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,d]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>d())}else return Promise.all([o(),a(s.delay)])}function Hl(e,t,s=0,n=0,i=1,o){const a=[],l=(e.variantChildren.size-1)*n,c=i===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(Gl).forEach((d,u)=>{d.notify("AnimationStart",t),a.push(Fs(d,t,{...o,delay:s+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(a)}function Gl(e,t){return e.sortNodePosition(t)}function _l(e,t,s={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const i=t.map(o=>Fs(e,o,s));n=Promise.all(i)}else if(typeof t=="string")n=Fs(e,t,s);else{const i=typeof t=="function"?cs(e,t,s.custom):t;n=Promise.all(Li(e,i,s))}return n.then(()=>e.notify("AnimationComplete",t))}const Wl=[...Ks].reverse(),ql=Ks.length;function Xl(e){return t=>Promise.all(t.map(({animation:s,options:n})=>_l(e,s,n)))}function Kl(e){let t=Xl(e);const s=Zl();let n=!0;const i=(c,d)=>{const u=cs(e,d);if(u){const{transition:f,transitionEnd:m,...x}=u;c={...c,...x,...m}}return c};function o(c){t=c(e)}function a(c,d){const u=e.getProps(),f=e.getVariantContext(!0)||{},m=[],x=new Set;let k={},v=1/0;for(let V=0;V<ql;V++){const T=Wl[V],S=s[T],L=u[T]!==void 0?u[T]:f[T],E=Nt(L),M=T===d?S.isActive:null;M===!1&&(v=V);let I=L===f[T]&&L!==u[T]&&E;if(I&&n&&e.manuallyAnimateOnMount&&(I=!1),S.protectedKeys={...k},!S.isActive&&M===null||!L&&!S.prevProp||is(L)||typeof L=="boolean")continue;let w=Yl(S.prevProp,L)||T===d&&S.isActive&&!I&&E||V>v&&E,C=!1;const R=Array.isArray(L)?L:[L];let b=R.reduce(i,{});M===!1&&(b={});const{prevResolvedValues:j={}}=S,N={...j,...b},h=D=>{w=!0,x.has(D)&&(C=!0,x.delete(D)),S.needsAnimating[D]=!0};for(const D in N){const F=b[D],G=j[D];if(k.hasOwnProperty(D))continue;let H=!1;Xt(F)&&Xt(G)?H=!ri(F,G):H=F!==G,H?F!==void 0?h(D):x.add(D):F!==void 0&&x.has(D)?h(D):S.protectedKeys[D]=!0}S.prevProp=L,S.prevResolvedValues=b,S.isActive&&(k={...k,...b}),n&&e.blockInitialAnimation&&(w=!1),w&&(!I||C)&&m.push(...R.map(D=>({animation:D,options:{type:T,...c}})))}if(x.size){const V={};x.forEach(T=>{const S=e.getBaseTarget(T);S!==void 0&&(V[T]=S)}),m.push({animation:V})}let P=!!m.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(P=!1),n=!1,P?t(m):Promise.resolve()}function l(c,d,u){var f;if(s[c].isActive===d)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(x=>{var k;return(k=x.animationState)===null||k===void 0?void 0:k.setActive(c,d)}),s[c].isActive=d;const m=a(u,c);for(const x in s)s[x].protectedKeys={};return m}return{animateChanges:a,setActive:l,setAnimateFunction:o,getState:()=>s}}function Yl(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!ri(t,e):!1}function He(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Zl(){return{animate:He(!0),whileInView:He(),whileHover:He(),whileTap:He(),whileDrag:He(),whileFocus:He(),exit:He()}}class Jl extends ze{constructor(t){super(t),t.animationState||(t.animationState=Kl(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),is(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:s}=this.node.prevProps||{};t!==s&&this.updateAnimationControlsSubscription()}unmount(){}}let Ql=0;class ec extends ze{constructor(){super(...arguments),this.id=Ql++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:s,custom:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const o=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});s&&!t&&o.then(()=>s(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const tc={animation:{Feature:Jl},exit:{Feature:ec}},En=(e,t)=>Math.abs(e-t);function sc(e,t){const s=En(e.x,t.x),n=En(e.y,t.y);return Math.sqrt(s**2+n**2)}class Ii{constructor(t,s,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=ws(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,x=sc(f.offset,{x:0,y:0})>=3;if(!m&&!x)return;const{point:k}=f,{timestamp:v}=ue;this.history.push({...k,timestamp:v});const{onStart:P,onMove:V}=this.handlers;m||(P&&P(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),V&&V(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=bs(m,this.transformPagePoint),ne.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:x,onSessionEnd:k,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const P=ws(f.type==="pointercancel"?this.lastMoveEventInfo:bs(m,this.transformPagePoint),this.history);this.startEvent&&x&&x(f,P),k&&k(f,P)},!Qr(t))return;this.dragSnapToOrigin=o,this.handlers=s,this.transformPagePoint=n,this.contextWindow=i||window;const a=ls(t),l=bs(a,this.transformPagePoint),{point:c}=l,{timestamp:d}=ue;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=s;u&&u(t,ws(l,this.history)),this.removeListeners=Fe(Ae(this.contextWindow,"pointermove",this.handlePointerMove),Ae(this.contextWindow,"pointerup",this.handlePointerUp),Ae(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ee(this.updatePoint)}}function bs(e,t){return t?{point:t(e.point)}:e}function Dn(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ws({point:e},t){return{point:e,delta:Dn(e,Fi(t)),offset:Dn(e,nc(t)),velocity:rc(t,.1)}}function nc(e){return e[0]}function Fi(e){return e[e.length-1]}function rc(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,n=null;const i=Fi(e);for(;s>=0&&(n=e[s],!(i.timestamp-n.timestamp>Ke(t)));)s--;if(!n)return{x:0,y:0};const o=Ve(i.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const a={x:(i.x-n.x)/o,y:(i.y-n.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function be(e){return e.max-e.min}function Bs(e,t=0,s=.01){return Math.abs(e-t)<=s}function Ln(e,t,s,n=.5){e.origin=n,e.originPoint=ie(t.min,t.max,e.origin),e.scale=be(s)/be(t),(Bs(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ie(s.min,s.max,e.origin)-e.originPoint,(Bs(e.translate)||isNaN(e.translate))&&(e.translate=0)}function wt(e,t,s,n){Ln(e.x,t.x,s.x,n?n.originX:void 0),Ln(e.y,t.y,s.y,n?n.originY:void 0)}function In(e,t,s){e.min=s.min+t.min,e.max=e.min+be(t)}function ic(e,t,s){In(e.x,t.x,s.x),In(e.y,t.y,s.y)}function Fn(e,t,s){e.min=t.min-s.min,e.max=e.min+be(t)}function jt(e,t,s){Fn(e.x,t.x,s.x),Fn(e.y,t.y,s.y)}function oc(e,{min:t,max:s},n){return t!==void 0&&e<t?e=n?ie(t,e,n.min):Math.max(e,t):s!==void 0&&e>s&&(e=n?ie(s,e,n.max):Math.min(e,s)),e}function Bn(e,t,s){return{min:t!==void 0?e.min+t:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function ac(e,{top:t,left:s,bottom:n,right:i}){return{x:Bn(e.x,s,i),y:Bn(e.y,t,n)}}function On(e,t){let s=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,n]=[n,s]),{min:s,max:n}}function lc(e,t){return{x:On(e.x,t.x),y:On(e.y,t.y)}}function cc(e,t){let s=.5;const n=be(e),i=be(t);return i>n?s=Ct(t.min,t.max-n,e.min):n>i&&(s=Ct(e.min,e.max-i,t.min)),Be(0,1,s)}function dc(e,t){const s={};return t.min!==void 0&&(s.min=t.min-e.min),t.max!==void 0&&(s.max=t.max-e.min),s}const Os=.35;function uc(e=Os){return e===!1?e=0:e===!0&&(e=Os),{x:zn(e,"left","right"),y:zn(e,"top","bottom")}}function zn(e,t,s){return{min:$n(e,t),max:$n(e,s)}}function $n(e,t){return typeof e=="number"?e:e[t]||0}const Un=()=>({translate:0,scale:1,origin:0,originPoint:0}),at=()=>({x:Un(),y:Un()}),Hn=()=>({min:0,max:0}),le=()=>({x:Hn(),y:Hn()});function Se(e){return[e("x"),e("y")]}function Bi({top:e,left:t,right:s,bottom:n}){return{x:{min:t,max:s},y:{min:e,max:n}}}function hc({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function fc(e,t){if(!t)return e;const s=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function js(e){return e===void 0||e===1}function zs({scale:e,scaleX:t,scaleY:s}){return!js(e)||!js(t)||!js(s)}function _e(e){return zs(e)||Oi(e)||e.z||e.rotate||e.rotateX||e.rotateY}function Oi(e){return Gn(e.x)||Gn(e.y)}function Gn(e){return e&&e!=="0%"}function Qt(e,t,s){const n=e-s,i=t*n;return s+i}function _n(e,t,s,n,i){return i!==void 0&&(e=Qt(e,i,n)),Qt(e,s,n)+t}function $s(e,t=0,s=1,n,i){e.min=_n(e.min,t,s,n,i),e.max=_n(e.max,t,s,n,i)}function zi(e,{x:t,y:s}){$s(e.x,t.translate,t.scale,t.originPoint),$s(e.y,s.translate,s.scale,s.originPoint)}function mc(e,t,s,n=!1){const i=s.length;if(!i)return;t.x=t.y=1;let o,a;for(let l=0;l<i;l++){o=s[l],a=o.projectionDelta;const c=o.instance;c&&c.style&&c.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&lt(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,zi(e,a)),n&&_e(o.latestValues)&&lt(e,o.latestValues))}t.x=Wn(t.x),t.y=Wn(t.y)}function Wn(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Ie(e,t){e.min=e.min+t,e.max=e.max+t}function qn(e,t,[s,n,i]){const o=t[i]!==void 0?t[i]:.5,a=ie(e.min,e.max,o);$s(e,t[s],t[n],a,t.scale)}const pc=["x","scaleX","originX"],gc=["y","scaleY","originY"];function lt(e,t){qn(e.x,t,pc),qn(e.y,t,gc)}function $i(e,t){return Bi(fc(e.getBoundingClientRect(),t))}function xc(e,t,s){const n=$i(e,s),{scroll:i}=t;return i&&(Ie(n.x,i.offset.x),Ie(n.y,i.offset.y)),n}const Ui=({current:e})=>e?e.ownerDocument.defaultView:null,yc=new WeakMap;class vc{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=le(),this.visualElement=t}start(t,{snapToCursor:s=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(ls(u,"page").point)},o=(u,f)=>{const{drag:m,dragPropagation:x,onDragStart:k}=this.getProps();if(m&&!x&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=ti(m),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Se(P=>{let V=this.getAxisMotionValue(P).get()||0;if(ke.test(V)){const{projection:T}=this.visualElement;if(T&&T.layout){const S=T.layout.layoutBox[P];S&&(V=be(S)*(parseFloat(V)/100))}}this.originPoint[P]=V}),k&&ne.update(()=>k(u,f),!1,!0);const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(u,f)=>{const{dragPropagation:m,dragDirectionLock:x,onDirectionLock:k,onDrag:v}=this.getProps();if(!m&&!this.openGlobalLock)return;const{offset:P}=f;if(x&&this.currentDirection===null){this.currentDirection=bc(P),this.currentDirection!==null&&k&&k(this.currentDirection);return}this.updateAxis("x",f.point,P),this.updateAxis("y",f.point,P),this.visualElement.render(),v&&v(u,f)},l=(u,f)=>this.stop(u,f),c=()=>Se(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new Ii(t,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:Ui(this.visualElement)})}stop(t,s){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&ne.update(()=>o(t,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:s}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(t,s,n){const{drag:i}=this.getProps();if(!n||!Bt(t,i,this.currentDirection))return;const o=this.getAxisMotionValue(t);let a=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(a=oc(a,this.constraints[t],this.elastic[t])),o.set(a)}resolveConstraints(){var t;const{dragConstraints:s,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,o=this.constraints;s&&it(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&i?this.constraints=ac(i.layoutBox,s):this.constraints=!1,this.elastic=uc(n),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Se(a=>{this.getAxisMotionValue(a)&&(this.constraints[a]=dc(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:s}=this.getProps();if(!t||!it(t))return!1;const n=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=xc(n,i.root,this.visualElement.getTransformPagePoint());let a=lc(i.layout.layoutBox,o);if(s){const l=s(hc(a));this.hasMutatedConstraints=!!l,l&&(a=Bi(l))}return a}startAnimation(t){const{drag:s,dragMomentum:n,dragElastic:i,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Se(u=>{if(!Bt(u,s,this.currentDirection))return;let f=c&&c[u]||{};a&&(f={min:0,max:0});const m=i?200:1e6,x=i?40:1e7,k={type:"inertia",velocity:n?t[u]:0,bounceStiffness:m,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...o,...f};return this.startAxisValueAnimation(u,k)});return Promise.all(d).then(l)}startAxisValueAnimation(t,s){const n=this.getAxisMotionValue(t);return n.start(hn(t,n,0,s))}stopAnimation(){Se(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Se(t=>{var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(t){var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(t){const s="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),i=n[s];return i||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Se(s=>{const{drag:n}=this.getProps();if(!Bt(s,n,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(s);if(i&&i.layout){const{min:a,max:l}=i.layout.layoutBox[s];o.set(t[s]-ie(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!it(s)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Se(a=>{const l=this.getAxisMotionValue(a);if(l){const c=l.get();i[a]=cc({min:c,max:c},this.constraints[a])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Se(a=>{if(!Bt(a,t,null))return;const l=this.getAxisMotionValue(a),{min:c,max:d}=this.constraints[a];l.set(ie(c,d,i[a]))})}addListeners(){if(!this.visualElement.current)return;yc.set(this.visualElement,this);const t=this.visualElement.current,s=Ae(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();it(c)&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),n();const a=Re(window,"resize",()=>this.scalePositionWithinConstraints()),l=i.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Se(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=c[u].translate,f.set(f.get()+c[u].translate))}),this.visualElement.render())});return()=>{a(),s(),o(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:a=Os,dragMomentum:l=!0}=t;return{...t,drag:s,dragDirectionLock:n,dragPropagation:i,dragConstraints:o,dragElastic:a,dragMomentum:l}}}function Bt(e,t,s){return(t===!0||t===e)&&(s===null||s===e)}function bc(e,t=10){let s=null;return Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x"),s}class wc extends ze{constructor(t){super(t),this.removeGroupControls=ae,this.removeListeners=ae,this.controls=new vc(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ae}unmount(){this.removeGroupControls(),this.removeListeners()}}const Xn=e=>(t,s)=>{e&&ne.update(()=>e(t,s))};class jc extends ze{constructor(){super(...arguments),this.removePointerDownListener=ae}onPointerDown(t){this.session=new Ii(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Ui(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:s,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:Xn(t),onStart:Xn(s),onMove:n,onEnd:(o,a)=>{delete this.session,i&&ne.update(()=>i(o,a))}}}mount(){this.removePointerDownListener=Ae(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Nc(){const e=g.useContext(ns);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:s,register:n}=e,i=g.useId();return g.useEffect(()=>n(i),[]),!t&&s?[!1,()=>s&&s(i)]:[!0]}const _t={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Kn(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const pt={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(J.test(e))e=parseFloat(e);else return e;const s=Kn(e,t.target.x),n=Kn(e,t.target.y);return`${s}% ${n}%`}},Sc={correct:(e,{treeScale:t,projectionDelta:s})=>{const n=e,i=Oe.parse(e);if(i.length>5)return n;const o=Oe.createTransformer(e),a=typeof i[0]!="number"?1:0,l=s.x.scale*t.x,c=s.y.scale*t.y;i[0+a]/=l,i[1+a]/=c;const d=ie(l,c,.5);return typeof i[2+a]=="number"&&(i[2+a]/=d),typeof i[3+a]=="number"&&(i[3+a]/=d),o(i)}};class Cc extends _s.Component{componentDidMount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n,layoutId:i}=this.props,{projection:o}=t;Vo(Tc),o&&(s.group&&s.group.add(o),n&&n.register&&i&&n.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),_t.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:s,visualElement:n,drag:i,isPresent:o}=this.props,a=n.projection;return a&&(a.isPresent=o,i||t.layoutDependency!==s||s===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==o&&(o?a.promote():a.relegate()||ne.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:i}=t;i&&(i.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Hi(e){const[t,s]=Nc(),n=g.useContext(Zs);return _s.createElement(Cc,{...e,layoutGroup:n,switchLayoutGroup:g.useContext(Br),isPresent:t,safeToRemove:s})}const Tc={borderRadius:{...pt,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:pt,borderTopRightRadius:pt,borderBottomLeftRadius:pt,borderBottomRightRadius:pt,boxShadow:Sc},Gi=["TopLeft","TopRight","BottomLeft","BottomRight"],Pc=Gi.length,Yn=e=>typeof e=="string"?parseFloat(e):e,Zn=e=>typeof e=="number"||J.test(e);function kc(e,t,s,n,i,o){i?(e.opacity=ie(0,s.opacity!==void 0?s.opacity:1,Mc(n)),e.opacityExit=ie(t.opacity!==void 0?t.opacity:1,0,Rc(n))):o&&(e.opacity=ie(t.opacity!==void 0?t.opacity:1,s.opacity!==void 0?s.opacity:1,n));for(let a=0;a<Pc;a++){const l=`border${Gi[a]}Radius`;let c=Jn(t,l),d=Jn(s,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||Zn(c)===Zn(d)?(e[l]=Math.max(ie(Yn(c),Yn(d),n),0),(ke.test(d)||ke.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||s.rotate)&&(e.rotate=ie(t.rotate||0,s.rotate||0,n))}function Jn(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Mc=_i(0,.5,fi),Rc=_i(.5,.95,ae);function _i(e,t,s){return n=>n<e?0:n>t?1:s(Ct(e,t,n))}function Qn(e,t){e.min=t.min,e.max=t.max}function Ne(e,t){Qn(e.x,t.x),Qn(e.y,t.y)}function er(e,t,s,n,i){return e-=t,e=Qt(e,1/s,n),i!==void 0&&(e=Qt(e,1/i,n)),e}function Ac(e,t=0,s=1,n=.5,i,o=e,a=e){if(ke.test(t)&&(t=parseFloat(t),t=ie(a.min,a.max,t/100)-a.min),typeof t!="number")return;let l=ie(o.min,o.max,n);e===o&&(l-=t),e.min=er(e.min,t,s,l,i),e.max=er(e.max,t,s,l,i)}function tr(e,t,[s,n,i],o,a){Ac(e,t[s],t[n],t[i],t.scale,o,a)}const Vc=["x","scaleX","originX"],Ec=["y","scaleY","originY"];function sr(e,t,s,n){tr(e.x,t,Vc,s?s.x:void 0,n?n.x:void 0),tr(e.y,t,Ec,s?s.y:void 0,n?n.y:void 0)}function nr(e){return e.translate===0&&e.scale===1}function Wi(e){return nr(e.x)&&nr(e.y)}function Dc(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function qi(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function rr(e){return be(e.x)/be(e.y)}class Lc{constructor(){this.members=[]}add(t){fn(this.members,t),t.scheduleRender()}remove(t){if(mn(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(t){const s=this.members.findIndex(i=>t===i);if(s===0)return!1;let n;for(let i=s;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(t,s){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,s&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:i}=t.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:s,resumingFrom:n}=t;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ir(e,t,s){let n="";const i=e.x.translate/t.x,o=e.y.translate/t.y;if((i||o)&&(n=`translate3d(${i}px, ${o}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),s){const{rotate:c,rotateX:d,rotateY:u}=s;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const Ic=(e,t)=>e.depth-t.depth;class Fc{constructor(){this.children=[],this.isDirty=!1}add(t){fn(this.children,t),this.isDirty=!0}remove(t){mn(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Ic),this.isDirty=!1,this.children.forEach(t)}}function Bc(e,t){const s=performance.now(),n=({timestamp:i})=>{const o=i-s;o>=t&&(Ee(n),e(o-t))};return ne.read(n,!0),()=>Ee(n)}function Oc(e){window.MotionDebug&&window.MotionDebug.record(e)}function zc(e){return e instanceof SVGElement&&e.tagName!=="svg"}function $c(e,t,s){const n=xe(e)?e:ct(e);return n.start(hn("",n,t,s)),n.animation}const or=["","X","Y","Z"],Uc={visibility:"hidden"},ar=1e3;let Hc=0;const We={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Xi({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(a={},l=t==null?void 0:t()){this.id=Hc++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,We.totalNodes=We.resolvedTargetDeltas=We.recalculatedProjection=0,this.nodes.forEach(Wc),this.nodes.forEach(Zc),this.nodes.forEach(Jc),this.nodes.forEach(qc),Oc(We)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Fc)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new pn),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=zc(a),this.instance=a;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let f;const m=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Bc(m,250),_t.hasAnimatedSinceResize&&(_t.hasAnimatedSinceResize=!1,this.nodes.forEach(cr))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeTargetChanged:x,layout:k})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||u.getDefaultTransition()||nd,{onLayoutAnimationStart:P,onLayoutAnimationComplete:V}=u.getProps(),T=!this.targetLayout||!qi(this.targetLayout,k)||x,S=!m&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||m&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,S);const L={...un(v,"layout"),onPlay:P,onComplete:V};(u.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else m||cr(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=k})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ee(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Qc),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(lr);return}this.isUpdating||this.nodes.forEach(Kc),this.isUpdating=!1,this.nodes.forEach(Yc),this.nodes.forEach(Gc),this.nodes.forEach(_c),this.clearAllSnapshots();const l=performance.now();ue.delta=Be(0,1e3/60,l-ue.timestamp),ue.timestamp=l,ue.isProcessing=!0,hs.update.process(ue),hs.preRender.process(ue),hs.render.process(ue),ue.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Xc),this.sharedNodes.forEach(ed)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ne.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ne.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=le(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:n(this.instance),offset:s(this.instance)})}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!Wi(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;a&&(l||_e(this.latestValues)||u)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),rd(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return le();const l=a.measureViewportBox(),{scroll:c}=this.root;return c&&(Ie(l.x,c.offset.x),Ie(l.y,c.offset.y)),l}removeElementScroll(a){const l=le();Ne(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:f}=d;if(d!==this.root&&u&&f.layoutScroll){if(u.isRoot){Ne(l,a);const{scroll:m}=this.root;m&&(Ie(l.x,-m.offset.x),Ie(l.y,-m.offset.y))}Ie(l.x,u.offset.x),Ie(l.y,u.offset.y)}}return l}applyTransform(a,l=!1){const c=le();Ne(c,a);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&lt(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),_e(u.latestValues)&&lt(c,u.latestValues)}return _e(this.latestValues)&&lt(c,this.latestValues),c}removeTransform(a){const l=le();Ne(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!_e(d.latestValues))continue;zs(d.latestValues)&&d.updateSnapshot();const u=le(),f=d.measurePageBox();Ne(u,f),sr(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return _e(this.latestValues)&&sr(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ue.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=ue.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=le(),this.relativeTargetOrigin=le(),jt(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Ne(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=le(),this.targetWithTransforms=le()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ic(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ne(this.target,this.layout.layoutBox),zi(this.target,this.targetDelta)):Ne(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=le(),this.relativeTargetOrigin=le(),jt(this.relativeTargetOrigin,this.target,x.target),Ne(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}We.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||zs(this.parent.latestValues)||Oi(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===ue.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;Ne(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,x=this.treeScale.y;mc(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:k}=l;if(!k){this.projectionTransform&&(this.projectionDelta=at(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=at(),this.projectionDeltaWithTransform=at());const v=this.projectionTransform;wt(this.projectionDelta,this.layoutCorrected,k,this.latestValues),this.projectionTransform=ir(this.projectionDelta,this.treeScale),(this.projectionTransform!==v||this.treeScale.x!==m||this.treeScale.y!==x)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",k)),We.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},f=at();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=le(),x=c?c.source:void 0,k=this.layout?this.layout.source:void 0,v=x!==k,P=this.getStack(),V=!P||P.members.length<=1,T=!!(v&&!V&&this.options.crossfade===!0&&!this.path.some(sd));this.animationProgress=0;let S;this.mixTargetDelta=L=>{const E=L/1e3;dr(f.x,a.x,E),dr(f.y,a.y,E),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(jt(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),td(this.relativeTarget,this.relativeTargetOrigin,m,E),S&&Dc(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=le()),Ne(S,this.relativeTarget)),v&&(this.animationValues=u,kc(u,d,this.latestValues,E,T,V)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ee(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ne.update(()=>{_t.hasAnimatedSinceResize=!0,this.currentAnimation=$c(0,ar,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(ar),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=a;if(!(!l||!c||!d)){if(this!==a&&this.layout&&d&&Ki(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||le();const f=be(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+f;const m=be(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+m}Ne(l,c),lt(l,u),wt(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Lc),this.sharedNodes.get(a).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<or.length;u++){const f="rotate"+or[u];c[f]&&(d[f]=c[f],a.setStaticValue(f,0))}a.render();for(const u in d)a.setStaticValue(u,d[u]);a.scheduleRender()}getProjectionStyles(a){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Uc;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Gt(a==null?void 0:a.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=Gt(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!_e(this.latestValues)&&(v.transform=u?u({},""):"none",this.hasProjected=!1),v}const m=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=ir(this.projectionDeltaWithTransform,this.treeScale,m),u&&(d.transform=u(m,d.transform));const{x,y:k}=this.projectionDelta;d.transformOrigin=`${x.origin*100}% ${k.origin*100}% 0`,f.animationValues?d.opacity=f===this?(c=(l=m.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:d.opacity=f===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const v in Wt){if(m[v]===void 0)continue;const{correct:P,applyTo:V}=Wt[v],T=d.transform==="none"?m[v]:P(m[v],f);if(V){const S=V.length;for(let L=0;L<S;L++)d[V[L]]=T}else d[v]=T}return this.options.layoutId&&(d.pointerEvents=f===this?Gt(a==null?void 0:a.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(lr),this.root.sharedNodes.clear()}}}function Gc(e){e.updateLayout()}function _c(e){var t;const s=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=e.layout,{animationType:o}=e.options,a=s.source!==e.layout.source;o==="size"?Se(f=>{const m=a?s.measuredBox[f]:s.layoutBox[f],x=be(m);m.min=n[f].min,m.max=m.min+x}):Ki(o,s.layoutBox,n)&&Se(f=>{const m=a?s.measuredBox[f]:s.layoutBox[f],x=be(n[f]);m.max=m.min+x,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+x)});const l=at();wt(l,n,s.layoutBox);const c=at();a?wt(c,e.applyTransform(i,!0),s.measuredBox):wt(c,n,s.layoutBox);const d=!Wi(l);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:x}=f;if(m&&x){const k=le();jt(k,s.layoutBox,m.layoutBox);const v=le();jt(v,n,x.layoutBox),qi(k,v)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=k,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Wc(e){We.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function qc(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Xc(e){e.clearSnapshot()}function lr(e){e.clearMeasurements()}function Kc(e){e.isLayoutDirty=!1}function Yc(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function cr(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Zc(e){e.resolveTargetDelta()}function Jc(e){e.calcProjection()}function Qc(e){e.resetRotation()}function ed(e){e.removeLeadSnapshot()}function dr(e,t,s){e.translate=ie(t.translate,0,s),e.scale=ie(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function ur(e,t,s,n){e.min=ie(t.min,s.min,n),e.max=ie(t.max,s.max,n)}function td(e,t,s,n){ur(e.x,t.x,s.x,n),ur(e.y,t.y,s.y,n)}function sd(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const nd={duration:.45,ease:[.4,0,.1,1]},hr=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),fr=hr("applewebkit/")&&!hr("chrome/")?Math.round:ae;function mr(e){e.min=fr(e.min),e.max=fr(e.max)}function rd(e){mr(e.x),mr(e.y)}function Ki(e,t,s){return e==="position"||e==="preserve-aspect"&&!Bs(rr(t),rr(s),.2)}const id=Xi({attachResizeListener:(e,t)=>Re(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ns={current:void 0},Yi=Xi({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ns.current){const e=new id({});e.mount(window),e.setOptions({layoutScroll:!0}),Ns.current=e}return Ns.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),od={pan:{Feature:jc},drag:{Feature:wc,ProjectionNode:Yi,MeasureLayout:Hi}},ad=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function ld(e){const t=ad.exec(e);if(!t)return[,];const[,s,n]=t;return[s,n]}function Us(e,t,s=1){const[n,i]=ld(e);if(!n)return;const o=window.getComputedStyle(t).getPropertyValue(n);if(o){const a=o.trim();return Vi(a)?parseFloat(a):a}else return As(i)?Us(i,t,s+1):i}function cd(e,{...t},s){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:s};s&&(s={...s}),e.values.forEach(i=>{const o=i.get();if(!As(o))return;const a=Us(o,n);a&&i.set(a)});for(const i in t){const o=t[i];if(!As(o))continue;const a=Us(o,n);a&&(t[i]=a,s||(s={}),s[i]===void 0&&(s[i]=o))}return{target:t,transitionEnd:s}}const dd=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Zi=e=>dd.has(e),ud=e=>Object.keys(e).some(Zi),pr=e=>e===Je||e===J,gr=(e,t)=>parseFloat(e.split(", ")[t]),xr=(e,t)=>(s,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/);if(i)return gr(i[1],t);{const o=n.match(/^matrix\((.+)\)$/);return o?gr(o[1],e):0}},hd=new Set(["x","y","z"]),fd=Tt.filter(e=>!hd.has(e));function md(e){const t=[];return fd.forEach(s=>{const n=e.getValue(s);n!==void 0&&(t.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),t.length&&e.render(),t}const dt={width:({x:e},{paddingLeft:t="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),height:({y:e},{paddingTop:t="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:xr(4,13),y:xr(5,14)};dt.translateX=dt.x;dt.translateY=dt.y;const pd=(e,t,s)=>{const n=t.measureViewportBox(),i=t.current,o=getComputedStyle(i),{display:a}=o,l={};a==="none"&&t.setStaticValue("display",e.display||"block"),s.forEach(d=>{l[d]=dt[d](n,o)}),t.render();const c=t.measureViewportBox();return s.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=dt[d](c,o)}),e},gd=(e,t,s={},n={})=>{t={...t},n={...n};const i=Object.keys(t).filter(Zi);let o=[],a=!1;const l=[];if(i.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=s[c],f=mt(u);const m=t[c];let x;if(Xt(m)){const k=m.length,v=m[0]===null?1:0;u=m[v],f=mt(u);for(let P=v;P<k&&m[P]!==null;P++)x?on(mt(m[P])===x):x=mt(m[P])}else x=mt(m);if(f!==x)if(pr(f)&&pr(x)){const k=d.get();typeof k=="string"&&d.set(parseFloat(k)),typeof m=="string"?t[c]=parseFloat(m):Array.isArray(m)&&x===J&&(t[c]=m.map(parseFloat))}else f!=null&&f.transform&&(x!=null&&x.transform)&&(u===0||m===0)?u===0?d.set(x.transform(u)):t[c]=f.transform(m):(a||(o=md(e),a=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(m))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=pd(t,e,l);return o.length&&o.forEach(([u,f])=>{e.getValue(u).set(f)}),e.render(),rs&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function xd(e,t,s,n){return ud(t)?gd(e,t,s,n):{target:t,transitionEnd:n}}const yd=(e,t,s,n)=>{const i=cd(e,t,n);return t=i.target,n=i.transitionEnd,xd(e,t,s,n)},Hs={current:null},Ji={current:!1};function vd(){if(Ji.current=!0,!!rs)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Hs.current=e.matches;e.addListener(t),t()}else Hs.current=!1}function bd(e,t,s){const{willChange:n}=t;for(const i in t){const o=t[i],a=s[i];if(xe(o))e.addValue(i,o),Jt(n)&&n.add(i);else if(xe(a))e.addValue(i,ct(o,{owner:e})),Jt(n)&&n.remove(i);else if(a!==o)if(e.hasValue(i)){const l=e.getValue(i);!l.hasAnimated&&l.set(o)}else{const l=e.getStaticValue(i);e.addValue(i,ct(l!==void 0?l:o,{owner:e}))}}for(const i in s)t[i]===void 0&&e.removeValue(i);return t}const yr=new WeakMap,Qi=Object.keys(St),wd=Qi.length,vr=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],jd=Ys.length;class Nd{constructor({parent:t,props:s,presenceContext:n,reducedMotionConfig:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ne.render(this.render,!1,!0);const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=s.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=s,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.isControllingVariants=os(s),this.isVariantNode=Fr(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(s,{});for(const f in u){const m=u[f];l[f]!==void 0&&xe(m)&&(m.set(l[f],!1),Jt(d)&&d.add(f))}}scrapeMotionValuesFromProps(t,s){return{}}mount(t){this.current=t,yr.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),Ji.current||vd(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Hs.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){yr.delete(this.current),this.projection&&this.projection.unmount(),Ee(this.notifyUpdate),Ee(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,s){const n=Ze.has(t),i=s.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&ne.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=s.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{i(),o()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...s},n,i,o){let a,l;for(let c=0;c<wd;c++){const d=Qi[c],{isEnabled:u,Feature:f,ProjectionNode:m,MeasureLayout:x}=St[d];m&&(a=m),u(s)&&(!this.features[d]&&f&&(this.features[d]=new f(this)),x&&(l=x))}if((this.type==="html"||this.type==="svg")&&!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:f,layoutScroll:m,layoutRoot:x}=s;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||f&&it(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:o,layoutScroll:m,layoutRoot:x})}return l}updateFeatures(){for(const t in this.features){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):le()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,s){this.latestValues[t]=s}makeTargetAnimatable(t,s=!0){return this.makeTargetAnimatableFromInstance(t,this.props,s)}update(t,s){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<vr.length;n++){const i=vr[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o=t["on"+i];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=bd(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const s={};for(let n=0;n<jd;n++){const i=Ys[n],o=this.props[i];(Nt(o)||o===!1)&&(s[i]=o)}return s}addVariantChild(t){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(t),()=>s.variantChildren.delete(t)}addValue(t,s){s!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,s)),this.values.set(t,s),this.latestValues[t]=s.get()}removeValue(t){this.values.delete(t);const s=this.valueSubscriptions.get(t);s&&(s(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,s){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&s!==void 0&&(n=ct(s,{owner:this}),this.addValue(t,n)),n}readValue(t){var s;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(s=this.getBaseTargetFromProps(this.props,t))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,s){this.baseTarget[t]=s}getBaseTarget(t){var s;const{initial:n}=this.props,i=typeof n=="string"||typeof n=="object"?(s=rn(this.props,n))===null||s===void 0?void 0:s[t]:void 0;if(n&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!xe(o)?o:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,s){return this.events[t]||(this.events[t]=new pn),this.events[t].add(s)}notify(t,...s){this.events[t]&&this.events[t].notify(...s)}}class eo extends Nd{sortInstanceNodePosition(t,s){return t.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(t,s){return t.style?t.style[s]:void 0}removeValueFromRenderState(t,{vars:s,style:n}){delete s[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:s,...n},{transformValues:i},o){let a=zl(n,t||{},this);if(i&&(s&&(s=i(s)),n&&(n=i(n)),a&&(a=i(a))),o){Bl(this,n,a);const l=yd(this,n,a,s);s=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:s,...n}}}function Sd(e){return window.getComputedStyle(e)}class Cd extends eo{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,s){if(Ze.has(s)){const n=dn(s);return n&&n.default||0}else{const n=Sd(t),i=($r(s)?n.getPropertyValue(s):n[s])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:s}){return $i(t,s)}build(t,s,n,i){Qs(t,s,n,i.transformTemplate)}scrapeMotionValuesFromProps(t,s){return nn(t,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;xe(t)&&(this.childSubscription=t.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}renderInstance(t,s,n,i){qr(t,s,n,i)}}class Td extends eo{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,s){return t[s]}readValueFromInstance(t,s){if(Ze.has(s)){const n=dn(s);return n&&n.default||0}return s=Xr.has(s)?s:Xs(s),t.getAttribute(s)}measureInstanceViewportBox(){return le()}scrapeMotionValuesFromProps(t,s){return Yr(t,s)}build(t,s,n,i){tn(t,s,n,this.isSVGTag,i.transformTemplate)}renderInstance(t,s,n,i){Kr(t,s,n,i)}mount(t){this.isSVGTag=sn(t.tagName),super.mount(t)}}const Pd=(e,t)=>Js(e)?new Td(t,{enableHardwareAcceleration:!1}):new Cd(t,{enableHardwareAcceleration:!0}),kd={layout:{ProjectionNode:Yi,MeasureLayout:Hi}},Md={...tc,...wa,...od,...kd},$=Ro((e,t)=>la(e,t,Md,Pd));function to(){const e=g.useRef(!1);return qs(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Rd(){const e=to(),[t,s]=g.useState(0),n=g.useCallback(()=>{e.current&&s(t+1)},[t]);return[g.useCallback(()=>ne.postRender(n),[n]),t]}class Ad extends g.Component{getSnapshotBeforeUpdate(t){const s=this.props.childRef.current;if(s&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=s.offsetHeight||0,n.width=s.offsetWidth||0,n.top=s.offsetTop,n.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Vd({children:e,isPresent:t}){const s=g.useId(),n=g.useRef(null),i=g.useRef({width:0,height:0,top:0,left:0});return g.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=i.current;if(t||!n.current||!o||!a)return;n.current.dataset.motionPopId=s;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),g.createElement(Ad,{isPresent:t,childRef:n,sizeRef:i},g.cloneElement(e,{ref:n}))}const Ss=({children:e,initial:t,isPresent:s,onExitComplete:n,custom:i,presenceAffectsLayout:o,mode:a})=>{const l=Zr(Ed),c=g.useId(),d=g.useMemo(()=>({id:c,initial:t,isPresent:s,custom:i,onExitComplete:u=>{l.set(u,!0);for(const f of l.values())if(!f)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),o?void 0:[s]);return g.useMemo(()=>{l.forEach((u,f)=>l.set(f,!1))},[s]),g.useEffect(()=>{!s&&!l.size&&n&&n()},[s]),a==="popLayout"&&(e=g.createElement(Vd,{isPresent:s},e)),g.createElement(ns.Provider,{value:d},e)};function Ed(){return new Map}function Dd(e){return g.useEffect(()=>()=>e(),[])}const qe=e=>e.key||"";function Ld(e,t){e.forEach(s=>{const n=qe(s);t.set(n,s)})}function Id(e){const t=[];return g.Children.forEach(e,s=>{g.isValidElement(s)&&t.push(s)}),t}const pe=({children:e,custom:t,initial:s=!0,onExitComplete:n,exitBeforeEnter:i,presenceAffectsLayout:o=!0,mode:a="sync"})=>{const l=g.useContext(Zs).forceRender||Rd()[0],c=to(),d=Id(e);let u=d;const f=g.useRef(new Map).current,m=g.useRef(u),x=g.useRef(new Map).current,k=g.useRef(!0);if(qs(()=>{k.current=!1,Ld(d,x),m.current=u}),Dd(()=>{k.current=!0,x.clear(),f.clear()}),k.current)return g.createElement(g.Fragment,null,u.map(T=>g.createElement(Ss,{key:qe(T),isPresent:!0,initial:s?void 0:!1,presenceAffectsLayout:o,mode:a},T)));u=[...u];const v=m.current.map(qe),P=d.map(qe),V=v.length;for(let T=0;T<V;T++){const S=v[T];P.indexOf(S)===-1&&!f.has(S)&&f.set(S,void 0)}return a==="wait"&&f.size&&(u=[]),f.forEach((T,S)=>{if(P.indexOf(S)!==-1)return;const L=x.get(S);if(!L)return;const E=v.indexOf(S);let M=T;if(!M){const I=()=>{f.delete(S);const A=Array.from(x.keys()).filter(w=>!P.includes(w));if(A.forEach(w=>x.delete(w)),m.current=d.filter(w=>{const C=qe(w);return C===S||A.includes(C)}),!f.size){if(c.current===!1)return;l(),n&&n()}};M=g.createElement(Ss,{key:qe(L),isPresent:!1,onExitComplete:I,custom:t,presenceAffectsLayout:o,mode:a},L),f.set(S,M)}u.splice(E,0,M)}),u=u.map(T=>{const S=T.key;return f.has(S)?T:g.createElement(Ss,{key:qe(T),isPresent:!0,presenceAffectsLayout:o,mode:a},T)}),g.createElement(g.Fragment,null,f.size?u:u.map(T=>g.cloneElement(T)))};function so(e){var t,s,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(s=so(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}function oe(){for(var e,t,s=0,n="",i=arguments.length;s<i;s++)(e=arguments[s])&&(t=so(e))&&(n&&(n+=" "),n+=t);return n}const Fd=({game:e})=>{const t=e.status==="available",s=e.status==="coming-soon",n=e.status==="maintenance",i=r.jsxs($.div,{whileHover:t?{scale:1.02}:{},whileTap:t?{scale:.98}:{},className:oe("relative h-full bg-gray-800 rounded-xl border-2 overflow-hidden transition-all duration-300",{"border-gray-700 hover:border-purple-500 cursor-pointer shadow-lg hover:shadow-purple-500/20":t,"border-gray-700 opacity-75 cursor-not-allowed":s,"border-orange-600 opacity-75 cursor-not-allowed":n}),children:[(s||n)&&r.jsx("div",{className:"absolute top-2 right-2 z-10",children:r.jsx("span",{className:oe("px-2 py-1 text-xs sm:px-3 sm:text-xs font-pixel rounded-full",{"bg-blue-600 text-white":s,"bg-orange-600 text-white":n}),children:s?"即将推出":"维护中"})}),r.jsx("div",{className:"h-24 sm:h-32 bg-gradient-to-br from-purple-900/50 to-pink-900/50 flex items-center justify-center",children:r.jsx("span",{className:"text-4xl sm:text-6xl",children:e.image})}),r.jsxs("div",{className:"p-3 sm:p-4 space-y-2 sm:space-y-3",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-game font-bold text-white",children:e.title}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400 line-clamp-2",children:e.description}),r.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:e.tags.map(o=>r.jsx("span",{className:"px-1.5 py-0.5 sm:px-2 sm:py-1 text-xs bg-gray-700 text-gray-300 rounded-md",children:o},o))}),r.jsxs("div",{className:"pt-2 sm:pt-3 border-t border-gray-700 grid grid-cols-3 gap-1 sm:gap-2 text-xs text-gray-500",children:[r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"难度"}),r.jsx("div",{className:oe("text-xs",{"text-green-400":e.difficulty==="简单","text-yellow-400":e.difficulty==="中等","text-red-400":e.difficulty==="困难"}),children:e.difficulty})]}),r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"玩家"}),r.jsx("div",{className:"text-xs",children:e.players})]}),r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"时长"}),r.jsx("div",{className:"text-xs",children:e.time})]})]}),t&&r.jsx("button",{className:"w-full mt-3 sm:mt-4 px-3 py-2 sm:px-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-game text-xs sm:text-sm rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all active:scale-95",children:"开始游戏"})]})]});return t?r.jsx(Ms,{to:e.path,children:i}):i},Bd=()=>{const[e,t]=g.useState(0),[s,n]=g.useState(!1),[i,o]=g.useState(null);return g.useEffect(()=>{let a;a="http://socket.qingfengyueying.xyz/stats",console.log("[OnlineStats] 正在连接到:",a);const l=Ws(a,{transports:["websocket","polling"],upgrade:!0,timeout:1e4,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3});return l.on("connect",()=>{console.log("[OnlineStats] 连接成功, Socket ID:",l.id),n(!0),l.emit("get-online-count")}),l.on("online-count",c=>{console.log("[OnlineStats] 收到在线人数:",c.count),t(c.count||0)}),l.on("user-count-update",c=>{console.log("[OnlineStats] 在线人数更新:",c.count),t(c.count||0)}),l.on("connect_error",c=>{console.error("[OnlineStats] 连接错误:",c.message),n(!1)}),l.on("disconnect",c=>{console.log("[OnlineStats] 连接断开, 原因:",c),n(!1)}),l.on("reconnect",c=>{console.log("[OnlineStats] 重连成功, 尝试次数:",c),n(!0),l.emit("get-online-count")}),l.on("reconnect_failed",()=>{console.error("[OnlineStats] 重连失败"),n(!1),t(Math.floor(Math.random()*30)+5)}),o(l),()=>{console.log("[OnlineStats] 清理Socket连接"),l&&l.disconnect()}},[]),{onlineCount:e,isConnected:s,socket:i}},br=[{id:"gomoku",title:"五子棋",description:"经典双人对战游戏",image:"♟️",path:"/games/gomoku",tags:["双人","策略","PVP"],difficulty:"简单",players:"2人",time:"10-20分钟",status:"available"},{id:"2048",title:"2048",description:"数字合并益智游戏",image:"🔢",path:"/games/2048",tags:["单人","益智","策略"],difficulty:"中等",players:"1人",time:"10-30分钟",status:"available"},{id:"snake",title:"贪吃蛇",description:"经典贪吃蛇游戏",image:"🐍",path:"/games/snake",tags:["单人","休闲","经典"],difficulty:"简单",players:"1人",time:"5-10分钟",status:"available"},{id:"popstar",title:"消灭星星",description:"点击消除同色方块",image:"⭐",path:"/games/popstar",tags:["单人","休闲","益智"],difficulty:"简单",players:"1人",time:"5-15分钟",status:"available"},{id:"tictactoe",title:"井字棋",description:"简单有趣的对战游戏",image:"❌",path:"/games/tictactoe",tags:["双人","策略","PVP"],difficulty:"简单",players:"1-2人",time:"2-5分钟",status:"available"},{id:"memory",title:"记忆翻牌",description:"考验记忆力的配对游戏",image:"🎴",path:"/games/memory",tags:["单人","益智","记忆"],difficulty:"简单",players:"1人",time:"5-10分钟",status:"available"},{id:"sudoku",title:"数独",description:"经典数字填空游戏",image:"🔢",path:"/games/sudoku",tags:["单人","益智","逻辑"],difficulty:"困难",players:"1人",time:"15-30分钟",status:"available"},{id:"breakout",title:"打砖块",description:"经典弹球消除游戏",image:"🧱",path:"/games/breakout",tags:["单人","休闲","经典"],difficulty:"中等",players:"1人",time:"10-20分钟",status:"available"}],Od=()=>{const[e,t]=g.useState("全部"),{onlineCount:s,isConnected:n}=Bd(),i=["全部","双人","单人","策略","休闲","益智"],o=g.useMemo(()=>e==="全部"?br:br.filter(l=>l.tags.includes(e)),[e]),a=g.useMemo(()=>({available:o.filter(l=>l.status==="available").length,comingSoon:o.filter(l=>l.status==="coming-soon").length,onlineUsers:s}),[o,s]);return r.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[r.jsxs($.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center space-y-4 sm:space-y-6",children:[r.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-game font-bold",children:r.jsx("span",{className:"bg-gradient-to-r from-purple-400 via-pink-400 to-red-400 bg-clip-text text-transparent",children:"游戏合集"})}),r.jsx("p",{className:"text-base sm:text-xl text-gray-400 font-game px-4",children:"精选经典小游戏，随时随地享受游戏乐趣"}),r.jsxs("div",{className:"flex justify-center gap-3 sm:gap-8 mt-6 sm:mt-8 px-4",children:[r.jsxs($.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsx("div",{className:"text-xl sm:text-3xl font-bold text-purple-400",children:a.available}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"可玩游戏"})]}),r.jsxs($.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsx("div",{className:"text-xl sm:text-3xl font-bold text-pink-400",children:a.comingSoon}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"即将推出"})]}),r.jsxs($.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsxs("div",{className:"text-xl sm:text-3xl font-bold text-blue-400 flex items-center justify-center gap-1",children:[a.onlineUsers,n&&r.jsx("span",{className:"inline-block w-2 h-2 bg-green-400 rounded-full animate-pulse"})]}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"在线玩家"})]})]})]}),r.jsx("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3 px-4",children:i.map((l,c)=>r.jsx($.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:c*.1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(l),className:`px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all
              ${l===e?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white border border-gray-700"}`,children:l},l))}),r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:o.length>0?o.map((l,c)=>r.jsx($.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:c*.1},children:r.jsx(Fd,{game:l})},l.id)):r.jsxs($.div,{initial:{opacity:0},animate:{opacity:1},className:"col-span-full text-center py-12",children:[r.jsxs("p",{className:"text-gray-400 text-lg",children:['没有找到"',e,'"类型的游戏']}),r.jsx("button",{onClick:()=>t("全部"),className:"mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"查看全部游戏"})]})}),r.jsxs($.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-12 sm:mt-16 grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6",children:[r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"🎮"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-purple-400",children:"精选游戏"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"精心挑选的经典游戏，保证游戏质量和趣味性"})]}),r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"🌐"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-pink-400",children:"在线对战"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"支持实时在线对战，与好友一起享受游戏乐趣"})]}),r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"📱"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-blue-400",children:"跨平台"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"完美适配手机和电脑，随时随地开始游戏"})]})]})]})},Gs=13,wr=["快乐的","聪明的","勇敢的","可爱的","厉害的","机智的","活泼的","霸气的","淡定的","优雅的","神秘的","幸运的","专注的","认真的","潇洒的","冷静的"],jr=["熊猫","狐狸","老虎","狮子","兔子","猫咪","狗狗","猴子","企鹅","海豚","鲸鱼","老鹰","凤凰","龙龙","独角兽","考拉"],gt=()=>Array(Gs).fill(null).map(()=>Array(Gs).fill(0)),ce=mo((e,t)=>({board:gt(),boardSize:Gs,currentPlayer:1,myColor:null,gameState:"waiting",winner:null,lastMove:null,winningLine:null,userRole:null,spectatorCount:0,myNickname:null,opponentNickname:null,history:[],canUndo:!1,score:{black:0,white:0},roundNumber:1,firstPlayer:1,roomId:null,isHost:!1,opponentName:null,notifications:[],initBoard:()=>{const{roundNumber:s}=t(),n=s%2===1?1:2;e({board:gt(),currentPlayer:n,winner:null,lastMove:null,winningLine:null,gameState:"waiting",history:[],canUndo:!1,firstPlayer:n})},makeMove:(s,n)=>{const{board:i,currentPlayer:o,gameState:a,myColor:l,boardSize:c,userRole:d}=t();if(a!=="playing"||d==="spectator"||o!==l||s<0||s>=c||n<0||n>=c||i[s][n]!==0)return!1;const u=i.map(x=>[...x]);u[s][n]=o;const f=t().checkWin(s,n,o),m=f!==null;return t().addHistory(o,{row:s,col:n}),e({board:u,lastMove:{row:s,col:n},currentPlayer:o===1?2:1,winner:m?o:null,winningLine:f,gameState:m?"finished":"playing",canUndo:!0}),m&&t().updateScore(o),!0},setPlayerColor:s=>{e({myColor:s})},setGameState:s=>{e({gameState:s})},setRoomInfo:(s,n)=>{e({roomId:s,isHost:n})},resetGame:()=>{e({board:gt(),currentPlayer:1,myColor:null,gameState:"waiting",winner:null,lastMove:null,winningLine:null,roomId:null,isHost:!1,history:[],canUndo:!1,opponentName:null,notifications:[],score:{black:0,white:0},roundNumber:1,firstPlayer:1,userRole:null,spectatorCount:0,myNickname:null,opponentNickname:null})},checkWin:(s,n,i)=>{const{board:o,boardSize:a}=t(),l=[[[0,1],[0,-1]],[[1,0],[-1,0]],[[1,1],[-1,-1]],[[1,-1],[-1,1]]];for(const c of l){const d=[{row:s,col:n}];for(const[u,f]of c){let m=s+u,x=n+f;for(;m>=0&&m<a&&x>=0&&x<a&&o[m][x]===i;)d.push({row:m,col:x}),m+=u,x+=f}if(d.length>=5)return d}return null},addNotification:(s,n)=>{const i={id:Math.random().toString(36).substr(2,9),type:s,message:n,timestamp:Date.now()};e(o=>({notifications:[...o.notifications,i]})),setTimeout(()=>{t().removeNotification(i.id)},5e3)},removeNotification:s=>{e(n=>({notifications:n.notifications.filter(i=>i.id!==s)}))},updateScore:s=>{e(n=>({score:{...n.score,[s===1?"black":"white"]:n.score[s===1?"black":"white"]+1}}))},nextRound:()=>{e(s=>{const n=s.roundNumber+1,i=n%2===1?1:2;return{board:gt(),currentPlayer:i,winner:null,lastMove:null,winningLine:null,gameState:"playing",history:[],canUndo:!1,roundNumber:n,firstPlayer:i}})},setOpponentName:s=>{e({opponentName:s})},addHistory:(s,n)=>{e(i=>({history:[...i.history,{player:s,position:n,timestamp:Date.now()}]}))},setCanUndo:s=>{e({canUndo:s})},undoMove:()=>{const{history:s}=t();if(s.length<2)return;const n=s.slice(0,-2),i=gt();n.forEach(l=>{i[l.position.row][l.position.col]=l.player});const o=n.length>0?n[n.length-1].player===1?2:1:t().firstPlayer,a=n.length>0?n[n.length-1].position:null;e({board:i,history:n,currentPlayer:o,lastMove:a,canUndo:!1,winningLine:null})},setWinningLine:s=>{e({winningLine:s})},setUserRole:s=>{e({userRole:s})},setSpectatorCount:s=>{e({spectatorCount:s})},canMakeMove:()=>{const{userRole:s,myColor:n,currentPlayer:i,gameState:o}=t();return s==="player"&&n===i&&o==="playing"},setMyNickname:s=>{e({myNickname:s})},setOpponentNickname:s=>{e({opponentNickname:s})},generateRandomNickname:()=>{const s=wr[Math.floor(Math.random()*wr.length)],n=jr[Math.floor(Math.random()*jr.length)],i=Math.floor(Math.random()*100);return`${s}${n}${i}`}}));let Z=null,Ge=!1;const ds=()=>{const[e,t]=g.useState(Ge),{setGameState:s,setPlayerColor:n,initBoard:i,addNotification:o,nextRound:a,undoMove:l,setCanUndo:c,setWinningLine:d,setUserRole:u,userRole:f,setOpponentNickname:m}=ce();return g.useEffect(()=>{if(Z)t(Ge);else{let A;A="http://socket.qingfengyueying.xyz",console.log("Attempting to connect to:",A),Z=Ws(A,{transports:["websocket","polling"],upgrade:!0,path:"/socket.io/",timeout:1e4,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),Z.on("connect",()=>{console.log("Socket connected to:",A),Ge=!0,t(!0)}),Z.on("disconnect",()=>{console.log("Socket disconnected"),Ge=!1,t(!1),o("warning","与服务器断开连接")}),Z.on("connect_error",w=>{console.error("Socket connection error:",w),Ge=!1,t(!1)}),Z.on("reconnect",w=>{console.log("Socket reconnected after",w,"attempts"),Ge=!0,t(!0),o("success","重新连接成功")}),Z.on("reconnect_error",w=>{console.error("Socket reconnection error:",w),Ge=!1,t(!1)}),Z.on("game-start",w=>{console.log("Game started, my color:",w.playerColor,"opponent:",w.opponentId),console.log("Before state update - gameState:",ce.getState().gameState),w.opponentNickname&&m(w.opponentNickname),n(w.playerColor),i(),s("playing"),o("success","🎯 游戏开始！"),console.log("After state update - gameState:",ce.getState().gameState),console.log("After state update - myColor:",ce.getState().myColor)}),Z.on("game-start-spectator",w=>{console.log("Game started for spectator, black:",w.blackPlayer,"white:",w.whitePlayer),w.blackNickname&&w.whiteNickname,i(),s("playing"),o("info","🎯 游戏已开始，你正在观战")}),Z.on("role-changed",w=>{console.log("Role changed to:",w.role),u(w.role),w.role==="spectator"?(n(null),o("info","👁️ 你现在是观众")):o("success","🎮  你现在是玩家")}),Z.on("user-role-changed",w=>{w.wasSurrender?o("info","🏳️ 一位玩家认输并成为观众"):w.role==="player"?o("info","👥 一位观众成为了玩家"):o("info","👁️ 一位玩家成为了观众")}),Z.on("role-change-error",w=>{console.error("Role change error:",w.message),o("error",`❌ ${w.message}`)}),Z.on("ready-prompt",()=>{console.log("Ready prompt received"),Z&&Z.emit("ready-to-play")}),Z.on("game-move",w=>{console.log("Game move for spectator:",w);const C=ce.getState();if(C.userRole!=="spectator")return;const R=C.board.map(N=>[...N]);R[w.row][w.col]=C.currentPlayer;const b=C.checkWin(w.row,w.col,C.currentPlayer),j=b!==null;C.addHistory(C.currentPlayer,{row:w.row,col:w.col}),ce.setState({board:R,lastMove:{row:w.row,col:w.col},currentPlayer:C.currentPlayer===1?2:1,winner:j?C.currentPlayer:null,winningLine:b,gameState:j?"finished":"playing"}),j&&C.updateScore(C.currentPlayer)}),Z.on("room-created",w=>{console.log("Room created:",w),o("success",`✅ 房间 ${w.roomId} 创建成功`)}),Z.on("room-joined",w=>{console.log("Room joined:",w),o("success",`✅ 已加入房间 ${w.roomId}`),Z&&(console.log("Auto-readying for game start..."),Z.emit("ready-to-play"))}),Z.on("spectator-joined",w=>{console.log("Joined as spectator:",w),o("info",`👁️ 已以观众身份加入房间 ${w.roomId}`)}),Z.on("room-error",w=>{console.error("Room error:",w.message),o("error",`❌ ${w.message}`)}),Z.on("room-list",w=>{console.log("Room list updated:",w)}),Z.on("opponent-move",w=>{console.log("Opponent made move:",w);const C=ce.getState();if(C.userRole!=="player")return;const R=C.board.map(N=>[...N]);R[w.row][w.col]=C.currentPlayer;const b=C.checkWin(w.row,w.col,C.currentPlayer),j=b!==null;C.addHistory(C.currentPlayer,{row:w.row,col:w.col}),ce.setState({board:R,lastMove:{row:w.row,col:w.col},currentPlayer:C.currentPlayer===1?2:1,winner:j?C.currentPlayer:null,winningLine:b,gameState:j?"finished":"playing",canUndo:!0}),j&&C.updateScore(C.currentPlayer)}),Z.on("game-restart",()=>{console.log("Game restart - both players agreed"),a(),s("playing"),o("success","🎮 游戏已重新开始")}),Z.on("undo-move",()=>{console.log("Undo move - both players agreed"),l(),o("info","↩️ 已悔棋")}),Z.on("opponent-nickname",w=>{console.log("Received opponent nickname:",w.nickname),m(w.nickname)})}return()=>{}},[s,n,i,o,a,l,c,d,u,f,m]),{socket:Z,connected:e,sendMove:(A,w,C)=>{Z&&(console.log("Sending move:",{roomId:A,row:w,col:C}),Z.emit("make-move",{roomId:A,row:w,col:C}))},requestRestart:A=>{Z&&(console.log("Requesting restart:",A),Z.emit("request-restart",{roomId:A}))},acceptRestart:A=>{Z&&(console.log("Accepting restart:",A),Z.emit("accept-restart",{roomId:A}))},rejectRestart:A=>{Z&&(console.log("Rejecting restart:",A),Z.emit("reject-restart",{roomId:A}))},requestUndo:A=>{Z&&(console.log("Requesting undo:",A),Z.emit("request-undo",{roomId:A}))},acceptUndo:A=>{Z&&(console.log("Accepting undo:",A),Z.emit("accept-undo",{roomId:A}))},rejectUndo:A=>{Z&&(console.log("Rejecting undo:",A),Z.emit("reject-undo",{roomId:A}))},surrender:(A,w)=>{Z&&(console.log("Surrendering:",A,"myColor:",w),Z.emit("surrender",{roomId:A,surrenderColor:w}))},sendChatMessage:(A,w)=>{Z&&(console.log("Sending chat message:",{roomId:A,message:w}),Z.emit("chat-message",{roomId:A,message:w}))},spectatorToPlayer:()=>{Z&&(console.log("Requesting to become player"),Z.emit("spectator-to-player"))},playerToSpectator:()=>{Z&&(console.log("Requesting to become spectator"),Z.emit("player-to-spectator"))}}},Nr=()=>{const e=g.useRef(null),t=g.useRef(null),s=g.useRef(null),[n,i]=g.useState(40),[o,a]=g.useState(520),[l,c]=g.useState(1),[d,u]=g.useState(null),{board:f,currentPlayer:m,gameState:x,makeMove:k,myColor:v,roomId:P,lastMove:V,winningLine:T}=ce(),{sendMove:S}=ds(),L=f.length;g.useEffect(()=>{const h=()=>{const D=window.innerWidth,F=window.innerHeight,G=window.devicePixelRatio||1;if(D<640){const _=D-15,X=F-15-25-25-15,K=Math.min(_,X),q=Math.min(K,_*.95),Y=Math.floor(q/L),te=Y*L;i(Y),a(te),c(G),console.log("Mobile board size:",{viewport:{width:D,height:F},available:{width:_,height:X},target:q,cell:Y,board:te})}else{const z=F-30-35-30,_=Math.min(580,z*.9),X=180*2,K=D-X-60,q=Math.min(_,K,z*.9),Y=Math.floor(q/L),te=Y*L;i(Y),a(te),c(G),console.log("PC board size:",{viewport:{width:D,height:F},availableHeight:z,availableWidth:K,target:q,cell:Y,board:te})}};return h(),window.addEventListener("resize",h),window.addEventListener("orientationchange",h),()=>{window.removeEventListener("resize",h),window.removeEventListener("orientationchange",h)}},[L]);const E=(h,D)=>{const F=e.current,G=s.current;if(!F||!G)return null;const H=G.getBoundingClientRect(),y=window.getComputedStyle(G),p=parseInt(y.paddingLeft)||0,B=parseInt(y.paddingTop)||0,z=h-H.left-p,_=D-H.top-B,X=Math.floor(z/n),K=Math.floor(_/n);return K>=0&&K<L&&X>=0&&X<L?{row:K,col:X}:null},M=h=>{const D=o*l;h.clearRect(0,0,D,D),h.save(),h.scale(l,l);const F=h.createLinearGradient(0,0,o,o);F.addColorStop(0,"#D4A574"),F.addColorStop(.3,"#C19A6B"),F.addColorStop(.6,"#CD9B62"),F.addColorStop(1,"#B8956A"),h.fillStyle=F,h.fillRect(0,0,o,o),h.globalAlpha=.1;for(let H=0;H<50;H++){h.strokeStyle="#8B7355",h.lineWidth=Math.random()*2,h.beginPath();const y=Math.random()*o;h.moveTo(0,y),h.bezierCurveTo(o*.3,y+Math.random()*20-10,o*.7,y+Math.random()*20-10,o,y+Math.random()*10-5),h.stroke()}h.globalAlpha=1,h.shadowColor="rgba(0, 0, 0, 0.3)",h.shadowBlur=2,h.shadowOffsetX=1,h.shadowOffsetY=1,h.strokeStyle="#2C1810",h.lineWidth=1.5;for(let H=0;H<L;H++){const y=H*n+n/2;h.beginPath(),h.moveTo(n/2,y),h.lineTo(o-n/2,y),h.stroke(),h.beginPath(),h.moveTo(y,n/2),h.lineTo(y,o-n/2),h.stroke()}h.shadowColor="transparent",h.shadowBlur=0,h.shadowOffsetX=0,h.shadowOffsetY=0;const G=[{row:3,col:3},{row:3,col:9},{row:9,col:3},{row:9,col:9},{row:6,col:6}];h.fillStyle="#1A0E08",G.forEach(H=>{if(H.row<L&&H.col<L){const y=H.col*n+n/2,p=H.row*n+n/2;h.beginPath(),h.arc(y,p,5,0,Math.PI*2),h.fill(),h.fillStyle="#2C1810",h.beginPath(),h.arc(y,p,3,0,Math.PI*2),h.fill(),h.fillStyle="#1A0E08"}}),h.restore()},I=(h,D,F,G,H=!1)=>{const y=F*n+n/2,p=D*n+n/2,B=n*.42;if(h.save(),h.scale(l,l),G===1){const z=h.createRadialGradient(y-B/3,p-B/3,0,y,p,B);z.addColorStop(0,"#4A4A4A"),z.addColorStop(.5,"#2C2C2C"),z.addColorStop(.8,"#1A1A1A"),z.addColorStop(1,"#000000"),h.shadowColor="rgba(0, 0, 0, 0.5)",h.shadowBlur=5,h.shadowOffsetX=2,h.shadowOffsetY=2,h.fillStyle=z,h.beginPath(),h.arc(y,p,B,0,Math.PI*2),h.fill();const _=h.createRadialGradient(y-B/3,p-B/3,0,y-B/3,p-B/3,B/2);_.addColorStop(0,"rgba(255, 255, 255, 0.3)"),_.addColorStop(1,"rgba(255, 255, 255, 0)"),h.fillStyle=_,h.beginPath(),h.arc(y,p,B,0,Math.PI*2),h.fill()}else{const z=h.createRadialGradient(y-B/3,p-B/3,0,y,p,B);z.addColorStop(0,"#FFFFFF"),z.addColorStop(.3,"#F8F8F8"),z.addColorStop(.7,"#E8E8E8"),z.addColorStop(1,"#D0D0D0"),h.shadowColor="rgba(0, 0, 0, 0.3)",h.shadowBlur=4,h.shadowOffsetX=2,h.shadowOffsetY=2,h.fillStyle=z,h.beginPath(),h.arc(y,p,B,0,Math.PI*2),h.fill(),h.strokeStyle="#B0B0B0",h.lineWidth=1,h.stroke();const _=h.createRadialGradient(y-B/4,p-B/4,0,y-B/4,p-B/4,B/3);_.addColorStop(0,"rgba(255, 255, 255, 0.9)"),_.addColorStop(1,"rgba(255, 255, 255, 0)"),h.fillStyle=_,h.beginPath(),h.arc(y,p,B,0,Math.PI*2),h.fill()}H&&(h.shadowColor="#FFD700",h.shadowBlur=15,h.strokeStyle="#FFD700",h.lineWidth=3,h.beginPath(),h.arc(y,p,B+5,0,Math.PI*2),h.stroke()),h.restore()},A=h=>{if(!V)return;h.save(),h.scale(l,l);const D=V.col*n+n/2,F=V.row*n+n/2,G=n*.2,H=n*.35,y=Date.now()/1e3,p=Math.sin(y*3)*.1+.9;h.strokeStyle="#FF6B6B",h.lineWidth=3,h.lineCap="round",h.globalAlpha=p,[{dx:-1,dy:-1},{dx:1,dy:-1},{dx:1,dy:1},{dx:-1,dy:1}].forEach(z=>{h.beginPath(),h.moveTo(D+z.dx*H,F+z.dy*H),h.lineTo(D+z.dx*(H-G),F+z.dy*H),h.moveTo(D+z.dx*H,F+z.dy*H),h.lineTo(D+z.dx*H,F+z.dy*(H-G)),h.stroke()}),h.restore()},w=h=>{if(!T||T.length<5)return;h.save(),h.scale(l,l);const D=T[0],F=T[T.length-1],G=D.col*n+n/2,H=D.row*n+n/2,y=F.col*n+n/2,p=F.row*n+n/2,B=Date.now()/100,z=B%20;h.strokeStyle="#FFD700",h.lineWidth=4,h.lineCap="round",h.shadowColor="#FFD700",h.shadowBlur=20,h.setLineDash([10,10]),h.lineDashOffset=-z,h.beginPath(),h.moveTo(G,H),h.lineTo(y,p),h.stroke();const _=5;for(let X=0;X<_;X++){const K=(B/10+X*20)%100/100,q=G+(y-G)*K,Y=H+(p-H)*K;h.fillStyle="#FFD700",h.globalAlpha=1-K,h.beginPath(),h.arc(q,Y,3+K*5,0,Math.PI*2),h.fill()}h.restore()},C=h=>{if(!d||x!=="playing"||m!==v||f[d.row][d.col]!==0)return;const D=o*l;h.clearRect(0,0,D,D),h.save(),h.scale(l,l);const F=d.col*n+n/2,G=d.row*n+n/2,H=n*.42,y=Date.now()/1e3,p=Math.sin(y*4)*.1+.9;if(h.globalAlpha=.5,m===1){const B=h.createRadialGradient(F,G,0,F,G,H*p);B.addColorStop(0,"rgba(0, 0, 0, 0.8)"),B.addColorStop(1,"rgba(0, 0, 0, 0.4)"),h.fillStyle=B}else{const B=h.createRadialGradient(F,G,0,F,G,H*p);B.addColorStop(0,"rgba(255, 255, 255, 0.9)"),B.addColorStop(1,"rgba(255, 255, 255, 0.5)"),h.fillStyle=B}h.beginPath(),h.arc(F,G,H*p,0,Math.PI*2),h.fill(),h.strokeStyle=m===1?"rgba(0, 0, 0, 0.3)":"rgba(255, 255, 255, 0.5)",h.lineWidth=2,h.beginPath(),h.arc(F,G,H*p+5,0,Math.PI*2),h.stroke(),h.restore()};g.useEffect(()=>{const h=e.current,D=h==null?void 0:h.getContext("2d");if(!D||!h)return;h.width=o*l,h.height=o*l,M(D),f.forEach((H,y)=>{H.forEach((p,B)=>{if(p!==0){const z=(T==null?void 0:T.some(_=>_.row===y&&_.col===B))||!1;I(D,y,B,p,z)}})}),A(D),w(D);let F;const G=()=>{A(D),w(D),F=requestAnimationFrame(G)};return(V||T)&&G(),()=>{F&&cancelAnimationFrame(F)}},[f,n,o,V,T,l]),g.useEffect(()=>{const h=t.current,D=h==null?void 0:h.getContext("2d");if(!D||!h)return;h.width=o*l,h.height=o*l,C(D);let F;const G=()=>{C(D),F=requestAnimationFrame(G)};return G(),()=>{cancelAnimationFrame(F)}},[d,f,x,m,v,n,o,l]);const R=h=>{if(x!=="playing"||m!==v)return;const D="touches"in h?h.touches[0].clientX:h.clientX,F="touches"in h?h.touches[0].clientY:h.clientY,G=E(D,F);if(!G)return;const{row:H,col:y}=G;f[H][y]===0&&(k(H,y),S&&P&&S(P,H,y),u(null))},b=h=>{const D=E(h.clientX,h.clientY);u(D)},j=()=>{u(null)},N=h=>{R(h)};return r.jsx($.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},className:"inline-block",children:r.jsxs("div",{ref:s,className:"relative pixel-container p-1 sm:p-2 bg-gradient-to-br from-amber-900/20 to-amber-800/20",onClick:R,onMouseMove:b,onMouseLeave:j,onTouchStart:N,style:{cursor:x==="playing"&&m===v?"pointer":"not-allowed"},children:[r.jsx("canvas",{ref:e,style:{width:`${o}px`,height:`${o}px`,display:"block",imageRendering:"crisp-edges"}}),r.jsx("canvas",{ref:t,className:"absolute top-1 left-1 sm:top-2 sm:left-2 pointer-events-none",style:{width:`${o}px`,height:`${o}px`,imageRendering:"crisp-edges"}})]})})},zd=({onJoinRoom:e})=>{const[t,s]=g.useState(""),[n,i]=g.useState([]),[o,a]=g.useState(!1),{socket:l,connected:c}=ds(),{setRoomInfo:d,setUserRole:u,generateRandomNickname:f,setMyNickname:m}=ce();console.log("RoomManager - connected:",c,"socket:",l),g.useEffect(()=>{if(l)return l.on("room-list",P=>{i(P)}),l.on("room-created",P=>{const V=f();m(V),l.emit("set-nickname",{roomId:P.roomId,nickname:V}),d(P.roomId,P.isHost),u("player"),e(),a(!1)}),l.on("room-joined",P=>{const V=f();m(V),l.emit("set-nickname",{roomId:P.roomId,nickname:V}),d(P.roomId,P.isHost),u("player"),e(),a(!1)}),l.on("spectator-joined",P=>{const V=f();m(V),l.emit("set-nickname",{roomId:P.roomId,nickname:V}),d(P.roomId,!1),u("spectator"),e(),a(!1)}),l.on("room-error",P=>{alert(P.message),a(!1)}),l.emit("get-rooms"),()=>{l.off("room-list"),l.off("room-created"),l.off("room-joined"),l.off("spectator-joined"),l.off("room-error")}},[l,e,d,u,f,m]);const x=()=>{if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("create-room")},k=P=>{const V=P||t.trim();if(!V){alert("请输入房间ID");return}if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("join-room",{roomId:V})},v=P=>{const V=P||t.trim();if(!V){alert("请输入房间ID");return}if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("join-as-spectator",{roomId:V})};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs($.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center",children:[r.jsx("h2",{className:"text-lg sm:text-xl font-game font-bold text-white",children:"五子棋房间管理"}),r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"创建新房间或加入现有房间开始游戏"})]}),r.jsxs($.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-gray-800 rounded-lg p-3 sm:p-4 space-y-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-purple-400",children:"创建新房间"}),r.jsx("button",{onClick:x,disabled:o||!c,className:"w-full pixel-btn bg-purple-600 hover:bg-purple-700 py-1.5 text-xs sm:text-sm",children:o?"创建中...":"创建房间"})]}),r.jsx("div",{className:"border-t border-gray-700"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-pink-400",children:"加入房间"}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("input",{type:"text",value:t,onChange:P=>s(P.target.value.toUpperCase()),onKeyPress:P=>P.key==="Enter"&&k(),placeholder:"输入房间ID",className:"w-full px-2 py-1 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-pink-400 focus:outline-none text-xs sm:text-sm",maxLength:6}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>k(),disabled:o||!c,className:"flex-1 pixel-btn bg-pink-600 hover:bg-pink-700 py-1 px-3 text-xs sm:text-sm",children:"加入游戏"}),r.jsx("button",{onClick:()=>v(),disabled:o||!c,className:"flex-1 pixel-btn bg-yellow-600 hover:bg-yellow-700 py-1 px-3 text-xs sm:text-sm",children:"观战"})]})]})]}),r.jsx("div",{className:"border-t border-gray-700"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-blue-400",children:"可用房间"}),r.jsx("div",{className:"space-y-1 max-h-32 sm:max-h-40 overflow-y-auto custom-scrollbar",children:n.length===0?r.jsx("p",{className:"text-gray-500 text-center py-2 text-xs sm:text-sm",children:"暂无可用房间"}):n.map(P=>r.jsxs($.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between p-1.5 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-pixel text-yellow-400 text-xs sm:text-sm",children:P.id}),r.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:[P.playerCount,"/2 玩家"]})]}),r.jsxs("div",{className:"flex gap-1",children:[P.playerCount<2&&r.jsx("button",{onClick:()=>k(P.id),disabled:o,className:"px-2 py-0.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors",children:"加入"}),r.jsx("button",{onClick:()=>v(P.id),disabled:o,className:"px-2 py-0.5 bg-yellow-600 hover:bg-yellow-700 text-white text-xs rounded transition-colors",children:"观战"})]})]},P.id))})]})]}),r.jsx("div",{className:"text-center",children:r.jsx("span",{className:`text-xs ${c?"text-green-400":"text-red-400"}`,children:c?"✓ 已连接到服务器":"✗ 未连接到服务器"})})]})},yt=({color:e,size:t="medium",isActive:s=!1,className:n=""})=>{const i={small:"w-7 h-7 text-xs",medium:"w-10 h-10 text-sm",large:"w-12 h-12 text-base"},o=l=>l===1?"🐼":l===2?"🦊":"👤",a=l=>l===1?"bg-gradient-to-br from-gray-800 to-black text-white":l===2?"bg-gradient-to-br from-white to-gray-200 text-gray-800 border-2 border-gray-400":"bg-gray-600 text-gray-400";return r.jsxs($.div,{className:oe(i[t],a(e),"rounded-full flex items-center justify-center shadow-lg font-bold relative",n),animate:s?{scale:[1,1.1,1]}:{},transition:s?{repeat:1/0,duration:2}:{},children:[r.jsx("span",{className:t==="small"?"text-sm":"text-lg",children:o(e)}),s&&r.jsx($.div,{className:"absolute -bottom-1 -right-1 w-2.5 h-2.5 bg-green-400 rounded-full border-2 border-gray-900",animate:{scale:[.8,1.2,.8]},transition:{repeat:1/0,duration:1.5}}),r.jsx("div",{className:oe("absolute -top-1 -right-1 rounded-full shadow-md",t==="small"?"w-3 h-3":"w-4 h-4",e===1?"bg-gradient-to-br from-gray-700 to-black":e===2?"bg-gradient-to-br from-white to-gray-300 border border-gray-400":"hidden")})]})},Cs=({side:e})=>{const{currentPlayer:t,gameState:s,myColor:n,score:i,roundNumber:o,winner:a,userRole:l,myNickname:c,opponentNickname:d}=ce(),u=l==="spectator",f=u?1:n,m=u||n===1?2:n===2?1:null;return e==="left"?r.jsx("div",{className:"pixel-container bg-gradient-to-b from-gray-800/50 to-gray-900/50 p-2 w-44",children:r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("div",{className:`text-xs font-bold text-white px-2 py-0.5 rounded ${u?"bg-gray-600/20":"bg-green-600/20"}`,children:u?"黑方":"你的棋子"}),r.jsx(yt,{color:f,size:"medium",isActive:s==="playing"&&t===f}),!u&&c&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:c}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:`w-4 h-4 rounded-full shadow-lg ${f===1?"bg-gradient-to-br from-gray-800 to-black":f===2?"bg-gradient-to-br from-white to-gray-200 border border-gray-400":"bg-gray-600"}`}),r.jsx("span",{className:"text-sm font-game text-white",children:f===1?"黑棋":f===2?"白棋":"未定"})]}),r.jsxs("div",{className:"text-xs text-gray-300",children:["得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:f===1?i.black:f===2?i.white:0})]}),!u&&s==="playing"&&t===n&&r.jsx($.div,{className:"text-green-400 font-pixel text-xs bg-green-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"🎯 你的回合"}),u&&s==="playing"&&t===1&&r.jsx($.div,{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"黑棋思考中"}),u&&s==="waiting"&&r.jsx($.div,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待开局"}),u&&s==="finished"&&a===1&&r.jsx($.div,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:"⚫ 黑棋获胜"})]})}):e==="right"?r.jsx("div",{className:"pixel-container bg-gradient-to-b from-gray-800/50 to-gray-900/50 p-2 w-44",children:r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("div",{className:"text-xs text-gray-400",children:u?"白方":"对手棋子"}),r.jsx(yt,{color:m,size:"medium",isActive:s==="playing"&&t===m}),!u&&d&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:d}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:`w-4 h-4 rounded-full shadow-lg ${m===1?"bg-gradient-to-br from-gray-800 to-black":m===2?"bg-gradient-to-br from-white to-gray-200 border border-gray-400":"bg-gray-600"}`}),r.jsx("span",{className:"text-sm font-game text-white",children:m===1?"黑棋":m===2?"白棋":"未定"})]}),r.jsxs("div",{className:"text-xs text-gray-300",children:["得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:m===1?i.black:m===2?i.white:0})]}),r.jsxs("div",{className:"text-gray-400 font-game bg-gray-800/50 px-2 py-0.5 rounded text-xs",children:["第 ",o," 回合"]}),s==="waiting"&&!u&&r.jsx($.span,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待对手..."}),s==="waiting"&&u&&r.jsx($.span,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待开局..."}),s==="playing"&&!u&&t!==n&&r.jsx("span",{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded",children:"对手思考中..."}),s==="playing"&&u&&t===2&&r.jsx($.div,{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"白棋思考中"}),s==="finished"&&!u&&r.jsx($.span,{className:`font-pixel text-xs px-2 py-0.5 rounded ${a===n?"text-yellow-400 bg-yellow-400/10 animate-glow":"text-gray-400 bg-gray-400/10"}`,initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:a===n?"🎉 你赢了！":"💪 再接再厉"}),s==="finished"&&u&&r.jsx($.span,{className:"text-yellow-400 bg-yellow-400/10 font-pixel text-xs px-2 py-0.5 rounded",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:a===1?"⚫ 黑棋获胜":"⚪ 白棋获胜"})]})}):r.jsx(r.Fragment,{children:r.jsx("div",{className:"sm:hidden",children:r.jsxs("div",{className:"flex items-center justify-between px-1 py-0.5",children:[r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsx(yt,{color:u?1:n,size:"small",isActive:s==="playing"&&t===(u?1:n)}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[8px] text-gray-400",children:u?"黑方":"你"}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsx("span",{className:"font-game text-xs text-white",children:u||n===1?"黑":n===2?"白":"-"}),r.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",u||n===1?i.black:n===2?i.white:0,")"]})]})]})]}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:"text-[9px] text-gray-400 font-pixel",children:["第",o,"回合"]}),r.jsxs("div",{className:"text-[9px] mt-0",children:[s==="waiting"&&!u&&r.jsx("span",{className:"text-yellow-400 font-pixel animate-pulse",children:"等待对手"}),s==="waiting"&&u&&r.jsx("span",{className:"text-yellow-400 font-pixel animate-pulse",children:"等待开局"}),s==="playing"&&!u&&t===n&&r.jsx("span",{className:"text-green-400 font-pixel animate-pulse",children:"你的回合"}),s==="playing"&&!u&&t!==n&&r.jsx("span",{className:"text-blue-400 font-pixel",children:"对手思考"}),s==="playing"&&u&&r.jsx("span",{className:"text-blue-400 font-pixel",children:t===1?"黑棋思考":"白棋思考"}),s==="finished"&&r.jsx("span",{className:u||a===n?"text-yellow-400":"text-gray-400",children:u?a===1?"黑棋胜":"白棋胜":a===n?"你赢了":"再接再厉"})]})]}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[8px] text-gray-400",children:u?"白方":"对手"}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",u?i.white:m===1?i.black:m===2?i.white:0,")"]}),r.jsx("span",{className:"font-game text-xs text-white",children:u?"白":m===1?"黑":m===2?"白":"-"})]})]}),r.jsx(yt,{color:u?2:m,size:"small",isActive:s==="playing"&&t===(u?2:m)})]})]})})})},$d=()=>{const{notifications:e,removeNotification:t}=ce();return r.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 pointer-events-none",children:r.jsx(pe,{children:e.map(s=>r.jsx($.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},transition:{duration:.3},className:oe("pixel-container p-3 min-w-[200px] max-w-[300px] pointer-events-auto cursor-pointer","backdrop-blur-sm shadow-lg",{"bg-blue-600/90 border-blue-400":s.type==="info","bg-green-600/90 border-green-400":s.type==="success","bg-yellow-600/90 border-yellow-400":s.type==="warning","bg-red-600/90 border-red-400":s.type==="error"}),onClick:()=>t(s.id),children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("div",{className:"text-white",children:[s.type==="info"&&"📢",s.type==="success"&&"✅",s.type==="warning"&&"⚠️",s.type==="error"&&"❌"]}),r.jsx("p",{className:"text-white text-sm font-game flex-1",children:s.message})]})},s.id))})})};var Rt={};(function e(t,s,n,i){var o=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",l=function(){if(!t.OffscreenCanvas)return!1;var y=new OffscreenCanvas(1,1),p=y.getContext("2d");p.fillRect(0,0,1,1);var B=y.transferToImageBitmap();try{p.createPattern(B,"no-repeat")}catch{return!1}return!0}();function c(){}function d(y){var p=s.exports.Promise,B=p!==void 0?p:t.Promise;return typeof B=="function"?new B(y):(y(c,c),null)}var u=function(y,p){return{transform:function(B){if(y)return B;if(p.has(B))return p.get(B);var z=new OffscreenCanvas(B.width,B.height),_=z.getContext("2d");return _.drawImage(B,0,0),p.set(B,z),z},clear:function(){p.clear()}}}(l,new Map),f=function(){var y=Math.floor(16.666666666666668),p,B,z={},_=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(p=function(X){var K=Math.random();return z[K]=requestAnimationFrame(function q(Y){_===Y||_+y-1<Y?(_=Y,delete z[K],X()):z[K]=requestAnimationFrame(q)}),K},B=function(X){z[X]&&cancelAnimationFrame(z[X])}):(p=function(X){return setTimeout(X,y)},B=function(X){return clearTimeout(X)}),{frame:p,cancel:B}}(),m=function(){var y,p,B={};function z(_){function X(K,q){_.postMessage({options:K||{},callback:q})}_.init=function(q){var Y=q.transferControlToOffscreen();_.postMessage({canvas:Y},[Y])},_.fire=function(q,Y,te){if(p)return X(q,null),p;var O=Math.random().toString(36).slice(2);return p=d(function(W){function U(Q){Q.data.callback===O&&(delete B[O],_.removeEventListener("message",U),p=null,u.clear(),te(),W())}_.addEventListener("message",U),X(q,O),B[O]=U.bind(null,{data:{callback:O}})}),p},_.reset=function(){_.postMessage({reset:!0});for(var q in B)B[q](),delete B[q]}}return function(){if(y)return y;if(!n&&o){var _=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{y=new Worker(URL.createObjectURL(new Blob([_])))}catch(X){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",X),null}z(y)}return y}}(),x={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function k(y,p){return p?p(y):y}function v(y){return y!=null}function P(y,p,B){return k(y&&v(y[p])?y[p]:x[p],B)}function V(y){return y<0?0:Math.floor(y)}function T(y,p){return Math.floor(Math.random()*(p-y))+y}function S(y){return parseInt(y,16)}function L(y){return y.map(E)}function E(y){var p=String(y).replace(/[^0-9a-f]/gi,"");return p.length<6&&(p=p[0]+p[0]+p[1]+p[1]+p[2]+p[2]),{r:S(p.substring(0,2)),g:S(p.substring(2,4)),b:S(p.substring(4,6))}}function M(y){var p=P(y,"origin",Object);return p.x=P(p,"x",Number),p.y=P(p,"y",Number),p}function I(y){y.width=document.documentElement.clientWidth,y.height=document.documentElement.clientHeight}function A(y){var p=y.getBoundingClientRect();y.width=p.width,y.height=p.height}function w(y){var p=document.createElement("canvas");return p.style.position="fixed",p.style.top="0px",p.style.left="0px",p.style.pointerEvents="none",p.style.zIndex=y,p}function C(y,p,B,z,_,X,K,q,Y){y.save(),y.translate(p,B),y.rotate(X),y.scale(z,_),y.arc(0,0,1,K,q,Y),y.restore()}function R(y){var p=y.angle*(Math.PI/180),B=y.spread*(Math.PI/180);return{x:y.x,y:y.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:y.startVelocity*.5+Math.random()*y.startVelocity,angle2D:-p+(.5*B-Math.random()*B),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:y.color,shape:y.shape,tick:0,totalTicks:y.ticks,decay:y.decay,drift:y.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:y.gravity*3,ovalScalar:.6,scalar:y.scalar,flat:y.flat}}function b(y,p){p.x+=Math.cos(p.angle2D)*p.velocity+p.drift,p.y+=Math.sin(p.angle2D)*p.velocity+p.gravity,p.velocity*=p.decay,p.flat?(p.wobble=0,p.wobbleX=p.x+10*p.scalar,p.wobbleY=p.y+10*p.scalar,p.tiltSin=0,p.tiltCos=0,p.random=1):(p.wobble+=p.wobbleSpeed,p.wobbleX=p.x+10*p.scalar*Math.cos(p.wobble),p.wobbleY=p.y+10*p.scalar*Math.sin(p.wobble),p.tiltAngle+=.1,p.tiltSin=Math.sin(p.tiltAngle),p.tiltCos=Math.cos(p.tiltAngle),p.random=Math.random()+2);var B=p.tick++/p.totalTicks,z=p.x+p.random*p.tiltCos,_=p.y+p.random*p.tiltSin,X=p.wobbleX+p.random*p.tiltCos,K=p.wobbleY+p.random*p.tiltSin;if(y.fillStyle="rgba("+p.color.r+", "+p.color.g+", "+p.color.b+", "+(1-B)+")",y.beginPath(),a&&p.shape.type==="path"&&typeof p.shape.path=="string"&&Array.isArray(p.shape.matrix))y.fill(F(p.shape.path,p.shape.matrix,p.x,p.y,Math.abs(X-z)*.1,Math.abs(K-_)*.1,Math.PI/10*p.wobble));else if(p.shape.type==="bitmap"){var q=Math.PI/10*p.wobble,Y=Math.abs(X-z)*.1,te=Math.abs(K-_)*.1,O=p.shape.bitmap.width*p.scalar,W=p.shape.bitmap.height*p.scalar,U=new DOMMatrix([Math.cos(q)*Y,Math.sin(q)*Y,-Math.sin(q)*te,Math.cos(q)*te,p.x,p.y]);U.multiplySelf(new DOMMatrix(p.shape.matrix));var Q=y.createPattern(u.transform(p.shape.bitmap),"no-repeat");Q.setTransform(U),y.globalAlpha=1-B,y.fillStyle=Q,y.fillRect(p.x-O/2,p.y-W/2,O,W),y.globalAlpha=1}else if(p.shape==="circle")y.ellipse?y.ellipse(p.x,p.y,Math.abs(X-z)*p.ovalScalar,Math.abs(K-_)*p.ovalScalar,Math.PI/10*p.wobble,0,2*Math.PI):C(y,p.x,p.y,Math.abs(X-z)*p.ovalScalar,Math.abs(K-_)*p.ovalScalar,Math.PI/10*p.wobble,0,2*Math.PI);else if(p.shape==="star")for(var ee=Math.PI/2*3,re=4*p.scalar,he=8*p.scalar,ye=p.x,we=p.y,Me=5,je=Math.PI/Me;Me--;)ye=p.x+Math.cos(ee)*he,we=p.y+Math.sin(ee)*he,y.lineTo(ye,we),ee+=je,ye=p.x+Math.cos(ee)*re,we=p.y+Math.sin(ee)*re,y.lineTo(ye,we),ee+=je;else y.moveTo(Math.floor(p.x),Math.floor(p.y)),y.lineTo(Math.floor(p.wobbleX),Math.floor(_)),y.lineTo(Math.floor(X),Math.floor(K)),y.lineTo(Math.floor(z),Math.floor(p.wobbleY));return y.closePath(),y.fill(),p.tick<p.totalTicks}function j(y,p,B,z,_){var X=p.slice(),K=y.getContext("2d"),q,Y,te=d(function(O){function W(){q=Y=null,K.clearRect(0,0,z.width,z.height),u.clear(),_(),O()}function U(){n&&!(z.width===i.width&&z.height===i.height)&&(z.width=y.width=i.width,z.height=y.height=i.height),!z.width&&!z.height&&(B(y),z.width=y.width,z.height=y.height),K.clearRect(0,0,z.width,z.height),X=X.filter(function(Q){return b(K,Q)}),X.length?q=f.frame(U):W()}q=f.frame(U),Y=W});return{addFettis:function(O){return X=X.concat(O),te},canvas:y,promise:te,reset:function(){q&&f.cancel(q),Y&&Y()}}}function N(y,p){var B=!y,z=!!P(p||{},"resize"),_=!1,X=P(p,"disableForReducedMotion",Boolean),K=o&&!!P(p||{},"useWorker"),q=K?m():null,Y=B?I:A,te=y&&q?!!y.__confetti_initialized:!1,O=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,W;function U(ee,re,he){for(var ye=P(ee,"particleCount",V),we=P(ee,"angle",Number),Me=P(ee,"spread",Number),je=P(ee,"startVelocity",Number),Vt=P(ee,"decay",Number),tt=P(ee,"gravity",Number),$e=P(ee,"drift",Number),Ue=P(ee,"colors",L),st=P(ee,"ticks",Number),ut=P(ee,"shapes"),Et=P(ee,"scalar"),Dt=!!P(ee,"flat"),ht=M(ee),ft=ye,nt=[],ge=y.width*ht.x,us=y.height*ht.y;ft--;)nt.push(R({x:ge,y:us,angle:we,spread:Me,startVelocity:je,color:Ue[ft%Ue.length],shape:ut[T(0,ut.length)],ticks:st,decay:Vt,gravity:tt,drift:$e,scalar:Et,flat:Dt}));return W?W.addFettis(nt):(W=j(y,nt,Y,re,he),W.promise)}function Q(ee){var re=X||P(ee,"disableForReducedMotion",Boolean),he=P(ee,"zIndex",Number);if(re&&O)return d(function(je){je()});B&&W?y=W.canvas:B&&!y&&(y=w(he),document.body.appendChild(y)),z&&!te&&Y(y);var ye={width:y.width,height:y.height};q&&!te&&q.init(y),te=!0,q&&(y.__confetti_initialized=!0);function we(){if(q){var je={getBoundingClientRect:function(){if(!B)return y.getBoundingClientRect()}};Y(je),q.postMessage({resize:{width:je.width,height:je.height}});return}ye.width=ye.height=null}function Me(){W=null,z&&(_=!1,t.removeEventListener("resize",we)),B&&y&&(document.body.contains(y)&&document.body.removeChild(y),y=null,te=!1)}return z&&!_&&(_=!0,t.addEventListener("resize",we,!1)),q?q.fire(ee,ye,Me):U(ee,ye,Me)}return Q.reset=function(){q&&q.reset(),W&&W.reset()},Q}var h;function D(){return h||(h=N(null,{useWorker:!0,resize:!0})),h}function F(y,p,B,z,_,X,K){var q=new Path2D(y),Y=new Path2D;Y.addPath(q,new DOMMatrix(p));var te=new Path2D;return te.addPath(Y,new DOMMatrix([Math.cos(K)*_,Math.sin(K)*_,-Math.sin(K)*X,Math.cos(K)*X,B,z])),te}function G(y){if(!a)throw new Error("path confetti are not supported in this browser");var p,B;typeof y=="string"?p=y:(p=y.path,B=y.matrix);var z=new Path2D(p),_=document.createElement("canvas"),X=_.getContext("2d");if(!B){for(var K=1e3,q=K,Y=K,te=0,O=0,W,U,Q=0;Q<K;Q+=2)for(var ee=0;ee<K;ee+=2)X.isPointInPath(z,Q,ee,"nonzero")&&(q=Math.min(q,Q),Y=Math.min(Y,ee),te=Math.max(te,Q),O=Math.max(O,ee));W=te-q,U=O-Y;var re=10,he=Math.min(re/W,re/U);B=[he,0,0,he,-Math.round(W/2+q)*he,-Math.round(U/2+Y)*he]}return{type:"path",path:p,matrix:B}}function H(y){var p,B=1,z="#000000",_='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof y=="string"?p=y:(p=y.text,B="scalar"in y?y.scalar:B,_="fontFamily"in y?y.fontFamily:_,z="color"in y?y.color:z);var X=10*B,K=""+X+"px "+_,q=new OffscreenCanvas(X,X),Y=q.getContext("2d");Y.font=K;var te=Y.measureText(p),O=Math.ceil(te.actualBoundingBoxRight+te.actualBoundingBoxLeft),W=Math.ceil(te.actualBoundingBoxAscent+te.actualBoundingBoxDescent),U=2,Q=te.actualBoundingBoxLeft+U,ee=te.actualBoundingBoxAscent+U;O+=U+U,W+=U+U,q=new OffscreenCanvas(O,W),Y=q.getContext("2d"),Y.font=K,Y.fillStyle=z,Y.fillText(p,Q,ee);var re=1/B;return{type:"bitmap",bitmap:q.transferToImageBitmap(),matrix:[re,0,0,re,-O*re/2,-W*re/2]}}s.exports=function(){return D().apply(this,arguments)},s.exports.reset=function(){D().reset()},s.exports.create=N,s.exports.shapeFromPath=G,s.exports.shapeFromText=H})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Rt,!1);const Ud=Rt.exports;Rt.exports.create;const Hd=({isOpen:e,onRestart:t,onClose:s,waitingForOpponent:n=!1})=>{const{winner:i,myColor:o,score:a,userRole:l}=ce(),c=i===o,d=l==="spectator";return console.log("GameOverModal - winner:",i,"myColor:",o,"isWinner:",c,"userRole:",l),g.useEffect(()=>{if(e&&c&&!n&&!d){const u=()=>{Ud({particleCount:100,spread:70,origin:{y:.6}})};u();const f=setTimeout(u,200),m=setTimeout(u,400);return()=>{clearTimeout(f),clearTimeout(m)}}},[e,c,n,d]),r.jsx(pe,{children:e&&r.jsxs(r.Fragment,{children:[r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",onClick:n?void 0:s}),r.jsx($.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:400},className:"fixed inset-0 flex items-center justify-center z-50 p-4",onClick:u=>u.stopPropagation(),children:r.jsx("div",{className:"pixel-container bg-gray-900 p-6 sm:p-8 max-w-md w-full",children:n?r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-yellow-400 mx-auto"})}),r.jsx("h2",{className:"text-2xl font-game font-bold text-yellow-400 mb-4",children:"等待对手..."}),r.jsx("p",{className:"text-gray-300 mb-6",children:"已发送再来一局请求，等待对手同意"})]}):r.jsxs(r.Fragment,{children:[r.jsx($.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"text-center mb-6",children:d?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-6xl mb-4",children:"🎮"}),r.jsx("h2",{className:"text-3xl font-game font-bold text-yellow-400 mb-2",children:"游戏结束"}),r.jsx("p",{className:"text-gray-300 text-xl",children:i===1?"黑棋获胜！":i===2?"白棋获胜！":"平局！"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-6xl mb-4",children:c?"🏆":"💪"}),r.jsx("h2",{className:oe("text-3xl font-game font-bold mb-2",c?"text-yellow-400 animate-glow":"text-gray-400"),children:c?"恭喜胜利！":"再接再厉！"}),r.jsx("p",{className:"text-gray-300",children:c?"你赢得了这局比赛！":"别灰心，下局再战！"})]})}),r.jsxs($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[r.jsx("div",{className:"text-center text-sm text-gray-400 mb-2",children:"当前比分"}),r.jsxs("div",{className:"flex items-center justify-center gap-6",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-800 to-black rounded-full shadow-lg"}),r.jsx("span",{className:"font-game text-2xl text-white",children:a.black})]}),r.jsx("div",{className:"text-gray-500 text-2xl",children:":"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-game text-2xl text-white",children:a.white}),r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-white to-gray-200 rounded-full border-2 border-gray-400 shadow-lg"})]})]}),r.jsx("div",{className:"text-center text-sm text-gray-400 mt-2",children:i===1?"黑棋获胜":i===2?"白棋获胜":"平局"})]}),r.jsxs("div",{className:"flex gap-3",children:[!d&&r.jsx($.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"flex-1 pixel-btn bg-green-600 hover:bg-green-700 text-white py-3",children:"再来一局"}),r.jsx($.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:s,className:oe("pixel-btn bg-gray-600 hover:bg-gray-700 text-white py-3",d?"w-full":"flex-1"),children:d?"关闭":"查看棋盘"})]})]})})})]})})},Ot=({isOpen:e,title:t,message:s,confirmText:n="同意",cancelText:i="拒绝",onConfirm:o,onCancel:a})=>r.jsx(pe,{children:e&&r.jsxs(r.Fragment,{children:[r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:a}),r.jsx($.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",damping:25,stiffness:400},className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none px-4",children:r.jsxs("div",{className:"pixel-container bg-gray-900 p-4 sm:p-6 max-w-sm w-full pointer-events-auto",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-game font-bold text-yellow-400 mb-3",children:t}),r.jsx("p",{className:"text-gray-300 mb-6 text-sm sm:text-base",children:s}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:o,className:"flex-1 pixel-btn bg-green-600 hover:bg-green-700 text-white py-2 text-sm sm:text-base",children:n}),r.jsx("button",{onClick:a,className:"flex-1 pixel-btn bg-red-600 hover:bg-red-700 text-white py-2 text-sm sm:text-base",children:i})]})]})})]})}),zt=({onSendMessage:e,userRole:t=null,className:s=""})=>{const[n,i]=g.useState(!1),[o,a]=g.useState("emoji"),l=["😊","😎","🤔","😅","😂","😭","👍","👎","👏","🙏","💪","✌️","🎉","🎯","💯","🔥","⚡","🌟","😤","😮","😲","🤯","😱","🙈"],u=t==="spectator"?["黑棋加油！你是最棒的！","白棋必胜！冲冲冲！","精彩！这局真是太精彩了！","黑棋这步棋下得妙啊！","白棋好厉害，学到了！","这是高手过招啊！","快看快看，要分胜负了！","黑棋稳住，马上就赢了！","白棋反击！还有机会！","太刺激了，我都紧张了！","这局势焦灼啊，谁都有机会","黑棋防守！要小心了！","白棋进攻！就是现在！","神仙打架，我等凡人观战","这棋局值得收藏学习","前排围观，吃瓜看戏🍿","支持黑棋，黑棋YYDS！","白棋粉丝团在此应援！","大家好，我是新来的观众","求解说，看不懂局势了"]:["你好呀！一起来玩吧～","承让承让，侥幸而已！","哇，这步棋真是绝了！","厉害厉害，我要认真了！","再来一局，刚才手滑了～","让你见识见识什么叫高手！","我等到花儿都谢了...","快点啊，我等到天都黑了","容我想想，这步很关键","这一步妙啊，学到了！","你是高手，我甘拜下风","加油加油，你可以的！","哎呀，失误了失误了","看我的绝杀！","友谊第一，比赛第二～","GG，精彩的对局！","别走，决战到天亮！","你这是在针对我吗？","稳住，我们能赢！","今天手感不太好啊..."],f=m=>{e(m),i(!1)};return r.jsxs("div",{className:"relative inline-flex items-center",children:[r.jsxs($.button,{onClick:()=>i(!n),className:oe("pixel-btn bg-purple-600 hover:bg-purple-700 text-white",s||"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm"),whileHover:{scale:1.05},whileTap:{scale:.95},children:[r.jsx("span",{className:"hidden sm:inline",children:"💬 聊天"}),r.jsx("span",{className:"sm:hidden",children:"聊天"})]}),r.jsx(pe,{children:n&&r.jsxs(r.Fragment,{children:[r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 z-40 sm:hidden",onClick:()=>i(!1)}),r.jsxs($.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{type:"spring",damping:25,stiffness:400},className:oe("z-50","sm:absolute sm:bottom-full sm:mb-2 sm:left-1/2 sm:transform sm:-translate-x-1/2 sm:w-80","fixed inset-x-4 top-1/2 -translate-y-1/2 sm:inset-auto sm:translate-y-0","pixel-container bg-gray-900/100 backdrop-blur-sm p-3 sm:p-4","max-h-[300px] max-w-sm mx-auto"),children:[r.jsxs("div",{className:"flex gap-2 mb-3",children:[r.jsx("button",{onClick:()=>a("emoji"),className:oe("flex-1 px-3 py-1 rounded text-sm font-pixel transition-all",o==="emoji"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"表情"}),r.jsx("button",{onClick:()=>a("phrase"),className:oe("flex-1 px-3 py-1 rounded text-sm font-pixel transition-all",o==="phrase"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"短语"})]}),r.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar",children:o==="emoji"?r.jsx("div",{className:"grid grid-cols-6 gap-2",children:l.map((m,x)=>r.jsx($.button,{onClick:()=>f(m),className:"text-2xl p-2 hover:bg-gray-700 rounded transition-colors",whileHover:{scale:1.2},whileTap:{scale:.9},children:m},x))}):r.jsx("div",{className:"space-y-1",children:u.map((m,x)=>r.jsx($.button,{onClick:()=>f(m),className:"w-full text-left px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 rounded transition-colors",whileHover:{x:5},whileTap:{scale:.98},children:m},x))})}),r.jsx("div",{className:`hidden sm:block absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-0 h-0 
                border-l-8 border-l-transparent 
                border-r-8 border-r-transparent 
                border-t-8 border-t-gray-900`})]})]})})]})},Gd=({messages:e})=>{const[t,s]=g.useState([]),{myColor:n,gameState:i}=ce();return g.useEffect(()=>{if(e.length>0){const o=e[e.length-1];s(a=>[...a,o]),setTimeout(()=>{s(a=>a.filter(l=>l.id!==o.id))},3e3)}},[e]),i==="waiting"?null:r.jsx(r.Fragment,{children:r.jsx(pe,{children:t.map((o,a)=>{const l=o.isOpponent?n===1?2:1:n,c=o.isOpponent;return r.jsx($.div,{initial:{opacity:0,scale:.3,x:-50,y:0},animate:{opacity:1,scale:1,x:0,y:-a*80},exit:{opacity:0,scale:0,y:-a*80-50},transition:{type:"spring",damping:20,stiffness:300,duration:.5},className:"fixed",style:{top:"50%",left:"20px",transform:"translateY(-50%)",zIndex:40+a},children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx($.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:r.jsx(yt,{color:l,size:"small",className:"pointer-events-auto"})}),r.jsxs($.div,{className:"relative",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:[r.jsx("div",{className:`
                      px-4 py-2 rounded-2xl shadow-lg pointer-events-auto
                      max-w-[200px] sm:max-w-[250px] break-words
                      ${c?"bg-gradient-to-r from-blue-500 to-blue-600 text-white":"bg-gradient-to-r from-green-500 to-green-600 text-white"}
                    `,children:o.content.match(/^[\u{1F300}-\u{1FAD6}]$/u)?r.jsx("span",{className:"text-3xl",children:o.content}):r.jsx("span",{className:"text-sm font-medium",children:o.content})}),r.jsx("div",{className:`
                      absolute w-0 h-0 
                      left-0 -ml-2 
                      border-t-8 border-t-transparent 
                      border-b-8 border-b-transparent 
                      border-r-8 
                      ${c?"border-r-blue-500":"border-r-green-500"}
                    `,style:{top:"50%",transform:"translateY(-50%)"}})]})]})},o.id)})})})},_d=()=>{const[e,t]=g.useState(!1),[s,n]=g.useState(!0),[i,o]=g.useState(!0),[a,l]=g.useState("prompt"),[c,d]=g.useState(""),u=g.useRef(null),f=g.useRef(new Map),m=g.useRef(null),{socket:x}=ds(),{roomId:k}=ce();g.useEffect(()=>{(()=>{const I=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="[::1]",A=window.location.protocol==="https:"||I;return!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia?(o(!1),d("浏览器不支持音频功能"),!1):A?!0:(d("⚠️ 由于安全限制，语音功能仅在HTTPS或本地环境可用。请使用localhost访问或部署HTTPS证书。"),o(!1),!1)})()},[]);const v=g.useCallback(async()=>{if(!i)return"denied";try{if(navigator.permissions&&navigator.permissions.query){const M=await navigator.permissions.query({name:"microphone"});return l(M.state),M.addEventListener("change",()=>{l(M.state)}),M.state}}catch(M){console.warn("无法查询麦克风权限:",M)}return"prompt"},[i]);g.useEffect(()=>{if(!m.current){const M=document.createElement("div");M.id="voice-chat-audio-container",M.style.display="none",document.body.appendChild(M),m.current=M}return()=>{m.current&&(m.current.remove(),m.current=null)}},[]);const P=g.useCallback(M=>{const I=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]});return u.current&&u.current.getTracks().forEach(A=>{u.current&&I.addTrack(A,u.current)}),I.ontrack=A=>{console.log("收到远程音频流:",M);const[w]=A.streams,C=document.createElement("audio");C.srcObject=w,C.autoplay=!0,C.muted=!s,m.current&&m.current.appendChild(C);const R=f.current.get(M);R&&(R.stream=w,R.audioElement=C)},I.onicecandidate=A=>{A.candidate&&x&&k&&x.emit("voice-ice-candidate",{roomId:k,candidate:A.candidate,targetPeerId:M})},I.onconnectionstatechange=()=>{console.log(`连接状态 [${M}]:`,I.connectionState),(I.connectionState==="failed"||I.connectionState==="disconnected")&&V(M)},I},[x,k,s]),V=g.useCallback(M=>{const I=f.current.get(M);I&&(I.audioElement&&m.current&&m.current.removeChild(I.audioElement),I.connection.close(),f.current.delete(M))},[]),T=g.useCallback(async()=>{if(!i)return d("当前环境不支持语音功能"),!1;try{const M=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return u.current=M,t(!0),l("granted"),n(!0),x&&k&&x.emit("join-voice-channel",{roomId:k}),!0}catch(M){return console.error("无法获取麦克风权限:",M),M.name==="NotAllowedError"?(l("denied"),d("麦克风权限被拒绝，请在浏览器设置中允许麦克风访问")):M.name==="NotFoundError"?d("未找到麦克风设备"):M.name==="NotReadableError"?d("麦克风被其他应用占用"):d("无法访问麦克风: "+M.message),!1}},[i,x,k]),S=g.useCallback(()=>{u.current&&(u.current.getTracks().forEach(M=>M.stop()),u.current=null),t(!1),x&&k&&x.emit("leave-voice-channel",{roomId:k}),f.current.forEach((M,I)=>{V(I)})},[x,k,V]),L=g.useCallback(async()=>{e?S():await T()},[e,T,S]),E=g.useCallback(()=>{const M=!s;n(M),f.current.forEach(I=>{I.audioElement&&(I.audioElement.muted=!M)})},[s]);return g.useEffect(()=>{if(!x||!k)return;const M=async R=>{if(console.log("用户加入语音频道:",R.userId),u.current){const b=P(R.userId);f.current.set(R.userId,{peerId:R.userId,connection:b});const j=await b.createOffer();await b.setLocalDescription(j),x.emit("voice-offer",{roomId:k,offer:j,targetPeerId:R.userId})}},I=async R=>{console.log("收到语音offer:",R.fromPeerId);const b=P(R.fromPeerId);f.current.set(R.fromPeerId,{peerId:R.fromPeerId,connection:b}),await b.setRemoteDescription(R.offer);const j=await b.createAnswer();await b.setLocalDescription(j),x.emit("voice-answer",{roomId:k,answer:j,targetPeerId:R.fromPeerId})},A=async R=>{console.log("收到语音answer:",R.fromPeerId);const b=f.current.get(R.fromPeerId);b&&await b.connection.setRemoteDescription(R.answer)},w=async R=>{const b=f.current.get(R.fromPeerId);b&&await b.connection.addIceCandidate(R.candidate)},C=R=>{console.log("用户离开语音频道:",R.userId),V(R.userId)};return x.on("user-joined-voice",M),x.on("voice-offer",I),x.on("voice-answer",A),x.on("voice-ice-candidate",w),x.on("user-left-voice",C),()=>{x.off("user-joined-voice",M),x.off("voice-offer",I),x.off("voice-answer",A),x.off("voice-ice-candidate",w),x.off("user-left-voice",C)}},[x,k,P,V]),g.useEffect(()=>()=>{S()},[S]),{isMicEnabled:e,isSpeakerEnabled:s,isSupported:i,permissionStatus:a,errorMessage:c,toggleMic:L,toggleSpeaker:E,checkPermission:v}},$t=({className:e})=>{const{isMicEnabled:t,isSpeakerEnabled:s,isSupported:n,permissionStatus:i,errorMessage:o,toggleMic:a,toggleSpeaker:l,checkPermission:c}=_d(),{addNotification:d}=ce();g.useEffect(()=>{c()},[c]),g.useEffect(()=>{o&&d("warning",o)},[o,d]);const u=async()=>{if(!n){d("warning","⚠️ 当前环境不支持语音功能，请使用HTTPS或localhost访问");return}if(i==="denied"){d("warning","⚠️ 麦克风权限被拒绝，请在浏览器设置中允许");return}await a()},f=()=>{!s&&!t&&d("info","💡 提示：单独开启喇叭可以听到其他人说话"),l()};return r.jsxs("div",{className:oe("flex gap-1",e),children:[r.jsxs($.button,{onClick:u,disabled:!n,className:oe("pixel-btn relative transition-all",t?"bg-green-600 hover:bg-green-700":"bg-gray-600 hover:bg-gray-700",!n&&"opacity-50 cursor-not-allowed"),whileHover:{scale:n?1.05:1},whileTap:{scale:n?.95:1},title:n?t?"关闭麦克风":"开启麦克风":"语音功能不可用",children:[t?r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z",clipRule:"evenodd"})}):r.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[r.jsx("path",{fillRule:"evenodd",d:"M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z",clipRule:"evenodd"}),r.jsx("path",{d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4z",opacity:"0.3"}),r.jsx("path",{d:"M11 14.93V17h3a1 1 0 110 2H6a1 1 0 110-2h3v-2.07A7.001 7.001 0 013 8a1 1 0 012 0 5 5 0 0010 0 1 1 0 112 0 7.001 7.001 0 01-6 6.93z",opacity:"0.3"})]}),t&&r.jsx($.span,{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full",animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:2}})]}),r.jsx($.button,{onClick:f,className:oe("pixel-btn relative transition-all",s?"bg-blue-600 hover:bg-blue-700":"bg-gray-600 hover:bg-gray-700"),whileHover:{scale:1.05},whileTap:{scale:.95},title:s?"关闭喇叭":"开启喇叭",children:s?r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}):r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),!n&&r.jsx("span",{className:"text-xs text-yellow-400 px-2 py-1",children:"⚠️ 需HTTPS"}),i==="denied"&&n&&r.jsx("span",{className:"text-xs text-red-400 px-2 py-1",children:"🚫 权限被拒"})]})},Wd=()=>{const[e,t]=g.useState(!1),[s,n]=g.useState(!1),[i,o]=g.useState(!1),[a,l]=g.useState(!1),[c,d]=g.useState(!1),[u,f]=g.useState(!1),[m,x]=g.useState(!1),[k,v]=g.useState(!1),[P,V]=g.useState(!1),[T,S]=g.useState([]),{gameState:L,roomId:E,resetGame:M,setRoomInfo:I,myColor:A,currentPlayer:w,canUndo:C,winner:R,addNotification:b,history:j,userRole:N}=ce(),{socket:h,connected:D,requestRestart:F,acceptRestart:G,rejectRestart:H,requestUndo:y,acceptUndo:p,rejectUndo:B,surrender:z,sendChatMessage:_,spectatorToPlayer:X,playerToSpectator:K}=ds();console.log("GomokuGame - connected:",D,"isInRoom:",e),g.useEffect(()=>{L==="finished"&&R&&setTimeout(()=>{n(!0)},1e3)},[L,R]),g.useEffect(()=>{if(!h)return;const $e=()=>{L==="finished"?(V(!1),n(!1),E&&G(E),b("info","双方同意，游戏即将重新开始")):(o(!0),d(!0))},Ue=()=>{V(!1),o(!1),b("warning","❌ 对手拒绝了重新开始请求")},st=()=>{l(!0),f(!0)},ut=()=>{l(!1),b("warning","❌ 对手拒绝了悔棋请求")},Et=()=>{n(!1),V(!1),o(!1),d(!1),S([])},Dt=ge=>{console.log("Player joined room:",ge.playerId),b("success","🎮 对手已加入房间"),h&&(console.log("Auto-readying for game start..."),h.emit("ready-to-play"))},ht=ge=>{console.log("Player left room:",ge.playerId),ce.setState({gameState:"waiting"}),b("warning","⚠️ 对手已离开房间")},ft=ge=>{console.log("Opponent surrendered, winner:",ge.winner,"myColor:",A),ge.winner!==A&&console.error("Winner color mismatch! Expected:",A,"Got:",ge.winner),ce.setState({gameState:"finished",winner:ge.winner}),ce.getState().updateScore(ge.winner),b("success","🏳️ 对手认输，你赢了！"),setTimeout(()=>{n(!0)},500)},nt=ge=>{console.log("Received chat message:",ge);const us={id:Math.random().toString(36).substr(2,9),content:ge.message,isOpponent:!0,timestamp:Date.now()};S(oo=>[...oo,us])};return h.on("restart-request",$e),h.on("restart-rejected",Ue),h.on("undo-request",st),h.on("undo-rejected",ut),h.on("game-restart",Et),h.on("player-joined",Dt),h.on("player-left",ht),h.on("opponent-surrender",ft),h.on("chat-message",nt),()=>{h.off("restart-request",$e),h.off("restart-rejected",Ue),h.off("undo-request",st),h.off("undo-rejected",ut),h.off("game-restart",Et),h.off("player-joined",Dt),h.off("player-left",ht),h.off("opponent-surrender",ft),h.off("chat-message",nt)}},[h,E,G,b,L,A]);const q=$e=>{if(!E)return;_(E,$e);const Ue={id:Math.random().toString(36).substr(2,9),content:$e,isOpponent:!1,timestamp:Date.now()};S(st=>[...st,Ue])},Y=()=>{E&&(G(E),o(!1),d(!1),b("success","✅ 已同意重新开始"))},te=()=>{E&&H(E),o(!1),d(!1),b("info","❌ 已拒绝重新开始请求")},O=()=>{E&&(p(E),l(!1),f(!1),b("success","✅ 已同意悔棋"))},W=()=>{E&&B(E),l(!1),f(!1),b("info","❌ 已拒绝悔棋请求")},U=()=>{h&&E&&h.emit("leave-room",{roomId:E}),t(!1),M(),I(null,!1),V(!1),S([]),b("info","👋 已离开房间")},Q=()=>{if(console.log("Restart requested, gameState:",L,"waitingForOpponentRestart:",P),P){b("info","⏳ 正在等待对手同意...");return}h&&E&&(L==="finished"?(V(!0),F(E),b("info","⏳ 等待对手同意再来一局...")):(F(E),b("info","📨 已发送重新开始请求")))},ee=()=>{if(!C||w!==A||j.length<2){b("warning","⚠️ 当前不能悔棋");return}h&&E&&(y(E),b("info","📨 已发送悔棋请求，等待对手确认..."))},re=()=>{if(N!=="player"){b("warning","⚠️ 你已经是观众了");return}x(!0)},he=()=>{K(),x(!1),b("info","👁️ 你已转为观众")},ye=()=>{x(!1)},we=()=>{if(L!=="playing"||N!=="player"){b("warning","⚠️ 当前不能认输");return}v(!0)},Me=()=>{E&&A&&(z(E,A),b("info","🏳️ 你已认输")),v(!1)},je=()=>{v(!1)},Vt=()=>{X()},tt=!C||w!==A||L!=="playing"||a||j.length<2;return r.jsxs("div",{className:"relative",children:[r.jsx($d,{}),e&&r.jsx(Gd,{messages:T}),r.jsx(Hd,{isOpen:s,onRestart:Q,onClose:()=>n(!1),waitingForOpponent:P}),r.jsx(Ot,{isOpen:c,title:"重新开始请求",message:"对手请求重新开始游戏，是否同意？",confirmText:"同意",cancelText:"拒绝",onConfirm:Y,onCancel:te}),r.jsx(Ot,{isOpen:u,title:"悔棋请求",message:"对手请求悔棋，是否同意？",confirmText:"同意",cancelText:"拒绝",onConfirm:O,onCancel:W}),r.jsx(Ot,{isOpen:m,title:"到观众席确认",message:"确定要到观众席吗？你将成为观众。",confirmText:"确认",cancelText:"取消",onConfirm:he,onCancel:ye}),r.jsx(Ot,{isOpen:k,title:"认输确认",message:"确定要认输吗？你将输掉当前游戏。",confirmText:"确认认输",cancelText:"取消",onConfirm:Me,onCancel:je}),r.jsx(pe,{mode:"wait",children:e?r.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex flex-col",children:[r.jsxs("div",{className:"hidden sm:flex flex-col",children:[r.jsxs("div",{className:"text-center py-0.5",children:[r.jsxs("h1",{className:"text-base font-game font-bold bg-gradient-to-r from-yellow-400 via-pink-400 to-purple-400 bg-clip-text text-transparent inline-flex items-center gap-2",children:["五子棋对战",N==="spectator"&&r.jsx("span",{className:"text-sm font-normal text-yellow-400",children:"（观战模式）"})]}),r.jsxs("p",{className:"text-gray-300 text-xs",children:["房间: ",r.jsx("span",{className:"text-yellow-400 font-pixel",children:E})]})]}),r.jsxs("div",{className:"flex justify-center px-4 pt-1",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Cs,{side:"left"})}),r.jsxs("div",{className:"mx-3 flex flex-col",children:[r.jsx(Nr,{}),r.jsxs("div",{className:"flex justify-center gap-1.5 mt-1 pb-2",children:[N==="player"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Q,disabled:i||P,className:oe("pixel-btn text-xs px-2.5 py-1 transition-all",(i||P)&&"opacity-50 cursor-not-allowed"),children:P?"等待对手...":i?"等待确认...":"重新开始"}),r.jsx("button",{onClick:ee,disabled:tt,className:oe("pixel-btn bg-blue-600 hover:bg-blue-700 text-xs px-2.5 py-1 transition-all",tt&&"opacity-50 cursor-not-allowed hover:bg-blue-600"),children:a?"等待确认...":"悔棋"}),r.jsx(zt,{onSendMessage:q,userRole:N,className:"text-xs px-2.5 py-1"}),r.jsx($t,{className:"text-xs px-2.5 py-1"}),r.jsx("button",{onClick:we,disabled:L!=="playing",className:oe("pixel-btn bg-red-600 hover:bg-red-700 text-xs px-2.5 py-1 transition-all",L!=="playing"&&"opacity-50 cursor-not-allowed hover:bg-red-600"),children:"认输"}),r.jsx("button",{onClick:re,className:"pixel-btn bg-yellow-600 hover:bg-yellow-700 text-xs px-2.5 py-1 transition-all",children:"到观众席"})]}):N==="spectator"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Vt,className:"pixel-btn bg-green-600 hover:bg-green-700 text-xs px-2.5 py-1 transition-all",children:"成为玩家"}),r.jsx(zt,{onSendMessage:q,userRole:N,className:"text-xs px-2.5 py-1"}),r.jsx($t,{className:"text-xs px-2.5 py-1"}),r.jsx("span",{className:"text-yellow-400 text-xs px-2 py-1",children:"👁️ 观战模式"})]}):null,r.jsx("button",{onClick:U,className:"pixel-btn bg-red-600 hover:bg-red-700 text-xs px-2.5 py-1 transition-all",children:"离开房间"})]})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Cs,{side:"right"})})]})]}),r.jsxs("div",{className:"sm:hidden flex flex-col",children:[r.jsx("div",{className:"text-center py-0.5",children:r.jsxs("h1",{className:"text-xs font-game font-bold text-yellow-400",children:["五子棋",N==="spectator"&&"(观战)"," - ",E]})}),r.jsx("div",{className:"px-1",children:r.jsx(Cs,{})}),r.jsxs("div",{className:"flex flex-col items-center pt-0.5",children:[r.jsx(Nr,{}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-0.5 mt-0.5 px-1 pb-2",children:[N==="player"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Q,disabled:i||P,className:oe("pixel-btn text-[8px] px-1.5 py-0.5 transition-all",(i||P)&&"opacity-50 cursor-not-allowed"),children:P||i?"等待":"重开"}),r.jsx("button",{onClick:ee,disabled:tt,className:oe("pixel-btn bg-blue-600 hover:bg-blue-700 text-[8px] px-1.5 py-0.5 transition-all",tt&&"opacity-50 cursor-not-allowed hover:bg-blue-600"),children:a?"等待":"悔棋"}),r.jsx(zt,{onSendMessage:q,userRole:N,className:"text-[8px] px-1.5 py-0.5"}),r.jsx($t,{className:"text-[8px] px-1.5 py-0.5"}),r.jsx("button",{onClick:we,disabled:L!=="playing",className:oe("pixel-btn bg-red-600 hover:bg-red-700 text-[8px] px-1.5 py-0.5 transition-all",L!=="playing"&&"opacity-50 cursor-not-allowed hover:bg-red-600"),children:"认输"}),r.jsx("button",{onClick:re,className:"pixel-btn bg-yellow-600 hover:bg-yellow-700 text-[8px] px-1.5 py-0.5 transition-all",children:"观众席"})]}):N==="spectator"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Vt,className:"pixel-btn bg-green-600 hover:bg-green-700 text-[8px] px-1.5 py-0.5 transition-all",children:"成玩家"}),r.jsx(zt,{onSendMessage:q,userRole:N,className:"text-[8px] px-1.5 py-0.5"}),r.jsx($t,{className:"text-[8px] px-1.5 py-0.5"})]}):null,r.jsx("button",{onClick:U,className:"pixel-btn bg-red-600 hover:bg-red-700 text-[8px] px-1.5 py-0.5 transition-all",children:"离开"})]})]})]})]},"game"):r.jsx($.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},className:"flex items-center justify-center px-4 py-2",children:r.jsx("div",{className:"w-full max-w-2xl",children:r.jsx(zd,{onJoinRoom:()=>t(!0)})})},"room-manager")}),!D&&e&&r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed bottom-2 right-2 bg-orange-600 text-white px-2 py-1 rounded shadow-lg text-xs z-50",children:r.jsx("span",{className:"animate-pulse",children:"连接中..."})})]})};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xd=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,s,n)=>n?n.toUpperCase():s.toLowerCase()),Sr=e=>{const t=Xd(e);return t.charAt(0).toUpperCase()+t.slice(1)},no=(...e)=>e.filter((t,s,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===s).join(" ").trim(),Kd=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Yd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=g.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:o,iconNode:a,...l},c)=>g.createElement("svg",{ref:c,...Yd,width:t,height:t,stroke:e,strokeWidth:n?Number(s)*24/Number(t):s,className:no("lucide",i),...!o&&!Kd(l)&&{"aria-hidden":"true"},...l},[...a.map(([d,u])=>g.createElement(d,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=(e,t)=>{const s=g.forwardRef(({className:n,...i},o)=>g.createElement(Zd,{ref:o,iconNode:t,className:no(`lucide-${qd(Sr(e))}`,`lucide-${e}`,n),...i}));return s.displayName=Sr(e),s};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Qe=de("arrow-left",Jd);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],eu=de("circle-alert",Qd);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ro=de("circle-check-big",tu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ts=de("circle",su);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ru=de("copy",nu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],ou=de("eraser",iu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],lu=de("heart",au);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Cr=de("lightbulb",cu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],uu=de("monitor",du);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],io=de("pause",hu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],es=de("play",fu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],et=de("rotate-ccw",mu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],gu=de("sparkles",pu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],yu=de("star",xu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],bu=de("target",vu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],ju=de("timer",wu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],At=de("trophy",Nu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Cu=de("users",Su);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ps=de("x",Tu),Pu=()=>{const e=Ye(),[t,s]=g.useState(()=>x()),[n,i]=g.useState(0),[o,a]=g.useState(()=>{const E=localStorage.getItem("2048-best-score");return E?parseInt(E):0}),[l,c]=g.useState(!1),[d,u]=g.useState(!1),[f,m]=g.useState(null);function x(){const E=Array(4).fill(null).map(()=>Array(4).fill(null));return k(E),k(E),E}function k(E){const M=[];for(let w=0;w<4;w++)for(let C=0;C<4;C++)E[w][C]===null&&M.push([w,C]);if(M.length===0)return!1;const[I,A]=M[Math.floor(Math.random()*M.length)];return E[I][A]=Math.random()<.9?2:4,!0}const v=g.useCallback(E=>{if(l||d)return;const M=t.map(C=>[...C]);let I=!1,A=0;const w=C=>{let R=C.filter(N=>N!==null),b=0,j=!1;for(let N=0;N<R.length-1;N++)R[N]===R[N+1]&&(R[N]=R[N]*2,b+=R[N],R.splice(N+1,1),j=!0);for(;R.length<4;)R.push(null);return JSON.stringify(C)!==JSON.stringify(R)&&(j=!0),[R,b,j]};if(E==="left")for(let C=0;C<4;C++){const[R,b,j]=w(M[C]);M[C]=R,A+=b,j&&(I=!0)}else if(E==="right")for(let C=0;C<4;C++){const R=[...M[C]].reverse(),[b,j,N]=w(R);M[C]=b.reverse(),A+=j,N&&(I=!0)}else if(E==="up")for(let C=0;C<4;C++){const R=[M[0][C],M[1][C],M[2][C],M[3][C]],[b,j,N]=w(R);for(let h=0;h<4;h++)M[h][C]=b[h];A+=j,N&&(I=!0)}else if(E==="down")for(let C=0;C<4;C++){const R=[M[3][C],M[2][C],M[1][C],M[0][C]],[b,j,N]=w(R);M[0][C]=b[3],M[1][C]=b[2],M[2][C]=b[1],M[3][C]=b[0],A+=j,N&&(I=!0)}if(I){k(M),s(M);const C=n+A;i(C),C>o&&(a(C),localStorage.setItem("2048-best-score",C.toString()));for(let R=0;R<4;R++)for(let b=0;b<4;b++)if(M[R][b]===2048){u(!0);return}P(M)||c(!0)}},[t,n,o,l,d]);function P(E){for(let M=0;M<4;M++)for(let I=0;I<4;I++)if(E[M][I]===null)return!0;for(let M=0;M<4;M++)for(let I=0;I<4;I++){const A=E[M][I];if(M<3&&A===E[M+1][I]||I<3&&A===E[M][I+1])return!0}return!1}g.useEffect(()=>{const E=M=>{M.key==="ArrowUp"?(M.preventDefault(),v("up")):M.key==="ArrowDown"?(M.preventDefault(),v("down")):M.key==="ArrowLeft"?(M.preventDefault(),v("left")):M.key==="ArrowRight"&&(M.preventDefault(),v("right"))};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[v]);const V=E=>{const M=E.touches[0];m({x:M.clientX,y:M.clientY})},T=E=>{if(!f)return;const M=E.changedTouches[0],I=M.clientX-f.x,A=M.clientY-f.y,w=50;Math.abs(I)>Math.abs(A)?Math.abs(I)>w&&(I>0?v("right"):v("left")):Math.abs(A)>w&&(A>0?v("down"):v("up")),m(null)},S=()=>{s(x()),i(0),c(!1),u(!1)},L=E=>E===null?"bg-gray-700":{2:"bg-gray-600",4:"bg-gray-500",8:"bg-orange-500",16:"bg-orange-600",32:"bg-red-500",64:"bg-red-600",128:"bg-yellow-500",256:"bg-yellow-600",512:"bg-green-500",1024:"bg-green-600",2048:"bg-purple-600"}[E]||"bg-purple-700";return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 p-4",children:r.jsxs("div",{className:"max-w-md mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("button",{onClick:()=>e("/"),className:"p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(Qe,{size:24})}),r.jsx("h1",{className:"text-3xl font-bold text-white font-game",children:"2048"}),r.jsx("button",{onClick:S,className:"p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(et,{size:24})})]}),r.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[r.jsxs("div",{className:"bg-gray-800 px-4 py-2 rounded-lg",children:[r.jsx("div",{className:"text-gray-400 text-sm",children:"得分"}),r.jsx("div",{className:"text-white text-2xl font-bold",children:n})]}),r.jsxs("div",{className:"bg-gray-800 px-4 py-2 rounded-lg",children:[r.jsx("div",{className:"text-gray-400 text-sm",children:"最高分"}),r.jsx("div",{className:"text-white text-2xl font-bold",children:o})]})]}),r.jsx("div",{className:"relative bg-gray-800 p-2 rounded-lg select-none",onTouchStart:V,onTouchEnd:T,children:r.jsx("div",{className:"grid grid-cols-4 gap-2",children:t.map((E,M)=>E.map((I,A)=>r.jsxs("div",{className:"aspect-square relative",children:[r.jsx("div",{className:"absolute inset-0 bg-gray-700 rounded"}),r.jsx(pe,{mode:"popLayout",children:I!==null&&r.jsx($.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:`absolute inset-0 ${L(I)} rounded flex items-center justify-center text-white font-bold ${I&&I>=128?"text-2xl":"text-3xl"} ${I&&I>=1024?"text-xl":""}`,children:I},`tile-${M}-${A}-${I}`)})]},`${M}-${A}`)))})}),r.jsxs("div",{className:"mt-6 text-center text-gray-400 text-sm",children:[r.jsx("p",{children:"使用方向键或滑动来移动方块"}),r.jsx("p",{children:"相同数字的方块会合并"})]}),r.jsx(pe,{children:(l||d)&&r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50",children:r.jsxs($.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},className:"bg-gray-800 p-8 rounded-xl text-center max-w-sm w-full",children:[d?r.jsxs(r.Fragment,{children:[r.jsx(At,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"恭喜获胜！"}),r.jsx("p",{className:"text-gray-400 mb-6",children:"你达到了2048！"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"游戏结束"}),r.jsxs("p",{className:"text-gray-400 mb-6",children:["最终得分：",n]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:S,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"返回首页"})]})]})})})]})})},De=20,Tr=150,ku=5,Mu=()=>{const e=Ye(),t=g.useRef(null),[s,n]=g.useState([{x:10,y:10}]),[i,o]=g.useState({x:15,y:15}),[a,l]=g.useState("RIGHT"),[c,d]=g.useState(!1),[u,f]=g.useState(0),[m,x]=g.useState(()=>{const b=localStorage.getItem("snake-high-score");return b?parseInt(b):0}),[k,v]=g.useState(!1),[P,V]=g.useState(null),T=g.useRef(a),[S,L]=g.useState(Tr),E=g.useCallback(b=>{let j;do j={x:Math.floor(Math.random()*De),y:Math.floor(Math.random()*De)};while(b.some(N=>N.x===j.x&&N.y===j.y));return j},[]),M=g.useCallback((b,j)=>b.x<0||b.x>=De||b.y<0||b.y>=De?!0:j.some(N=>N.x===b.x&&N.y===b.y),[]),I=g.useCallback(()=>{c||!k||n(b=>{const j=[...b],N={...j[0]};switch(T.current){case"UP":N.y-=1;break;case"DOWN":N.y+=1;break;case"LEFT":N.x-=1;break;case"RIGHT":N.x+=1;break}return M(N,j)?(d(!0),v(!1),u>m&&(x(u),localStorage.setItem("snake-high-score",u.toString())),b):(j.unshift(N),N.x===i.x&&N.y===i.y?(f(h=>h+10),o(E(j)),L(h=>Math.max(50,h-ku))):j.pop(),j)})},[c,k,i,M,E,u,m]);g.useEffect(()=>{const b=setInterval(I,S);return()=>clearInterval(b)},[I,S]),g.useEffect(()=>{const b=j=>{if(c||!k)return;const N=j.key;let h=T.current;switch(N){case"ArrowUp":case"w":case"W":T.current!=="DOWN"&&(h="UP");break;case"ArrowDown":case"s":case"S":T.current!=="UP"&&(h="DOWN");break;case"ArrowLeft":case"a":case"A":T.current!=="RIGHT"&&(h="LEFT");break;case"ArrowRight":case"d":case"D":T.current!=="LEFT"&&(h="RIGHT");break;case" ":j.preventDefault(),v(D=>!D);break}h!==T.current&&(T.current=h,l(h))};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[c,k]);const A=b=>{const j=b.touches[0];V({x:j.clientX,y:j.clientY})},w=b=>{if(!P||c||!k)return;const j=b.changedTouches[0],N=j.clientX-P.x,h=j.clientY-P.y;Math.abs(N)>Math.abs(h)?N>30&&T.current!=="LEFT"?(T.current="RIGHT",l("RIGHT")):N<-30&&T.current!=="RIGHT"&&(T.current="LEFT",l("LEFT")):h>30&&T.current!=="UP"?(T.current="DOWN",l("DOWN")):h<-30&&T.current!=="DOWN"&&(T.current="UP",l("UP")),V(null)},C=()=>{n([{x:10,y:10}]),o({x:15,y:15}),l("RIGHT"),T.current="RIGHT",d(!1),f(0),L(Tr),v(!1)},R=()=>{c?C():v(!0)};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-2xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Qe,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"贪吃蛇"}),r.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(et,{size:16}),r.jsx("span",{className:"font-game",children:"重新开始"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"当前分数"}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:u})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(At,{size:14}),"最高分数"]}),r.jsx("div",{className:"text-2xl font-bold text-yellow-400 font-game",children:m})]})]})]}),r.jsxs("div",{ref:t,className:"bg-gray-900 border border-gray-700 p-4 rounded-b-xl relative",onTouchStart:A,onTouchEnd:w,children:[r.jsxs("div",{className:"relative bg-gray-800 rounded-lg",style:{width:`${De*16}px`,height:`${De*16}px`,maxWidth:"100%",aspectRatio:"1/1"},children:[r.jsx("div",{className:"absolute inset-0 grid grid-cols-20 grid-rows-20",children:Array.from({length:De*De}).map((b,j)=>r.jsx("div",{className:"border border-gray-700/20"},j))}),r.jsx(pe,{children:s.map((b,j)=>r.jsx($.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:`absolute ${j===0?"bg-gradient-to-br from-green-400 to-green-600 z-20":"bg-gradient-to-br from-green-500 to-green-700 z-10"} rounded-sm`,style:{left:`${b.x*16}px`,top:`${b.y*16}px`,width:"14px",height:"14px",margin:"1px"}},`${b.x}-${b.y}-${j}`))}),r.jsx($.div,{initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{duration:.5,repeat:1/0},className:"absolute bg-gradient-to-br from-red-400 to-red-600 rounded-full z-30",style:{left:`${i.x*16}px`,top:`${i.y*16}px`,width:"14px",height:"14px",margin:"1px"}},`${i.x}-${i.y}`),(!k||c)&&r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center z-40",children:r.jsx("div",{className:"text-center",children:c?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-4",children:["得分: ",u]}),u>m&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新纪录!"}),r.jsx("button",{onClick:C,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:u===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:R,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(es,{size:20}),u===0?"开始游戏":"继续游戏"]}),r.jsxs("div",{className:"mt-4 text-gray-400 text-sm font-game",children:[r.jsx("p",{children:"使用方向键或WASD控制"}),r.jsx("p",{children:"手机上滑动屏幕控制方向"}),r.jsx("p",{children:"空格键暂停/继续"})]})]})})})]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("button",{onClick:()=>v(b=>!b),className:`px-6 py-3 ${k?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center gap-2`,children:k?r.jsxs(r.Fragment,{children:[r.jsx(io,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(es,{size:20}),u===0?"开始":"继续"]})})})]})]})})},fe=10,Pr=["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500"],Ru={"bg-red-500":"from-red-400 to-red-600","bg-blue-500":"from-blue-400 to-blue-600","bg-green-500":"from-green-400 to-green-600","bg-yellow-500":"from-yellow-400 to-yellow-600","bg-purple-500":"from-purple-400 to-purple-600"},Au=()=>{const e=Ye(),[t,s]=g.useState([]),[n,i]=g.useState(0),[o,a]=g.useState(new Set),[l,c]=g.useState(!1),[d,u]=g.useState(null),[f,m]=g.useState(()=>{const R=localStorage.getItem("popstar-high-score");return R?parseInt(R):0}),[x,k]=g.useState(0),[v,P]=g.useState(fe*fe),V=g.useCallback(()=>{const R=[];for(let b=0;b<fe;b++){const j=[];for(let N=0;N<fe;N++)j.push({id:`${b}-${N}`,color:Pr[Math.floor(Math.random()*Pr.length)],isSelected:!1,willBeRemoved:!1});R.push(j)}return R},[]),T=()=>{s(V()),i(0),a(new Set),c(!1),k(0),P(fe*fe),u(null)},S=(R,b,j,N)=>{const h=new Set,D=[[b,j]],F=new Set;for(;D.length>0;){const[G,H]=D.pop(),y=`${G}-${H}`;F.has(y)||(F.add(y),!(G<0||G>=fe||H<0||H>=fe)&&(!R[G][H].color||R[G][H].color!==N||(h.add(y),D.push([G-1,H]),D.push([G+1,H]),D.push([G,H-1]),D.push([G,H+1]))))}return h},L=(R,b,j)=>{if(l)return;const N=t[R][b];if(!N.color)return;const h=S(t,R,b,N.color);o.size>0&&o.has(`${R}-${b}`)?h.size>=2&&M(h,j):h.size>=2?(a(h),E(h)):(a(new Set),E(new Set))},E=R=>{s(b=>b.map((j,N)=>j.map((h,D)=>({...h,isSelected:R.has(`${N}-${D}`)}))))},M=(R,b)=>{const j=R.size,N=I(j),h=b.target.getBoundingClientRect();u({value:N,position:{x:h.left+h.width/2,y:h.top}}),setTimeout(()=>u(null),1e3);const D=t.map((F,G)=>F.map((H,y)=>({...H,willBeRemoved:R.has(`${G}-${y}`)})));s(D),setTimeout(()=>{A(R),i(F=>F+N),k(F=>F+1),P(F=>F-j),a(new Set)},300)},I=R=>R*R*5,A=R=>{s(b=>{const j=b.map(h=>[...h]);R.forEach(h=>{const[D,F]=h.split("-").map(Number);j[D][F]={...j[D][F],color:null,willBeRemoved:!1}});for(let h=0;h<fe;h++){let D=fe-1;for(let F=fe-1;F>=0;F--)j[F][h].color!==null&&(F!==D&&(j[D][h]=j[F][h],j[F][h]={...j[F][h],color:null}),D--)}let N=0;for(let h=0;h<fe;h++)if(!j.every(F=>F[h].color===null)){if(h!==N)for(let F=0;F<fe;F++)j[F][N]=j[F][h],j[F][h]={...j[F][h],color:null};N++}return j.map(h=>h.map(D=>({...D,isSelected:!1})))})},w=()=>{for(let R=0;R<fe;R++)for(let b=0;b<fe;b++){const j=t[R][b].color;if(j&&S(t,R,b,j).size>=2)return!1}return!0},C=()=>v===0?2e3:v<=5?1e3:v<=10?500:0;return g.useEffect(()=>{T()},[]),g.useEffect(()=>{if(t.length>0&&w()&&!l){const b=C(),j=n+b;i(j),c(!0),j>f&&(m(j),localStorage.setItem("popstar-high-score",j.toString()))}},[t,n,l,f,v]),r.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-4rem)] p-4",children:[r.jsxs($.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"w-full max-w-md mb-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("button",{onClick:()=>e("/"),className:"p-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors",children:r.jsx(Qe,{className:"w-5 h-5"})}),r.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500",children:"消灭星星"}),r.jsx("button",{onClick:T,className:"p-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors",children:r.jsx(et,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[r.jsxs("div",{className:"bg-gray-800 rounded-lg p-2 text-center",children:[r.jsx("div",{className:"text-xs text-gray-400",children:"得分"}),r.jsx("div",{className:"text-lg font-bold text-yellow-400",children:n})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-2 text-center",children:[r.jsx("div",{className:"text-xs text-gray-400",children:"最高分"}),r.jsx("div",{className:"text-lg font-bold text-purple-400",children:f})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-2 text-center",children:[r.jsx("div",{className:"text-xs text-gray-400",children:"步数"}),r.jsx("div",{className:"text-lg font-bold text-blue-400",children:x})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-2 text-center",children:[r.jsx("div",{className:"text-xs text-gray-400",children:"剩余"}),r.jsx("div",{className:"text-lg font-bold text-green-400",children:v})]})]}),o.size>0&&r.jsxs($.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-gray-800 rounded-lg p-2 mb-2 text-center",children:[r.jsx("span",{className:"text-sm text-gray-400",children:"选中 "}),r.jsx("span",{className:"text-lg font-bold text-yellow-400",children:o.size}),r.jsx("span",{className:"text-sm text-gray-400",children:" 个方块，得分 "}),r.jsx("span",{className:"text-lg font-bold text-green-400",children:I(o.size)})]})]}),r.jsx($.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"relative bg-gray-800 p-2 rounded-lg",children:r.jsx("div",{className:"grid grid-cols-10 gap-1",style:{width:"min(90vw, 400px)"},children:t.map((R,b)=>R.map((j,N)=>r.jsxs($.button,{initial:!1,animate:{scale:j.isSelected?1.1:1,opacity:j.willBeRemoved?0:j.color?1:0},transition:{type:"spring",stiffness:300,damping:20},className:`
                  aspect-square rounded-md relative
                  ${j.color?`bg-gradient-to-br ${Ru[j.color]}`:"bg-transparent"}
                  ${j.isSelected?"ring-2 ring-white ring-opacity-70":""}
                  ${j.color?"cursor-pointer hover:brightness-110":"cursor-default"}
                  transition-all duration-200
                `,onClick:h=>L(b,N,h),style:{width:"calc((min(90vw, 400px) - 36px) / 10)",height:"calc((min(90vw, 400px) - 36px) / 10)"},children:[j.color&&r.jsx(yu,{className:"w-full h-full p-1 text-white opacity-50",fill:"currentColor"}),j.isSelected&&r.jsx($.div,{initial:{scale:0},animate:{scale:1},className:"absolute inset-0 flex items-center justify-center",children:r.jsx(gu,{className:"w-4 h-4 text-white"})})]},`${b}-${N}`)))})}),r.jsx(pe,{children:d&&r.jsx($.div,{initial:{opacity:0,y:0,scale:.5},animate:{opacity:1,y:-50,scale:1},exit:{opacity:0,y:-100},className:"fixed pointer-events-none z-50",style:{left:d.position.x,top:d.position.y,transform:"translate(-50%, -50%)"},children:r.jsxs("div",{className:"text-3xl font-bold text-yellow-400 drop-shadow-lg",children:["+",d.value]})})}),r.jsx(pe,{children:l&&r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",children:r.jsx($.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-gray-800 rounded-lg p-6 max-w-sm w-full",children:r.jsxs("div",{className:"text-center",children:[r.jsx(At,{className:"w-16 h-16 mx-auto mb-4 text-yellow-400"}),r.jsx("h2",{className:"text-2xl font-bold mb-2",children:"游戏结束!"}),v===0&&r.jsx("div",{className:"text-yellow-400 mb-2",children:"完美通关！奖励 2000 分！"}),r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("div",{className:"text-lg",children:["最终得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:n})]}),r.jsxs("div",{className:"text-lg",children:["步数: ",r.jsx("span",{className:"text-blue-400 font-bold",children:x})]}),r.jsxs("div",{className:"text-lg",children:["剩余星星: ",r.jsx("span",{className:"text-green-400 font-bold",children:v})]}),n>f&&r.jsx("div",{className:"text-purple-400 font-bold",children:"🎉 新纪录！"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:T,className:"flex-1 px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:brightness-110 transition-all",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-all",children:"返回首页"})]})]})})})})]})};let se=null,Ut=!1;const Vu=(e,t,s,n,i,o,a,l,c)=>{const[d,u]=g.useState(Ut);return g.useEffect(()=>{if(se)u(Ut);else{let T;T="http://socket.qingfengyueying.xyz",console.log("TicTacToe - Connecting to:",T),se=Ws(T,{transports:["websocket","polling"],upgrade:!0,path:"/socket.io/",timeout:1e4,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),se.on("connect",()=>{console.log("TicTacToe socket connected"),Ut=!0,u(!0)}),se.on("disconnect",()=>{console.log("TicTacToe socket disconnected"),Ut=!1,u(!1)}),se.on("ttt-game-start",S=>{console.log("TicTacToe game start:",S),e(S)}),se.on("ttt-opponent-move",S=>{console.log("TicTacToe opponent move:",S),t(S)}),se.on("ttt-game-end",S=>{console.log("TicTacToe game end:",S),s(S)}),se.on("ttt-room-joined",S=>{console.log("TicTacToe room joined:",S),n(S)}),se.on("ttt-room-created",S=>{console.log("TicTacToe room created:",S),n(S)}),se.on("ttt-player-joined",S=>{console.log("TicTacToe player joined:",S),i(S)}),se.on("ttt-player-left",S=>{console.log("TicTacToe player left:",S),o(S)}),se.on("ttt-restart-request",()=>{console.log("TicTacToe restart request"),a()}),se.on("ttt-game-restart",()=>{console.log("TicTacToe game restart"),l()}),se.on("ttt-error",S=>{console.error("TicTacToe error:",S.message),c(S.message)})}return()=>{}},[e,t,s,n,i,o,a,l,c]),{socket:se,connected:d,joinRoom:(T,S)=>{se&&S==="online"&&(console.log("Joining TicTacToe room:",T),se.emit("ttt-join-room",{roomId:T}))},createRoom:T=>{se&&T==="online"&&(console.log("Creating TicTacToe room"),se.emit("ttt-create-room"))},makeMove:(T,S,L)=>{se&&(console.log("Making TicTacToe move:",{roomId:T,row:S,col:L}),se.emit("ttt-make-move",{roomId:T,row:S,col:L}))},requestRestart:T=>{se&&(console.log("Requesting TicTacToe restart:",T),se.emit("ttt-request-restart",{roomId:T}))},acceptRestart:T=>{se&&(console.log("Accepting TicTacToe restart:",T),se.emit("ttt-accept-restart",{roomId:T}))},rejectRestart:T=>{se&&(console.log("Rejecting TicTacToe restart:",T),se.emit("ttt-reject-restart",{roomId:T}))},leaveRoom:T=>{se&&(console.log("Leaving TicTacToe room:",T),se.emit("ttt-leave-room",{roomId:T}))}}},Eu=()=>{const e=Ye(),[t,s]=g.useState(()=>Array(3).fill(null).map(()=>Array(3).fill(null))),[n,i]=g.useState("X"),[o,a]=g.useState(null),[l,c]=g.useState(null),[d,u]=g.useState("waiting"),[f,m]=g.useState(null),[x,k]=g.useState([]),[v,P]=g.useState(""),[V,T]=g.useState({X:0,O:0,draws:0}),[S,L]=g.useState(!1),[E,M]=g.useState(!1),[I,A]=g.useState(!1),[w,C]=g.useState(""),{connected:R,joinRoom:b,createRoom:j,makeMove:N,requestRestart:h,acceptRestart:D,rejectRestart:F,leaveRoom:G}=Vu(O=>{a(O.playerSymbol),u("playing"),i("X"),_(),C("游戏开始！你是 "+O.playerSymbol)},O=>{const W=[...t];W[O.row][O.col]=n,s(W);const U=H(W);U.winner?B(U.winner,U.line):i(n==="X"?"O":"X")},O=>{m(O.winner),u("finished"),z(O.winner)},O=>{P(O.roomId),M(!O.isHost),C(O.isHost?"房间创建成功，等待对手加入...":"成功加入房间")},()=>{M(!1),C("对手已加入，游戏即将开始")},()=>{C("对手已离开"),u("waiting"),M(!0)},()=>{L(!0),C("对手请求重新开始")},()=>{X(),C("游戏重新开始")},O=>{C(O)}),H=O=>{for(let U=0;U<3;U++)if(O[U][0]&&O[U][0]===O[U][1]&&O[U][1]===O[U][2])return{winner:O[U][0],line:[[U,0],[U,1],[U,2]]};for(let U=0;U<3;U++)if(O[0][U]&&O[0][U]===O[1][U]&&O[1][U]===O[2][U])return{winner:O[0][U],line:[[0,U],[1,U],[2,U]]};return O[0][0]&&O[0][0]===O[1][1]&&O[1][1]===O[2][2]?{winner:O[0][0],line:[[0,0],[1,1],[2,2]]}:O[0][2]&&O[0][2]===O[1][1]&&O[1][1]===O[2][0]?{winner:O[0][2],line:[[0,2],[1,1],[2,0]]}:O.every(U=>U.every(Q=>Q!==null))?{winner:"draw",line:[]}:{winner:null,line:[]}},y=g.useCallback(()=>{d!=="playing"||n!=="O"||setTimeout(()=>{const O=[];for(let U=0;U<3;U++)for(let Q=0;Q<3;Q++)t[U][Q]||O.push([U,Q]);if(O.length===0)return;let W=null;for(const[U,Q]of O){const ee=t.map(re=>[...re]);if(ee[U][Q]="O",H(ee).winner==="O"){W=[U,Q];break}}if(!W)for(const[U,Q]of O){const ee=t.map(re=>[...re]);if(ee[U][Q]="X",H(ee).winner==="X"){W=[U,Q];break}}if(!W&&!t[1][1]&&(W=[1,1]),!W){const Q=[[0,0],[0,2],[2,0],[2,2]].filter(([ee,re])=>!t[ee][re]);Q.length>0&&(W=Q[Math.floor(Math.random()*Q.length)])}W||(W=O[Math.floor(Math.random()*O.length)]),W&&p(W[0],W[1])},500)},[t,n,d]),p=(O,W)=>{if(d!=="playing"||t[O][W]||f||l==="online"&&n!==o)return;const U=[...t];U[O][W]=n,s(U),l==="online"&&v&&N(v,O,W);const Q=H(U);Q.winner?B(Q.winner,Q.line):i(n==="X"?"O":"X")},B=(O,W=[])=>{m(O),k(W),u("finished"),z(O),C(O==="draw"?"平局！":`${l==="single"?O==="X"?"你":"电脑":O===o?"你":"对手"}获胜！`)},z=O=>{O==="draw"?T(W=>({...W,draws:W.draws+1})):O&&T(W=>({...W,[O]:W[O]+1}))},_=()=>{s(Array(3).fill(null).map(()=>Array(3).fill(null))),m(null),k([])},X=()=>{_(),i("X"),u(l?"playing":"waiting"),L(!1)},K=O=>{c(O),X(),O==="single"?(a("X"),u("playing")):O==="online"&&j("online")},q=()=>{const O=prompt("请输入房间号:");O&&(P(O.toUpperCase()),b(O.toUpperCase(),"online"),c("online"))},Y=()=>{navigator.clipboard.writeText(v),A(!0),setTimeout(()=>A(!1),2e3)},te=()=>{l==="online"&&v&&G(v),c(null),u("waiting"),_(),P(""),a(null)};return g.useEffect(()=>{l==="single"&&d==="playing"&&n==="O"&&!f&&y()},[l,d,n,f,y]),g.useEffect(()=>{if(w){const O=setTimeout(()=>C(""),3e3);return()=>clearTimeout(O)}},[w]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-lg",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>l?te():e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Qe,{size:20}),r.jsx("span",{className:"font-game",children:l?"菜单":"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"井字棋"}),d==="playing"&&r.jsxs("button",{onClick:X,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(et,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]}),l&&r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsxs("div",{className:"text-blue-400 font-game flex items-center justify-center gap-1",children:[r.jsx(Ps,{size:16}),l==="single"?"玩家":"X"]}),r.jsx("div",{className:"text-xl font-bold text-white",children:V.X})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsx("div",{className:"text-gray-400 font-game",children:"平局"}),r.jsx("div",{className:"text-xl font-bold text-white",children:V.draws})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsxs("div",{className:"text-red-400 font-game flex items-center justify-center gap-1",children:[r.jsx(Ts,{size:16}),l==="single"?"电脑":"O"]}),r.jsx("div",{className:"text-xl font-bold text-white",children:V.O})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsx(pe,{children:w&&r.jsx($.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-4 p-3 bg-blue-600/20 border border-blue-600 rounded-lg text-blue-400 text-center font-game",children:w})}),!l&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-game text-white text-center mb-6",children:"选择游戏模式"}),r.jsxs("button",{onClick:()=>K("single"),className:"w-full p-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all flex items-center justify-center gap-3",children:[r.jsx(uu,{size:24}),r.jsx("span",{className:"font-game text-lg",children:"单机对战"})]}),r.jsxs("button",{onClick:()=>K("online"),disabled:!R,className:`w-full p-4 ${R?"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800":"bg-gray-700 cursor-not-allowed opacity-50"} text-white rounded-lg transition-all flex items-center justify-center gap-3`,children:[r.jsx(Cu,{size:24}),r.jsx("span",{className:"font-game text-lg",children:"在线对战"}),!R&&r.jsx("span",{className:"text-xs",children:"(未连接)"})]}),r.jsx("button",{onClick:q,disabled:!R,className:`w-full p-4 ${R?"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800":"bg-gray-700 cursor-not-allowed opacity-50"} text-white rounded-lg transition-all flex items-center justify-center gap-3`,children:r.jsx("span",{className:"font-game text-lg",children:"加入房间"})})]}),l==="online"&&v&&r.jsxs("div",{className:"mb-4 p-3 bg-gray-800 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-gray-400 font-game",children:"房间号:"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-white font-game font-bold text-lg",children:v}),r.jsx("button",{onClick:Y,className:"p-1 hover:bg-gray-700 rounded transition-colors",children:I?r.jsx(ro,{size:16,className:"text-green-400"}):r.jsx(ru,{size:16,className:"text-gray-400"})})]})]}),E&&r.jsx("div",{className:"mt-2 text-yellow-400 text-sm font-game animate-pulse",children:"等待对手加入..."})]}),l&&r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-800 p-4 rounded-lg",children:t.map((O,W)=>O.map((U,Q)=>{const ee=x.some(([re,he])=>re===W&&he===Q);return r.jsx($.button,{whileHover:{scale:U?1:1.05},whileTap:{scale:.95},onClick:()=>p(W,Q),disabled:!!U||d!=="playing"||l==="online"&&n!==o,className:`
                          h-24 sm:h-28 bg-gray-900 rounded-lg border-2 transition-all
                          ${U?"border-gray-600":"border-gray-700 hover:border-gray-500"}
                          ${ee?"bg-green-900/30 border-green-500":""}
                          ${!U&&d==="playing"&&(l==="single"||n===o)?"cursor-pointer":"cursor-not-allowed"}
                          flex items-center justify-center
                        `,children:r.jsx(pe,{children:U&&r.jsx($.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},className:`text-5xl sm:text-6xl font-bold ${U==="X"?"text-blue-400":"text-red-400"}`,children:U==="X"?r.jsx(Ps,{size:48}):r.jsx(Ts,{size:48})})})},`${W}-${Q}`)}))}),d==="playing"&&!f&&r.jsxs("div",{className:"mt-4 text-center",children:[r.jsx("span",{className:"text-gray-400 font-game",children:"当前回合: "}),r.jsx("span",{className:`font-game font-bold text-lg ${n==="X"?"text-blue-400":"text-red-400"}`,children:l==="single"?n==="X"?"你":"电脑":l==="online"&&n===o?"你":n})]}),d==="finished"&&f&&r.jsx($.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsxs("div",{className:"text-center p-6",children:[f==="draw"?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-yellow-400 mb-4",children:"平局!"}),r.jsx("p",{className:"text-white font-game mb-4",children:"势均力敌"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:l==="single"?f==="X"?"你赢了!":"电脑赢了!":f===o?"你赢了!":"对手赢了!"}),r.jsx("div",{className:`text-5xl mb-4 ${f==="X"?"text-blue-400":"text-red-400"}`,children:f==="X"?r.jsx(Ps,{size:60}):r.jsx(Ts,{size:60})})]}),r.jsx("button",{onClick:l==="online"?()=>h(v):X,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"再来一局"})]})})]}),S&&r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 max-w-sm",children:[r.jsx("h3",{className:"text-xl font-game text-white mb-4",children:"对手请求重新开始"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{D(v),L(!1)},className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"同意"}),r.jsx("button",{onClick:()=>{F(v),L(!1)},className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"拒绝"})]})]})})]})]})})},Du=["🎮","🎯","🎲","🎨","🎪","🎭","🎰","🎸","🏀","⚽","🏈","🎾","🎱","🏆","🎪","🎨"],Lu=()=>{const e=Ye(),[t,s]=g.useState([]),[n,i]=g.useState([]),[o,a]=g.useState(0),[l,c]=g.useState(0),[d,u]=g.useState(!1),[f,m]=g.useState(!1),[x,k]=g.useState("medium"),[v,P]=g.useState(0),[V,T]=g.useState(0),[S,L]=g.useState(()=>{const N=localStorage.getItem("memory-best-scores");return N?JSON.parse(N):{easy:{moves:1/0,time:1/0},medium:{moves:1/0,time:1/0},hard:{moves:1/0,time:1/0}}}),E=N=>{switch(N){case"easy":return 8;case"medium":return 12;case"hard":return 16;default:return 12}},M=g.useCallback(()=>{const N=E(x),h=Du.slice(0,N/2),D=[];h.forEach((F,G)=>{D.push({id:G*2,emoji:F,isFlipped:!1,isMatched:!1},{id:G*2+1,emoji:F,isFlipped:!1,isMatched:!1})});for(let F=D.length-1;F>0;F--){const G=Math.floor(Math.random()*(F+1));[D[F],D[G]]=[D[G],D[F]]}s(D),i([]),a(0),c(0),m(!1),u(!1),T(0)},[x]),I=N=>{d||(u(!0),P(Date.now()));const h=t.find(G=>G.id===N);if(!h||h.isFlipped||h.isMatched||n.length>=2)return;const D=t.map(G=>G.id===N?{...G,isFlipped:!0}:G);s(D);const F=[...n,N];i(F),F.length===2&&(a(o+1),A(F))},A=N=>{const[h,D]=N,F=t.find(H=>H.id===h),G=t.find(H=>H.id===D);F&&G&&F.emoji===G.emoji?setTimeout(()=>{s(y=>y.map(p=>p.id===h||p.id===D?{...p,isMatched:!0}:p)),c(l+1),i([]);const H=E(x);l+1===H/2&&w()},500):setTimeout(()=>{s(H=>H.map(y=>y.id===h||y.id===D?{...y,isFlipped:!1}:y)),i([])},1e3)},w=()=>{const N=Date.now(),h=Math.floor((N-v)/1e3);T(h),m(!0);const D=S[x];if(o<D.moves||h<D.time){const F={...S,[x]:{moves:Math.min(o,D.moves),time:Math.min(h,D.time)}};L(F),localStorage.setItem("memory-best-scores",JSON.stringify(F))}},C=()=>{M()},R=N=>{k(N),u(!1),m(!1)};g.useEffect(()=>{let N;return d&&!f&&(N=setInterval(()=>{T(Math.floor((Date.now()-v)/1e3))},1e3)),()=>clearInterval(N)},[d,f,v]),g.useEffect(()=>{M()},[M]);const b=N=>{const h=Math.floor(N/60),D=N%60;return`${h}:${D.toString().padStart(2,"0")}`},j=()=>{switch(x){case"easy":return"grid-cols-4";case"medium":return"grid-cols-4";case"hard":return"grid-cols-4";default:return"grid-cols-4"}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Qe,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"记忆翻牌"}),r.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(et,{size:16}),r.jsx("span",{className:"font-game",children:"重新开始"})]})]}),r.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["easy","medium","hard"].map(N=>r.jsx("button",{onClick:()=>R(N),className:`px-4 py-2 rounded-lg font-game transition-all ${x===N?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,children:N==="easy"?"简单":N==="medium"?"中等":"困难"},N))}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(bu,{size:14}),"步数"]}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:o})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(ju,{size:14}),"时间"]}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:b(V)})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"匹配"}),r.jsxs("div",{className:"text-2xl font-bold text-green-400 font-game",children:[l,"/",E(x)/2]})]})]}),S[x].moves!==1/0&&r.jsxs("div",{className:"mt-4 p-3 bg-gray-700/30 rounded-lg flex justify-center gap-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-gray-400 text-xs font-game",children:"最少步数"}),r.jsx("div",{className:"text-yellow-400 font-game font-bold",children:S[x].moves})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-gray-400 text-xs font-game flex items-center gap-1",children:[r.jsx(At,{size:12}),"最快时间"]}),r.jsx("div",{className:"text-yellow-400 font-game font-bold",children:b(S[x].time)})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsx("div",{className:`grid ${j()} gap-3 max-w-2xl mx-auto`,children:t.map(N=>r.jsx($.div,{whileHover:{scale:N.isFlipped||N.isMatched?1:1.05},whileTap:{scale:.95},className:"aspect-square",children:r.jsxs("button",{onClick:()=>I(N.id),disabled:N.isFlipped||N.isMatched,className:"w-full h-full relative preserve-3d",style:{transformStyle:"preserve-3d",transform:N.isFlipped||N.isMatched?"rotateY(180deg)":"rotateY(0deg)",transition:"transform 0.6s"},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600 to-purple-800 rounded-lg border-2 border-purple-500 flex items-center justify-center backface-hidden",style:{backfaceVisibility:"hidden"},children:r.jsx("span",{className:"text-3xl sm:text-4xl",children:"❓"})}),r.jsx("div",{className:`absolute inset-0 ${N.isMatched?"bg-gradient-to-br from-green-600 to-green-800 border-green-500":"bg-gradient-to-br from-blue-600 to-blue-800 border-blue-500"} rounded-lg border-2 flex items-center justify-center`,style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:r.jsx($.span,{className:"text-4xl sm:text-5xl",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:N.emoji})})]})},N.id))}),r.jsx(pe,{children:f&&r.jsx($.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs($.div,{initial:{y:50},animate:{y:0},className:"bg-gray-800 p-8 rounded-xl border border-gray-700 text-center max-w-md",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:"🎉 完成!"}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("p",{className:"text-white font-game",children:["用时: ",r.jsx("span",{className:"text-yellow-400",children:b(V)})]}),r.jsxs("p",{className:"text-white font-game",children:["步数: ",r.jsx("span",{className:"text-yellow-400",children:o})]}),o<=S[x].moves&&r.jsx("p",{className:"text-green-400 font-game",children:"🏆 新记录!"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:C,className:"flex-1 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-game rounded-lg transition-colors",children:"返回主页"})]})]})})})]})]})})},kr=e=>{const t=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]],s=e==="easy"?30:e==="medium"?40:50,n=t.map(o=>o.map(a=>({value:a,isFixed:!0,isError:!1,notes:[]})));let i=0;for(;i<s;){const o=Math.floor(Math.random()*9),a=Math.floor(Math.random()*9);n[o][a].value!==null&&(n[o][a]={value:null,isFixed:!1,isError:!1,notes:[]},i++)}return n},Iu=()=>{const e=Ye(),[t,s]=g.useState(()=>kr("easy")),[n,i]=g.useState(null),[o,a]=g.useState("easy"),[l,c]=g.useState(0),[d,u]=g.useState(3),[f,m]=g.useState(!1),[x,k]=g.useState(!1),[v]=g.useState(Date.now()),[P,V]=g.useState(0),T=(w,C,R,b)=>{for(let h=0;h<9;h++)if(h!==R&&w[C][h].value===b)return!1;for(let h=0;h<9;h++)if(h!==C&&w[h][R].value===b)return!1;const j=Math.floor(C/3)*3,N=Math.floor(R/3)*3;for(let h=0;h<3;h++)for(let D=0;D<3;D++)if((j+h!==C||N+D!==R)&&w[j+h][N+D].value===b)return!1;return!0},S=w=>{if(!n||t[n.row][n.col].isFixed)return;const C=t.map(b=>b.map(j=>({...j}))),R=C[n.row][n.col];if(f)R.notes.includes(w)?R.notes=R.notes.filter(b=>b!==w):R.notes.push(w),R.value=null;else{const b=T(C,n.row,n.col,w);R.value=w,R.notes=[],R.isError=!b,b||c(l+1)}s(C),M(C)},L=()=>{if(!n||t[n.row][n.col].isFixed)return;const w=t.map(C=>C.map(R=>({...R})));w[n.row][n.col]={value:null,isFixed:!1,isError:!1,notes:[]},s(w)},E=()=>{if(d<=0||!n||t[n.row][n.col].isFixed)return;const w=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]],C=t.map(R=>R.map(b=>({...b})));C[n.row][n.col]={value:w[n.row][n.col],isFixed:!1,isError:!1,notes:[]},s(C),u(d-1),M(C)},M=w=>{w.every((R,b)=>R.every((j,N)=>j.value!==null&&!j.isError&&T(w,b,N,j.value)))&&k(!0)},I=w=>{s(kr(w||o)),i(null),c(0),u(3),m(!1),k(!1),w&&a(w)};g.useEffect(()=>{const w=setInterval(()=>{V(Math.floor((Date.now()-v)/1e3))},1e3);return()=>clearInterval(w)},[v]),g.useEffect(()=>{const w=C=>{C.key>="1"&&C.key<="9"?S(parseInt(C.key)):C.key==="Delete"||C.key==="Backspace"?L():(C.key==="n"||C.key==="N")&&m(!f)};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[n,f]);const A=w=>{const C=Math.floor(w/60),R=w%60;return`${C}:${R.toString().padStart(2,"0")}`};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Qe,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"数独"}),r.jsxs("button",{onClick:()=>I(),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(et,{size:16}),r.jsx("span",{className:"font-game",children:"新游戏"})]})]}),r.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["easy","medium","hard"].map(w=>r.jsx("button",{onClick:()=>I(w),className:`px-4 py-2 rounded-lg font-game transition-all ${o===w?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,children:w==="easy"?"简单":w==="medium"?"中等":"困难"},w))}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"时间"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:A(P)})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(eu,{size:14}),"错误"]}),r.jsx("div",{className:"text-xl font-bold text-red-400 font-game",children:l})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Cr,{size:14}),"提示"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:d})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-center justify-center",children:[r.jsx("div",{className:"bg-gray-800 p-2 rounded-lg",children:r.jsx("div",{className:"grid grid-cols-9 gap-0",children:t.map((w,C)=>w.map((R,b)=>r.jsx("button",{onClick:()=>i({row:C,col:b}),className:`
                        w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center relative
                        ${R.isFixed?"bg-gray-700":"bg-gray-900 hover:bg-gray-800"}
                        ${(n==null?void 0:n.row)===C&&(n==null?void 0:n.col)===b?"bg-blue-900":""}
                        ${R.isError?"bg-red-900/50":""}
                        ${b%3===2&&b<8?"border-r-2 border-gray-600":"border-r border-gray-700"}
                        ${C%3===2&&C<8?"border-b-2 border-gray-600":"border-b border-gray-700"}
                        transition-colors
                      `,disabled:x,children:R.value?r.jsx("span",{className:`
                          text-lg sm:text-xl font-bold
                          ${R.isFixed?"text-gray-400":R.isError?"text-red-400":"text-white"}
                        `,children:R.value}):r.jsx("div",{className:"grid grid-cols-3 gap-0 text-xs text-blue-400",children:[1,2,3,4,5,6,7,8,9].map(j=>r.jsx("span",{className:"text-[8px]",children:R.notes.includes(j)?j:""},j))})},`${C}-${b}`)))})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9].map(w=>r.jsx("button",{onClick:()=>S(w),className:"w-14 h-14 bg-gray-700 hover:bg-gray-600 text-white text-xl font-bold rounded-lg transition-colors",disabled:x,children:w},w))}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("button",{onClick:()=>m(!f),className:`w-full p-3 ${f?"bg-blue-600 hover:bg-blue-700":"bg-gray-700 hover:bg-gray-600"} text-white rounded-lg transition-colors flex items-center justify-center gap-2`,disabled:x,children:[r.jsx("span",{className:"font-game",children:"笔记模式"}),f&&r.jsx(ro,{size:16})]}),r.jsxs("button",{onClick:L,className:"w-full p-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center justify-center gap-2",disabled:x,children:[r.jsx(ou,{size:16}),r.jsx("span",{className:"font-game",children:"清除"})]}),r.jsxs("button",{onClick:E,className:"w-full p-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors flex items-center justify-center gap-2",disabled:x||d<=0,children:[r.jsx(Cr,{size:16}),r.jsxs("span",{className:"font-game",children:["提示 (",d,")"]})]})]})]})]}),x&&r.jsx($.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-gray-800 p-8 rounded-xl border border-gray-700 text-center",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:"🎉 完成!"}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("p",{className:"text-white font-game",children:["用时: ",r.jsx("span",{className:"text-yellow-400",children:A(P)})]}),r.jsxs("p",{className:"text-white font-game",children:["错误: ",r.jsx("span",{className:"text-yellow-400",children:l})]})]}),r.jsx("button",{onClick:()=>I(),className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"新游戏"})]})})]})]})})},ve=600,Pe=400,Ce=100,rt=10,Ht=8,Mr=75,Rr=20,Ar=10,Fu=60,Bu=35,Ou=5,zu=6,ks=[{color:"#ef4444",points:50,hits:3},{color:"#f97316",points:40,hits:2},{color:"#eab308",points:30,hits:2},{color:"#22c55e",points:20,hits:1},{color:"#06b6d4",points:10,hits:1}],$u=()=>{const e=Ye(),t=g.useRef(null),s=g.useRef(),[n,i]=g.useState(!1),[o,a]=g.useState(!1),[l,c]=g.useState(0),[d,u]=g.useState(3),[f,m]=g.useState(1),[x,k]=g.useState(()=>{const b=localStorage.getItem("breakout-high-score");return b?parseInt(b):0}),[v,P]=g.useState({x:ve/2,y:Pe-30,dx:3,dy:-3,radius:Ht}),[V,T]=g.useState({x:(ve-Ce)/2,y:Pe-rt-10,width:Ce,height:rt}),[S,L]=g.useState([]),E=g.useCallback(()=>{const b=[];for(let j=0;j<Ou;j++)for(let N=0;N<zu;N++){const h=ks[Math.min(j,ks.length-1)];b.push({x:N*(Mr+Ar)+Bu,y:j*(Rr+Ar)+Fu,width:Mr,height:Rr,color:h.color,points:h.points,hits:h.hits,destroyed:!1})}L(b)},[]),M=()=>{P({x:ve/2,y:Pe-30,dx:3+f*.5,dy:-(3+f*.5),radius:Ht}),T({x:(ve-Ce)/2,y:Pe-rt-10,width:Ce,height:rt}),E(),c(0),u(3),m(1),a(!1),i(!1)},I=()=>{P({x:ve/2,y:Pe-30,dx:3+f*.5,dy:-(3+f*.5),radius:Ht}),T({x:(ve-Ce)/2,y:Pe-rt-10,width:Ce,height:rt})},A=()=>{m(b=>b+1),P({x:ve/2,y:Pe-30,dx:3+(f+1)*.5,dy:-(3+(f+1)*.5),radius:Ht}),E()},w=g.useCallback(()=>{if((v.x+v.radius>ve||v.x-v.radius<0)&&(v.dx=-v.dx),v.y-v.radius<0&&(v.dy=-v.dy),v.y+v.radius>Pe&&u(j=>{const N=j-1;return N<=0?(a(!0),i(!1),l>x&&(k(l),localStorage.setItem("breakout-high-score",l.toString()))):I(),N}),v.x>V.x&&v.x<V.x+V.width&&v.y+v.radius>V.y&&v.y-v.radius<V.y+V.height){const j=(v.x-V.x)/V.width;v.dx=8*(j-.5),v.dy=-v.dy}let b=!0;S.forEach(j=>{if(!j.destroyed&&(b=!1,v.x>j.x&&v.x<j.x+j.width&&v.y>j.y&&v.y<j.y+j.height))if(v.dy=-v.dy,j.hits--,j.hits<=0)j.destroyed=!0,c(N=>N+j.points);else{const N=j.hits/ks.find(h=>h.color===j.color).hits;j.color=j.color+Math.floor(N*255).toString(16).padStart(2,"0")}}),b&&A()},[v,V,S,l,x]),C=g.useCallback(()=>{if(!n||o)return;const b=t.current;if(!b)return;const j=b.getContext("2d");if(!j)return;j.clearRect(0,0,ve,Pe),S.forEach(h=>{h.destroyed||(j.fillStyle=h.color,j.fillRect(h.x,h.y,h.width,h.height),j.strokeStyle="#1f2937",j.strokeRect(h.x,h.y,h.width,h.height))});const N=j.createLinearGradient(V.x,V.y,V.x,V.y+V.height);N.addColorStop(0,"#8b5cf6"),N.addColorStop(1,"#7c3aed"),j.fillStyle=N,j.fillRect(V.x,V.y,V.width,V.height),j.beginPath(),j.arc(v.x,v.y,v.radius,0,Math.PI*2),j.fillStyle="#ffffff",j.fill(),j.closePath(),v.x+=v.dx,v.y+=v.dy,w(),s.current=requestAnimationFrame(C)},[n,o,v,V,S,w]);g.useEffect(()=>{const b=j=>{if(!t.current||!n)return;const N=t.current.getBoundingClientRect(),h=j.clientX-N.left;T(D=>({...D,x:Math.max(0,Math.min(ve-Ce,h-Ce/2))}))};return window.addEventListener("mousemove",b),()=>window.removeEventListener("mousemove",b)},[n]);const R=b=>{if(!t.current||!n)return;const j=t.current.getBoundingClientRect(),N=b.touches[0].clientX-j.left;T(h=>({...h,x:Math.max(0,Math.min(ve-Ce,N-Ce/2))}))};return g.useEffect(()=>{const b=j=>{if(!n){j.key===" "&&(j.preventDefault(),i(!0));return}switch(j.key){case"ArrowLeft":case"a":case"A":T(N=>({...N,x:Math.max(0,N.x-20)}));break;case"ArrowRight":case"d":case"D":T(N=>({...N,x:Math.min(ve-Ce,N.x+20)}));break;case" ":case"p":case"P":j.preventDefault(),i(N=>!N);break}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[n]),g.useEffect(()=>(n&&!o&&(s.current=requestAnimationFrame(C)),()=>{s.current&&cancelAnimationFrame(s.current)}),[n,o,C]),g.useEffect(()=>{E()},[E]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Qe,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"打砖块"}),r.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(et,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"分数"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:l})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(lu,{size:14}),"生命"]}),r.jsx("div",{className:"text-xl font-bold text-red-400 font-game",children:d})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"关卡"}),r.jsx("div",{className:"text-xl font-bold text-green-400 font-game",children:f})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(At,{size:14}),"最高分"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:x})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsxs("div",{className:"relative flex justify-center",children:[r.jsx("canvas",{ref:t,width:ve,height:Pe,className:"bg-gray-800 rounded-lg border-2 border-gray-700",onTouchMove:R,style:{maxWidth:"100%",height:"auto"}}),(!n||o)&&r.jsx($.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-center p-6",children:o?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-2",children:["得分: ",l]}),l>x&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新记录!"}),r.jsx("button",{onClick:M,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:l===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:()=>i(!0),className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(es,{size:20}),l===0?"开始游戏":"继续"]}),r.jsxs("div",{className:"mt-4 text-gray-400 text-sm font-game",children:[r.jsx("p",{children:"使用鼠标或触摸控制挡板"}),r.jsx("p",{children:"← → 或 A/D 键盘控制"}),r.jsx("p",{children:"空格键暂停/继续"})]})]})})})]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("button",{onClick:()=>i(b=>!b),className:`px-6 py-3 ${n?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center gap-2`,children:n?r.jsxs(r.Fragment,{children:[r.jsx(io,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(es,{size:20}),l===0?"开始":"继续"]})})})]})]})})},Uu=()=>{const e=co(),[t,s]=g.useState(new Date);g.useEffect(()=>{const i=setInterval(()=>s(new Date),1e3);return()=>clearInterval(i)},[]);const n=e.pathname==="/";return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900",children:[r.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none -z-10",children:[...Array(window.innerWidth<768?20:50)].map((i,o)=>r.jsx($.div,{className:"absolute w-1 h-1 bg-white opacity-30",initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{y:[null,-window.innerHeight]},transition:{duration:Math.random()*20+10,repeat:1/0,ease:"linear",delay:Math.random()*10}},o))}),r.jsx("header",{className:"relative z-1",children:r.jsx("nav",{className:"container mx-auto px-3 sm:px-4 py-2 sm:py-3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(Ms,{to:"/",className:"flex items-center space-x-2 sm:space-x-3",children:[r.jsx($.div,{whileHover:{rotate:360},whileTap:{scale:.95},transition:{duration:.5},className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-white font-bold text-lg sm:text-xl",children:"G"})}),r.jsxs("h1",{className:"text-base sm:text-xl font-game font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:[r.jsx("span",{className:"hidden sm:inline",children:"Game Collection"}),r.jsx("span",{className:"sm:hidden",children:"游戏合集"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-6",children:[!n&&r.jsx($.div,{whileTap:{scale:.95},transition:{duration:.1},children:r.jsxs(Ms,{to:"/",className:"pixel-btn text-xs px-2 py-1 sm:px-3 sm:py-2 flex items-center justify-center",children:[r.jsx("span",{className:"hidden sm:inline",children:"返回首页"}),r.jsx("span",{className:"sm:hidden",children:"首页"})]})}),r.jsx("div",{className:"text-xs sm:text-sm font-pixel text-gray-400 hidden sm:block",children:t.toLocaleTimeString("zh-CN")})]})]})})}),r.jsx("main",{className:"relative z-1 container mx-auto px-3 sm:px-4 py-1 sm:py-2",children:r.jsx($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:r.jsx(uo,{})},e.pathname)}),r.jsx("footer",{className:"relative z-1",children:r.jsx("div",{className:"container mx-auto px-3 sm:px-4 py-2 sm:py-3",children:r.jsx("div",{className:"text-center text-xs sm:text-sm text-gray-500 font-pixel",children:"© 2024 Game Collection"})})})]})};function Hu(){return r.jsx(ho,{children:r.jsx(pe,{mode:"wait",children:r.jsx(fo,{children:r.jsxs(Te,{path:"/",element:r.jsx(Uu,{}),children:[r.jsx(Te,{index:!0,element:r.jsx(Od,{})}),r.jsx(Te,{path:"games/gomoku",element:r.jsx(Wd,{})}),r.jsx(Te,{path:"games/2048",element:r.jsx(Pu,{})}),r.jsx(Te,{path:"games/snake",element:r.jsx(Mu,{})}),r.jsx(Te,{path:"games/popstar",element:r.jsx(Au,{})}),r.jsx(Te,{path:"games/tictactoe",element:r.jsx(Eu,{})}),r.jsx(Te,{path:"games/memory",element:r.jsx(Lu,{})}),r.jsx(Te,{path:"games/sudoku",element:r.jsx(Iu,{})}),r.jsx(Te,{path:"games/breakout",element:r.jsx($u,{})})]})})})})}Rs.createRoot(document.getElementById("root")).render(r.jsx(_s.StrictMode,{children:r.jsx(Hu,{})}))});export default Gu();
//# sourceMappingURL=index-CDmqaKla.js.map

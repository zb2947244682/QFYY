var hi=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);import{r as g,a as fi,R as Ks,L as Ds,u as Ke,b as mi,O as pi,B as gi,c as xi,d as Te}from"./react-vendor-RGTUMA6Z.js";import{l as Ys,c as yi}from"./game-vendor-B_MNHd1B.js";var Ju=hi((nh,Vt)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();var Lr={exports:{}},rs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vi=g,bi=Symbol.for("react.element"),wi=Symbol.for("react.fragment"),ji=Object.prototype.hasOwnProperty,Ni=vi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Si={key:!0,ref:!0,__self:!0,__source:!0};function Ir(e,t,s){var n,o={},i=null,a=null;s!==void 0&&(i=""+s),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)ji.call(t,n)&&!Si.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:bi,type:e,key:i,ref:a,props:o,_owner:Ni.current}}rs.Fragment=wi;rs.jsx=Ir;rs.jsxs=Ir;Lr.exports=rs;var r=Lr.exports,Es={},bn=fi;Es.createRoot=bn.createRoot,Es.hydrateRoot=bn.hydrateRoot;const Fr=g.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),os=g.createContext({}),is=g.createContext(null),as=typeof document<"u",Zs=as?g.useLayoutEffect:g.useEffect,Br=g.createContext({strict:!1}),Js=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Ci="framerAppearId",Or="data-"+Js(Ci);function Ti(e,t,s,n){const{visualElement:o}=g.useContext(os),i=g.useContext(Br),a=g.useContext(is),l=g.useContext(Fr).reducedMotion,c=g.useRef();n=n||i.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:o,props:s,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;g.useInsertionEffect(()=>{d&&d.update(s,a)});const u=g.useRef(!!(s[Or]&&!window.HandoffComplete));return Zs(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),g.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function it(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function ki(e,t,s){return g.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),s&&(typeof s=="function"?s(n):it(s)&&(s.current=n))},[t])}function Ct(e){return typeof e=="string"||Array.isArray(e)}function ls(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Qs=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],en=["initial",...Qs];function cs(e){return ls(e.animate)||en.some(t=>Ct(e[t]))}function zr(e){return!!(cs(e)||e.variants)}function Pi(e,t){if(cs(e)){const{initial:s,animate:n}=e;return{initial:s===!1||Ct(s)?s:void 0,animate:Ct(n)?n:void 0}}return e.inherit!==!1?t:{}}function Mi(e){const{initial:t,animate:s}=Pi(e,g.useContext(os));return g.useMemo(()=>({initial:t,animate:s}),[wn(t),wn(s)])}function wn(e){return Array.isArray(e)?e.join(" "):e}const jn={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Tt={};for(const e in jn)Tt[e]={isEnabled:t=>jn[e].some(s=>!!t[s])};function Ai(e){for(const t in e)Tt[t]={...Tt[t],...e[t]}}const tn=g.createContext({}),$r=g.createContext({}),Ri=Symbol.for("motionComponentSymbol");function Vi({preloadedFeatures:e,createVisualElement:t,useRender:s,useVisualState:n,Component:o}){e&&Ai(e);function i(l,c){let d;const u={...g.useContext(Fr),...l,layoutId:Di(l)},{isStatic:h}=u,p=Mi(l),x=n(l,h);if(!h&&as){p.visualElement=Ti(o,x,u,t);const S=g.useContext($r),b=g.useContext(Br).strict;p.visualElement&&(d=p.visualElement.loadFeatures(u,b,e,S))}return g.createElement(os.Provider,{value:p},d&&p.visualElement?g.createElement(d,{visualElement:p.visualElement,...u}):null,s(o,l,ki(x,p.visualElement,c),x,h,p.visualElement))}const a=g.forwardRef(i);return a[Ri]=o,a}function Di({layoutId:e}){const t=g.useContext(tn).id;return t&&e!==void 0?t+"-"+e:e}function Ei(e){function t(n,o={}){return Vi(e(n,o))}if(typeof Proxy>"u")return t;const s=new Map;return new Proxy(t,{get:(n,o)=>(s.has(o)||s.set(o,t(o)),s.get(o))})}const Li=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function sn(e){return typeof e!="string"||e.includes("-")?!1:!!(Li.indexOf(e)>-1||/[A-Z]/.test(e))}const Kt={};function Ii(e){Object.assign(Kt,e)}const Pt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ye=new Set(Pt);function Ur(e,{layout:t,layoutId:s}){return Ye.has(e)||e.startsWith("origin")||(t||s!==void 0)&&(!!Kt[e]||e==="opacity")}const pe=e=>!!(e&&e.getVelocity),Fi={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Bi=Pt.length;function Oi(e,{enableHardwareAcceleration:t=!0,allowTransformNone:s=!0},n,o){let i="";for(let a=0;a<Bi;a++){const l=Pt[a];if(e[l]!==void 0){const c=Fi[l]||l;i+=`${c}(${e[l]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),o?i=o(e,n?"":i):s&&n&&(i="none"),i}const Hr=e=>t=>typeof t=="string"&&t.startsWith(e),Gr=Hr("--"),Ls=Hr("var(--"),zi=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,$i=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Fe=(e,t,s)=>Math.min(Math.max(s,e),t),Ze={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},wt={...Ze,transform:e=>Fe(0,1,e)},Ft={...Ze,default:1},jt=e=>Math.round(e*1e5)/1e5,ds=/(-)?([\d]*\.?[\d])+/g,_r=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Ui=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Mt(e){return typeof e=="string"}const At=e=>({test:t=>Mt(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ee=At("deg"),Pe=At("%"),J=At("px"),Hi=At("vh"),Gi=At("vw"),Nn={...Pe,parse:e=>Pe.parse(e)/100,transform:e=>Pe.transform(e*100)},Sn={...Ze,transform:Math.round},Wr={borderWidth:J,borderTopWidth:J,borderRightWidth:J,borderBottomWidth:J,borderLeftWidth:J,borderRadius:J,radius:J,borderTopLeftRadius:J,borderTopRightRadius:J,borderBottomRightRadius:J,borderBottomLeftRadius:J,width:J,maxWidth:J,height:J,maxHeight:J,size:J,top:J,right:J,bottom:J,left:J,padding:J,paddingTop:J,paddingRight:J,paddingBottom:J,paddingLeft:J,margin:J,marginTop:J,marginRight:J,marginBottom:J,marginLeft:J,rotate:Ee,rotateX:Ee,rotateY:Ee,rotateZ:Ee,scale:Ft,scaleX:Ft,scaleY:Ft,scaleZ:Ft,skew:Ee,skewX:Ee,skewY:Ee,distance:J,translateX:J,translateY:J,translateZ:J,x:J,y:J,z:J,perspective:J,transformPerspective:J,opacity:wt,originX:Nn,originY:Nn,originZ:J,zIndex:Sn,fillOpacity:wt,strokeOpacity:wt,numOctaves:Sn};function nn(e,t,s,n){const{style:o,vars:i,transform:a,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const h in t){const p=t[h];if(Gr(h)){i[h]=p;continue}const x=Wr[h],S=$i(p,x);if(Ye.has(h)){if(c=!0,a[h]=S,!u)continue;p!==(x.default||0)&&(u=!1)}else h.startsWith("origin")?(d=!0,l[h]=S):o[h]=S}if(t.transform||(c||n?o.transform=Oi(e.transform,s,u,n):o.transform&&(o.transform="none")),d){const{originX:h="50%",originY:p="50%",originZ:x=0}=l;o.transformOrigin=`${h} ${p} ${x}`}}const rn=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function qr(e,t,s){for(const n in t)!pe(t[n])&&!Ur(n,s)&&(e[n]=t[n])}function _i({transformTemplate:e},t,s){return g.useMemo(()=>{const n=rn();return nn(n,t,{enableHardwareAcceleration:!s},e),Object.assign({},n.vars,n.style)},[t])}function Wi(e,t,s){const n=e.style||{},o={};return qr(o,n,e),Object.assign(o,_i(e,t,s)),e.transformValues?e.transformValues(o):o}function qi(e,t,s){const n={},o=Wi(e,t,s);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=o,n}const Xi=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Yt(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Xi.has(e)}let Xr=e=>!Yt(e);function Ki(e){e&&(Xr=t=>t.startsWith("on")?!Yt(t):e(t))}try{Ki(require("@emotion/is-prop-valid").default)}catch{}function Yi(e,t,s){const n={};for(const o in e)o==="values"&&typeof e.values=="object"||(Xr(o)||s===!0&&Yt(o)||!t&&!Yt(o)||e.draggable&&o.startsWith("onDrag"))&&(n[o]=e[o]);return n}function Cn(e,t,s){return typeof e=="string"?e:J.transform(t+s*e)}function Zi(e,t,s){const n=Cn(t,e.x,e.width),o=Cn(s,e.y,e.height);return`${n} ${o}`}const Ji={offset:"stroke-dashoffset",array:"stroke-dasharray"},Qi={offset:"strokeDashoffset",array:"strokeDasharray"};function ea(e,t,s=1,n=0,o=!0){e.pathLength=1;const i=o?Ji:Qi;e[i.offset]=J.transform(-n);const a=J.transform(t),l=J.transform(s);e[i.array]=`${a} ${l}`}function on(e,{attrX:t,attrY:s,attrScale:n,originX:o,originY:i,pathLength:a,pathSpacing:l=1,pathOffset:c=0,...d},u,h,p){if(nn(e,d,u,p),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:x,style:S,dimensions:b}=e;x.transform&&(b&&(S.transform=x.transform),delete x.transform),b&&(o!==void 0||i!==void 0||S.transform)&&(S.transformOrigin=Zi(b,o!==void 0?o:.5,i!==void 0?i:.5)),t!==void 0&&(x.x=t),s!==void 0&&(x.y=s),n!==void 0&&(x.scale=n),a!==void 0&&ea(x,a,l,c,!1)}const Kr=()=>({...rn(),attrs:{}}),an=e=>typeof e=="string"&&e.toLowerCase()==="svg";function ta(e,t,s,n){const o=g.useMemo(()=>{const i=Kr();return on(i,t,{enableHardwareAcceleration:!1},an(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};qr(i,e.style,e),o.style={...i,...o.style}}return o}function sa(e=!1){return(s,n,o,{latestValues:i},a)=>{const c=(sn(s)?ta:qi)(n,i,a,s),u={...Yi(n,typeof s=="string",e),...c,ref:o},{children:h}=n,p=g.useMemo(()=>pe(h)?h.get():h,[h]);return g.createElement(s,{...u,children:p})}}function Yr(e,{style:t,vars:s},n,o){Object.assign(e.style,t,o&&o.getProjectionStyles(n));for(const i in s)e.style.setProperty(i,s[i])}const Zr=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Jr(e,t,s,n){Yr(e,t,void 0,n);for(const o in t.attrs)e.setAttribute(Zr.has(o)?o:Js(o),t.attrs[o])}function ln(e,t){const{style:s}=e,n={};for(const o in s)(pe(s[o])||t.style&&pe(t.style[o])||Ur(o,e))&&(n[o]=s[o]);return n}function Qr(e,t){const s=ln(e,t);for(const n in e)if(pe(e[n])||pe(t[n])){const o=Pt.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;s[o]=e[n]}return s}function cn(e,t,s,n={},o={}){return typeof t=="function"&&(t=t(s!==void 0?s:e.custom,n,o)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(s!==void 0?s:e.custom,n,o)),t}function eo(e){const t=g.useRef(null);return t.current===null&&(t.current=e()),t.current}const Zt=e=>Array.isArray(e),na=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),ra=e=>Zt(e)?e[e.length-1]||0:e;function qt(e){const t=pe(e)?e.get():e;return na(t)?t.toValue():t}function oa({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:s},n,o,i){const a={latestValues:ia(n,o,i,e),renderState:t()};return s&&(a.mount=l=>s(n,l,a)),a}const to=e=>(t,s)=>{const n=g.useContext(os),o=g.useContext(is),i=()=>oa(e,t,n,o);return s?i():eo(i)};function ia(e,t,s,n){const o={},i=n(e,{});for(const p in i)o[p]=qt(i[p]);let{initial:a,animate:l}=e;const c=cs(e),d=zr(e);t&&d&&!c&&e.inherit!==!1&&(a===void 0&&(a=t.initial),l===void 0&&(l=t.animate));let u=s?s.initial===!1:!1;u=u||a===!1;const h=u?l:a;return h&&typeof h!="boolean"&&!ls(h)&&(Array.isArray(h)?h:[h]).forEach(x=>{const S=cn(e,x);if(!S)return;const{transitionEnd:b,transition:w,...D}=S;for(const M in D){let C=D[M];if(Array.isArray(C)){const B=u?C.length-1:0;C=C[B]}C!==null&&(o[M]=C)}for(const M in b)o[M]=b[M]}),o}const le=e=>e;class Tn{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const s=this.order.indexOf(t);s!==-1&&(this.order.splice(s,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function aa(e){let t=new Tn,s=new Tn,n=0,o=!1,i=!1;const a=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const h=u&&o,p=h?t:s;return d&&a.add(c),p.add(c)&&h&&o&&(n=t.order.length),c},cancel:c=>{s.remove(c),a.delete(c)},process:c=>{if(o){i=!0;return}if(o=!0,[t,s]=[s,t],s.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),a.has(u)&&(l.schedule(u),e())}o=!1,i&&(i=!1,l.process(c))}};return l}const Bt=["prepare","read","update","preRender","render","postRender"],la=40;function ca(e,t){let s=!1,n=!0;const o={delta:0,timestamp:0,isProcessing:!1},i=Bt.reduce((h,p)=>(h[p]=aa(()=>s=!0),h),{}),a=h=>i[h].process(o),l=()=>{const h=performance.now();s=!1,o.delta=n?1e3/60:Math.max(Math.min(h-o.timestamp,la),1),o.timestamp=h,o.isProcessing=!0,Bt.forEach(a),o.isProcessing=!1,s&&t&&(n=!1,e(l))},c=()=>{s=!0,n=!0,o.isProcessing||e(l)};return{schedule:Bt.reduce((h,p)=>{const x=i[p];return h[p]=(S,b=!1,w=!1)=>(s||c(),x.schedule(S,b,w)),h},{}),cancel:h=>Bt.forEach(p=>i[p].cancel(h)),state:o,steps:i}}const{schedule:ne,cancel:De,state:ue,steps:ps}=ca(typeof requestAnimationFrame<"u"?requestAnimationFrame:le,!0),da={useVisualState:to({scrapeMotionValuesFromProps:Qr,createRenderState:Kr,onMount:(e,t,{renderState:s,latestValues:n})=>{ne.read(()=>{try{s.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}),ne.render(()=>{on(s,n,{enableHardwareAcceleration:!1},an(t.tagName),e.transformTemplate),Jr(t,s)})}})},ua={useVisualState:to({scrapeMotionValuesFromProps:ln,createRenderState:rn})};function ha(e,{forwardMotionProps:t=!1},s,n){return{...sn(e)?da:ua,preloadedFeatures:s,useRender:sa(t),createVisualElement:n,Component:e}}function Ae(e,t,s,n={passive:!0}){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s)}const so=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function us(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const fa=e=>t=>so(t)&&e(t,us(t));function Re(e,t,s,n){return Ae(e,t,fa(s),n)}const ma=(e,t)=>s=>t(e(s)),Ie=(...e)=>e.reduce(ma);function no(e){let t=null;return()=>{const s=()=>{t=null};return t===null?(t=e,s):!1}}const kn=no("dragHorizontal"),Pn=no("dragVertical");function ro(e){let t=!1;if(e==="y")t=Pn();else if(e==="x")t=kn();else{const s=kn(),n=Pn();s&&n?t=()=>{s(),n()}:(s&&s(),n&&n())}return t}function oo(){const e=ro(!0);return e?(e(),!1):!0}class Oe{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Mn(e,t){const s="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),o=(i,a)=>{if(i.pointerType==="touch"||oo())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&ne.update(()=>l[n](i,a))};return Re(e.current,s,o,{passive:!e.getProps()[n]})}class pa extends Oe{mount(){this.unmount=Ie(Mn(this.node,!0),Mn(this.node,!1))}unmount(){}}class ga extends Oe{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ie(Ae(this.node.current,"focus",()=>this.onFocus()),Ae(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const io=(e,t)=>t?e===t?!0:io(e,t.parentElement):!1;function gs(e,t){if(!t)return;const s=new PointerEvent("pointer"+e);t(s,us(s))}class xa extends Oe{constructor(){super(...arguments),this.removeStartListeners=le,this.removeEndListeners=le,this.removeAccessibleListeners=le,this.startPointerPress=(t,s)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Re(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:h}=this.node.getProps();ne.update(()=>{!h&&!io(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),a=Re(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Ie(i,a),this.startPress(t,s)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const a=l=>{l.key!=="Enter"||!this.checkPressEnd()||gs("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&ne.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=Ae(this.node.current,"keyup",a),gs("down",(l,c)=>{this.startPress(l,c)})},s=Ae(this.node.current,"keydown",t),n=()=>{this.isPressing&&gs("cancel",(i,a)=>this.cancelPress(i,a))},o=Ae(this.node.current,"blur",n);this.removeAccessibleListeners=Ie(s,o)}}startPress(t,s){this.isPressing=!0;const{onTapStart:n,whileTap:o}=this.node.getProps();o&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&ne.update(()=>n(t,s))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!oo()}cancelPress(t,s){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&ne.update(()=>n(t,s))}mount(){const t=this.node.getProps(),s=Re(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Ae(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Ie(s,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Is=new WeakMap,xs=new WeakMap,ya=e=>{const t=Is.get(e.target);t&&t(e)},va=e=>{e.forEach(ya)};function ba({root:e,...t}){const s=e||document;xs.has(s)||xs.set(s,{});const n=xs.get(s),o=JSON.stringify(t);return n[o]||(n[o]=new IntersectionObserver(va,{root:e,...t})),n[o]}function wa(e,t,s){const n=ba(t);return Is.set(e,s),n.observe(e),()=>{Is.delete(e),n.unobserve(e)}}const ja={some:0,all:1};class Na extends Oe{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:s,margin:n,amount:o="some",once:i}=t,a={root:s?s.current:void 0,rootMargin:n,threshold:typeof o=="number"?o:ja[o]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),p=d?u:h;p&&p(c)};return wa(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:s}=this.node;["amount","margin","root"].some(Sa(t,s))&&this.startObserver()}unmount(){}}function Sa({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}const Ca={inView:{Feature:Na},tap:{Feature:xa},focus:{Feature:ga},hover:{Feature:pa}};function ao(e,t){if(!Array.isArray(t))return!1;const s=t.length;if(s!==e.length)return!1;for(let n=0;n<s;n++)if(t[n]!==e[n])return!1;return!0}function Ta(e){const t={};return e.values.forEach((s,n)=>t[n]=s.get()),t}function ka(e){const t={};return e.values.forEach((s,n)=>t[n]=s.getVelocity()),t}function hs(e,t,s){const n=e.getProps();return cn(n,t,s!==void 0?s:n.custom,Ta(e),ka(e))}let dn=le;const Xe=e=>e*1e3,Ve=e=>e/1e3,Pa={current:!1},lo=e=>Array.isArray(e)&&typeof e[0]=="number";function co(e){return!!(!e||typeof e=="string"&&uo[e]||lo(e)||Array.isArray(e)&&e.every(co))}const vt=([e,t,s,n])=>`cubic-bezier(${e}, ${t}, ${s}, ${n})`,uo={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vt([0,.65,.55,1]),circOut:vt([.55,0,1,.45]),backIn:vt([.31,.01,.66,-.59]),backOut:vt([.33,1.53,.69,.99])};function ho(e){if(e)return lo(e)?vt(e):Array.isArray(e)?e.map(ho):uo[e]}function Ma(e,t,s,{delay:n=0,duration:o,repeat:i=0,repeatType:a="loop",ease:l,times:c}={}){const d={[t]:s};c&&(d.offset=c);const u=ho(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:o,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"})}function Aa(e,{repeat:t,repeatType:s="loop"}){const n=t&&s!=="loop"&&t%2===1?0:e.length-1;return e[n]}const fo=(e,t,s)=>(((1-3*s+3*t)*e+(3*s-6*t))*e+3*t)*e,Ra=1e-7,Va=12;function Da(e,t,s,n,o){let i,a,l=0;do a=t+(s-t)/2,i=fo(a,n,o)-e,i>0?s=a:t=a;while(Math.abs(i)>Ra&&++l<Va);return a}function Rt(e,t,s,n){if(e===t&&s===n)return le;const o=i=>Da(i,0,1,e,s);return i=>i===0||i===1?i:fo(o(i),t,n)}const Ea=Rt(.42,0,1,1),La=Rt(0,0,.58,1),mo=Rt(.42,0,.58,1),Ia=e=>Array.isArray(e)&&typeof e[0]!="number",po=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,go=e=>t=>1-e(1-t),un=e=>1-Math.sin(Math.acos(e)),xo=go(un),Fa=po(un),yo=Rt(.33,1.53,.69,.99),hn=go(yo),Ba=po(hn),Oa=e=>(e*=2)<1?.5*hn(e):.5*(2-Math.pow(2,-10*(e-1))),za={linear:le,easeIn:Ea,easeInOut:mo,easeOut:La,circIn:un,circInOut:Fa,circOut:xo,backIn:hn,backInOut:Ba,backOut:yo,anticipate:Oa},An=e=>{if(Array.isArray(e)){dn(e.length===4);const[t,s,n,o]=e;return Rt(t,s,n,o)}else if(typeof e=="string")return za[e];return e},fn=(e,t)=>s=>!!(Mt(s)&&Ui.test(s)&&s.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(s,t)),vo=(e,t,s)=>n=>{if(!Mt(n))return n;const[o,i,a,l]=n.match(ds);return{[e]:parseFloat(o),[t]:parseFloat(i),[s]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},$a=e=>Fe(0,255,e),ys={...Ze,transform:e=>Math.round($a(e))},qe={test:fn("rgb","red"),parse:vo("red","green","blue"),transform:({red:e,green:t,blue:s,alpha:n=1})=>"rgba("+ys.transform(e)+", "+ys.transform(t)+", "+ys.transform(s)+", "+jt(wt.transform(n))+")"};function Ua(e){let t="",s="",n="",o="";return e.length>5?(t=e.substring(1,3),s=e.substring(3,5),n=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),s=e.substring(2,3),n=e.substring(3,4),o=e.substring(4,5),t+=t,s+=s,n+=n,o+=o),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:o?parseInt(o,16)/255:1}}const Fs={test:fn("#"),parse:Ua,transform:qe.transform},at={test:fn("hsl","hue"),parse:vo("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:s,alpha:n=1})=>"hsla("+Math.round(e)+", "+Pe.transform(jt(t))+", "+Pe.transform(jt(s))+", "+jt(wt.transform(n))+")"},fe={test:e=>qe.test(e)||Fs.test(e)||at.test(e),parse:e=>qe.test(e)?qe.parse(e):at.test(e)?at.parse(e):Fs.parse(e),transform:e=>Mt(e)?e:e.hasOwnProperty("red")?qe.transform(e):at.transform(e)},oe=(e,t,s)=>-s*e+s*t+e;function vs(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(t-e)*6*s:s<1/2?t:s<2/3?e+(t-e)*(2/3-s)*6:e}function Ha({hue:e,saturation:t,lightness:s,alpha:n}){e/=360,t/=100,s/=100;let o=0,i=0,a=0;if(!t)o=i=a=s;else{const l=s<.5?s*(1+t):s+t-s*t,c=2*s-l;o=vs(c,l,e+1/3),i=vs(c,l,e),a=vs(c,l,e-1/3)}return{red:Math.round(o*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:n}}const bs=(e,t,s)=>{const n=e*e;return Math.sqrt(Math.max(0,s*(t*t-n)+n))},Ga=[Fs,qe,at],_a=e=>Ga.find(t=>t.test(e));function Rn(e){const t=_a(e);let s=t.parse(e);return t===at&&(s=Ha(s)),s}const bo=(e,t)=>{const s=Rn(e),n=Rn(t),o={...s};return i=>(o.red=bs(s.red,n.red,i),o.green=bs(s.green,n.green,i),o.blue=bs(s.blue,n.blue,i),o.alpha=oe(s.alpha,n.alpha,i),qe.transform(o))};function Wa(e){var t,s;return isNaN(e)&&Mt(e)&&(((t=e.match(ds))===null||t===void 0?void 0:t.length)||0)+(((s=e.match(_r))===null||s===void 0?void 0:s.length)||0)>0}const wo={regex:zi,countKey:"Vars",token:"${v}",parse:le},jo={regex:_r,countKey:"Colors",token:"${c}",parse:fe.parse},No={regex:ds,countKey:"Numbers",token:"${n}",parse:Ze.parse};function ws(e,{regex:t,countKey:s,token:n,parse:o}){const i=e.tokenised.match(t);i&&(e["num"+s]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(o)))}function Jt(e){const t=e.toString(),s={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return s.value.includes("var(--")&&ws(s,wo),ws(s,jo),ws(s,No),s}function So(e){return Jt(e).values}function Co(e){const{values:t,numColors:s,numVars:n,tokenised:o}=Jt(e),i=t.length;return a=>{let l=o;for(let c=0;c<i;c++)c<n?l=l.replace(wo.token,a[c]):c<n+s?l=l.replace(jo.token,fe.transform(a[c])):l=l.replace(No.token,jt(a[c]));return l}}const qa=e=>typeof e=="number"?0:e;function Xa(e){const t=So(e);return Co(e)(t.map(qa))}const Be={test:Wa,parse:So,createTransformer:Co,getAnimatableNone:Xa},To=(e,t)=>s=>`${s>0?t:e}`;function ko(e,t){return typeof e=="number"?s=>oe(e,t,s):fe.test(e)?bo(e,t):e.startsWith("var(")?To(e,t):Mo(e,t)}const Po=(e,t)=>{const s=[...e],n=s.length,o=e.map((i,a)=>ko(i,t[a]));return i=>{for(let a=0;a<n;a++)s[a]=o[a](i);return s}},Ka=(e,t)=>{const s={...e,...t},n={};for(const o in s)e[o]!==void 0&&t[o]!==void 0&&(n[o]=ko(e[o],t[o]));return o=>{for(const i in n)s[i]=n[i](o);return s}},Mo=(e,t)=>{const s=Be.createTransformer(t),n=Jt(e),o=Jt(t);return n.numVars===o.numVars&&n.numColors===o.numColors&&n.numNumbers>=o.numNumbers?Ie(Po(n.values,o.values),s):To(e,t)},kt=(e,t,s)=>{const n=t-e;return n===0?1:(s-e)/n},Vn=(e,t)=>s=>oe(e,t,s);function Ya(e){return typeof e=="number"?Vn:typeof e=="string"?fe.test(e)?bo:Mo:Array.isArray(e)?Po:typeof e=="object"?Ka:Vn}function Za(e,t,s){const n=[],o=s||Ya(e[0]),i=e.length-1;for(let a=0;a<i;a++){let l=o(e[a],e[a+1]);if(t){const c=Array.isArray(t)?t[a]||le:t;l=Ie(c,l)}n.push(l)}return n}function Ao(e,t,{clamp:s=!0,ease:n,mixer:o}={}){const i=e.length;if(dn(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=Za(t,n,o),l=a.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const h=kt(e[u],e[u+1],d);return a[u](h)};return s?d=>c(Fe(e[0],e[i-1],d)):c}function Ja(e,t){const s=e[e.length-1];for(let n=1;n<=t;n++){const o=kt(0,t,n);e.push(oe(s,1,o))}}function Qa(e){const t=[0];return Ja(t,e.length-1),t}function el(e,t){return e.map(s=>s*t)}function tl(e,t){return e.map(()=>t||mo).splice(0,e.length-1)}function Qt({duration:e=300,keyframes:t,times:s,ease:n="easeInOut"}){const o=Ia(n)?n.map(An):An(n),i={done:!1,value:t[0]},a=el(s&&s.length===t.length?s:Qa(t),e),l=Ao(a,t,{ease:Array.isArray(o)?o:tl(t,o)});return{calculatedDuration:e,next:c=>(i.value=l(c),i.done=c>=e,i)}}function Ro(e,t){return t?e*(1e3/t):0}const sl=5;function Vo(e,t,s){const n=Math.max(t-sl,0);return Ro(s-e(n),t-n)}const js=.001,nl=.01,rl=10,ol=.05,il=1;function al({duration:e=800,bounce:t=.25,velocity:s=0,mass:n=1}){let o,i,a=1-t;a=Fe(ol,il,a),e=Fe(nl,rl,Ve(e)),a<1?(o=d=>{const u=d*a,h=u*e,p=u-s,x=Bs(d,a),S=Math.exp(-h);return js-p/x*S},i=d=>{const h=d*a*e,p=h*s+s,x=Math.pow(a,2)*Math.pow(d,2)*e,S=Math.exp(-h),b=Bs(Math.pow(d,2),a);return(-o(d)+js>0?-1:1)*((p-x)*S)/b}):(o=d=>{const u=Math.exp(-d*e),h=(d-s)*e+1;return-js+u*h},i=d=>{const u=Math.exp(-d*e),h=(s-d)*(e*e);return u*h});const l=5/e,c=cl(o,i,l);if(e=Xe(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:a*2*Math.sqrt(n*d),duration:e}}}const ll=12;function cl(e,t,s){let n=s;for(let o=1;o<ll;o++)n=n-e(n)/t(n);return n}function Bs(e,t){return e*Math.sqrt(1-t*t)}const dl=["duration","bounce"],ul=["stiffness","damping","mass"];function Dn(e,t){return t.some(s=>e[s]!==void 0)}function hl(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!Dn(e,ul)&&Dn(e,dl)){const s=al(e);t={...t,...s,mass:1},t.isResolvedFromDuration=!0}return t}function Do({keyframes:e,restDelta:t,restSpeed:s,...n}){const o=e[0],i=e[e.length-1],a={done:!1,value:o},{stiffness:l,damping:c,mass:d,duration:u,velocity:h,isResolvedFromDuration:p}=hl({...n,velocity:-Ve(n.velocity||0)}),x=h||0,S=c/(2*Math.sqrt(l*d)),b=i-o,w=Ve(Math.sqrt(l/d)),D=Math.abs(b)<5;s||(s=D?.01:2),t||(t=D?.005:.5);let M;if(S<1){const C=Bs(w,S);M=B=>{const E=Math.exp(-S*w*B);return i-E*((x+S*w*b)/C*Math.sin(C*B)+b*Math.cos(C*B))}}else if(S===1)M=C=>i-Math.exp(-w*C)*(b+(x+w*b)*C);else{const C=w*Math.sqrt(S*S-1);M=B=>{const E=Math.exp(-S*w*B),P=Math.min(C*B,300);return i-E*((x+S*w*b)*Math.sinh(P)+C*b*Math.cosh(P))/C}}return{calculatedDuration:p&&u||null,next:C=>{const B=M(C);if(p)a.done=C>=u;else{let E=x;C!==0&&(S<1?E=Vo(M,C,B):E=0);const P=Math.abs(E)<=s,O=Math.abs(i-B)<=t;a.done=P&&O}return a.value=a.done?i:B,a}}}function En({keyframes:e,velocity:t=0,power:s=.8,timeConstant:n=325,bounceDamping:o=10,bounceStiffness:i=500,modifyTarget:a,min:l,max:c,restDelta:d=.5,restSpeed:u}){const h=e[0],p={done:!1,value:h},x=A=>l!==void 0&&A<l||c!==void 0&&A>c,S=A=>l===void 0?c:c===void 0||Math.abs(l-A)<Math.abs(c-A)?l:c;let b=s*t;const w=h+b,D=a===void 0?w:a(w);D!==w&&(b=D-h);const M=A=>-b*Math.exp(-A/n),C=A=>D+M(A),B=A=>{const v=M(A),T=C(A);p.done=Math.abs(v)<=d,p.value=p.done?D:T};let E,P;const O=A=>{x(p.value)&&(E=A,P=Do({keyframes:[p.value,S(p.value)],velocity:Vo(C,A,p.value),damping:o,stiffness:i,restDelta:d,restSpeed:u}))};return O(0),{calculatedDuration:null,next:A=>{let v=!1;return!P&&E===void 0&&(v=!0,B(A),O(A)),E!==void 0&&A>E?P.next(A-E):(!v&&B(A),p)}}}const fl=e=>{const t=({timestamp:s})=>e(s);return{start:()=>ne.update(t,!0),stop:()=>De(t),now:()=>ue.isProcessing?ue.timestamp:performance.now()}},Ln=2e4;function In(e){let t=0;const s=50;let n=e.next(t);for(;!n.done&&t<Ln;)t+=s,n=e.next(t);return t>=Ln?1/0:t}const ml={decay:En,inertia:En,tween:Qt,keyframes:Qt,spring:Do};function es({autoplay:e=!0,delay:t=0,driver:s=fl,keyframes:n,type:o="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:h,...p}){let x=1,S=!1,b,w;const D=()=>{w=new Promise(f=>{b=f})};D();let M;const C=ml[o]||Qt;let B;C!==Qt&&typeof n[0]!="number"&&(B=Ao([0,100],n,{clamp:!1}),n=[0,100]);const E=C({...p,keyframes:n});let P;l==="mirror"&&(P=C({...p,keyframes:[...n].reverse(),velocity:-(p.velocity||0)}));let O="idle",A=null,v=null,T=null;E.calculatedDuration===null&&i&&(E.calculatedDuration=In(E));const{calculatedDuration:I}=E;let V=1/0,k=1/0;I!==null&&(V=I+a,k=V*(i+1)-a);let j=0;const m=f=>{if(v===null)return;x>0&&(v=Math.min(v,f)),x<0&&(v=Math.min(f-k/x,v)),A!==null?j=A:j=Math.round(f-v)*x;const N=j-t*(x>=0?1:-1),R=x>=0?N<0:N>k;j=Math.max(N,0),O==="finished"&&A===null&&(j=k);let F=j,$=E;if(i){const te=Math.min(j,k)/V;let z=Math.floor(te),K=te%1;!K&&te>=1&&(K=1),K===1&&z--,z=Math.min(z,i+1),!!(z%2)&&(l==="reverse"?(K=1-K,a&&(K-=a/V)):l==="mirror"&&($=P)),F=Fe(0,1,K)*V}const H=R?{done:!1,value:n[0]}:$.next(F);B&&(H.value=B(H.value));let{done:X}=H;!R&&I!==null&&(X=x>=0?j>=k:j<=0);const Y=A===null&&(O==="finished"||O==="running"&&X);return h&&h(H.value),Y&&W(),H},L=()=>{M&&M.stop(),M=void 0},U=()=>{O="idle",L(),b(),D(),v=T=null},W=()=>{O="finished",u&&u(),L(),b()},G=()=>{if(S)return;M||(M=s(m));const f=M.now();c&&c(),A!==null?v=f-A:(!v||O==="finished")&&(v=f),O==="finished"&&D(),T=v,A=null,O="running",M.start()};e&&G();const y={then(f,N){return w.then(f,N)},get time(){return Ve(j)},set time(f){f=Xe(f),j=f,A!==null||!M||x===0?A=f:v=M.now()-f/x},get duration(){const f=E.calculatedDuration===null?In(E):E.calculatedDuration;return Ve(f)},get speed(){return x},set speed(f){f===x||!M||(x=f,y.time=Ve(j))},get state(){return O},play:G,pause:()=>{O="paused",A=j},stop:()=>{S=!0,O!=="idle"&&(O="idle",d&&d(),U())},cancel:()=>{T!==null&&m(T),U()},complete:()=>{O="finished"},sample:f=>(v=0,m(f))};return y}function pl(e){let t;return()=>(t===void 0&&(t=e()),t)}const gl=pl(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),xl=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Ot=10,yl=2e4,vl=(e,t)=>t.type==="spring"||e==="backgroundColor"||!co(t.ease);function bl(e,t,{onUpdate:s,onComplete:n,...o}){if(!(gl()&&xl.has(t)&&!o.repeatDelay&&o.repeatType!=="mirror"&&o.damping!==0&&o.type!=="inertia"))return!1;let a=!1,l,c,d=!1;const u=()=>{c=new Promise(C=>{l=C})};u();let{keyframes:h,duration:p=300,ease:x,times:S}=o;if(vl(t,o)){const C=es({...o,repeat:0,delay:0});let B={done:!1,value:h[0]};const E=[];let P=0;for(;!B.done&&P<yl;)B=C.sample(P),E.push(B.value),P+=Ot;S=void 0,h=E,p=P-Ot,x="linear"}const b=Ma(e.owner.current,t,h,{...o,duration:p,ease:x,times:S}),w=()=>{d=!1,b.cancel()},D=()=>{d=!0,ne.update(w),l(),u()};return b.onfinish=()=>{d||(e.set(Aa(h,o)),n&&n(),D())},{then(C,B){return c.then(C,B)},attachTimeline(C){return b.timeline=C,b.onfinish=null,le},get time(){return Ve(b.currentTime||0)},set time(C){b.currentTime=Xe(C)},get speed(){return b.playbackRate},set speed(C){b.playbackRate=C},get duration(){return Ve(p)},play:()=>{a||(b.play(),De(w))},pause:()=>b.pause(),stop:()=>{if(a=!0,b.playState==="idle")return;const{currentTime:C}=b;if(C){const B=es({...o,autoplay:!1});e.setWithVelocity(B.sample(C-Ot).value,B.sample(C).value,Ot)}D()},complete:()=>{d||b.finish()},cancel:D}}function wl({keyframes:e,delay:t,onUpdate:s,onComplete:n}){const o=()=>(s&&s(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:le,pause:le,stop:le,then:i=>(i(),Promise.resolve()),cancel:le,complete:le});return t?es({keyframes:[0,1],duration:0,delay:t,onComplete:o}):o()}const jl={type:"spring",stiffness:500,damping:25,restSpeed:10},Nl=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Sl={type:"keyframes",duration:.8},Cl={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Tl=(e,{keyframes:t})=>t.length>2?Sl:Ye.has(e)?e.startsWith("scale")?Nl(t[1]):jl:Cl,Os=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Be.test(t)||t==="0")&&!t.startsWith("url(")),kl=new Set(["brightness","contrast","saturate","opacity"]);function Pl(e){const[t,s]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=s.match(ds)||[];if(!n)return e;const o=s.replace(n,"");let i=kl.has(t)?1:0;return n!==s&&(i*=100),t+"("+i+o+")"}const Ml=/([a-z-]*)\(.*?\)/g,zs={...Be,getAnimatableNone:e=>{const t=e.match(Ml);return t?t.map(Pl).join(" "):e}},Al={...Wr,color:fe,backgroundColor:fe,outlineColor:fe,fill:fe,stroke:fe,borderColor:fe,borderTopColor:fe,borderRightColor:fe,borderBottomColor:fe,borderLeftColor:fe,filter:zs,WebkitFilter:zs},mn=e=>Al[e];function Eo(e,t){let s=mn(e);return s!==zs&&(s=Be),s.getAnimatableNone?s.getAnimatableNone(t):void 0}const Lo=e=>/^0[^.\s]+$/.test(e);function Rl(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Lo(e)}function Vl(e,t,s,n){const o=Os(t,s);let i;Array.isArray(s)?i=[...s]:i=[null,s];const a=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<i.length;d++)i[d]===null&&(i[d]=d===0?a:i[d-1]),Rl(i[d])&&c.push(d),typeof i[d]=="string"&&i[d]!=="none"&&i[d]!=="0"&&(l=i[d]);if(o&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];i[u]=Eo(t,l)}return i}function Dl({when:e,delay:t,delayChildren:s,staggerChildren:n,staggerDirection:o,repeat:i,repeatType:a,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function pn(e,t){return e[t]||e.default||e}const El={skipAnimations:!1},gn=(e,t,s,n={})=>o=>{const i=pn(n,e)||{},a=i.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Xe(a);const c=Vl(t,e,s,i),d=c[0],u=c[c.length-1],h=Os(e,d),p=Os(e,u);let x={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:S=>{t.set(S),i.onUpdate&&i.onUpdate(S)},onComplete:()=>{o(),i.onComplete&&i.onComplete()}};if(Dl(i)||(x={...x,...Tl(e,x)}),x.duration&&(x.duration=Xe(x.duration)),x.repeatDelay&&(x.repeatDelay=Xe(x.repeatDelay)),!h||!p||Pa.current||i.type===!1||El.skipAnimations)return wl(x);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const S=bl(t,e,x);if(S)return S}return es(x)};function ts(e){return!!(pe(e)&&e.add)}const Io=e=>/^\-?\d*\.?\d+$/.test(e);function xn(e,t){e.indexOf(t)===-1&&e.push(t)}function yn(e,t){const s=e.indexOf(t);s>-1&&e.splice(s,1)}class vn{constructor(){this.subscriptions=[]}add(t){return xn(this.subscriptions,t),()=>yn(this.subscriptions,t)}notify(t,s,n){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,s,n);else for(let i=0;i<o;i++){const a=this.subscriptions[i];a&&a(t,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ll=e=>!isNaN(parseFloat(e));class Il{constructor(t,s={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,o=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:a}=ue;this.lastUpdated!==a&&(this.timeDelta=i,this.lastUpdated=a,ne.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>ne.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=Ll(this.current),this.owner=s.owner}onChange(t){return this.on("change",t)}on(t,s){this.events[t]||(this.events[t]=new vn);const n=this.events[t].add(s);return t==="change"?()=>{n(),ne.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,s){this.passiveEffect=t,this.stopPassiveEffect=s}set(t,s=!0){!s||!this.passiveEffect?this.updateAndNotify(t,s):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,s,n){this.set(s),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Ro(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=t(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function dt(e,t){return new Il(e,t)}const Fo=e=>t=>t.test(e),Fl={test:e=>e==="auto",parse:e=>e},Bo=[Ze,J,Pe,Ee,Gi,Hi,Fl],pt=e=>Bo.find(Fo(e)),Bl=[...Bo,fe,Be],Ol=e=>Bl.find(Fo(e));function zl(e,t,s){e.hasValue(t)?e.getValue(t).set(s):e.addValue(t,dt(s))}function $l(e,t){const s=hs(e,t);let{transitionEnd:n={},transition:o={},...i}=s?e.makeTargetAnimatable(s,!1):{};i={...i,...n};for(const a in i){const l=ra(i[a]);zl(e,a,l)}}function Ul(e,t,s){var n,o;const i=Object.keys(t).filter(l=>!e.hasValue(l)),a=i.length;if(a)for(let l=0;l<a;l++){const c=i[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(o=(n=s[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&o!==void 0?o:t[c]),u!=null&&(typeof u=="string"&&(Io(u)||Lo(u))?u=parseFloat(u):!Ol(u)&&Be.test(d)&&(u=Eo(c,d)),e.addValue(c,dt(u,{owner:e})),s[c]===void 0&&(s[c]=u),u!==null&&e.setBaseTarget(c,u))}}function Hl(e,t){return t?(t[e]||t.default||t).from:void 0}function Gl(e,t,s){const n={};for(const o in e){const i=Hl(o,t);if(i!==void 0)n[o]=i;else{const a=s.getValue(o);a&&(n[o]=a.get())}}return n}function _l({protectedKeys:e,needsAnimating:t},s){const n=e.hasOwnProperty(s)&&t[s]!==!0;return t[s]=!1,n}function Wl(e,t){const s=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==s)return!0}else return s!==t}function Oo(e,t,{delay:s=0,transitionOverride:n,type:o}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(i=n);const d=[],u=o&&e.animationState&&e.animationState.getState()[o];for(const h in l){const p=e.getValue(h),x=l[h];if(!p||x===void 0||u&&_l(u,h))continue;const S={delay:s,elapsed:0,...pn(i||{},h)};if(window.HandoffAppearAnimations){const D=e.getProps()[Or];if(D){const M=window.HandoffAppearAnimations(D,h,p,ne);M!==null&&(S.elapsed=M,S.isHandoff=!0)}}let b=!S.isHandoff&&!Wl(p,x);if(S.type==="spring"&&(p.getVelocity()||S.velocity)&&(b=!1),p.animation&&(b=!1),b)continue;p.start(gn(h,p,x,e.shouldReduceMotion&&Ye.has(h)?{type:!1}:S));const w=p.animation;ts(c)&&(c.add(h),w.then(()=>c.remove(h))),d.push(w)}return a&&Promise.all(d).then(()=>{a&&$l(e,a)}),d}function $s(e,t,s={}){const n=hs(e,t,s.custom);let{transition:o=e.getDefaultTransition()||{}}=n||{};s.transitionOverride&&(o=s.transitionOverride);const i=n?()=>Promise.all(Oo(e,n,s)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:h}=o;return ql(e,t,d+c,u,h,s)}:()=>Promise.resolve(),{when:l}=o;if(l){const[c,d]=l==="beforeChildren"?[i,a]:[a,i];return c().then(()=>d())}else return Promise.all([i(),a(s.delay)])}function ql(e,t,s=0,n=0,o=1,i){const a=[],l=(e.variantChildren.size-1)*n,c=o===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(Xl).forEach((d,u)=>{d.notify("AnimationStart",t),a.push($s(d,t,{...i,delay:s+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(a)}function Xl(e,t){return e.sortNodePosition(t)}function Kl(e,t,s={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const o=t.map(i=>$s(e,i,s));n=Promise.all(o)}else if(typeof t=="string")n=$s(e,t,s);else{const o=typeof t=="function"?hs(e,t,s.custom):t;n=Promise.all(Oo(e,o,s))}return n.then(()=>e.notify("AnimationComplete",t))}const Yl=[...Qs].reverse(),Zl=Qs.length;function Jl(e){return t=>Promise.all(t.map(({animation:s,options:n})=>Kl(e,s,n)))}function Ql(e){let t=Jl(e);const s=tc();let n=!0;const o=(c,d)=>{const u=hs(e,d);if(u){const{transition:h,transitionEnd:p,...x}=u;c={...c,...x,...p}}return c};function i(c){t=c(e)}function a(c,d){const u=e.getProps(),h=e.getVariantContext(!0)||{},p=[],x=new Set;let S={},b=1/0;for(let D=0;D<Zl;D++){const M=Yl[D],C=s[M],B=u[M]!==void 0?u[M]:h[M],E=Ct(B),P=M===d?C.isActive:null;P===!1&&(b=D);let O=B===h[M]&&B!==u[M]&&E;if(O&&n&&e.manuallyAnimateOnMount&&(O=!1),C.protectedKeys={...S},!C.isActive&&P===null||!B&&!C.prevProp||ls(B)||typeof B=="boolean")continue;let v=ec(C.prevProp,B)||M===d&&C.isActive&&!O&&E||D>b&&E,T=!1;const I=Array.isArray(B)?B:[B];let V=I.reduce(o,{});P===!1&&(V={});const{prevResolvedValues:k={}}=C,j={...k,...V},m=L=>{v=!0,x.has(L)&&(T=!0,x.delete(L)),C.needsAnimating[L]=!0};for(const L in j){const U=V[L],W=k[L];if(S.hasOwnProperty(L))continue;let G=!1;Zt(U)&&Zt(W)?G=!ao(U,W):G=U!==W,G?U!==void 0?m(L):x.add(L):U!==void 0&&x.has(L)?m(L):C.protectedKeys[L]=!0}C.prevProp=B,C.prevResolvedValues=V,C.isActive&&(S={...S,...V}),n&&e.blockInitialAnimation&&(v=!1),v&&(!O||T)&&p.push(...I.map(L=>({animation:L,options:{type:M,...c}})))}if(x.size){const D={};x.forEach(M=>{const C=e.getBaseTarget(M);C!==void 0&&(D[M]=C)}),p.push({animation:D})}let w=!!p.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(w=!1),n=!1,w?t(p):Promise.resolve()}function l(c,d,u){var h;if(s[c].isActive===d)return Promise.resolve();(h=e.variantChildren)===null||h===void 0||h.forEach(x=>{var S;return(S=x.animationState)===null||S===void 0?void 0:S.setActive(c,d)}),s[c].isActive=d;const p=a(u,c);for(const x in s)s[x].protectedKeys={};return p}return{animateChanges:a,setActive:l,setAnimateFunction:i,getState:()=>s}}function ec(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!ao(t,e):!1}function Ue(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function tc(){return{animate:Ue(!0),whileInView:Ue(),whileHover:Ue(),whileTap:Ue(),whileDrag:Ue(),whileFocus:Ue(),exit:Ue()}}class sc extends Oe{constructor(t){super(t),t.animationState||(t.animationState=Ql(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),ls(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:s}=this.node.prevProps||{};t!==s&&this.updateAnimationControlsSubscription()}unmount(){}}let nc=0;class rc extends Oe{constructor(){super(...arguments),this.id=nc++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:s,custom:n}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===o)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});s&&!t&&i.then(()=>s(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const oc={animation:{Feature:sc},exit:{Feature:rc}},Fn=(e,t)=>Math.abs(e-t);function ic(e,t){const s=Fn(e.x,t.x),n=Fn(e.y,t.y);return Math.sqrt(s**2+n**2)}class zo{constructor(t,s,{transformPagePoint:n,contextWindow:o,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Ss(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=ic(h.offset,{x:0,y:0})>=3;if(!p&&!x)return;const{point:S}=h,{timestamp:b}=ue;this.history.push({...S,timestamp:b});const{onStart:w,onMove:D}=this.handlers;p||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),D&&D(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Ns(p,this.transformPagePoint),ne.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:x,onSessionEnd:S,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Ss(h.type==="pointercancel"?this.lastMoveEventInfo:Ns(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,w),S&&S(h,w)},!so(t))return;this.dragSnapToOrigin=i,this.handlers=s,this.transformPagePoint=n,this.contextWindow=o||window;const a=us(t),l=Ns(a,this.transformPagePoint),{point:c}=l,{timestamp:d}=ue;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=s;u&&u(t,Ss(l,this.history)),this.removeListeners=Ie(Re(this.contextWindow,"pointermove",this.handlePointerMove),Re(this.contextWindow,"pointerup",this.handlePointerUp),Re(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),De(this.updatePoint)}}function Ns(e,t){return t?{point:t(e.point)}:e}function Bn(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ss({point:e},t){return{point:e,delta:Bn(e,$o(t)),offset:Bn(e,ac(t)),velocity:lc(t,.1)}}function ac(e){return e[0]}function $o(e){return e[e.length-1]}function lc(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,n=null;const o=$o(e);for(;s>=0&&(n=e[s],!(o.timestamp-n.timestamp>Xe(t)));)s--;if(!n)return{x:0,y:0};const i=Ve(o.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const a={x:(o.x-n.x)/i,y:(o.y-n.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function ve(e){return e.max-e.min}function Us(e,t=0,s=.01){return Math.abs(e-t)<=s}function On(e,t,s,n=.5){e.origin=n,e.originPoint=oe(t.min,t.max,e.origin),e.scale=ve(s)/ve(t),(Us(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=oe(s.min,s.max,e.origin)-e.originPoint,(Us(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Nt(e,t,s,n){On(e.x,t.x,s.x,n?n.originX:void 0),On(e.y,t.y,s.y,n?n.originY:void 0)}function zn(e,t,s){e.min=s.min+t.min,e.max=e.min+ve(t)}function cc(e,t,s){zn(e.x,t.x,s.x),zn(e.y,t.y,s.y)}function $n(e,t,s){e.min=t.min-s.min,e.max=e.min+ve(t)}function St(e,t,s){$n(e.x,t.x,s.x),$n(e.y,t.y,s.y)}function dc(e,{min:t,max:s},n){return t!==void 0&&e<t?e=n?oe(t,e,n.min):Math.max(e,t):s!==void 0&&e>s&&(e=n?oe(s,e,n.max):Math.min(e,s)),e}function Un(e,t,s){return{min:t!==void 0?e.min+t:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function uc(e,{top:t,left:s,bottom:n,right:o}){return{x:Un(e.x,s,o),y:Un(e.y,t,n)}}function Hn(e,t){let s=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,n]=[n,s]),{min:s,max:n}}function hc(e,t){return{x:Hn(e.x,t.x),y:Hn(e.y,t.y)}}function fc(e,t){let s=.5;const n=ve(e),o=ve(t);return o>n?s=kt(t.min,t.max-n,e.min):n>o&&(s=kt(e.min,e.max-o,t.min)),Fe(0,1,s)}function mc(e,t){const s={};return t.min!==void 0&&(s.min=t.min-e.min),t.max!==void 0&&(s.max=t.max-e.min),s}const Hs=.35;function pc(e=Hs){return e===!1?e=0:e===!0&&(e=Hs),{x:Gn(e,"left","right"),y:Gn(e,"top","bottom")}}function Gn(e,t,s){return{min:_n(e,t),max:_n(e,s)}}function _n(e,t){return typeof e=="number"?e:e[t]||0}const Wn=()=>({translate:0,scale:1,origin:0,originPoint:0}),lt=()=>({x:Wn(),y:Wn()}),qn=()=>({min:0,max:0}),ce=()=>({x:qn(),y:qn()});function Se(e){return[e("x"),e("y")]}function Uo({top:e,left:t,right:s,bottom:n}){return{x:{min:t,max:s},y:{min:e,max:n}}}function gc({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function xc(e,t){if(!t)return e;const s=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function Cs(e){return e===void 0||e===1}function Gs({scale:e,scaleX:t,scaleY:s}){return!Cs(e)||!Cs(t)||!Cs(s)}function Ge(e){return Gs(e)||Ho(e)||e.z||e.rotate||e.rotateX||e.rotateY}function Ho(e){return Xn(e.x)||Xn(e.y)}function Xn(e){return e&&e!=="0%"}function ss(e,t,s){const n=e-s,o=t*n;return s+o}function Kn(e,t,s,n,o){return o!==void 0&&(e=ss(e,o,n)),ss(e,s,n)+t}function _s(e,t=0,s=1,n,o){e.min=Kn(e.min,t,s,n,o),e.max=Kn(e.max,t,s,n,o)}function Go(e,{x:t,y:s}){_s(e.x,t.translate,t.scale,t.originPoint),_s(e.y,s.translate,s.scale,s.originPoint)}function yc(e,t,s,n=!1){const o=s.length;if(!o)return;t.x=t.y=1;let i,a;for(let l=0;l<o;l++){i=s[l],a=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ct(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Go(e,a)),n&&Ge(i.latestValues)&&ct(e,i.latestValues))}t.x=Yn(t.x),t.y=Yn(t.y)}function Yn(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Le(e,t){e.min=e.min+t,e.max=e.max+t}function Zn(e,t,[s,n,o]){const i=t[o]!==void 0?t[o]:.5,a=oe(e.min,e.max,i);_s(e,t[s],t[n],a,t.scale)}const vc=["x","scaleX","originX"],bc=["y","scaleY","originY"];function ct(e,t){Zn(e.x,t,vc),Zn(e.y,t,bc)}function _o(e,t){return Uo(xc(e.getBoundingClientRect(),t))}function wc(e,t,s){const n=_o(e,s),{scroll:o}=t;return o&&(Le(n.x,o.offset.x),Le(n.y,o.offset.y)),n}const Wo=({current:e})=>e?e.ownerDocument.defaultView:null,jc=new WeakMap;class Nc{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ce(),this.visualElement=t}start(t,{snapToCursor:s=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const o=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(us(u,"page").point)},i=(u,h)=>{const{drag:p,dragPropagation:x,onDragStart:S}=this.getProps();if(p&&!x&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=ro(p),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Se(w=>{let D=this.getAxisMotionValue(w).get()||0;if(Pe.test(D)){const{projection:M}=this.visualElement;if(M&&M.layout){const C=M.layout.layoutBox[w];C&&(D=ve(C)*(parseFloat(D)/100))}}this.originPoint[w]=D}),S&&ne.update(()=>S(u,h),!1,!0);const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,h)=>{const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:S,onDrag:b}=this.getProps();if(!p&&!this.openGlobalLock)return;const{offset:w}=h;if(x&&this.currentDirection===null){this.currentDirection=Sc(w),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),b&&b(u,h)},l=(u,h)=>this.stop(u,h),c=()=>Se(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new zo(t,{onSessionStart:o,onStart:i,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:Wo(this.visualElement)})}stop(t,s){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:i}=this.getProps();i&&ne.update(()=>i(t,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:s}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(t,s,n){const{drag:o}=this.getProps();if(!n||!zt(t,o,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(a=dc(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var t;const{dragConstraints:s,dragElastic:n}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;s&&it(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&o?this.constraints=uc(o.layoutBox,s):this.constraints=!1,this.elastic=pc(n),i!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&Se(a=>{this.getAxisMotionValue(a)&&(this.constraints[a]=mc(o.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:s}=this.getProps();if(!t||!it(t))return!1;const n=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const i=wc(n,o.root,this.visualElement.getTransformPagePoint());let a=hc(o.layout.layoutBox,i);if(s){const l=s(gc(a));this.hasMutatedConstraints=!!l,l&&(a=Uo(l))}return a}startAnimation(t){const{drag:s,dragMomentum:n,dragElastic:o,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Se(u=>{if(!zt(u,s,this.currentDirection))return;let h=c&&c[u]||{};a&&(h={min:0,max:0});const p=o?200:1e6,x=o?40:1e7,S={type:"inertia",velocity:n?t[u]:0,bounceStiffness:p,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,S)});return Promise.all(d).then(l)}startAxisValueAnimation(t,s){const n=this.getAxisMotionValue(t);return n.start(gn(t,n,0,s))}stopAnimation(){Se(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Se(t=>{var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(t){var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(t){const s="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),o=n[s];return o||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Se(s=>{const{drag:n}=this.getProps();if(!zt(s,n,this.currentDirection))return;const{projection:o}=this.visualElement,i=this.getAxisMotionValue(s);if(o&&o.layout){const{min:a,max:l}=o.layout.layoutBox[s];i.set(t[s]-oe(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!it(s)||!n||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Se(a=>{const l=this.getAxisMotionValue(a);if(l){const c=l.get();o[a]=fc({min:c,max:c},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Se(a=>{if(!zt(a,t,null))return;const l=this.getAxisMotionValue(a),{min:c,max:d}=this.constraints[a];l.set(oe(c,d,o[a]))})}addListeners(){if(!this.visualElement.current)return;jc.set(this.visualElement,this);const t=this.visualElement.current,s=Re(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();it(c)&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,i=o.addEventListener("measure",n);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),n();const a=Ae(window,"resize",()=>this.scalePositionWithinConstraints()),l=o.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Se(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=c[u].translate,h.set(h.get()+c[u].translate))}),this.visualElement.render())});return()=>{a(),s(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:o=!1,dragConstraints:i=!1,dragElastic:a=Hs,dragMomentum:l=!0}=t;return{...t,drag:s,dragDirectionLock:n,dragPropagation:o,dragConstraints:i,dragElastic:a,dragMomentum:l}}}function zt(e,t,s){return(t===!0||t===e)&&(s===null||s===e)}function Sc(e,t=10){let s=null;return Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x"),s}class Cc extends Oe{constructor(t){super(t),this.removeGroupControls=le,this.removeListeners=le,this.controls=new Nc(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||le}unmount(){this.removeGroupControls(),this.removeListeners()}}const Jn=e=>(t,s)=>{e&&ne.update(()=>e(t,s))};class Tc extends Oe{constructor(){super(...arguments),this.removePointerDownListener=le}onPointerDown(t){this.session=new zo(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Wo(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:s,onPan:n,onPanEnd:o}=this.node.getProps();return{onSessionStart:Jn(t),onStart:Jn(s),onMove:n,onEnd:(i,a)=>{delete this.session,o&&ne.update(()=>o(i,a))}}}mount(){this.removePointerDownListener=Re(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function kc(){const e=g.useContext(is);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:s,register:n}=e,o=g.useId();return g.useEffect(()=>n(o),[]),!t&&s?[!1,()=>s&&s(o)]:[!0]}const Xt={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Qn(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const gt={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(J.test(e))e=parseFloat(e);else return e;const s=Qn(e,t.target.x),n=Qn(e,t.target.y);return`${s}% ${n}%`}},Pc={correct:(e,{treeScale:t,projectionDelta:s})=>{const n=e,o=Be.parse(e);if(o.length>5)return n;const i=Be.createTransformer(e),a=typeof o[0]!="number"?1:0,l=s.x.scale*t.x,c=s.y.scale*t.y;o[0+a]/=l,o[1+a]/=c;const d=oe(l,c,.5);return typeof o[2+a]=="number"&&(o[2+a]/=d),typeof o[3+a]=="number"&&(o[3+a]/=d),i(o)}};class Mc extends Ks.Component{componentDidMount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n,layoutId:o}=this.props,{projection:i}=t;Ii(Ac),i&&(s.group&&s.group.add(i),n&&n.register&&o&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Xt.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:s,visualElement:n,drag:o,isPresent:i}=this.props,a=n.projection;return a&&(a.isPresent=i,o||t.layoutDependency!==s||s===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ne.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:o}=t;o&&(o.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(o),n&&n.deregister&&n.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function qo(e){const[t,s]=kc(),n=g.useContext(tn);return Ks.createElement(Mc,{...e,layoutGroup:n,switchLayoutGroup:g.useContext($r),isPresent:t,safeToRemove:s})}const Ac={borderRadius:{...gt,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:gt,borderTopRightRadius:gt,borderBottomLeftRadius:gt,borderBottomRightRadius:gt,boxShadow:Pc},Xo=["TopLeft","TopRight","BottomLeft","BottomRight"],Rc=Xo.length,er=e=>typeof e=="string"?parseFloat(e):e,tr=e=>typeof e=="number"||J.test(e);function Vc(e,t,s,n,o,i){o?(e.opacity=oe(0,s.opacity!==void 0?s.opacity:1,Dc(n)),e.opacityExit=oe(t.opacity!==void 0?t.opacity:1,0,Ec(n))):i&&(e.opacity=oe(t.opacity!==void 0?t.opacity:1,s.opacity!==void 0?s.opacity:1,n));for(let a=0;a<Rc;a++){const l=`border${Xo[a]}Radius`;let c=sr(t,l),d=sr(s,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||tr(c)===tr(d)?(e[l]=Math.max(oe(er(c),er(d),n),0),(Pe.test(d)||Pe.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||s.rotate)&&(e.rotate=oe(t.rotate||0,s.rotate||0,n))}function sr(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Dc=Ko(0,.5,xo),Ec=Ko(.5,.95,le);function Ko(e,t,s){return n=>n<e?0:n>t?1:s(kt(e,t,n))}function nr(e,t){e.min=t.min,e.max=t.max}function Ne(e,t){nr(e.x,t.x),nr(e.y,t.y)}function rr(e,t,s,n,o){return e-=t,e=ss(e,1/s,n),o!==void 0&&(e=ss(e,1/o,n)),e}function Lc(e,t=0,s=1,n=.5,o,i=e,a=e){if(Pe.test(t)&&(t=parseFloat(t),t=oe(a.min,a.max,t/100)-a.min),typeof t!="number")return;let l=oe(i.min,i.max,n);e===i&&(l-=t),e.min=rr(e.min,t,s,l,o),e.max=rr(e.max,t,s,l,o)}function or(e,t,[s,n,o],i,a){Lc(e,t[s],t[n],t[o],t.scale,i,a)}const Ic=["x","scaleX","originX"],Fc=["y","scaleY","originY"];function ir(e,t,s,n){or(e.x,t,Ic,s?s.x:void 0,n?n.x:void 0),or(e.y,t,Fc,s?s.y:void 0,n?n.y:void 0)}function ar(e){return e.translate===0&&e.scale===1}function Yo(e){return ar(e.x)&&ar(e.y)}function Bc(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function Zo(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function lr(e){return ve(e.x)/ve(e.y)}class Oc{constructor(){this.members=[]}add(t){xn(this.members,t),t.scheduleRender()}remove(t){if(yn(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(t){const s=this.members.findIndex(o=>t===o);if(s===0)return!1;let n;for(let o=s;o>=0;o--){const i=this.members[o];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,s){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,s&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:s,resumingFrom:n}=t;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function cr(e,t,s){let n="";const o=e.x.translate/t.x,i=e.y.translate/t.y;if((o||i)&&(n=`translate3d(${o}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),s){const{rotate:c,rotateX:d,rotateY:u}=s;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const zc=(e,t)=>e.depth-t.depth;class $c{constructor(){this.children=[],this.isDirty=!1}add(t){xn(this.children,t),this.isDirty=!0}remove(t){yn(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(zc),this.isDirty=!1,this.children.forEach(t)}}function Uc(e,t){const s=performance.now(),n=({timestamp:o})=>{const i=o-s;i>=t&&(De(n),e(i-t))};return ne.read(n,!0),()=>De(n)}function Hc(e){window.MotionDebug&&window.MotionDebug.record(e)}function Gc(e){return e instanceof SVGElement&&e.tagName!=="svg"}function _c(e,t,s){const n=pe(e)?e:dt(e);return n.start(gn("",n,t,s)),n.animation}const dr=["","X","Y","Z"],Wc={visibility:"hidden"},ur=1e3;let qc=0;const _e={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Jo({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:n,resetTransform:o}){return class{constructor(a={},l=t==null?void 0:t()){this.id=qc++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,_e.totalNodes=_e.resolvedTargetDeltas=_e.recalculatedProjection=0,this.nodes.forEach(Yc),this.nodes.forEach(td),this.nodes.forEach(sd),this.nodes.forEach(Zc),Hc(_e)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new $c)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new vn),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Gc(a),this.instance=a;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let h;const p=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=Uc(p,250),Xt.hasAnimatedSinceResize&&(Xt.hasAnimatedSinceResize=!1,this.nodes.forEach(fr))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeTargetChanged:x,layout:S})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||u.getDefaultTransition()||ad,{onLayoutAnimationStart:w,onLayoutAnimationComplete:D}=u.getProps(),M=!this.targetLayout||!Zo(this.targetLayout,S)||x,C=!p&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||C||p&&(M||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,C);const B={...pn(b,"layout"),onPlay:w,onComplete:D};(u.shouldReduceMotion||this.options.layoutRoot)&&(B.delay=0,B.type=!1),this.startAnimation(B)}else p||fr(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=S})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,De(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(nd),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hr);return}this.isUpdating||this.nodes.forEach(Qc),this.isUpdating=!1,this.nodes.forEach(ed),this.nodes.forEach(Xc),this.nodes.forEach(Kc),this.clearAllSnapshots();const l=performance.now();ue.delta=Fe(0,1e3/60,l-ue.timestamp),ue.timestamp=l,ue.isProcessing=!0,ps.update.process(ue),ps.preRender.process(ue),ps.render.process(ue),ue.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Jc),this.sharedNodes.forEach(rd)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ne.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ne.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ce(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:n(this.instance),offset:s(this.instance)})}resetTransform(){if(!o)return;const a=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!Yo(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;a&&(l||Ge(this.latestValues)||u)&&(o(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),ld(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return ce();const l=a.measureViewportBox(),{scroll:c}=this.root;return c&&(Le(l.x,c.offset.x),Le(l.y,c.offset.y)),l}removeElementScroll(a){const l=ce();Ne(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:h}=d;if(d!==this.root&&u&&h.layoutScroll){if(u.isRoot){Ne(l,a);const{scroll:p}=this.root;p&&(Le(l.x,-p.offset.x),Le(l.y,-p.offset.y))}Le(l.x,u.offset.x),Le(l.y,u.offset.y)}}return l}applyTransform(a,l=!1){const c=ce();Ne(c,a);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&ct(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Ge(u.latestValues)&&ct(c,u.latestValues)}return Ge(this.latestValues)&&ct(c,this.latestValues),c}removeTransform(a){const l=ce();Ne(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Ge(d.latestValues))continue;Gs(d.latestValues)&&d.updateSnapshot();const u=ce(),h=d.measurePageBox();Ne(u,h),ir(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Ge(this.latestValues)&&ir(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ue.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=ue.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ce(),this.relativeTargetOrigin=ce(),St(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Ne(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ce(),this.targetWithTransforms=ce()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),cc(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ne(this.target,this.layout.layoutBox),Go(this.target,this.targetDelta)):Ne(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ce(),this.relativeTargetOrigin=ce(),St(this.relativeTargetOrigin,this.target,x.target),Ne(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}_e.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Gs(this.parent.latestValues)||Ho(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===ue.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Ne(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,x=this.treeScale.y;yc(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:S}=l;if(!S){this.projectionTransform&&(this.projectionDelta=lt(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=lt(),this.projectionDeltaWithTransform=lt());const b=this.projectionTransform;Nt(this.projectionDelta,this.layoutCorrected,S,this.latestValues),this.projectionTransform=cr(this.projectionDelta,this.treeScale),(this.projectionTransform!==b||this.treeScale.x!==p||this.treeScale.y!==x)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",S)),_e.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},h=lt();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const p=ce(),x=c?c.source:void 0,S=this.layout?this.layout.source:void 0,b=x!==S,w=this.getStack(),D=!w||w.members.length<=1,M=!!(b&&!D&&this.options.crossfade===!0&&!this.path.some(id));this.animationProgress=0;let C;this.mixTargetDelta=B=>{const E=B/1e3;mr(h.x,a.x,E),mr(h.y,a.y,E),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(St(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),od(this.relativeTarget,this.relativeTargetOrigin,p,E),C&&Bc(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=ce()),Ne(C,this.relativeTarget)),b&&(this.animationValues=u,Vc(u,d,this.latestValues,E,M,D)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(De(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ne.update(()=>{Xt.hasAnimatedSinceResize=!0,this.currentAnimation=_c(0,ur,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(ur),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=a;if(!(!l||!c||!d)){if(this!==a&&this.layout&&d&&Qo(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||ce();const h=ve(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+h;const p=ve(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+p}Ne(l,c),ct(l,u),Nt(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Oc),this.sharedNodes.get(a).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<dr.length;u++){const h="rotate"+dr[u];c[h]&&(d[h]=c[h],a.setStaticValue(h,0))}a.render();for(const u in d)a.setStaticValue(u,d[u]);a.scheduleRender()}getProjectionStyles(a){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Wc;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=qt(a==null?void 0:a.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=qt(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Ge(this.latestValues)&&(b.transform=u?u({},""):"none",this.hasProjected=!1),b}const p=h.animationValues||h.latestValues;this.applyTransformsToTarget(),d.transform=cr(this.projectionDeltaWithTransform,this.treeScale,p),u&&(d.transform=u(p,d.transform));const{x,y:S}=this.projectionDelta;d.transformOrigin=`${x.origin*100}% ${S.origin*100}% 0`,h.animationValues?d.opacity=h===this?(c=(l=p.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:d.opacity=h===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const b in Kt){if(p[b]===void 0)continue;const{correct:w,applyTo:D}=Kt[b],M=d.transform==="none"?p[b]:w(p[b],h);if(D){const C=D.length;for(let B=0;B<C;B++)d[D[B]]=M}else d[b]=M}return this.options.layoutId&&(d.pointerEvents=h===this?qt(a==null?void 0:a.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(hr),this.root.sharedNodes.clear()}}}function Xc(e){e.updateLayout()}function Kc(e){var t;const s=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:o}=e.layout,{animationType:i}=e.options,a=s.source!==e.layout.source;i==="size"?Se(h=>{const p=a?s.measuredBox[h]:s.layoutBox[h],x=ve(p);p.min=n[h].min,p.max=p.min+x}):Qo(i,s.layoutBox,n)&&Se(h=>{const p=a?s.measuredBox[h]:s.layoutBox[h],x=ve(n[h]);p.max=p.min+x,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+x)});const l=lt();Nt(l,n,s.layoutBox);const c=lt();a?Nt(c,e.applyTransform(o,!0),s.measuredBox):Nt(c,n,s.layoutBox);const d=!Yo(l);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:x}=h;if(p&&x){const S=ce();St(S,s.layoutBox,p.layoutBox);const b=ce();St(b,n,x.layoutBox),Zo(S,b)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=S,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Yc(e){_e.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Zc(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Jc(e){e.clearSnapshot()}function hr(e){e.clearMeasurements()}function Qc(e){e.isLayoutDirty=!1}function ed(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function fr(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function td(e){e.resolveTargetDelta()}function sd(e){e.calcProjection()}function nd(e){e.resetRotation()}function rd(e){e.removeLeadSnapshot()}function mr(e,t,s){e.translate=oe(t.translate,0,s),e.scale=oe(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function pr(e,t,s,n){e.min=oe(t.min,s.min,n),e.max=oe(t.max,s.max,n)}function od(e,t,s,n){pr(e.x,t.x,s.x,n),pr(e.y,t.y,s.y,n)}function id(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const ad={duration:.45,ease:[.4,0,.1,1]},gr=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),xr=gr("applewebkit/")&&!gr("chrome/")?Math.round:le;function yr(e){e.min=xr(e.min),e.max=xr(e.max)}function ld(e){yr(e.x),yr(e.y)}function Qo(e,t,s){return e==="position"||e==="preserve-aspect"&&!Us(lr(t),lr(s),.2)}const cd=Jo({attachResizeListener:(e,t)=>Ae(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ts={current:void 0},ei=Jo({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ts.current){const e=new cd({});e.mount(window),e.setOptions({layoutScroll:!0}),Ts.current=e}return Ts.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),dd={pan:{Feature:Tc},drag:{Feature:Cc,ProjectionNode:ei,MeasureLayout:qo}},ud=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function hd(e){const t=ud.exec(e);if(!t)return[,];const[,s,n]=t;return[s,n]}function Ws(e,t,s=1){const[n,o]=hd(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const a=i.trim();return Io(a)?parseFloat(a):a}else return Ls(o)?Ws(o,t,s+1):o}function fd(e,{...t},s){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:s};s&&(s={...s}),e.values.forEach(o=>{const i=o.get();if(!Ls(i))return;const a=Ws(i,n);a&&o.set(a)});for(const o in t){const i=t[o];if(!Ls(i))continue;const a=Ws(i,n);a&&(t[o]=a,s||(s={}),s[o]===void 0&&(s[o]=i))}return{target:t,transitionEnd:s}}const md=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),ti=e=>md.has(e),pd=e=>Object.keys(e).some(ti),vr=e=>e===Ze||e===J,br=(e,t)=>parseFloat(e.split(", ")[t]),wr=(e,t)=>(s,{transform:n})=>{if(n==="none"||!n)return 0;const o=n.match(/^matrix3d\((.+)\)$/);if(o)return br(o[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?br(i[1],e):0}},gd=new Set(["x","y","z"]),xd=Pt.filter(e=>!gd.has(e));function yd(e){const t=[];return xd.forEach(s=>{const n=e.getValue(s);n!==void 0&&(t.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),t.length&&e.render(),t}const ut={width:({x:e},{paddingLeft:t="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),height:({y:e},{paddingTop:t="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:wr(4,13),y:wr(5,14)};ut.translateX=ut.x;ut.translateY=ut.y;const vd=(e,t,s)=>{const n=t.measureViewportBox(),o=t.current,i=getComputedStyle(o),{display:a}=i,l={};a==="none"&&t.setStaticValue("display",e.display||"block"),s.forEach(d=>{l[d]=ut[d](n,i)}),t.render();const c=t.measureViewportBox();return s.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=ut[d](c,i)}),e},bd=(e,t,s={},n={})=>{t={...t},n={...n};const o=Object.keys(t).filter(ti);let i=[],a=!1;const l=[];if(o.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=s[c],h=pt(u);const p=t[c];let x;if(Zt(p)){const S=p.length,b=p[0]===null?1:0;u=p[b],h=pt(u);for(let w=b;w<S&&p[w]!==null;w++)x?dn(pt(p[w])===x):x=pt(p[w])}else x=pt(p);if(h!==x)if(vr(h)&&vr(x)){const S=d.get();typeof S=="string"&&d.set(parseFloat(S)),typeof p=="string"?t[c]=parseFloat(p):Array.isArray(p)&&x===J&&(t[c]=p.map(parseFloat))}else h!=null&&h.transform&&(x!=null&&x.transform)&&(u===0||p===0)?u===0?d.set(x.transform(u)):t[c]=h.transform(p):(a||(i=yd(e),a=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(p))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=vd(t,e,l);return i.length&&i.forEach(([u,h])=>{e.getValue(u).set(h)}),e.render(),as&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function wd(e,t,s,n){return pd(t)?bd(e,t,s,n):{target:t,transitionEnd:n}}const jd=(e,t,s,n)=>{const o=fd(e,t,n);return t=o.target,n=o.transitionEnd,wd(e,t,s,n)},qs={current:null},si={current:!1};function Nd(){if(si.current=!0,!!as)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>qs.current=e.matches;e.addListener(t),t()}else qs.current=!1}function Sd(e,t,s){const{willChange:n}=t;for(const o in t){const i=t[o],a=s[o];if(pe(i))e.addValue(o,i),ts(n)&&n.add(o);else if(pe(a))e.addValue(o,dt(i,{owner:e})),ts(n)&&n.remove(o);else if(a!==i)if(e.hasValue(o)){const l=e.getValue(o);!l.hasAnimated&&l.set(i)}else{const l=e.getStaticValue(o);e.addValue(o,dt(l!==void 0?l:i,{owner:e}))}}for(const o in s)t[o]===void 0&&e.removeValue(o);return t}const jr=new WeakMap,ni=Object.keys(Tt),Cd=ni.length,Nr=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Td=en.length;class kd{constructor({parent:t,props:s,presenceContext:n,reducedMotionConfig:o,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ne.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=s.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=s,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=a,this.isControllingVariants=cs(s),this.isVariantNode=zr(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(s,{});for(const h in u){const p=u[h];l[h]!==void 0&&pe(p)&&(p.set(l[h],!1),ts(d)&&d.add(h))}}scrapeMotionValuesFromProps(t,s){return{}}mount(t){this.current=t,jr.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),si.current||Nd(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:qs.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){jr.delete(this.current),this.projection&&this.projection.unmount(),De(this.notifyUpdate),De(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,s){const n=Ye.has(t),o=s.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&ne.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=s.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{o(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...s},n,o,i){let a,l;for(let c=0;c<Cd;c++){const d=ni[c],{isEnabled:u,Feature:h,ProjectionNode:p,MeasureLayout:x}=Tt[d];p&&(a=p),u(s)&&(!this.features[d]&&h&&(this.features[d]=new h(this)),x&&(l=x))}if((this.type==="html"||this.type==="svg")&&!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:h,layoutScroll:p,layoutRoot:x}=s;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||h&&it(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:i,layoutScroll:p,layoutRoot:x})}return l}updateFeatures(){for(const t in this.features){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ce()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,s){this.latestValues[t]=s}makeTargetAnimatable(t,s=!0){return this.makeTargetAnimatableFromInstance(t,this.props,s)}update(t,s){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<Nr.length;n++){const o=Nr[n];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const i=t["on"+o];i&&(this.propEventSubscriptions[o]=this.on(o,i))}this.prevMotionValues=Sd(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const s={};for(let n=0;n<Td;n++){const o=en[n],i=this.props[o];(Ct(i)||i===!1)&&(s[o]=i)}return s}addVariantChild(t){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(t),()=>s.variantChildren.delete(t)}addValue(t,s){s!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,s)),this.values.set(t,s),this.latestValues[t]=s.get()}removeValue(t){this.values.delete(t);const s=this.valueSubscriptions.get(t);s&&(s(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,s){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&s!==void 0&&(n=dt(s,{owner:this}),this.addValue(t,n)),n}readValue(t){var s;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(s=this.getBaseTargetFromProps(this.props,t))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,s){this.baseTarget[t]=s}getBaseTarget(t){var s;const{initial:n}=this.props,o=typeof n=="string"||typeof n=="object"?(s=cn(this.props,n))===null||s===void 0?void 0:s[t]:void 0;if(n&&o!==void 0)return o;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!pe(i)?i:this.initialValues[t]!==void 0&&o===void 0?void 0:this.baseTarget[t]}on(t,s){return this.events[t]||(this.events[t]=new vn),this.events[t].add(s)}notify(t,...s){this.events[t]&&this.events[t].notify(...s)}}class ri extends kd{sortInstanceNodePosition(t,s){return t.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(t,s){return t.style?t.style[s]:void 0}removeValueFromRenderState(t,{vars:s,style:n}){delete s[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:s,...n},{transformValues:o},i){let a=Gl(n,t||{},this);if(o&&(s&&(s=o(s)),n&&(n=o(n)),a&&(a=o(a))),i){Ul(this,n,a);const l=jd(this,n,a,s);s=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:s,...n}}}function Pd(e){return window.getComputedStyle(e)}class Md extends ri{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,s){if(Ye.has(s)){const n=mn(s);return n&&n.default||0}else{const n=Pd(t),o=(Gr(s)?n.getPropertyValue(s):n[s])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(t,{transformPagePoint:s}){return _o(t,s)}build(t,s,n,o){nn(t,s,n,o.transformTemplate)}scrapeMotionValuesFromProps(t,s){return ln(t,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;pe(t)&&(this.childSubscription=t.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}renderInstance(t,s,n,o){Yr(t,s,n,o)}}class Ad extends ri{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,s){return t[s]}readValueFromInstance(t,s){if(Ye.has(s)){const n=mn(s);return n&&n.default||0}return s=Zr.has(s)?s:Js(s),t.getAttribute(s)}measureInstanceViewportBox(){return ce()}scrapeMotionValuesFromProps(t,s){return Qr(t,s)}build(t,s,n,o){on(t,s,n,this.isSVGTag,o.transformTemplate)}renderInstance(t,s,n,o){Jr(t,s,n,o)}mount(t){this.isSVGTag=an(t.tagName),super.mount(t)}}const Rd=(e,t)=>sn(e)?new Ad(t,{enableHardwareAcceleration:!1}):new Md(t,{enableHardwareAcceleration:!0}),Vd={layout:{ProjectionNode:ei,MeasureLayout:qo}},Dd={...oc,...Ca,...dd,...Vd},q=Ei((e,t)=>ha(e,t,Dd,Rd));function oi(){const e=g.useRef(!1);return Zs(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Ed(){const e=oi(),[t,s]=g.useState(0),n=g.useCallback(()=>{e.current&&s(t+1)},[t]);return[g.useCallback(()=>ne.postRender(n),[n]),t]}class Ld extends g.Component{getSnapshotBeforeUpdate(t){const s=this.props.childRef.current;if(s&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=s.offsetHeight||0,n.width=s.offsetWidth||0,n.top=s.offsetTop,n.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Id({children:e,isPresent:t}){const s=g.useId(),n=g.useRef(null),o=g.useRef({width:0,height:0,top:0,left:0});return g.useInsertionEffect(()=>{const{width:i,height:a,top:l,left:c}=o.current;if(t||!n.current||!i||!a)return;n.current.dataset.motionPopId=s;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),g.createElement(Ld,{isPresent:t,childRef:n,sizeRef:o},g.cloneElement(e,{ref:n}))}const ks=({children:e,initial:t,isPresent:s,onExitComplete:n,custom:o,presenceAffectsLayout:i,mode:a})=>{const l=eo(Fd),c=g.useId(),d=g.useMemo(()=>({id:c,initial:t,isPresent:s,custom:o,onExitComplete:u=>{l.set(u,!0);for(const h of l.values())if(!h)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),i?void 0:[s]);return g.useMemo(()=>{l.forEach((u,h)=>l.set(h,!1))},[s]),g.useEffect(()=>{!s&&!l.size&&n&&n()},[s]),a==="popLayout"&&(e=g.createElement(Id,{isPresent:s},e)),g.createElement(is.Provider,{value:d},e)};function Fd(){return new Map}function Bd(e){return g.useEffect(()=>()=>e(),[])}const We=e=>e.key||"";function Od(e,t){e.forEach(s=>{const n=We(s);t.set(n,s)})}function zd(e){const t=[];return g.Children.forEach(e,s=>{g.isValidElement(s)&&t.push(s)}),t}const be=({children:e,custom:t,initial:s=!0,onExitComplete:n,exitBeforeEnter:o,presenceAffectsLayout:i=!0,mode:a="sync"})=>{const l=g.useContext(tn).forceRender||Ed()[0],c=oi(),d=zd(e);let u=d;const h=g.useRef(new Map).current,p=g.useRef(u),x=g.useRef(new Map).current,S=g.useRef(!0);if(Zs(()=>{S.current=!1,Od(d,x),p.current=u}),Bd(()=>{S.current=!0,x.clear(),h.clear()}),S.current)return g.createElement(g.Fragment,null,u.map(M=>g.createElement(ks,{key:We(M),isPresent:!0,initial:s?void 0:!1,presenceAffectsLayout:i,mode:a},M)));u=[...u];const b=p.current.map(We),w=d.map(We),D=b.length;for(let M=0;M<D;M++){const C=b[M];w.indexOf(C)===-1&&!h.has(C)&&h.set(C,void 0)}return a==="wait"&&h.size&&(u=[]),h.forEach((M,C)=>{if(w.indexOf(C)!==-1)return;const B=x.get(C);if(!B)return;const E=b.indexOf(C);let P=M;if(!P){const O=()=>{h.delete(C);const A=Array.from(x.keys()).filter(v=>!w.includes(v));if(A.forEach(v=>x.delete(v)),p.current=d.filter(v=>{const T=We(v);return T===C||A.includes(T)}),!h.size){if(c.current===!1)return;l(),n&&n()}};P=g.createElement(ks,{key:We(B),isPresent:!1,onExitComplete:O,custom:t,presenceAffectsLayout:i,mode:a},B),h.set(C,P)}u.splice(E,0,P)}),u=u.map(M=>{const C=M.key;return h.has(C)?M:g.createElement(ks,{key:We(M),isPresent:!0,presenceAffectsLayout:i,mode:a},M)}),g.createElement(g.Fragment,null,h.size?u:u.map(M=>g.cloneElement(M)))};function ii(e){var t,s,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(s=ii(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}function ae(){for(var e,t,s=0,n="",o=arguments.length;s<o;s++)(e=arguments[s])&&(t=ii(e))&&(n&&(n+=" "),n+=t);return n}const $d=({game:e})=>{const t=e.status==="available",s=e.status==="coming-soon",n=e.status==="maintenance",o=r.jsxs(q.div,{whileHover:t?{scale:1.02}:{},whileTap:t?{scale:.98}:{},className:ae("relative h-full bg-gray-800 rounded-xl border-2 overflow-hidden transition-all duration-300",{"border-gray-700 hover:border-purple-500 cursor-pointer shadow-lg hover:shadow-purple-500/20":t,"border-gray-700 opacity-75 cursor-not-allowed":s,"border-orange-600 opacity-75 cursor-not-allowed":n}),children:[(s||n)&&r.jsx("div",{className:"absolute top-2 right-2 z-10",children:r.jsx("span",{className:ae("px-2 py-1 text-xs sm:px-3 sm:text-xs font-pixel rounded-full",{"bg-blue-600 text-white":s,"bg-orange-600 text-white":n}),children:s?"即将推出":"维护中"})}),r.jsx("div",{className:"h-24 sm:h-32 bg-gradient-to-br from-purple-900/50 to-pink-900/50 flex items-center justify-center",children:r.jsx("span",{className:"text-4xl sm:text-6xl",children:e.image})}),r.jsxs("div",{className:"p-3 sm:p-4 space-y-2 sm:space-y-3",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-game font-bold text-white",children:e.title}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400 line-clamp-2",children:e.description}),r.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:e.tags.map(i=>r.jsx("span",{className:"px-1.5 py-0.5 sm:px-2 sm:py-1 text-xs bg-gray-700 text-gray-300 rounded-md",children:i},i))}),r.jsxs("div",{className:"pt-2 sm:pt-3 border-t border-gray-700 grid grid-cols-3 gap-1 sm:gap-2 text-xs text-gray-500",children:[r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"难度"}),r.jsx("div",{className:ae("text-xs",{"text-green-400":e.difficulty==="简单","text-yellow-400":e.difficulty==="中等","text-red-400":e.difficulty==="困难"}),children:e.difficulty})]}),r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"玩家"}),r.jsx("div",{className:"text-xs",children:e.players})]}),r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("div",{className:"font-semibold text-gray-400 text-xs",children:"时长"}),r.jsx("div",{className:"text-xs",children:e.time})]})]}),t&&r.jsx("button",{className:"w-full mt-3 sm:mt-4 px-3 py-2 sm:px-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-game text-xs sm:text-sm rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all active:scale-95",children:"开始游戏"})]})]});return t?r.jsx(Ds,{to:e.path,children:o}):o},Ud=()=>{const[e,t]=g.useState(0),[s,n]=g.useState(!1),[o,i]=g.useState(null);return g.useEffect(()=>{let a;a="http://socket.qingfengyueying.xyz/stats",console.log("[OnlineStats] 正在连接到:",a);const l=Ys(a,{transports:["websocket","polling"],upgrade:!0,timeout:1e4,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3});return l.on("connect",()=>{console.log("[OnlineStats] 连接成功, Socket ID:",l.id),n(!0),l.emit("get-online-count")}),l.on("online-count",c=>{console.log("[OnlineStats] 收到在线人数:",c.count),t(c.count||0)}),l.on("user-count-update",c=>{console.log("[OnlineStats] 在线人数更新:",c.count),t(c.count||0)}),l.on("connect_error",c=>{console.error("[OnlineStats] 连接错误:",c.message),n(!1)}),l.on("disconnect",c=>{console.log("[OnlineStats] 连接断开, 原因:",c),n(!1)}),l.on("reconnect",c=>{console.log("[OnlineStats] 重连成功, 尝试次数:",c),n(!0),l.emit("get-online-count")}),l.on("reconnect_failed",()=>{console.error("[OnlineStats] 重连失败"),n(!1),t(Math.floor(Math.random()*30)+5)}),i(l),()=>{console.log("[OnlineStats] 清理Socket连接"),l&&l.disconnect()}},[]),{onlineCount:e,isConnected:s,socket:o}},Sr=[{id:"gomoku",title:"五子棋",description:"经典双人对战游戏",image:"♟️",path:"/games/gomoku",tags:["双人","策略","PVP"],difficulty:"简单",players:"2人",time:"10-20分钟",status:"available"},{id:"2048",title:"2048",description:"数字合并益智游戏",image:"🔢",path:"/games/2048",tags:["单人","益智","策略"],difficulty:"中等",players:"1人",time:"10-30分钟",status:"available"},{id:"colortouch",title:"颜色消消乐",description:"点击消除同色方块",image:"🎨",path:"/games/colortouch",tags:["单人","休闲","益智"],difficulty:"简单",players:"1人",time:"5-15分钟",status:"available"},{id:"tetris",title:"俄罗斯方块",description:"经典方块消除游戏",image:"🎮",path:"/games/tetris",tags:["单人","休闲","经典"],difficulty:"中等",players:"1人",time:"无限",status:"available"},{id:"tictactoe",title:"井字棋",description:"简单有趣的对战游戏",image:"❌",path:"/games/tictactoe",tags:["双人","策略","PVP"],difficulty:"简单",players:"1-2人",time:"2-5分钟",status:"available"},{id:"memory",title:"记忆翻牌",description:"考验记忆力的配对游戏",image:"🎴",path:"/games/memory",tags:["单人","益智","记忆"],difficulty:"简单",players:"1人",time:"5-10分钟",status:"available"},{id:"sudoku",title:"数独",description:"经典数字填空游戏",image:"🔢",path:"/games/sudoku",tags:["单人","益智","逻辑"],difficulty:"困难",players:"1人",time:"15-30分钟",status:"available"},{id:"breakout",title:"打砖块",description:"经典弹球消除游戏",image:"🧱",path:"/games/breakout",tags:["单人","休闲","经典"],difficulty:"中等",players:"1人",time:"10-20分钟",status:"available"}],Hd=()=>{const[e,t]=g.useState("全部"),{onlineCount:s,isConnected:n}=Ud(),o=["全部","双人","单人","策略","休闲","益智"],i=g.useMemo(()=>e==="全部"?Sr:Sr.filter(l=>l.tags.includes(e)),[e]),a=g.useMemo(()=>({available:i.filter(l=>l.status==="available").length,comingSoon:i.filter(l=>l.status==="coming-soon").length,onlineUsers:s}),[i,s]);return r.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[r.jsxs(q.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center space-y-4 sm:space-y-6",children:[r.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-game font-bold",children:r.jsx("span",{className:"bg-gradient-to-r from-purple-400 via-pink-400 to-red-400 bg-clip-text text-transparent",children:"游戏合集"})}),r.jsx("p",{className:"text-base sm:text-xl text-gray-400 font-game px-4",children:"精选经典小游戏，随时随地享受游戏乐趣"}),r.jsxs("div",{className:"flex justify-center gap-3 sm:gap-8 mt-6 sm:mt-8 px-4",children:[r.jsxs(q.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsx("div",{className:"text-xl sm:text-3xl font-bold text-purple-400",children:a.available}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"可玩游戏"})]}),r.jsxs(q.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsx("div",{className:"text-xl sm:text-3xl font-bold text-pink-400",children:a.comingSoon}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"即将推出"})]}),r.jsxs(q.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gray-800/50 backdrop-blur px-3 sm:px-6 py-3 sm:py-4 rounded-lg border border-gray-700 flex-1 max-w-[100px] sm:max-w-none",children:[r.jsxs("div",{className:"text-xl sm:text-3xl font-bold text-blue-400 flex items-center justify-center gap-1",children:[a.onlineUsers,n&&r.jsx("span",{className:"inline-block w-2 h-2 bg-green-400 rounded-full animate-pulse"})]}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-400",children:"在线玩家"})]})]})]}),r.jsx("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3 px-4",children:o.map((l,c)=>r.jsx(q.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:c*.1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(l),className:`px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all
              ${l===e?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white border border-gray-700"}`,children:l},l))}),r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:i.length>0?i.map((l,c)=>r.jsx(q.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:c*.1},children:r.jsx($d,{game:l})},l.id)):r.jsxs(q.div,{initial:{opacity:0},animate:{opacity:1},className:"col-span-full text-center py-12",children:[r.jsxs("p",{className:"text-gray-400 text-lg",children:['没有找到"',e,'"类型的游戏']}),r.jsx("button",{onClick:()=>t("全部"),className:"mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"查看全部游戏"})]})}),r.jsxs(q.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-12 sm:mt-16 grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6",children:[r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"🎮"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-purple-400",children:"精选游戏"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"精心挑选的经典游戏，保证游戏质量和趣味性"})]}),r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"🌐"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-pink-400",children:"在线对战"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"支持实时在线对战，与好友一起享受游戏乐趣"})]}),r.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-gray-800/30 backdrop-blur rounded-lg border border-gray-700",children:[r.jsx("div",{className:"text-3xl sm:text-4xl",children:"📱"}),r.jsx("h3",{className:"text-base sm:text-lg font-game font-semibold text-blue-400",children:"跨平台"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"完美适配手机和电脑，随时随地开始游戏"})]})]})]})},Xs=13,Cr=["快乐的","聪明的","勇敢的","可爱的","厉害的","机智的","活泼的","霸气的","淡定的","优雅的","神秘的","幸运的","专注的","认真的","潇洒的","冷静的"],Tr=["熊猫","狐狸","老虎","狮子","兔子","猫咪","狗狗","猴子","企鹅","海豚","鲸鱼","老鹰","凤凰","龙龙","独角兽","考拉"],xt=()=>Array(Xs).fill(null).map(()=>Array(Xs).fill(0)),de=yi((e,t)=>({board:xt(),boardSize:Xs,currentPlayer:1,myColor:null,gameState:"waiting",winner:null,lastMove:null,winningLine:null,userRole:null,spectatorCount:0,myNickname:null,opponentNickname:null,history:[],canUndo:!1,score:{black:0,white:0},roundNumber:1,firstPlayer:1,roomId:null,isHost:!1,opponentName:null,notifications:[],initBoard:()=>{const{roundNumber:s}=t(),n=s%2===1?1:2;e({board:xt(),currentPlayer:n,winner:null,lastMove:null,winningLine:null,gameState:"waiting",history:[],canUndo:!1,firstPlayer:n})},makeMove:(s,n)=>{const{board:o,currentPlayer:i,gameState:a,myColor:l,boardSize:c,userRole:d}=t();if(a!=="playing"||d==="spectator"||i!==l||s<0||s>=c||n<0||n>=c||o[s][n]!==0)return!1;const u=o.map(x=>[...x]);u[s][n]=i;const h=t().checkWin(s,n,i),p=h!==null;return t().addHistory(i,{row:s,col:n}),e({board:u,lastMove:{row:s,col:n},currentPlayer:i===1?2:1,winner:p?i:null,winningLine:h,gameState:p?"finished":"playing",canUndo:!0}),p&&t().updateScore(i),!0},setPlayerColor:s=>{e({myColor:s})},setGameState:s=>{e({gameState:s})},setRoomInfo:(s,n)=>{e({roomId:s,isHost:n})},resetGame:()=>{e({board:xt(),currentPlayer:1,myColor:null,gameState:"waiting",winner:null,lastMove:null,winningLine:null,roomId:null,isHost:!1,history:[],canUndo:!1,opponentName:null,notifications:[],score:{black:0,white:0},roundNumber:1,firstPlayer:1,userRole:null,spectatorCount:0,myNickname:null,opponentNickname:null})},checkWin:(s,n,o)=>{const{board:i,boardSize:a}=t(),l=[[[0,1],[0,-1]],[[1,0],[-1,0]],[[1,1],[-1,-1]],[[1,-1],[-1,1]]];for(const c of l){const d=[{row:s,col:n}];for(const[u,h]of c){let p=s+u,x=n+h;for(;p>=0&&p<a&&x>=0&&x<a&&i[p][x]===o;)d.push({row:p,col:x}),p+=u,x+=h}if(d.length>=5)return d}return null},addNotification:(s,n)=>{const o={id:Math.random().toString(36).substr(2,9),type:s,message:n,timestamp:Date.now()};e(i=>({notifications:[...i.notifications,o]})),setTimeout(()=>{t().removeNotification(o.id)},5e3)},removeNotification:s=>{e(n=>({notifications:n.notifications.filter(o=>o.id!==s)}))},updateScore:s=>{e(n=>({score:{...n.score,[s===1?"black":"white"]:n.score[s===1?"black":"white"]+1}}))},nextRound:()=>{e(s=>{const n=s.roundNumber+1,o=n%2===1?1:2;return{board:xt(),currentPlayer:o,winner:null,lastMove:null,winningLine:null,gameState:"playing",history:[],canUndo:!1,roundNumber:n,firstPlayer:o}})},setOpponentName:s=>{e({opponentName:s})},addHistory:(s,n)=>{e(o=>({history:[...o.history,{player:s,position:n,timestamp:Date.now()}]}))},setCanUndo:s=>{e({canUndo:s})},undoMove:()=>{const{history:s}=t();if(s.length<2)return;const n=s.slice(0,-2),o=xt();n.forEach(l=>{o[l.position.row][l.position.col]=l.player});const i=n.length>0?n[n.length-1].player===1?2:1:t().firstPlayer,a=n.length>0?n[n.length-1].position:null;e({board:o,history:n,currentPlayer:i,lastMove:a,canUndo:!1,winningLine:null})},setWinningLine:s=>{e({winningLine:s})},setUserRole:s=>{e({userRole:s})},setSpectatorCount:s=>{e({spectatorCount:s})},canMakeMove:()=>{const{userRole:s,myColor:n,currentPlayer:o,gameState:i}=t();return s==="player"&&n===o&&i==="playing"},setMyNickname:s=>{e({myNickname:s})},setOpponentNickname:s=>{e({opponentNickname:s})},generateRandomNickname:()=>{const s=Cr[Math.floor(Math.random()*Cr.length)],n=Tr[Math.floor(Math.random()*Tr.length)],o=Math.floor(Math.random()*100);return`${s}${n}${o}`}}));let Z=null,He=!1;const fs=()=>{const[e,t]=g.useState(He),{setGameState:s,setPlayerColor:n,initBoard:o,addNotification:i,nextRound:a,undoMove:l,setCanUndo:c,setWinningLine:d,setUserRole:u,userRole:h,setOpponentNickname:p}=de();return g.useEffect(()=>{if(Z)t(He);else{let A;A="http://socket.qingfengyueying.xyz",console.log("Attempting to connect to:",A),Z=Ys(A,{transports:["websocket","polling"],upgrade:!0,path:"/socket.io/",timeout:1e4,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),Z.on("connect",()=>{console.log("Socket connected to:",A),He=!0,t(!0)}),Z.on("disconnect",()=>{console.log("Socket disconnected"),He=!1,t(!1),i("warning","与服务器断开连接")}),Z.on("connect_error",v=>{console.error("Socket connection error:",v),He=!1,t(!1)}),Z.on("reconnect",v=>{console.log("Socket reconnected after",v,"attempts"),He=!0,t(!0),i("success","重新连接成功")}),Z.on("reconnect_error",v=>{console.error("Socket reconnection error:",v),He=!1,t(!1)}),Z.on("game-start",v=>{console.log("Game started, my color:",v.playerColor,"opponent:",v.opponentId),console.log("Before state update - gameState:",de.getState().gameState),v.opponentNickname&&p(v.opponentNickname),n(v.playerColor),o(),s("playing"),i("success","🎯 游戏开始！"),console.log("After state update - gameState:",de.getState().gameState),console.log("After state update - myColor:",de.getState().myColor)}),Z.on("game-start-spectator",v=>{console.log("Game started for spectator, black:",v.blackPlayer,"white:",v.whitePlayer),v.blackNickname&&v.whiteNickname,o(),s("playing"),i("info","🎯 游戏已开始，你正在观战")}),Z.on("role-changed",v=>{console.log("Role changed to:",v.role),u(v.role),v.role==="spectator"?(n(null),i("info","👁️ 你现在是观众")):i("success","🎮  你现在是玩家")}),Z.on("user-role-changed",v=>{v.wasSurrender?i("info","🏳️ 一位玩家认输并成为观众"):v.role==="player"?i("info","👥 一位观众成为了玩家"):i("info","👁️ 一位玩家成为了观众")}),Z.on("role-change-error",v=>{console.error("Role change error:",v.message),i("error",`❌ ${v.message}`)}),Z.on("ready-prompt",()=>{console.log("Ready prompt received"),Z&&Z.emit("ready-to-play")}),Z.on("game-move",v=>{console.log("Game move for spectator:",v);const T=de.getState();if(T.userRole!=="spectator")return;const I=T.board.map(j=>[...j]);I[v.row][v.col]=T.currentPlayer;const V=T.checkWin(v.row,v.col,T.currentPlayer),k=V!==null;T.addHistory(T.currentPlayer,{row:v.row,col:v.col}),de.setState({board:I,lastMove:{row:v.row,col:v.col},currentPlayer:T.currentPlayer===1?2:1,winner:k?T.currentPlayer:null,winningLine:V,gameState:k?"finished":"playing"}),k&&T.updateScore(T.currentPlayer)}),Z.on("room-created",v=>{console.log("Room created:",v),i("success",`✅ 房间 ${v.roomId} 创建成功`)}),Z.on("room-joined",v=>{console.log("Room joined:",v),i("success",`✅ 已加入房间 ${v.roomId}`),Z&&(console.log("Auto-readying for game start..."),Z.emit("ready-to-play"))}),Z.on("spectator-joined",v=>{console.log("Joined as spectator:",v),i("info",`👁️ 已以观众身份加入房间 ${v.roomId}`)}),Z.on("room-error",v=>{console.error("Room error:",v.message),i("error",`❌ ${v.message}`)}),Z.on("room-list",v=>{console.log("Room list updated:",v)}),Z.on("opponent-move",v=>{console.log("Opponent made move:",v);const T=de.getState();if(T.userRole!=="player")return;const I=T.board.map(j=>[...j]);I[v.row][v.col]=T.currentPlayer;const V=T.checkWin(v.row,v.col,T.currentPlayer),k=V!==null;T.addHistory(T.currentPlayer,{row:v.row,col:v.col}),de.setState({board:I,lastMove:{row:v.row,col:v.col},currentPlayer:T.currentPlayer===1?2:1,winner:k?T.currentPlayer:null,winningLine:V,gameState:k?"finished":"playing",canUndo:!0}),k&&T.updateScore(T.currentPlayer)}),Z.on("game-restart",()=>{console.log("Game restart - both players agreed"),a(),s("playing"),i("success","🎮 游戏已重新开始")}),Z.on("undo-move",()=>{console.log("Undo move - both players agreed"),l(),i("info","↩️ 已悔棋")}),Z.on("opponent-nickname",v=>{console.log("Received opponent nickname:",v.nickname),p(v.nickname)})}return()=>{}},[s,n,o,i,a,l,c,d,u,h,p]),{socket:Z,connected:e,sendMove:(A,v,T)=>{Z&&(console.log("Sending move:",{roomId:A,row:v,col:T}),Z.emit("make-move",{roomId:A,row:v,col:T}))},requestRestart:A=>{Z&&(console.log("Requesting restart:",A),Z.emit("request-restart",{roomId:A}))},acceptRestart:A=>{Z&&(console.log("Accepting restart:",A),Z.emit("accept-restart",{roomId:A}))},rejectRestart:A=>{Z&&(console.log("Rejecting restart:",A),Z.emit("reject-restart",{roomId:A}))},requestUndo:A=>{Z&&(console.log("Requesting undo:",A),Z.emit("request-undo",{roomId:A}))},acceptUndo:A=>{Z&&(console.log("Accepting undo:",A),Z.emit("accept-undo",{roomId:A}))},rejectUndo:A=>{Z&&(console.log("Rejecting undo:",A),Z.emit("reject-undo",{roomId:A}))},surrender:(A,v)=>{Z&&(console.log("Surrendering:",A,"myColor:",v),Z.emit("surrender",{roomId:A,surrenderColor:v}))},sendChatMessage:(A,v)=>{Z&&(console.log("Sending chat message:",{roomId:A,message:v}),Z.emit("chat-message",{roomId:A,message:v}))},spectatorToPlayer:()=>{Z&&(console.log("Requesting to become player"),Z.emit("spectator-to-player"))},playerToSpectator:()=>{Z&&(console.log("Requesting to become spectator"),Z.emit("player-to-spectator"))}}},kr=()=>{const e=g.useRef(null),t=g.useRef(null),s=g.useRef(null),[n,o]=g.useState(40),[i,a]=g.useState(520),[l,c]=g.useState(1),[d,u]=g.useState(null),{board:h,currentPlayer:p,gameState:x,makeMove:S,myColor:b,roomId:w,lastMove:D,winningLine:M}=de(),{sendMove:C}=fs(),B=h.length;g.useEffect(()=>{const m=()=>{const L=window.innerWidth,U=window.innerHeight,W=window.devicePixelRatio||1;if(L<640){const F=L-15,$=U-15-25-25-15,H=Math.min(F,$),X=Math.min(H,F*.95),Y=Math.floor(X/B),te=Y*B;o(Y),a(te),c(W),console.log("Mobile board size:",{viewport:{width:L,height:U},available:{width:F,height:$},target:X,cell:Y,board:te})}else{const R=U-30-35-30,F=Math.min(580,R*.9),$=180*2,H=L-$-60,X=Math.min(F,H,R*.9),Y=Math.floor(X/B),te=Y*B;o(Y),a(te),c(W),console.log("PC board size:",{viewport:{width:L,height:U},availableHeight:R,availableWidth:H,target:X,cell:Y,board:te})}};return m(),window.addEventListener("resize",m),window.addEventListener("orientationchange",m),()=>{window.removeEventListener("resize",m),window.removeEventListener("orientationchange",m)}},[B]);const E=(m,L)=>{const U=e.current,W=s.current;if(!U||!W)return null;const G=W.getBoundingClientRect(),y=window.getComputedStyle(W),f=parseInt(y.paddingLeft)||0,N=parseInt(y.paddingTop)||0,R=m-G.left-f,F=L-G.top-N,$=Math.floor(R/n),H=Math.floor(F/n);return H>=0&&H<B&&$>=0&&$<B?{row:H,col:$}:null},P=m=>{const L=i*l;m.clearRect(0,0,L,L),m.save(),m.scale(l,l);const U=m.createLinearGradient(0,0,i,i);U.addColorStop(0,"#D4A574"),U.addColorStop(.3,"#C19A6B"),U.addColorStop(.6,"#CD9B62"),U.addColorStop(1,"#B8956A"),m.fillStyle=U,m.fillRect(0,0,i,i),m.globalAlpha=.1;for(let G=0;G<50;G++){m.strokeStyle="#8B7355",m.lineWidth=Math.random()*2,m.beginPath();const y=Math.random()*i;m.moveTo(0,y),m.bezierCurveTo(i*.3,y+Math.random()*20-10,i*.7,y+Math.random()*20-10,i,y+Math.random()*10-5),m.stroke()}m.globalAlpha=1,m.shadowColor="rgba(0, 0, 0, 0.3)",m.shadowBlur=2,m.shadowOffsetX=1,m.shadowOffsetY=1,m.strokeStyle="#2C1810",m.lineWidth=1.5;for(let G=0;G<B;G++){const y=G*n+n/2;m.beginPath(),m.moveTo(n/2,y),m.lineTo(i-n/2,y),m.stroke(),m.beginPath(),m.moveTo(y,n/2),m.lineTo(y,i-n/2),m.stroke()}m.shadowColor="transparent",m.shadowBlur=0,m.shadowOffsetX=0,m.shadowOffsetY=0;const W=[{row:3,col:3},{row:3,col:9},{row:9,col:3},{row:9,col:9},{row:6,col:6}];m.fillStyle="#1A0E08",W.forEach(G=>{if(G.row<B&&G.col<B){const y=G.col*n+n/2,f=G.row*n+n/2;m.beginPath(),m.arc(y,f,5,0,Math.PI*2),m.fill(),m.fillStyle="#2C1810",m.beginPath(),m.arc(y,f,3,0,Math.PI*2),m.fill(),m.fillStyle="#1A0E08"}}),m.restore()},O=(m,L,U,W,G=!1)=>{const y=U*n+n/2,f=L*n+n/2,N=n*.42;if(m.save(),m.scale(l,l),W===1){const R=m.createRadialGradient(y-N/3,f-N/3,0,y,f,N);R.addColorStop(0,"#4A4A4A"),R.addColorStop(.5,"#2C2C2C"),R.addColorStop(.8,"#1A1A1A"),R.addColorStop(1,"#000000"),m.shadowColor="rgba(0, 0, 0, 0.5)",m.shadowBlur=5,m.shadowOffsetX=2,m.shadowOffsetY=2,m.fillStyle=R,m.beginPath(),m.arc(y,f,N,0,Math.PI*2),m.fill();const F=m.createRadialGradient(y-N/3,f-N/3,0,y-N/3,f-N/3,N/2);F.addColorStop(0,"rgba(255, 255, 255, 0.3)"),F.addColorStop(1,"rgba(255, 255, 255, 0)"),m.fillStyle=F,m.beginPath(),m.arc(y,f,N,0,Math.PI*2),m.fill()}else{const R=m.createRadialGradient(y-N/3,f-N/3,0,y,f,N);R.addColorStop(0,"#FFFFFF"),R.addColorStop(.3,"#F8F8F8"),R.addColorStop(.7,"#E8E8E8"),R.addColorStop(1,"#D0D0D0"),m.shadowColor="rgba(0, 0, 0, 0.3)",m.shadowBlur=4,m.shadowOffsetX=2,m.shadowOffsetY=2,m.fillStyle=R,m.beginPath(),m.arc(y,f,N,0,Math.PI*2),m.fill(),m.strokeStyle="#B0B0B0",m.lineWidth=1,m.stroke();const F=m.createRadialGradient(y-N/4,f-N/4,0,y-N/4,f-N/4,N/3);F.addColorStop(0,"rgba(255, 255, 255, 0.9)"),F.addColorStop(1,"rgba(255, 255, 255, 0)"),m.fillStyle=F,m.beginPath(),m.arc(y,f,N,0,Math.PI*2),m.fill()}G&&(m.shadowColor="#FFD700",m.shadowBlur=15,m.strokeStyle="#FFD700",m.lineWidth=3,m.beginPath(),m.arc(y,f,N+5,0,Math.PI*2),m.stroke()),m.restore()},A=m=>{if(!D)return;m.save(),m.scale(l,l);const L=D.col*n+n/2,U=D.row*n+n/2,W=n*.2,G=n*.35,y=Date.now()/1e3,f=Math.sin(y*3)*.1+.9;m.strokeStyle="#FF6B6B",m.lineWidth=3,m.lineCap="round",m.globalAlpha=f,[{dx:-1,dy:-1},{dx:1,dy:-1},{dx:1,dy:1},{dx:-1,dy:1}].forEach(R=>{m.beginPath(),m.moveTo(L+R.dx*G,U+R.dy*G),m.lineTo(L+R.dx*(G-W),U+R.dy*G),m.moveTo(L+R.dx*G,U+R.dy*G),m.lineTo(L+R.dx*G,U+R.dy*(G-W)),m.stroke()}),m.restore()},v=m=>{if(!M||M.length<5)return;m.save(),m.scale(l,l);const L=M[0],U=M[M.length-1],W=L.col*n+n/2,G=L.row*n+n/2,y=U.col*n+n/2,f=U.row*n+n/2,N=Date.now()/100,R=N%20;m.strokeStyle="#FFD700",m.lineWidth=4,m.lineCap="round",m.shadowColor="#FFD700",m.shadowBlur=20,m.setLineDash([10,10]),m.lineDashOffset=-R,m.beginPath(),m.moveTo(W,G),m.lineTo(y,f),m.stroke();const F=5;for(let $=0;$<F;$++){const H=(N/10+$*20)%100/100,X=W+(y-W)*H,Y=G+(f-G)*H;m.fillStyle="#FFD700",m.globalAlpha=1-H,m.beginPath(),m.arc(X,Y,3+H*5,0,Math.PI*2),m.fill()}m.restore()},T=m=>{if(!d||x!=="playing"||p!==b||h[d.row][d.col]!==0)return;const L=i*l;m.clearRect(0,0,L,L),m.save(),m.scale(l,l);const U=d.col*n+n/2,W=d.row*n+n/2,G=n*.42,y=Date.now()/1e3,f=Math.sin(y*4)*.1+.9;if(m.globalAlpha=.5,p===1){const N=m.createRadialGradient(U,W,0,U,W,G*f);N.addColorStop(0,"rgba(0, 0, 0, 0.8)"),N.addColorStop(1,"rgba(0, 0, 0, 0.4)"),m.fillStyle=N}else{const N=m.createRadialGradient(U,W,0,U,W,G*f);N.addColorStop(0,"rgba(255, 255, 255, 0.9)"),N.addColorStop(1,"rgba(255, 255, 255, 0.5)"),m.fillStyle=N}m.beginPath(),m.arc(U,W,G*f,0,Math.PI*2),m.fill(),m.strokeStyle=p===1?"rgba(0, 0, 0, 0.3)":"rgba(255, 255, 255, 0.5)",m.lineWidth=2,m.beginPath(),m.arc(U,W,G*f+5,0,Math.PI*2),m.stroke(),m.restore()};g.useEffect(()=>{const m=e.current,L=m==null?void 0:m.getContext("2d");if(!L||!m)return;m.width=i*l,m.height=i*l,P(L),h.forEach((G,y)=>{G.forEach((f,N)=>{if(f!==0){const R=(M==null?void 0:M.some(F=>F.row===y&&F.col===N))||!1;O(L,y,N,f,R)}})}),A(L),v(L);let U;const W=()=>{A(L),v(L),U=requestAnimationFrame(W)};return(D||M)&&W(),()=>{U&&cancelAnimationFrame(U)}},[h,n,i,D,M,l]),g.useEffect(()=>{const m=t.current,L=m==null?void 0:m.getContext("2d");if(!L||!m)return;m.width=i*l,m.height=i*l,T(L);let U;const W=()=>{T(L),U=requestAnimationFrame(W)};return W(),()=>{cancelAnimationFrame(U)}},[d,h,x,p,b,n,i,l]);const I=m=>{if(x!=="playing"||p!==b)return;const L="touches"in m?m.touches[0].clientX:m.clientX,U="touches"in m?m.touches[0].clientY:m.clientY,W=E(L,U);if(!W)return;const{row:G,col:y}=W;h[G][y]===0&&(S(G,y),C&&w&&C(w,G,y),u(null))},V=m=>{const L=E(m.clientX,m.clientY);u(L)},k=()=>{u(null)},j=m=>{I(m)};return r.jsx(q.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},className:"inline-block",children:r.jsxs("div",{ref:s,className:"relative pixel-container p-1 sm:p-2 bg-gradient-to-br from-amber-900/20 to-amber-800/20",onClick:I,onMouseMove:V,onMouseLeave:k,onTouchStart:j,style:{cursor:x==="playing"&&p===b?"pointer":"not-allowed"},children:[r.jsx("canvas",{ref:e,style:{width:`${i}px`,height:`${i}px`,display:"block",imageRendering:"crisp-edges"}}),r.jsx("canvas",{ref:t,className:"absolute top-1 left-1 sm:top-2 sm:left-2 pointer-events-none",style:{width:`${i}px`,height:`${i}px`,imageRendering:"crisp-edges"}})]})})},Gd=({onJoinRoom:e})=>{const[t,s]=g.useState(""),[n,o]=g.useState([]),[i,a]=g.useState(!1),{socket:l,connected:c}=fs(),{setRoomInfo:d,setUserRole:u,generateRandomNickname:h,setMyNickname:p}=de();console.log("RoomManager - connected:",c,"socket:",l),g.useEffect(()=>{if(l)return l.on("room-list",w=>{o(w)}),l.on("room-created",w=>{const D=h();p(D),l.emit("set-nickname",{roomId:w.roomId,nickname:D}),d(w.roomId,w.isHost),u("player"),e(),a(!1)}),l.on("room-joined",w=>{const D=h();p(D),l.emit("set-nickname",{roomId:w.roomId,nickname:D}),d(w.roomId,w.isHost),u("player"),e(),a(!1)}),l.on("spectator-joined",w=>{const D=h();p(D),l.emit("set-nickname",{roomId:w.roomId,nickname:D}),d(w.roomId,!1),u("spectator"),e(),a(!1)}),l.on("room-error",w=>{alert(w.message),a(!1)}),l.emit("get-rooms"),()=>{l.off("room-list"),l.off("room-created"),l.off("room-joined"),l.off("spectator-joined"),l.off("room-error")}},[l,e,d,u,h,p]);const x=()=>{if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("create-room")},S=w=>{const D=w||t.trim();if(!D){alert("请输入房间ID");return}if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("join-room",{roomId:D})},b=w=>{const D=w||t.trim();if(!D){alert("请输入房间ID");return}if(!l||!c){alert("未连接到服务器");return}a(!0),l.emit("join-as-spectator",{roomId:D})};return r.jsxs("div",{className:"space-y-3",children:[r.jsxs(q.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center",children:[r.jsx("h2",{className:"text-lg sm:text-xl font-game font-bold text-white",children:"五子棋房间管理"}),r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm",children:"创建新房间或加入现有房间开始游戏"})]}),r.jsxs(q.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-gray-800 rounded-lg p-3 sm:p-4 space-y-2",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-purple-400",children:"创建新房间"}),r.jsx("button",{onClick:x,disabled:i||!c,className:"w-full pixel-btn bg-purple-600 hover:bg-purple-700 py-1.5 text-xs sm:text-sm",children:i?"创建中...":"创建房间"})]}),r.jsx("div",{className:"border-t border-gray-700"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-pink-400",children:"加入房间"}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("input",{type:"text",value:t,onChange:w=>s(w.target.value.toUpperCase()),onKeyPress:w=>w.key==="Enter"&&S(),placeholder:"输入房间ID",className:"w-full px-2 py-1 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-pink-400 focus:outline-none text-xs sm:text-sm",maxLength:6}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>S(),disabled:i||!c,className:"flex-1 pixel-btn bg-pink-600 hover:bg-pink-700 py-1 px-3 text-xs sm:text-sm",children:"加入游戏"}),r.jsx("button",{onClick:()=>b(),disabled:i||!c,className:"flex-1 pixel-btn bg-yellow-600 hover:bg-yellow-700 py-1 px-3 text-xs sm:text-sm",children:"观战"})]})]})]}),r.jsx("div",{className:"border-t border-gray-700"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("h3",{className:"text-sm font-game text-blue-400",children:"可用房间"}),r.jsx("div",{className:"space-y-1 max-h-32 sm:max-h-40 overflow-y-auto custom-scrollbar",children:n.length===0?r.jsx("p",{className:"text-gray-500 text-center py-2 text-xs sm:text-sm",children:"暂无可用房间"}):n.map(w=>r.jsxs(q.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between p-1.5 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-pixel text-yellow-400 text-xs sm:text-sm",children:w.id}),r.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:[w.playerCount,"/2 玩家"]})]}),r.jsxs("div",{className:"flex gap-1",children:[w.playerCount<2&&r.jsx("button",{onClick:()=>S(w.id),disabled:i,className:"px-2 py-0.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors",children:"加入"}),r.jsx("button",{onClick:()=>b(w.id),disabled:i,className:"px-2 py-0.5 bg-yellow-600 hover:bg-yellow-700 text-white text-xs rounded transition-colors",children:"观战"})]})]},w.id))})]})]}),r.jsx("div",{className:"text-center",children:r.jsx("span",{className:`text-xs ${c?"text-green-400":"text-red-400"}`,children:c?"✓ 已连接到服务器":"✗ 未连接到服务器"})})]})},bt=({color:e,size:t="medium",isActive:s=!1,className:n=""})=>{const o={small:"w-7 h-7 text-xs",medium:"w-10 h-10 text-sm",large:"w-12 h-12 text-base"},i=l=>l===1?"🐼":l===2?"🦊":"👤",a=l=>l===1?"bg-gradient-to-br from-gray-800 to-black text-white":l===2?"bg-gradient-to-br from-white to-gray-200 text-gray-800 border-2 border-gray-400":"bg-gray-600 text-gray-400";return r.jsxs(q.div,{className:ae(o[t],a(e),"rounded-full flex items-center justify-center shadow-lg font-bold relative",n),animate:s?{scale:[1,1.1,1]}:{},transition:s?{repeat:1/0,duration:2}:{},children:[r.jsx("span",{className:t==="small"?"text-sm":"text-lg",children:i(e)}),s&&r.jsx(q.div,{className:"absolute -bottom-1 -right-1 w-2.5 h-2.5 bg-green-400 rounded-full border-2 border-gray-900",animate:{scale:[.8,1.2,.8]},transition:{repeat:1/0,duration:1.5}}),r.jsx("div",{className:ae("absolute -top-1 -right-1 rounded-full shadow-md",t==="small"?"w-3 h-3":"w-4 h-4",e===1?"bg-gradient-to-br from-gray-700 to-black":e===2?"bg-gradient-to-br from-white to-gray-300 border border-gray-400":"hidden")})]})},Ps=({side:e})=>{const{currentPlayer:t,gameState:s,myColor:n,score:o,roundNumber:i,winner:a,userRole:l,myNickname:c,opponentNickname:d}=de(),u=l==="spectator",h=u?1:n,p=u||n===1?2:n===2?1:null;return e==="left"?r.jsx("div",{className:"pixel-container bg-gradient-to-b from-gray-800/50 to-gray-900/50 p-2 w-44",children:r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("div",{className:`text-xs font-bold text-white px-2 py-0.5 rounded ${u?"bg-gray-600/20":"bg-green-600/20"}`,children:u?"黑方":"你的棋子"}),r.jsx(bt,{color:h,size:"medium",isActive:s==="playing"&&t===h}),!u&&c&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:c}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:`w-4 h-4 rounded-full shadow-lg ${h===1?"bg-gradient-to-br from-gray-800 to-black":h===2?"bg-gradient-to-br from-white to-gray-200 border border-gray-400":"bg-gray-600"}`}),r.jsx("span",{className:"text-sm font-game text-white",children:h===1?"黑棋":h===2?"白棋":"未定"})]}),r.jsxs("div",{className:"text-xs text-gray-300",children:["得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:h===1?o.black:h===2?o.white:0})]}),!u&&s==="playing"&&t===n&&r.jsx(q.div,{className:"text-green-400 font-pixel text-xs bg-green-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"🎯 你的回合"}),u&&s==="playing"&&t===1&&r.jsx(q.div,{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"黑棋思考中"}),u&&s==="waiting"&&r.jsx(q.div,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待开局"}),u&&s==="finished"&&a===1&&r.jsx(q.div,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:"⚫ 黑棋获胜"})]})}):e==="right"?r.jsx("div",{className:"pixel-container bg-gradient-to-b from-gray-800/50 to-gray-900/50 p-2 w-44",children:r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("div",{className:"text-xs text-gray-400",children:u?"白方":"对手棋子"}),r.jsx(bt,{color:p,size:"medium",isActive:s==="playing"&&t===p}),!u&&d&&r.jsx("div",{className:"text-xs text-yellow-300 font-game truncate max-w-full px-1",children:d}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:`w-4 h-4 rounded-full shadow-lg ${p===1?"bg-gradient-to-br from-gray-800 to-black":p===2?"bg-gradient-to-br from-white to-gray-200 border border-gray-400":"bg-gray-600"}`}),r.jsx("span",{className:"text-sm font-game text-white",children:p===1?"黑棋":p===2?"白棋":"未定"})]}),r.jsxs("div",{className:"text-xs text-gray-300",children:["得分: ",r.jsx("span",{className:"text-yellow-400 font-bold",children:p===1?o.black:p===2?o.white:0})]}),r.jsxs("div",{className:"text-gray-400 font-game bg-gray-800/50 px-2 py-0.5 rounded text-xs",children:["第 ",i," 回合"]}),s==="waiting"&&!u&&r.jsx(q.span,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待对手..."}),s==="waiting"&&u&&r.jsx(q.span,{className:"text-yellow-400 font-pixel text-xs bg-yellow-400/10 px-2 py-0.5 rounded animate-pulse",animate:{opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2},children:"等待开局..."}),s==="playing"&&!u&&t!==n&&r.jsx("span",{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded",children:"对手思考中..."}),s==="playing"&&u&&t===2&&r.jsx(q.div,{className:"text-blue-400 font-pixel text-xs bg-blue-400/10 px-2 py-0.5 rounded animate-pulse",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:1.5},children:"白棋思考中"}),s==="finished"&&!u&&r.jsx(q.span,{className:`font-pixel text-xs px-2 py-0.5 rounded ${a===n?"text-yellow-400 bg-yellow-400/10 animate-glow":"text-gray-400 bg-gray-400/10"}`,initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:a===n?"🎉 你赢了！":"💪 再接再厉"}),s==="finished"&&u&&r.jsx(q.span,{className:"text-yellow-400 bg-yellow-400/10 font-pixel text-xs px-2 py-0.5 rounded",initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:a===1?"⚫ 黑棋获胜":"⚪ 白棋获胜"})]})}):r.jsx(r.Fragment,{children:r.jsx("div",{className:"sm:hidden",children:r.jsxs("div",{className:"flex items-center justify-between px-1 py-0.5",children:[r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsx(bt,{color:u?1:n,size:"small",isActive:s==="playing"&&t===(u?1:n)}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[8px] text-gray-400",children:u?"黑方":"你"}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsx("span",{className:"font-game text-xs text-white",children:u||n===1?"黑":n===2?"白":"-"}),r.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",u||n===1?o.black:n===2?o.white:0,")"]})]})]})]}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:"text-[9px] text-gray-400 font-pixel",children:["第",i,"回合"]}),r.jsxs("div",{className:"text-[9px] mt-0",children:[s==="waiting"&&!u&&r.jsx("span",{className:"text-yellow-400 font-pixel animate-pulse",children:"等待对手"}),s==="waiting"&&u&&r.jsx("span",{className:"text-yellow-400 font-pixel animate-pulse",children:"等待开局"}),s==="playing"&&!u&&t===n&&r.jsx("span",{className:"text-green-400 font-pixel animate-pulse",children:"你的回合"}),s==="playing"&&!u&&t!==n&&r.jsx("span",{className:"text-blue-400 font-pixel",children:"对手思考"}),s==="playing"&&u&&r.jsx("span",{className:"text-blue-400 font-pixel",children:t===1?"黑棋思考":"白棋思考"}),s==="finished"&&r.jsx("span",{className:u||a===n?"text-yellow-400":"text-gray-400",children:u?a===1?"黑棋胜":"白棋胜":a===n?"你赢了":"再接再厉"})]})]}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[8px] text-gray-400",children:u?"白方":"对手"}),r.jsxs("div",{className:"flex items-center gap-0.5",children:[r.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",u?o.white:p===1?o.black:p===2?o.white:0,")"]}),r.jsx("span",{className:"font-game text-xs text-white",children:u?"白":p===1?"黑":p===2?"白":"-"})]})]}),r.jsx(bt,{color:u?2:p,size:"small",isActive:s==="playing"&&t===(u?2:p)})]})]})})})},_d=()=>{const{notifications:e,removeNotification:t}=de();return r.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 pointer-events-none",children:r.jsx(be,{children:e.map(s=>r.jsx(q.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},transition:{duration:.3},className:ae("pixel-container p-3 min-w-[200px] max-w-[300px] pointer-events-auto cursor-pointer","backdrop-blur-sm shadow-lg",{"bg-blue-600/90 border-blue-400":s.type==="info","bg-green-600/90 border-green-400":s.type==="success","bg-yellow-600/90 border-yellow-400":s.type==="warning","bg-red-600/90 border-red-400":s.type==="error"}),onClick:()=>t(s.id),children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("div",{className:"text-white",children:[s.type==="info"&&"📢",s.type==="success"&&"✅",s.type==="warning"&&"⚠️",s.type==="error"&&"❌"]}),r.jsx("p",{className:"text-white text-sm font-game flex-1",children:s.message})]})},s.id))})})};var Vt={};(function e(t,s,n,o){var i=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",l=function(){if(!t.OffscreenCanvas)return!1;var y=new OffscreenCanvas(1,1),f=y.getContext("2d");f.fillRect(0,0,1,1);var N=y.transferToImageBitmap();try{f.createPattern(N,"no-repeat")}catch{return!1}return!0}();function c(){}function d(y){var f=s.exports.Promise,N=f!==void 0?f:t.Promise;return typeof N=="function"?new N(y):(y(c,c),null)}var u=function(y,f){return{transform:function(N){if(y)return N;if(f.has(N))return f.get(N);var R=new OffscreenCanvas(N.width,N.height),F=R.getContext("2d");return F.drawImage(N,0,0),f.set(N,R),R},clear:function(){f.clear()}}}(l,new Map),h=function(){var y=Math.floor(16.666666666666668),f,N,R={},F=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(f=function($){var H=Math.random();return R[H]=requestAnimationFrame(function X(Y){F===Y||F+y-1<Y?(F=Y,delete R[H],$()):R[H]=requestAnimationFrame(X)}),H},N=function($){R[$]&&cancelAnimationFrame(R[$])}):(f=function($){return setTimeout($,y)},N=function($){return clearTimeout($)}),{frame:f,cancel:N}}(),p=function(){var y,f,N={};function R(F){function $(H,X){F.postMessage({options:H||{},callback:X})}F.init=function(X){var Y=X.transferControlToOffscreen();F.postMessage({canvas:Y},[Y])},F.fire=function(X,Y,te){if(f)return $(X,null),f;var z=Math.random().toString(36).slice(2);return f=d(function(K){function _(Q){Q.data.callback===z&&(delete N[z],F.removeEventListener("message",_),f=null,u.clear(),te(),K())}F.addEventListener("message",_),$(X,z),N[z]=_.bind(null,{data:{callback:z}})}),f},F.reset=function(){F.postMessage({reset:!0});for(var X in N)N[X](),delete N[X]}}return function(){if(y)return y;if(!n&&i){var F=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{y=new Worker(URL.createObjectURL(new Blob([F])))}catch($){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",$),null}R(y)}return y}}(),x={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function S(y,f){return f?f(y):y}function b(y){return y!=null}function w(y,f,N){return S(y&&b(y[f])?y[f]:x[f],N)}function D(y){return y<0?0:Math.floor(y)}function M(y,f){return Math.floor(Math.random()*(f-y))+y}function C(y){return parseInt(y,16)}function B(y){return y.map(E)}function E(y){var f=String(y).replace(/[^0-9a-f]/gi,"");return f.length<6&&(f=f[0]+f[0]+f[1]+f[1]+f[2]+f[2]),{r:C(f.substring(0,2)),g:C(f.substring(2,4)),b:C(f.substring(4,6))}}function P(y){var f=w(y,"origin",Object);return f.x=w(f,"x",Number),f.y=w(f,"y",Number),f}function O(y){y.width=document.documentElement.clientWidth,y.height=document.documentElement.clientHeight}function A(y){var f=y.getBoundingClientRect();y.width=f.width,y.height=f.height}function v(y){var f=document.createElement("canvas");return f.style.position="fixed",f.style.top="0px",f.style.left="0px",f.style.pointerEvents="none",f.style.zIndex=y,f}function T(y,f,N,R,F,$,H,X,Y){y.save(),y.translate(f,N),y.rotate($),y.scale(R,F),y.arc(0,0,1,H,X,Y),y.restore()}function I(y){var f=y.angle*(Math.PI/180),N=y.spread*(Math.PI/180);return{x:y.x,y:y.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:y.startVelocity*.5+Math.random()*y.startVelocity,angle2D:-f+(.5*N-Math.random()*N),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:y.color,shape:y.shape,tick:0,totalTicks:y.ticks,decay:y.decay,drift:y.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:y.gravity*3,ovalScalar:.6,scalar:y.scalar,flat:y.flat}}function V(y,f){f.x+=Math.cos(f.angle2D)*f.velocity+f.drift,f.y+=Math.sin(f.angle2D)*f.velocity+f.gravity,f.velocity*=f.decay,f.flat?(f.wobble=0,f.wobbleX=f.x+10*f.scalar,f.wobbleY=f.y+10*f.scalar,f.tiltSin=0,f.tiltCos=0,f.random=1):(f.wobble+=f.wobbleSpeed,f.wobbleX=f.x+10*f.scalar*Math.cos(f.wobble),f.wobbleY=f.y+10*f.scalar*Math.sin(f.wobble),f.tiltAngle+=.1,f.tiltSin=Math.sin(f.tiltAngle),f.tiltCos=Math.cos(f.tiltAngle),f.random=Math.random()+2);var N=f.tick++/f.totalTicks,R=f.x+f.random*f.tiltCos,F=f.y+f.random*f.tiltSin,$=f.wobbleX+f.random*f.tiltCos,H=f.wobbleY+f.random*f.tiltSin;if(y.fillStyle="rgba("+f.color.r+", "+f.color.g+", "+f.color.b+", "+(1-N)+")",y.beginPath(),a&&f.shape.type==="path"&&typeof f.shape.path=="string"&&Array.isArray(f.shape.matrix))y.fill(U(f.shape.path,f.shape.matrix,f.x,f.y,Math.abs($-R)*.1,Math.abs(H-F)*.1,Math.PI/10*f.wobble));else if(f.shape.type==="bitmap"){var X=Math.PI/10*f.wobble,Y=Math.abs($-R)*.1,te=Math.abs(H-F)*.1,z=f.shape.bitmap.width*f.scalar,K=f.shape.bitmap.height*f.scalar,_=new DOMMatrix([Math.cos(X)*Y,Math.sin(X)*Y,-Math.sin(X)*te,Math.cos(X)*te,f.x,f.y]);_.multiplySelf(new DOMMatrix(f.shape.matrix));var Q=y.createPattern(u.transform(f.shape.bitmap),"no-repeat");Q.setTransform(_),y.globalAlpha=1-N,y.fillStyle=Q,y.fillRect(f.x-z/2,f.y-K/2,z,K),y.globalAlpha=1}else if(f.shape==="circle")y.ellipse?y.ellipse(f.x,f.y,Math.abs($-R)*f.ovalScalar,Math.abs(H-F)*f.ovalScalar,Math.PI/10*f.wobble,0,2*Math.PI):T(y,f.x,f.y,Math.abs($-R)*f.ovalScalar,Math.abs(H-F)*f.ovalScalar,Math.PI/10*f.wobble,0,2*Math.PI);else if(f.shape==="star")for(var ee=Math.PI/2*3,re=4*f.scalar,he=8*f.scalar,ge=f.x,we=f.y,Me=5,je=Math.PI/Me;Me--;)ge=f.x+Math.cos(ee)*he,we=f.y+Math.sin(ee)*he,y.lineTo(ge,we),ee+=je,ge=f.x+Math.cos(ee)*re,we=f.y+Math.sin(ee)*re,y.lineTo(ge,we),ee+=je;else y.moveTo(Math.floor(f.x),Math.floor(f.y)),y.lineTo(Math.floor(f.wobbleX),Math.floor(F)),y.lineTo(Math.floor($),Math.floor(H)),y.lineTo(Math.floor(R),Math.floor(f.wobbleY));return y.closePath(),y.fill(),f.tick<f.totalTicks}function k(y,f,N,R,F){var $=f.slice(),H=y.getContext("2d"),X,Y,te=d(function(z){function K(){X=Y=null,H.clearRect(0,0,R.width,R.height),u.clear(),F(),z()}function _(){n&&!(R.width===o.width&&R.height===o.height)&&(R.width=y.width=o.width,R.height=y.height=o.height),!R.width&&!R.height&&(N(y),R.width=y.width,R.height=y.height),H.clearRect(0,0,R.width,R.height),$=$.filter(function(Q){return V(H,Q)}),$.length?X=h.frame(_):K()}X=h.frame(_),Y=K});return{addFettis:function(z){return $=$.concat(z),te},canvas:y,promise:te,reset:function(){X&&h.cancel(X),Y&&Y()}}}function j(y,f){var N=!y,R=!!w(f||{},"resize"),F=!1,$=w(f,"disableForReducedMotion",Boolean),H=i&&!!w(f||{},"useWorker"),X=H?p():null,Y=N?O:A,te=y&&X?!!y.__confetti_initialized:!1,z=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,K;function _(ee,re,he){for(var ge=w(ee,"particleCount",D),we=w(ee,"angle",Number),Me=w(ee,"spread",Number),je=w(ee,"startVelocity",Number),Et=w(ee,"decay",Number),et=w(ee,"gravity",Number),ze=w(ee,"drift",Number),$e=w(ee,"colors",B),tt=w(ee,"ticks",Number),ht=w(ee,"shapes"),Lt=w(ee,"scalar"),It=!!w(ee,"flat"),ft=P(ee),mt=ge,st=[],me=y.width*ft.x,ms=y.height*ft.y;mt--;)st.push(I({x:me,y:ms,angle:we,spread:Me,startVelocity:je,color:$e[mt%$e.length],shape:ht[M(0,ht.length)],ticks:tt,decay:Et,gravity:et,drift:ze,scalar:Lt,flat:It}));return K?K.addFettis(st):(K=k(y,st,Y,re,he),K.promise)}function Q(ee){var re=$||w(ee,"disableForReducedMotion",Boolean),he=w(ee,"zIndex",Number);if(re&&z)return d(function(je){je()});N&&K?y=K.canvas:N&&!y&&(y=v(he),document.body.appendChild(y)),R&&!te&&Y(y);var ge={width:y.width,height:y.height};X&&!te&&X.init(y),te=!0,X&&(y.__confetti_initialized=!0);function we(){if(X){var je={getBoundingClientRect:function(){if(!N)return y.getBoundingClientRect()}};Y(je),X.postMessage({resize:{width:je.width,height:je.height}});return}ge.width=ge.height=null}function Me(){K=null,R&&(F=!1,t.removeEventListener("resize",we)),N&&y&&(document.body.contains(y)&&document.body.removeChild(y),y=null,te=!1)}return R&&!F&&(F=!0,t.addEventListener("resize",we,!1)),X?X.fire(ee,ge,Me):_(ee,ge,Me)}return Q.reset=function(){X&&X.reset(),K&&K.reset()},Q}var m;function L(){return m||(m=j(null,{useWorker:!0,resize:!0})),m}function U(y,f,N,R,F,$,H){var X=new Path2D(y),Y=new Path2D;Y.addPath(X,new DOMMatrix(f));var te=new Path2D;return te.addPath(Y,new DOMMatrix([Math.cos(H)*F,Math.sin(H)*F,-Math.sin(H)*$,Math.cos(H)*$,N,R])),te}function W(y){if(!a)throw new Error("path confetti are not supported in this browser");var f,N;typeof y=="string"?f=y:(f=y.path,N=y.matrix);var R=new Path2D(f),F=document.createElement("canvas"),$=F.getContext("2d");if(!N){for(var H=1e3,X=H,Y=H,te=0,z=0,K,_,Q=0;Q<H;Q+=2)for(var ee=0;ee<H;ee+=2)$.isPointInPath(R,Q,ee,"nonzero")&&(X=Math.min(X,Q),Y=Math.min(Y,ee),te=Math.max(te,Q),z=Math.max(z,ee));K=te-X,_=z-Y;var re=10,he=Math.min(re/K,re/_);N=[he,0,0,he,-Math.round(K/2+X)*he,-Math.round(_/2+Y)*he]}return{type:"path",path:f,matrix:N}}function G(y){var f,N=1,R="#000000",F='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof y=="string"?f=y:(f=y.text,N="scalar"in y?y.scalar:N,F="fontFamily"in y?y.fontFamily:F,R="color"in y?y.color:R);var $=10*N,H=""+$+"px "+F,X=new OffscreenCanvas($,$),Y=X.getContext("2d");Y.font=H;var te=Y.measureText(f),z=Math.ceil(te.actualBoundingBoxRight+te.actualBoundingBoxLeft),K=Math.ceil(te.actualBoundingBoxAscent+te.actualBoundingBoxDescent),_=2,Q=te.actualBoundingBoxLeft+_,ee=te.actualBoundingBoxAscent+_;z+=_+_,K+=_+_,X=new OffscreenCanvas(z,K),Y=X.getContext("2d"),Y.font=H,Y.fillStyle=R,Y.fillText(f,Q,ee);var re=1/N;return{type:"bitmap",bitmap:X.transferToImageBitmap(),matrix:[re,0,0,re,-z*re/2,-K*re/2]}}s.exports=function(){return L().apply(this,arguments)},s.exports.reset=function(){L().reset()},s.exports.create=j,s.exports.shapeFromPath=W,s.exports.shapeFromText=G})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Vt,!1);const Wd=Vt.exports;Vt.exports.create;const qd=({isOpen:e,onRestart:t,onClose:s,waitingForOpponent:n=!1})=>{const{winner:o,myColor:i,score:a,userRole:l}=de(),c=o===i,d=l==="spectator";return console.log("GameOverModal - winner:",o,"myColor:",i,"isWinner:",c,"userRole:",l),g.useEffect(()=>{if(e&&c&&!n&&!d){const u=()=>{Wd({particleCount:100,spread:70,origin:{y:.6}})};u();const h=setTimeout(u,200),p=setTimeout(u,400);return()=>{clearTimeout(h),clearTimeout(p)}}},[e,c,n,d]),r.jsx(be,{children:e&&r.jsxs(r.Fragment,{children:[r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",onClick:n?void 0:s}),r.jsx(q.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:400},className:"fixed inset-0 flex items-center justify-center z-50 p-4",onClick:u=>u.stopPropagation(),children:r.jsx("div",{className:"pixel-container bg-gray-900 p-6 sm:p-8 max-w-md w-full",children:n?r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-yellow-400 mx-auto"})}),r.jsx("h2",{className:"text-2xl font-game font-bold text-yellow-400 mb-4",children:"等待对手..."}),r.jsx("p",{className:"text-gray-300 mb-6",children:"已发送再来一局请求，等待对手同意"})]}):r.jsxs(r.Fragment,{children:[r.jsx(q.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"text-center mb-6",children:d?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-6xl mb-4",children:"🎮"}),r.jsx("h2",{className:"text-3xl font-game font-bold text-yellow-400 mb-2",children:"游戏结束"}),r.jsx("p",{className:"text-gray-300 text-xl",children:o===1?"黑棋获胜！":o===2?"白棋获胜！":"平局！"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-6xl mb-4",children:c?"🏆":"💪"}),r.jsx("h2",{className:ae("text-3xl font-game font-bold mb-2",c?"text-yellow-400 animate-glow":"text-gray-400"),children:c?"恭喜胜利！":"再接再厉！"}),r.jsx("p",{className:"text-gray-300",children:c?"你赢得了这局比赛！":"别灰心，下局再战！"})]})}),r.jsxs(q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:[r.jsx("div",{className:"text-center text-sm text-gray-400 mb-2",children:"当前比分"}),r.jsxs("div",{className:"flex items-center justify-center gap-6",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-800 to-black rounded-full shadow-lg"}),r.jsx("span",{className:"font-game text-2xl text-white",children:a.black})]}),r.jsx("div",{className:"text-gray-500 text-2xl",children:":"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-game text-2xl text-white",children:a.white}),r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-white to-gray-200 rounded-full border-2 border-gray-400 shadow-lg"})]})]}),r.jsx("div",{className:"text-center text-sm text-gray-400 mt-2",children:o===1?"黑棋获胜":o===2?"白棋获胜":"平局"})]}),r.jsxs("div",{className:"flex gap-3",children:[!d&&r.jsx(q.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"flex-1 pixel-btn bg-green-600 hover:bg-green-700 text-white py-3",children:"再来一局"}),r.jsx(q.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:s,className:ae("pixel-btn bg-gray-600 hover:bg-gray-700 text-white py-3",d?"w-full":"flex-1"),children:d?"关闭":"查看棋盘"})]})]})})})]})})},$t=({isOpen:e,title:t,message:s,confirmText:n="同意",cancelText:o="拒绝",onConfirm:i,onCancel:a})=>r.jsx(be,{children:e&&r.jsxs(r.Fragment,{children:[r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:a}),r.jsx(q.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",damping:25,stiffness:400},className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none px-4",children:r.jsxs("div",{className:"pixel-container bg-gray-900 p-4 sm:p-6 max-w-sm w-full pointer-events-auto",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-game font-bold text-yellow-400 mb-3",children:t}),r.jsx("p",{className:"text-gray-300 mb-6 text-sm sm:text-base",children:s}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:i,className:"flex-1 pixel-btn bg-green-600 hover:bg-green-700 text-white py-2 text-sm sm:text-base",children:n}),r.jsx("button",{onClick:a,className:"flex-1 pixel-btn bg-red-600 hover:bg-red-700 text-white py-2 text-sm sm:text-base",children:o})]})]})})]})}),Ut=({onSendMessage:e,userRole:t=null,className:s=""})=>{const[n,o]=g.useState(!1),[i,a]=g.useState("emoji"),l=["😊","😎","🤔","😅","😂","😭","👍","👎","👏","🙏","💪","✌️","🎉","🎯","💯","🔥","⚡","🌟","😤","😮","😲","🤯","😱","🙈"],u=t==="spectator"?["黑棋加油！你是最棒的！","白棋必胜！冲冲冲！","精彩！这局真是太精彩了！","黑棋这步棋下得妙啊！","白棋好厉害，学到了！","这是高手过招啊！","快看快看，要分胜负了！","黑棋稳住，马上就赢了！","白棋反击！还有机会！","太刺激了，我都紧张了！","这局势焦灼啊，谁都有机会","黑棋防守！要小心了！","白棋进攻！就是现在！","神仙打架，我等凡人观战","这棋局值得收藏学习","前排围观，吃瓜看戏🍿","支持黑棋，黑棋YYDS！","白棋粉丝团在此应援！","大家好，我是新来的观众","求解说，看不懂局势了"]:["你好呀！一起来玩吧～","承让承让，侥幸而已！","哇，这步棋真是绝了！","厉害厉害，我要认真了！","再来一局，刚才手滑了～","让你见识见识什么叫高手！","我等到花儿都谢了...","快点啊，我等到天都黑了","容我想想，这步很关键","这一步妙啊，学到了！","你是高手，我甘拜下风","加油加油，你可以的！","哎呀，失误了失误了","看我的绝杀！","友谊第一，比赛第二～","GG，精彩的对局！","别走，决战到天亮！","你这是在针对我吗？","稳住，我们能赢！","今天手感不太好啊..."],h=p=>{e(p),o(!1)};return r.jsxs("div",{className:"relative inline-flex items-center",children:[r.jsxs(q.button,{onClick:()=>o(!n),className:ae("pixel-btn bg-purple-600 hover:bg-purple-700 text-white",s||"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm"),whileHover:{scale:1.05},whileTap:{scale:.95},children:[r.jsx("span",{className:"hidden sm:inline",children:"💬 聊天"}),r.jsx("span",{className:"sm:hidden",children:"聊天"})]}),r.jsx(be,{children:n&&r.jsxs(r.Fragment,{children:[r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 z-40 sm:hidden",onClick:()=>o(!1)}),r.jsxs(q.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{type:"spring",damping:25,stiffness:400},className:ae("z-50","sm:absolute sm:bottom-full sm:mb-2 sm:left-1/2 sm:transform sm:-translate-x-1/2 sm:w-80","fixed inset-x-4 top-1/2 -translate-y-1/2 sm:inset-auto sm:translate-y-0","pixel-container bg-gray-900/100 backdrop-blur-sm p-3 sm:p-4","max-h-[300px] max-w-sm mx-auto"),children:[r.jsxs("div",{className:"flex gap-2 mb-3",children:[r.jsx("button",{onClick:()=>a("emoji"),className:ae("flex-1 px-3 py-1 rounded text-sm font-pixel transition-all",i==="emoji"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"表情"}),r.jsx("button",{onClick:()=>a("phrase"),className:ae("flex-1 px-3 py-1 rounded text-sm font-pixel transition-all",i==="phrase"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"短语"})]}),r.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar",children:i==="emoji"?r.jsx("div",{className:"grid grid-cols-6 gap-2",children:l.map((p,x)=>r.jsx(q.button,{onClick:()=>h(p),className:"text-2xl p-2 hover:bg-gray-700 rounded transition-colors",whileHover:{scale:1.2},whileTap:{scale:.9},children:p},x))}):r.jsx("div",{className:"space-y-1",children:u.map((p,x)=>r.jsx(q.button,{onClick:()=>h(p),className:"w-full text-left px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 rounded transition-colors",whileHover:{x:5},whileTap:{scale:.98},children:p},x))})}),r.jsx("div",{className:`hidden sm:block absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-0 h-0 
                border-l-8 border-l-transparent 
                border-r-8 border-r-transparent 
                border-t-8 border-t-gray-900`})]})]})})]})},Xd=({messages:e})=>{const[t,s]=g.useState([]),{myColor:n,gameState:o}=de();return g.useEffect(()=>{if(e.length>0){const i=e[e.length-1];s(a=>[...a,i]),setTimeout(()=>{s(a=>a.filter(l=>l.id!==i.id))},3e3)}},[e]),o==="waiting"?null:r.jsx(r.Fragment,{children:r.jsx(be,{children:t.map((i,a)=>{const l=i.isOpponent?n===1?2:1:n,c=i.isOpponent;return r.jsx(q.div,{initial:{opacity:0,scale:.3,x:-50,y:0},animate:{opacity:1,scale:1,x:0,y:-a*80},exit:{opacity:0,scale:0,y:-a*80-50},transition:{type:"spring",damping:20,stiffness:300,duration:.5},className:"fixed",style:{top:"50%",left:"20px",transform:"translateY(-50%)",zIndex:40+a},children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(q.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:r.jsx(bt,{color:l,size:"small",className:"pointer-events-auto"})}),r.jsxs(q.div,{className:"relative",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:[r.jsx("div",{className:`
                      px-4 py-2 rounded-2xl shadow-lg pointer-events-auto
                      max-w-[200px] sm:max-w-[250px] break-words
                      ${c?"bg-gradient-to-r from-blue-500 to-blue-600 text-white":"bg-gradient-to-r from-green-500 to-green-600 text-white"}
                    `,children:i.content.match(/^[\u{1F300}-\u{1FAD6}]$/u)?r.jsx("span",{className:"text-3xl",children:i.content}):r.jsx("span",{className:"text-sm font-medium",children:i.content})}),r.jsx("div",{className:`
                      absolute w-0 h-0 
                      left-0 -ml-2 
                      border-t-8 border-t-transparent 
                      border-b-8 border-b-transparent 
                      border-r-8 
                      ${c?"border-r-blue-500":"border-r-green-500"}
                    `,style:{top:"50%",transform:"translateY(-50%)"}})]})]})},i.id)})})})},Kd=()=>{const[e,t]=g.useState(!1),[s,n]=g.useState(!0),[o,i]=g.useState(!0),[a,l]=g.useState("prompt"),[c,d]=g.useState(""),u=g.useRef(null),h=g.useRef(new Map),p=g.useRef(null),{socket:x}=fs(),{roomId:S}=de();g.useEffect(()=>{(()=>{const O=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="[::1]",A=window.location.protocol==="https:"||O;return!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia?(i(!1),d("浏览器不支持音频功能"),!1):A?!0:(d("⚠️ 由于安全限制，语音功能仅在HTTPS或本地环境可用。请使用localhost访问或部署HTTPS证书。"),i(!1),!1)})()},[]);const b=g.useCallback(async()=>{if(!o)return"denied";try{if(navigator.permissions&&navigator.permissions.query){const P=await navigator.permissions.query({name:"microphone"});return l(P.state),P.addEventListener("change",()=>{l(P.state)}),P.state}}catch(P){console.warn("无法查询麦克风权限:",P)}return"prompt"},[o]);g.useEffect(()=>{if(!p.current){const P=document.createElement("div");P.id="voice-chat-audio-container",P.style.display="none",document.body.appendChild(P),p.current=P}return()=>{p.current&&(p.current.remove(),p.current=null)}},[]);const w=g.useCallback(P=>{const O=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]});return u.current&&u.current.getTracks().forEach(A=>{u.current&&O.addTrack(A,u.current)}),O.ontrack=A=>{console.log("收到远程音频流:",P);const[v]=A.streams,T=document.createElement("audio");T.srcObject=v,T.autoplay=!0,T.muted=!s,p.current&&p.current.appendChild(T);const I=h.current.get(P);I&&(I.stream=v,I.audioElement=T)},O.onicecandidate=A=>{A.candidate&&x&&S&&x.emit("voice-ice-candidate",{roomId:S,candidate:A.candidate,targetPeerId:P})},O.onconnectionstatechange=()=>{console.log(`连接状态 [${P}]:`,O.connectionState),(O.connectionState==="failed"||O.connectionState==="disconnected")&&D(P)},O},[x,S,s]),D=g.useCallback(P=>{const O=h.current.get(P);O&&(O.audioElement&&p.current&&p.current.removeChild(O.audioElement),O.connection.close(),h.current.delete(P))},[]),M=g.useCallback(async()=>{if(!o)return d("当前环境不支持语音功能"),!1;try{const P=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return u.current=P,t(!0),l("granted"),n(!0),x&&S&&x.emit("join-voice-channel",{roomId:S}),!0}catch(P){return console.error("无法获取麦克风权限:",P),P.name==="NotAllowedError"?(l("denied"),d("麦克风权限被拒绝，请在浏览器设置中允许麦克风访问")):P.name==="NotFoundError"?d("未找到麦克风设备"):P.name==="NotReadableError"?d("麦克风被其他应用占用"):d("无法访问麦克风: "+P.message),!1}},[o,x,S]),C=g.useCallback(()=>{u.current&&(u.current.getTracks().forEach(P=>P.stop()),u.current=null),t(!1),x&&S&&x.emit("leave-voice-channel",{roomId:S}),h.current.forEach((P,O)=>{D(O)})},[x,S,D]),B=g.useCallback(async()=>{e?C():await M()},[e,M,C]),E=g.useCallback(()=>{const P=!s;n(P),h.current.forEach(O=>{O.audioElement&&(O.audioElement.muted=!P)})},[s]);return g.useEffect(()=>{if(!x||!S)return;const P=async I=>{if(console.log("用户加入语音频道:",I.userId),u.current){const V=w(I.userId);h.current.set(I.userId,{peerId:I.userId,connection:V});const k=await V.createOffer();await V.setLocalDescription(k),x.emit("voice-offer",{roomId:S,offer:k,targetPeerId:I.userId})}},O=async I=>{console.log("收到语音offer:",I.fromPeerId);const V=w(I.fromPeerId);h.current.set(I.fromPeerId,{peerId:I.fromPeerId,connection:V}),await V.setRemoteDescription(I.offer);const k=await V.createAnswer();await V.setLocalDescription(k),x.emit("voice-answer",{roomId:S,answer:k,targetPeerId:I.fromPeerId})},A=async I=>{console.log("收到语音answer:",I.fromPeerId);const V=h.current.get(I.fromPeerId);V&&await V.connection.setRemoteDescription(I.answer)},v=async I=>{const V=h.current.get(I.fromPeerId);V&&await V.connection.addIceCandidate(I.candidate)},T=I=>{console.log("用户离开语音频道:",I.userId),D(I.userId)};return x.on("user-joined-voice",P),x.on("voice-offer",O),x.on("voice-answer",A),x.on("voice-ice-candidate",v),x.on("user-left-voice",T),()=>{x.off("user-joined-voice",P),x.off("voice-offer",O),x.off("voice-answer",A),x.off("voice-ice-candidate",v),x.off("user-left-voice",T)}},[x,S,w,D]),g.useEffect(()=>()=>{C()},[C]),{isMicEnabled:e,isSpeakerEnabled:s,isSupported:o,permissionStatus:a,errorMessage:c,toggleMic:B,toggleSpeaker:E,checkPermission:b}},Ht=({className:e})=>{const{isMicEnabled:t,isSpeakerEnabled:s,isSupported:n,permissionStatus:o,errorMessage:i,toggleMic:a,toggleSpeaker:l,checkPermission:c}=Kd(),{addNotification:d}=de();g.useEffect(()=>{c()},[c]),g.useEffect(()=>{i&&d("warning",i)},[i,d]);const u=async()=>{if(!n){d("warning","⚠️ 当前环境不支持语音功能，请使用HTTPS或localhost访问");return}if(o==="denied"){d("warning","⚠️ 麦克风权限被拒绝，请在浏览器设置中允许");return}await a()},h=()=>{!s&&!t&&d("info","💡 提示：单独开启喇叭可以听到其他人说话"),l()};return r.jsxs("div",{className:ae("flex gap-1",e),children:[r.jsxs(q.button,{onClick:u,disabled:!n,className:ae("pixel-btn relative transition-all",t?"bg-green-600 hover:bg-green-700":"bg-gray-600 hover:bg-gray-700",!n&&"opacity-50 cursor-not-allowed"),whileHover:{scale:n?1.05:1},whileTap:{scale:n?.95:1},title:n?t?"关闭麦克风":"开启麦克风":"语音功能不可用",children:[t?r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z",clipRule:"evenodd"})}):r.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:[r.jsx("path",{fillRule:"evenodd",d:"M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z",clipRule:"evenodd"}),r.jsx("path",{d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4z",opacity:"0.3"}),r.jsx("path",{d:"M11 14.93V17h3a1 1 0 110 2H6a1 1 0 110-2h3v-2.07A7.001 7.001 0 013 8a1 1 0 012 0 5 5 0 0010 0 1 1 0 112 0 7.001 7.001 0 01-6 6.93z",opacity:"0.3"})]}),t&&r.jsx(q.span,{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full",animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:2}})]}),r.jsx(q.button,{onClick:h,className:ae("pixel-btn relative transition-all",s?"bg-blue-600 hover:bg-blue-700":"bg-gray-600 hover:bg-gray-700"),whileHover:{scale:1.05},whileTap:{scale:.95},title:s?"关闭喇叭":"开启喇叭",children:s?r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}):r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),!n&&r.jsx("span",{className:"text-xs text-yellow-400 px-2 py-1",children:"⚠️ 需HTTPS"}),o==="denied"&&n&&r.jsx("span",{className:"text-xs text-red-400 px-2 py-1",children:"🚫 权限被拒"})]})},Yd=()=>{const[e,t]=g.useState(!1),[s,n]=g.useState(!1),[o,i]=g.useState(!1),[a,l]=g.useState(!1),[c,d]=g.useState(!1),[u,h]=g.useState(!1),[p,x]=g.useState(!1),[S,b]=g.useState(!1),[w,D]=g.useState(!1),[M,C]=g.useState([]),{gameState:B,roomId:E,resetGame:P,setRoomInfo:O,myColor:A,currentPlayer:v,canUndo:T,winner:I,addNotification:V,history:k,userRole:j}=de(),{socket:m,connected:L,requestRestart:U,acceptRestart:W,rejectRestart:G,requestUndo:y,acceptUndo:f,rejectUndo:N,surrender:R,sendChatMessage:F,spectatorToPlayer:$,playerToSpectator:H}=fs();console.log("GomokuGame - connected:",L,"isInRoom:",e),g.useEffect(()=>{B==="finished"&&I&&setTimeout(()=>{n(!0)},1e3)},[B,I]),g.useEffect(()=>{if(!m)return;const ze=()=>{B==="finished"?(D(!1),n(!1),E&&W(E),V("info","双方同意，游戏即将重新开始")):(i(!0),d(!0))},$e=()=>{D(!1),i(!1),V("warning","❌ 对手拒绝了重新开始请求")},tt=()=>{l(!0),h(!0)},ht=()=>{l(!1),V("warning","❌ 对手拒绝了悔棋请求")},Lt=()=>{n(!1),D(!1),i(!1),d(!1),C([])},It=me=>{console.log("Player joined room:",me.playerId),V("success","🎮 对手已加入房间"),m&&(console.log("Auto-readying for game start..."),m.emit("ready-to-play"))},ft=me=>{console.log("Player left room:",me.playerId),de.setState({gameState:"waiting"}),V("warning","⚠️ 对手已离开房间")},mt=me=>{console.log("Opponent surrendered, winner:",me.winner,"myColor:",A),me.winner!==A&&console.error("Winner color mismatch! Expected:",A,"Got:",me.winner),de.setState({gameState:"finished",winner:me.winner}),de.getState().updateScore(me.winner),V("success","🏳️ 对手认输，你赢了！"),setTimeout(()=>{n(!0)},500)},st=me=>{console.log("Received chat message:",me);const ms={id:Math.random().toString(36).substr(2,9),content:me.message,isOpponent:!0,timestamp:Date.now()};C(ui=>[...ui,ms])};return m.on("restart-request",ze),m.on("restart-rejected",$e),m.on("undo-request",tt),m.on("undo-rejected",ht),m.on("game-restart",Lt),m.on("player-joined",It),m.on("player-left",ft),m.on("opponent-surrender",mt),m.on("chat-message",st),()=>{m.off("restart-request",ze),m.off("restart-rejected",$e),m.off("undo-request",tt),m.off("undo-rejected",ht),m.off("game-restart",Lt),m.off("player-joined",It),m.off("player-left",ft),m.off("opponent-surrender",mt),m.off("chat-message",st)}},[m,E,W,V,B,A]);const X=ze=>{if(!E)return;F(E,ze);const $e={id:Math.random().toString(36).substr(2,9),content:ze,isOpponent:!1,timestamp:Date.now()};C(tt=>[...tt,$e])},Y=()=>{E&&(W(E),i(!1),d(!1),V("success","✅ 已同意重新开始"))},te=()=>{E&&G(E),i(!1),d(!1),V("info","❌ 已拒绝重新开始请求")},z=()=>{E&&(f(E),l(!1),h(!1),V("success","✅ 已同意悔棋"))},K=()=>{E&&N(E),l(!1),h(!1),V("info","❌ 已拒绝悔棋请求")},_=()=>{m&&E&&m.emit("leave-room",{roomId:E}),t(!1),P(),O(null,!1),D(!1),C([]),V("info","👋 已离开房间")},Q=()=>{if(console.log("Restart requested, gameState:",B,"waitingForOpponentRestart:",w),w){V("info","⏳ 正在等待对手同意...");return}m&&E&&(B==="finished"?(D(!0),U(E),V("info","⏳ 等待对手同意再来一局...")):(U(E),V("info","📨 已发送重新开始请求")))},ee=()=>{if(!T||v!==A||k.length<2){V("warning","⚠️ 当前不能悔棋");return}m&&E&&(y(E),V("info","📨 已发送悔棋请求，等待对手确认..."))},re=()=>{if(j!=="player"){V("warning","⚠️ 你已经是观众了");return}x(!0)},he=()=>{H(),x(!1),V("info","👁️ 你已转为观众")},ge=()=>{x(!1)},we=()=>{if(B!=="playing"||j!=="player"){V("warning","⚠️ 当前不能认输");return}b(!0)},Me=()=>{E&&A&&(R(E,A),V("info","🏳️ 你已认输")),b(!1)},je=()=>{b(!1)},Et=()=>{$()},et=!T||v!==A||B!=="playing"||a||k.length<2;return r.jsxs("div",{className:"relative",children:[r.jsx(_d,{}),e&&r.jsx(Xd,{messages:M}),r.jsx(qd,{isOpen:s,onRestart:Q,onClose:()=>n(!1),waitingForOpponent:w}),r.jsx($t,{isOpen:c,title:"重新开始请求",message:"对手请求重新开始游戏，是否同意？",confirmText:"同意",cancelText:"拒绝",onConfirm:Y,onCancel:te}),r.jsx($t,{isOpen:u,title:"悔棋请求",message:"对手请求悔棋，是否同意？",confirmText:"同意",cancelText:"拒绝",onConfirm:z,onCancel:K}),r.jsx($t,{isOpen:p,title:"到观众席确认",message:"确定要到观众席吗？你将成为观众。",confirmText:"确认",cancelText:"取消",onConfirm:he,onCancel:ge}),r.jsx($t,{isOpen:S,title:"认输确认",message:"确定要认输吗？你将输掉当前游戏。",confirmText:"确认认输",cancelText:"取消",onConfirm:Me,onCancel:je}),r.jsx(be,{mode:"wait",children:e?r.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex flex-col",children:[r.jsxs("div",{className:"hidden sm:flex flex-col",children:[r.jsxs("div",{className:"text-center py-0.5",children:[r.jsxs("h1",{className:"text-base font-game font-bold bg-gradient-to-r from-yellow-400 via-pink-400 to-purple-400 bg-clip-text text-transparent inline-flex items-center gap-2",children:["五子棋对战",j==="spectator"&&r.jsx("span",{className:"text-sm font-normal text-yellow-400",children:"（观战模式）"})]}),r.jsxs("p",{className:"text-gray-300 text-xs",children:["房间: ",r.jsx("span",{className:"text-yellow-400 font-pixel",children:E})]})]}),r.jsxs("div",{className:"flex justify-center px-4 pt-1",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Ps,{side:"left"})}),r.jsxs("div",{className:"mx-3 flex flex-col",children:[r.jsx(kr,{}),r.jsxs("div",{className:"flex justify-center gap-1.5 mt-1 pb-2",children:[j==="player"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Q,disabled:o||w,className:ae("pixel-btn text-xs px-2.5 py-1 transition-all",(o||w)&&"opacity-50 cursor-not-allowed"),children:w?"等待对手...":o?"等待确认...":"重新开始"}),r.jsx("button",{onClick:ee,disabled:et,className:ae("pixel-btn bg-blue-600 hover:bg-blue-700 text-xs px-2.5 py-1 transition-all",et&&"opacity-50 cursor-not-allowed hover:bg-blue-600"),children:a?"等待确认...":"悔棋"}),r.jsx(Ut,{onSendMessage:X,userRole:j,className:"text-xs px-2.5 py-1"}),r.jsx(Ht,{className:"text-xs px-2.5 py-1"}),r.jsx("button",{onClick:we,disabled:B!=="playing",className:ae("pixel-btn bg-red-600 hover:bg-red-700 text-xs px-2.5 py-1 transition-all",B!=="playing"&&"opacity-50 cursor-not-allowed hover:bg-red-600"),children:"认输"}),r.jsx("button",{onClick:re,className:"pixel-btn bg-yellow-600 hover:bg-yellow-700 text-xs px-2.5 py-1 transition-all",children:"到观众席"})]}):j==="spectator"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Et,className:"pixel-btn bg-green-600 hover:bg-green-700 text-xs px-2.5 py-1 transition-all",children:"成为玩家"}),r.jsx(Ut,{onSendMessage:X,userRole:j,className:"text-xs px-2.5 py-1"}),r.jsx(Ht,{className:"text-xs px-2.5 py-1"}),r.jsx("span",{className:"text-yellow-400 text-xs px-2 py-1",children:"👁️ 观战模式"})]}):null,r.jsx("button",{onClick:_,className:"pixel-btn bg-red-600 hover:bg-red-700 text-xs px-2.5 py-1 transition-all",children:"离开房间"})]})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Ps,{side:"right"})})]})]}),r.jsxs("div",{className:"sm:hidden flex flex-col",children:[r.jsx("div",{className:"text-center py-0.5",children:r.jsxs("h1",{className:"text-xs font-game font-bold text-yellow-400",children:["五子棋",j==="spectator"&&"(观战)"," - ",E]})}),r.jsx("div",{className:"px-1",children:r.jsx(Ps,{})}),r.jsxs("div",{className:"flex flex-col items-center pt-0.5",children:[r.jsx(kr,{}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-0.5 mt-0.5 px-1 pb-2",children:[j==="player"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Q,disabled:o||w,className:ae("pixel-btn text-[8px] px-1.5 py-0.5 transition-all",(o||w)&&"opacity-50 cursor-not-allowed"),children:w||o?"等待":"重开"}),r.jsx("button",{onClick:ee,disabled:et,className:ae("pixel-btn bg-blue-600 hover:bg-blue-700 text-[8px] px-1.5 py-0.5 transition-all",et&&"opacity-50 cursor-not-allowed hover:bg-blue-600"),children:a?"等待":"悔棋"}),r.jsx(Ut,{onSendMessage:X,userRole:j,className:"text-[8px] px-1.5 py-0.5"}),r.jsx(Ht,{className:"text-[8px] px-1.5 py-0.5"}),r.jsx("button",{onClick:we,disabled:B!=="playing",className:ae("pixel-btn bg-red-600 hover:bg-red-700 text-[8px] px-1.5 py-0.5 transition-all",B!=="playing"&&"opacity-50 cursor-not-allowed hover:bg-red-600"),children:"认输"}),r.jsx("button",{onClick:re,className:"pixel-btn bg-yellow-600 hover:bg-yellow-700 text-[8px] px-1.5 py-0.5 transition-all",children:"观众席"})]}):j==="spectator"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:Et,className:"pixel-btn bg-green-600 hover:bg-green-700 text-[8px] px-1.5 py-0.5 transition-all",children:"成玩家"}),r.jsx(Ut,{onSendMessage:X,userRole:j,className:"text-[8px] px-1.5 py-0.5"}),r.jsx(Ht,{className:"text-[8px] px-1.5 py-0.5"})]}):null,r.jsx("button",{onClick:_,className:"pixel-btn bg-red-600 hover:bg-red-700 text-[8px] px-1.5 py-0.5 transition-all",children:"离开"})]})]})]})]},"game"):r.jsx(q.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},className:"flex items-center justify-center px-4 py-2",children:r.jsx("div",{className:"w-full max-w-2xl",children:r.jsx(Gd,{onJoinRoom:()=>t(!0)})})},"room-manager")}),!L&&e&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed bottom-2 right-2 bg-orange-600 text-white px-2 py-1 rounded shadow-lg text-xs z-50",children:r.jsx("span",{className:"animate-pulse",children:"连接中..."})})]})};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Jd=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,s,n)=>n?n.toUpperCase():s.toLowerCase()),Pr=e=>{const t=Jd(e);return t.charAt(0).toUpperCase()+t.slice(1)},ai=(...e)=>e.filter((t,s,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===s).join(" ").trim(),Qd=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eu={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=g.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:o="",children:i,iconNode:a,...l},c)=>g.createElement("svg",{ref:c,...eu,width:t,height:t,stroke:e,strokeWidth:n?Number(s)*24/Number(t):s,className:ai("lucide",o),...!i&&!Qd(l)&&{"aria-hidden":"true"},...l},[...a.map(([d,u])=>g.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=(e,t)=>{const s=g.forwardRef(({className:n,...o},i)=>g.createElement(tu,{ref:i,iconNode:t,className:ai(`lucide-${Zd(Pr(e))}`,`lucide-${e}`,n),...o}));return s.displayName=Pr(e),s};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Je=ie("arrow-left",su);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ru=ie("chevron-down",nu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ou=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],iu=ie("chevron-left",ou);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],lu=ie("chevron-right",au);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],du=ie("circle-alert",cu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],li=ie("circle-check-big",uu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ms=ie("circle",hu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],mu=ie("copy",fu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],gu=ie("eraser",pu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],yu=ie("heart",xu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Mr=ie("lightbulb",vu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],wu=ie("monitor",bu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],ci=ie("pause",ju);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ns=ie("play",Nu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Qe=ie("rotate-ccw",Su);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cu=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Tu=ie("rotate-cw",Cu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ar=ie("sparkles",ku);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],di=ie("target",Pu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Au=ie("timer",Mu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Dt=ie("trophy",Ru);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Du=ie("users",Vu);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eu=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],As=ie("x",Eu),Lu=()=>{const e=Ke(),[t,s]=g.useState(()=>x()),[n,o]=g.useState(0),[i,a]=g.useState(()=>{const E=localStorage.getItem("2048-best-score");return E?parseInt(E):0}),[l,c]=g.useState(!1),[d,u]=g.useState(!1),[h,p]=g.useState(null);function x(){const E=Array(4).fill(null).map(()=>Array(4).fill(null));return S(E),S(E),E}function S(E){const P=[];for(let v=0;v<4;v++)for(let T=0;T<4;T++)E[v][T]===null&&P.push([v,T]);if(P.length===0)return!1;const[O,A]=P[Math.floor(Math.random()*P.length)];return E[O][A]=Math.random()<.9?2:4,!0}const b=g.useCallback(E=>{if(l||d)return;const P=t.map(T=>[...T]);let O=!1,A=0;const v=T=>{let I=T.filter(j=>j!==null),V=0,k=!1;for(let j=0;j<I.length-1;j++)I[j]===I[j+1]&&(I[j]=I[j]*2,V+=I[j],I.splice(j+1,1),k=!0);for(;I.length<4;)I.push(null);return JSON.stringify(T)!==JSON.stringify(I)&&(k=!0),[I,V,k]};if(E==="left")for(let T=0;T<4;T++){const[I,V,k]=v(P[T]);P[T]=I,A+=V,k&&(O=!0)}else if(E==="right")for(let T=0;T<4;T++){const I=[...P[T]].reverse(),[V,k,j]=v(I);P[T]=V.reverse(),A+=k,j&&(O=!0)}else if(E==="up")for(let T=0;T<4;T++){const I=[P[0][T],P[1][T],P[2][T],P[3][T]],[V,k,j]=v(I);for(let m=0;m<4;m++)P[m][T]=V[m];A+=k,j&&(O=!0)}else if(E==="down")for(let T=0;T<4;T++){const I=[P[3][T],P[2][T],P[1][T],P[0][T]],[V,k,j]=v(I);P[0][T]=V[3],P[1][T]=V[2],P[2][T]=V[1],P[3][T]=V[0],A+=k,j&&(O=!0)}if(O){S(P),s(P);const T=n+A;o(T),T>i&&(a(T),localStorage.setItem("2048-best-score",T.toString()));for(let I=0;I<4;I++)for(let V=0;V<4;V++)if(P[I][V]===2048){u(!0);return}w(P)||c(!0)}},[t,n,i,l,d]);function w(E){for(let P=0;P<4;P++)for(let O=0;O<4;O++)if(E[P][O]===null)return!0;for(let P=0;P<4;P++)for(let O=0;O<4;O++){const A=E[P][O];if(P<3&&A===E[P+1][O]||O<3&&A===E[P][O+1])return!0}return!1}g.useEffect(()=>{const E=P=>{P.key==="ArrowUp"?(P.preventDefault(),b("up")):P.key==="ArrowDown"?(P.preventDefault(),b("down")):P.key==="ArrowLeft"?(P.preventDefault(),b("left")):P.key==="ArrowRight"&&(P.preventDefault(),b("right"))};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[b]);const D=E=>{const P=E.touches[0];p({x:P.clientX,y:P.clientY})},M=E=>{if(!h)return;const P=E.changedTouches[0],O=P.clientX-h.x,A=P.clientY-h.y,v=50;Math.abs(O)>Math.abs(A)?Math.abs(O)>v&&(O>0?b("right"):b("left")):Math.abs(A)>v&&(A>0?b("down"):b("up")),p(null)},C=()=>{s(x()),o(0),c(!1),u(!1)},B=E=>E===null?"bg-gray-700":{2:"bg-gray-600",4:"bg-gray-500",8:"bg-orange-500",16:"bg-orange-600",32:"bg-red-500",64:"bg-red-600",128:"bg-yellow-500",256:"bg-yellow-600",512:"bg-green-500",1024:"bg-green-600",2048:"bg-purple-600"}[E]||"bg-purple-700";return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 p-4",children:r.jsxs("div",{className:"max-w-md mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("button",{onClick:()=>e("/"),className:"p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(Je,{size:24})}),r.jsx("h1",{className:"text-3xl font-bold text-white font-game",children:"2048"}),r.jsx("button",{onClick:C,className:"p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(Qe,{size:24})})]}),r.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[r.jsxs("div",{className:"bg-gray-800 px-4 py-2 rounded-lg",children:[r.jsx("div",{className:"text-gray-400 text-sm",children:"得分"}),r.jsx("div",{className:"text-white text-2xl font-bold",children:n})]}),r.jsxs("div",{className:"bg-gray-800 px-4 py-2 rounded-lg",children:[r.jsx("div",{className:"text-gray-400 text-sm",children:"最高分"}),r.jsx("div",{className:"text-white text-2xl font-bold",children:i})]})]}),r.jsx("div",{className:"relative bg-gray-800 p-2 rounded-lg select-none",onTouchStart:D,onTouchEnd:M,children:r.jsx("div",{className:"grid grid-cols-4 gap-2",children:t.map((E,P)=>E.map((O,A)=>r.jsxs("div",{className:"aspect-square relative",children:[r.jsx("div",{className:"absolute inset-0 bg-gray-700 rounded"}),r.jsx(be,{mode:"popLayout",children:O!==null&&r.jsx(q.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:`absolute inset-0 ${B(O)} rounded flex items-center justify-center text-white font-bold ${O&&O>=128?"text-2xl":"text-3xl"} ${O&&O>=1024?"text-xl":""}`,children:O},`tile-${P}-${A}-${O}`)})]},`${P}-${A}`)))})}),r.jsxs("div",{className:"mt-6 text-center text-gray-400 text-sm",children:[r.jsx("p",{children:"使用方向键或滑动来移动方块"}),r.jsx("p",{children:"相同数字的方块会合并"})]}),r.jsx(be,{children:(l||d)&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50",children:r.jsxs(q.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},className:"bg-gray-800 p-8 rounded-xl text-center max-w-sm w-full",children:[d?r.jsxs(r.Fragment,{children:[r.jsx(Dt,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"恭喜获胜！"}),r.jsx("p",{className:"text-gray-400 mb-6",children:"你达到了2048！"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"游戏结束"}),r.jsxs("p",{className:"text-gray-400 mb-6",children:["最终得分：",n]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:C,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"返回首页"})]})]})})})]})})},Gt=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#FFD93D"],xe=8,Rs=2,Iu=()=>{const e=Ke(),[t,s]=g.useState([]),[n,o]=g.useState(0),[i,a]=g.useState(0),[l,c]=g.useState(1e3),[d,u]=g.useState(1),[h,p]=g.useState(!1),[x,S]=g.useState(new Set),[b,w]=g.useState(0),[D,M]=g.useState(!1),[C,B]=g.useState(()=>{const k=localStorage.getItem("colortouch-high-score");return k?parseInt(k):0}),E=g.useRef(0),P=g.useCallback(()=>{const k=[];for(let j=0;j<xe;j++){k[j]=[];for(let m=0;m<xe;m++)k[j][m]={color:Gt[Math.floor(Math.random()*Math.min(3+Math.floor(d/2),Gt.length))],id:E.current++}}return k},[d]),O=g.useCallback(()=>{s(P()),o(0),a(0),c(1e3*d),p(!1),S(new Set),w(0)},[P,d]);g.useEffect(()=>{O()},[O]);const A=g.useCallback((k,j,m,L)=>{var G,y;const U=`${k}-${j}`;if(k<0||k>=xe||j<0||j>=xe||L.has(U)||!((G=t[k])!=null&&G[j])||((y=t[k][j])==null?void 0:y.color)!==m)return[];L.add(U);const W=[U];return W.push(...A(k-1,j,m,L)),W.push(...A(k+1,j,m,L)),W.push(...A(k,j-1,m,L)),W.push(...A(k,j+1,m,L)),W},[t]),v=g.useCallback((k,j)=>{var W;if(h||!((W=t[k])!=null&&W[j]))return;const m=t[k][j].color,U=A(k,j,m,new Set);U.length>=Rs&&(S(new Set(U)),setTimeout(()=>{const G=t.map(f=>[...f]);U.forEach(f=>{const[N,R]=f.split("-").map(Number);G[N][R]=null});const y=U.length*U.length*10;o(f=>f+y),a(f=>f+1),U.length>=5&&(w(f=>f+1),M(!0),setTimeout(()=>M(!1),1e3));for(let f=0;f<xe;f++){const N=[];for(let R=xe-1;R>=0;R--)G[R][f]&&N.push(G[R][f]);for(;N.length<xe;)N.push({color:Gt[Math.floor(Math.random()*Math.min(3+Math.floor(d/2),Gt.length))],id:E.current++});for(let R=0;R<xe;R++)G[xe-1-R][f]=N[R]}s(G),S(new Set),T(G)},300))},[t,h,A,d]),T=g.useCallback(k=>{var m;if(n>=l){u(L=>L+1),c(L=>L+1e3);return}let j=!1;for(let L=0;L<xe;L++){for(let U=0;U<xe;U++)if((m=k[L])!=null&&m[U]){const W=k[L][U].color;if(A(L,U,W,new Set).length>=Rs){j=!0;break}}if(j)break}j||(p(!0),n>C&&(B(n),localStorage.setItem("colortouch-high-score",n.toString())))},[n,l,C,A]),I=()=>{u(1),O()},V=g.useCallback(()=>{var k;for(let j=0;j<xe;j++)for(let m=0;m<xe;m++)if((k=t[j])!=null&&k[m]){const L=t[j][m].color,W=A(j,m,L,new Set);if(W.length>=Rs){S(new Set(W)),setTimeout(()=>S(new Set),1e3);return}}},[t,A]);return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-pink-800 to-orange-700 flex flex-col items-center justify-center p-4",children:r.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:[r.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-t-2xl p-4 border-t border-l border-r border-white/20",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-white/80 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"颜色消消乐"}),r.jsx("button",{onClick:I,className:"p-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors",children:r.jsx(Qe,{size:18})})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"bg-white/10 rounded-lg p-2 text-center",children:[r.jsx("div",{className:"text-white/60 text-xs font-game",children:"得分"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:n})]}),r.jsxs("div",{className:"bg-white/10 rounded-lg p-2 text-center",children:[r.jsxs("div",{className:"text-white/60 text-xs font-game flex items-center justify-center gap-1",children:[r.jsx(di,{size:10}),"目标"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-300 font-game",children:l})]}),r.jsxs("div",{className:"bg-white/10 rounded-lg p-2 text-center",children:[r.jsxs("div",{className:"text-white/60 text-xs font-game flex items-center justify-center gap-1",children:[r.jsx(Dt,{size:10}),"最高"]}),r.jsx("div",{className:"text-xl font-bold text-orange-300 font-game",children:C})]})]}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"bg-white/10 rounded-full h-3 overflow-hidden",children:r.jsx(q.div,{className:"h-full bg-gradient-to-r from-yellow-400 to-orange-400",initial:{width:0},animate:{width:`${Math.min(n/l*100,100)}%`},transition:{duration:.5}})}),r.jsxs("div",{className:"flex justify-between mt-1",children:[r.jsxs("span",{className:"text-xs text-white/60 font-game",children:["关卡 ",d]}),r.jsxs("span",{className:"text-xs text-white/60 font-game",children:["步数 ",i]})]})]})]}),r.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/20 p-4 rounded-b-2xl relative",children:[r.jsx(be,{children:D&&r.jsx(q.div,{initial:{scale:0,y:20},animate:{scale:1,y:0},exit:{scale:0,y:-20},className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50",children:r.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-6 py-3 rounded-full font-game font-bold text-xl flex items-center gap-2",children:[r.jsx(Ar,{size:24}),"连击 x",b,"!"]})})}),r.jsx("div",{className:"grid grid-cols-8 gap-1 bg-white/10 p-2 rounded-lg",children:t.map((k,j)=>k.map((m,L)=>r.jsx(q.button,{initial:{scale:0},animate:{scale:x.has(`${j}-${L}`)?.8:1,opacity:m?1:0},whileHover:{scale:m?1.1:1},whileTap:{scale:m?.9:1},onClick:()=>v(j,L),className:`aspect-square rounded-md transition-all ${m?"cursor-pointer":"cursor-default"}`,style:{backgroundColor:(m==null?void 0:m.color)||"transparent",boxShadow:m?"0 2px 8px rgba(0,0,0,0.3)":"none"},disabled:!m||h},`${j}-${L}`)))}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsxs("button",{onClick:V,className:"px-6 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-game rounded-full hover:scale-105 transition-transform flex items-center gap-2",disabled:h,children:[r.jsx(Ar,{size:16}),"提示"]})}),h&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/70 backdrop-blur-sm rounded-b-2xl flex items-center justify-center",children:r.jsxs("div",{className:"text-center p-6",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-white mb-2",children:"游戏结束!"}),r.jsx("p",{className:"text-xl font-game text-white/80 mb-1",children:"最终得分"}),r.jsx("p",{className:"text-4xl font-game font-bold text-yellow-400 mb-4",children:n}),n>C&&r.jsx("p",{className:"text-lg font-game text-orange-400 mb-4",children:"🎉 新纪录!"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("button",{onClick:I,className:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-game rounded-lg hover:scale-105 transition-transform",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"w-full px-6 py-3 bg-white/20 text-white font-game rounded-lg hover:bg-white/30 transition-colors",children:"返回主页"})]})]})})]}),r.jsxs("div",{className:"mt-4 text-center text-white/60 text-sm font-game",children:[r.jsx("p",{children:"点击相同颜色的相邻方块进行消除"}),r.jsx("p",{children:"连续消除更多方块获得高分!"})]})]})})},nt=10,yt=20,Fu=800,Bu=50,rt={I:{shape:[[1,1,1,1]],color:"from-cyan-400 to-cyan-600"},O:{shape:[[1,1],[1,1]],color:"from-yellow-400 to-yellow-600"},T:{shape:[[0,1,0],[1,1,1]],color:"from-purple-400 to-purple-600"},S:{shape:[[0,1,1],[1,1,0]],color:"from-green-400 to-green-600"},Z:{shape:[[1,1,0],[0,1,1]],color:"from-red-400 to-red-600"},J:{shape:[[1,0,0],[1,1,1]],color:"from-blue-400 to-blue-600"},L:{shape:[[0,0,1],[1,1,1]],color:"from-orange-400 to-orange-600"}},Ou=()=>{const e=Ke(),t=g.useRef(null),[s,n]=g.useState(()=>Array(yt).fill(null).map(()=>Array(nt).fill(null))),[o,i]=g.useState(null),[a,l]=g.useState("T"),[c,d]=g.useState(0),[u,h]=g.useState(0),[p,x]=g.useState(1),[S,b]=g.useState(!1),[w,D]=g.useState(!1),[M,C]=g.useState(()=>{const f=localStorage.getItem("tetris-high-score");return f?parseInt(f):0}),[B,E]=g.useState(null),P=g.useRef(0),O=()=>{const f=Object.keys(rt);return f[Math.floor(Math.random()*f.length)]},A=f=>{const N=f.length,R=f[0].length,F=Array(R).fill(null).map(()=>Array(N).fill(0));for(let $=0;$<N;$++)for(let H=0;H<R;H++)F[H][N-1-$]=f[$][H];return F},v=(f,N)=>{for(let R=0;R<N.shape.length;R++)for(let F=0;F<N.shape[R].length;F++)if(N.shape[R][F]){const $=N.position.x+F,H=N.position.y+R;if($<0||$>=nt||H>=yt||H>=0&&f[H][$])return!0}return!1},T=(f,N)=>{const R=f.map($=>[...$]),F=rt[N.type].color;for(let $=0;$<N.shape.length;$++)for(let H=0;H<N.shape[$].length;H++)if(N.shape[$][H]){const X=N.position.y+$,Y=N.position.x+H;X>=0&&(R[X][Y]=F)}return R},I=f=>{let N=[...f],R=0;for(let F=yt-1;F>=0;F--)N[F].every($=>$!==null)&&(N.splice(F,1),N.unshift(Array(nt).fill(null)),R++,F++);return{board:N,linesCleared:R}},V=f=>{const N=rt[f].shape;return{type:f,shape:N,position:{x:Math.floor((nt-N[0].length)/2),y:0}}},k=g.useCallback((f,N)=>{if(!o||!w||S)return!1;const R={x:o.position.x+f,y:o.position.y+N},F={...o,position:R};return v(s,F)?!1:(i(F),!0)},[o,s,w,S]),j=g.useCallback(()=>{if(!o||!w||S)return;const f=A(o.shape),N={...o,shape:f};if(!v(s,N))i(N);else for(const R of[1,-1,2,-2]){const F={...N,position:{...N.position,x:N.position.x+R}};if(!v(s,F)){i(F);break}}},[o,s,w,S]),m=g.useCallback(()=>{if(!o||!w||S)return;let f=0;for(;k(0,1);)f++;d(N=>N+f*2)},[o,w,S,k]);g.useEffect(()=>{if(!w||S||!o)return;const f=Math.max(100,Fu-(p-1)*Bu),N=setInterval(()=>{if(!k(0,1)){const R=T(s,o),{board:F,linesCleared:$}=I(R);n(F),$>0&&(h(X=>X+$),d(X=>X+$*100*p),x(Math.floor((u+$)/10)+1));const H=V(a);v(F,H)?(b(!0),D(!1),c>M&&(C(c),localStorage.setItem("tetris-high-score",c.toString()))):(i(H),l(O()))}},f);return()=>clearInterval(N)},[o,s,w,S,a,k,p,u,c,M]),g.useEffect(()=>{const f=N=>{if(!w||S){N.key===" "&&(N.preventDefault(),S?G():y());return}const R=Date.now(),F=R-P.current;switch(N.key){case"ArrowLeft":case"a":case"A":F>50&&(k(-1,0),P.current=R);break;case"ArrowRight":case"d":case"D":F>50&&(k(1,0),P.current=R);break;case"ArrowDown":case"s":case"S":k(0,1),d($=>$+1);break;case"ArrowUp":case"w":case"W":j();break;case" ":N.preventDefault(),m();break;case"p":case"P":D($=>!$);break}};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[w,S,k,j,m]);const L=f=>{const N=f.touches[0];E({x:N.clientX,y:N.clientY})},U=f=>{if(!B||!w||S)return;const N=f.changedTouches[0],R=N.clientX-B.x,F=N.clientY-B.y;Math.abs(R)>Math.abs(F)?Math.abs(R)>30&&(R>0?k(1,0):k(-1,0)):F>50?(k(0,1),d($=>$+1)):F<-30&&j(),E(null)},W=()=>{w&&!S&&j()},G=()=>{n(Array(yt).fill(null).map(()=>Array(nt).fill(null))),i(null),l(O()),d(0),h(0),x(1),b(!1),D(!1)},y=()=>{if(S&&G(),D(!0),!o){const f=V(a);i(f),l(O())}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsx("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"俄罗斯方块"}),r.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]})}),r.jsx("div",{className:"bg-gray-900 border border-gray-700 p-4 rounded-b-xl",children:r.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[r.jsxs("div",{ref:t,className:"relative bg-gray-800 rounded-lg p-2",onTouchStart:L,onTouchEnd:U,onClick:W,children:[r.jsxs("div",{className:"grid grid-cols-10 gap-px bg-gray-700",style:{width:"240px"},children:[s.map((f,N)=>f.map((R,F)=>r.jsx("div",{className:`w-6 h-6 ${R?`bg-gradient-to-br ${R}`:"bg-gray-900"} ${R?"border border-gray-600":""}`},`${N}-${F}`))),o&&o.shape.map((f,N)=>f.map((R,F)=>{if(!R)return null;const $=o.position.y+N,H=o.position.x+F;return $<0||$>=yt||H<0||H>=nt?null:r.jsx(q.div,{initial:{scale:0},animate:{scale:1},className:`absolute w-6 h-6 bg-gradient-to-br ${rt[o.type].color} border border-gray-600`,style:{left:`${H*24+H}px`,top:`${$*24+$}px`}},`current-${N}-${F}`)}))]}),(!w||S)&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/70 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-center p-4",children:S?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-2",children:["得分: ",c]}),c>M&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新纪录!"}),r.jsx("button",{onClick:G,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:c===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:y,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(ns,{size:20}),c===0?"开始游戏":"继续"]})]})})})]}),r.jsxs("div",{className:"flex-1 space-y-4",children:[r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[r.jsx("h3",{className:"text-sm font-game text-gray-400 mb-2",children:"下一个"}),r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"grid gap-px bg-gray-700 p-1",children:rt[a].shape.map((f,N)=>r.jsx("div",{className:"flex gap-px",children:f.map((R,F)=>r.jsx("div",{className:`w-5 h-5 ${R?`bg-gradient-to-br ${rt[a].color} border border-gray-600`:""}`},F))},N))})})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 space-y-3",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"分数"}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:c})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"行数"}),r.jsx("div",{className:"text-xl font-bold text-blue-400 font-game",children:u})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"等级"}),r.jsx("div",{className:"text-xl font-bold text-green-400 font-game",children:p})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center gap-1",children:[r.jsx(Dt,{size:14}),"最高分"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:M})]})]}),r.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 text-xs text-gray-400 font-game space-y-1",children:[r.jsx("p",{children:"← → 或 A/D: 左右移动"}),r.jsx("p",{children:"↓ 或 S: 加速下落"}),r.jsx("p",{children:"↑ 或 W: 旋转"}),r.jsx("p",{children:"空格: 硬降"}),r.jsx("p",{children:"P: 暂停"}),r.jsx("p",{className:"text-purple-400",children:"手机: 滑动或点击旋转"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 lg:hidden",children:[r.jsx("button",{onClick:()=>k(-1,0),className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!w||S,children:r.jsx(iu,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:j,className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!w||S,children:r.jsx(Tu,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:()=>k(1,0),className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!w||S,children:r.jsx(lu,{size:20,className:"mx-auto text-white"})}),r.jsx("button",{onClick:()=>{k(0,1),d(f=>f+1)},className:"col-span-3 p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",disabled:!w||S,children:r.jsx(ru,{size:20,className:"mx-auto text-white"})})]}),r.jsx("button",{onClick:()=>w?D(!1):y(),className:`w-full px-6 py-3 ${w?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center justify-center gap-2`,children:w?r.jsxs(r.Fragment,{children:[r.jsx(ci,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(ns,{size:20}),S||c===0?"开始游戏":"继续"]})})]})]})})]})})};let se=null,_t=!1;const zu=(e,t,s,n,o,i,a,l,c)=>{const[d,u]=g.useState(_t);return g.useEffect(()=>{if(se)u(_t);else{let M;M="http://socket.qingfengyueying.xyz",console.log("TicTacToe - Connecting to:",M),se=Ys(M,{transports:["websocket","polling"],upgrade:!0,path:"/socket.io/",timeout:1e4,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),se.on("connect",()=>{console.log("TicTacToe socket connected"),_t=!0,u(!0)}),se.on("disconnect",()=>{console.log("TicTacToe socket disconnected"),_t=!1,u(!1)}),se.on("ttt-game-start",C=>{console.log("TicTacToe game start:",C),e(C)}),se.on("ttt-opponent-move",C=>{console.log("TicTacToe opponent move:",C),t(C)}),se.on("ttt-game-end",C=>{console.log("TicTacToe game end:",C),s(C)}),se.on("ttt-room-joined",C=>{console.log("TicTacToe room joined:",C),n(C)}),se.on("ttt-room-created",C=>{console.log("TicTacToe room created:",C),n(C)}),se.on("ttt-player-joined",C=>{console.log("TicTacToe player joined:",C),o(C)}),se.on("ttt-player-left",C=>{console.log("TicTacToe player left:",C),i(C)}),se.on("ttt-restart-request",()=>{console.log("TicTacToe restart request"),a()}),se.on("ttt-game-restart",()=>{console.log("TicTacToe game restart"),l()}),se.on("ttt-error",C=>{console.error("TicTacToe error:",C.message),c(C.message)})}return()=>{}},[e,t,s,n,o,i,a,l,c]),{socket:se,connected:d,joinRoom:(M,C)=>{se&&C==="online"&&(console.log("Joining TicTacToe room:",M),se.emit("ttt-join-room",{roomId:M}))},createRoom:M=>{se&&M==="online"&&(console.log("Creating TicTacToe room"),se.emit("ttt-create-room"))},makeMove:(M,C,B)=>{se&&(console.log("Making TicTacToe move:",{roomId:M,row:C,col:B}),se.emit("ttt-make-move",{roomId:M,row:C,col:B}))},requestRestart:M=>{se&&(console.log("Requesting TicTacToe restart:",M),se.emit("ttt-request-restart",{roomId:M}))},acceptRestart:M=>{se&&(console.log("Accepting TicTacToe restart:",M),se.emit("ttt-accept-restart",{roomId:M}))},rejectRestart:M=>{se&&(console.log("Rejecting TicTacToe restart:",M),se.emit("ttt-reject-restart",{roomId:M}))},leaveRoom:M=>{se&&(console.log("Leaving TicTacToe room:",M),se.emit("ttt-leave-room",{roomId:M}))}}},$u=()=>{const e=Ke(),[t,s]=g.useState(()=>Array(3).fill(null).map(()=>Array(3).fill(null))),[n,o]=g.useState("X"),[i,a]=g.useState(null),[l,c]=g.useState(null),[d,u]=g.useState("waiting"),[h,p]=g.useState(null),[x,S]=g.useState([]),[b,w]=g.useState(""),[D,M]=g.useState({X:0,O:0,draws:0}),[C,B]=g.useState(!1),[E,P]=g.useState(!1),[O,A]=g.useState(!1),[v,T]=g.useState(""),{connected:I,joinRoom:V,createRoom:k,makeMove:j,requestRestart:m,acceptRestart:L,rejectRestart:U,leaveRoom:W}=zu(z=>{a(z.playerSymbol),u("playing"),o("X"),F(),T("游戏开始！你是 "+z.playerSymbol)},z=>{const K=[...t];K[z.row][z.col]=n,s(K);const _=G(K);_.winner?N(_.winner,_.line):o(n==="X"?"O":"X")},z=>{p(z.winner),u("finished"),R(z.winner)},z=>{w(z.roomId),P(!z.isHost),T(z.isHost?"房间创建成功，等待对手加入...":"成功加入房间")},()=>{P(!1),T("对手已加入，游戏即将开始")},()=>{T("对手已离开"),u("waiting"),P(!0)},()=>{B(!0),T("对手请求重新开始")},()=>{$(),T("游戏重新开始")},z=>{T(z)}),G=z=>{for(let _=0;_<3;_++)if(z[_][0]&&z[_][0]===z[_][1]&&z[_][1]===z[_][2])return{winner:z[_][0],line:[[_,0],[_,1],[_,2]]};for(let _=0;_<3;_++)if(z[0][_]&&z[0][_]===z[1][_]&&z[1][_]===z[2][_])return{winner:z[0][_],line:[[0,_],[1,_],[2,_]]};return z[0][0]&&z[0][0]===z[1][1]&&z[1][1]===z[2][2]?{winner:z[0][0],line:[[0,0],[1,1],[2,2]]}:z[0][2]&&z[0][2]===z[1][1]&&z[1][1]===z[2][0]?{winner:z[0][2],line:[[0,2],[1,1],[2,0]]}:z.every(_=>_.every(Q=>Q!==null))?{winner:"draw",line:[]}:{winner:null,line:[]}},y=g.useCallback(()=>{d!=="playing"||n!=="O"||setTimeout(()=>{const z=[];for(let _=0;_<3;_++)for(let Q=0;Q<3;Q++)t[_][Q]||z.push([_,Q]);if(z.length===0)return;let K=null;for(const[_,Q]of z){const ee=t.map(re=>[...re]);if(ee[_][Q]="O",G(ee).winner==="O"){K=[_,Q];break}}if(!K)for(const[_,Q]of z){const ee=t.map(re=>[...re]);if(ee[_][Q]="X",G(ee).winner==="X"){K=[_,Q];break}}if(!K&&!t[1][1]&&(K=[1,1]),!K){const Q=[[0,0],[0,2],[2,0],[2,2]].filter(([ee,re])=>!t[ee][re]);Q.length>0&&(K=Q[Math.floor(Math.random()*Q.length)])}K||(K=z[Math.floor(Math.random()*z.length)]),K&&f(K[0],K[1])},500)},[t,n,d]),f=(z,K)=>{if(d!=="playing"||t[z][K]||h||l==="online"&&n!==i)return;const _=[...t];_[z][K]=n,s(_),l==="online"&&b&&j(b,z,K);const Q=G(_);Q.winner?N(Q.winner,Q.line):o(n==="X"?"O":"X")},N=(z,K=[])=>{p(z),S(K),u("finished"),R(z),T(z==="draw"?"平局！":`${l==="single"?z==="X"?"你":"电脑":z===i?"你":"对手"}获胜！`)},R=z=>{z==="draw"?M(K=>({...K,draws:K.draws+1})):z&&M(K=>({...K,[z]:K[z]+1}))},F=()=>{s(Array(3).fill(null).map(()=>Array(3).fill(null))),p(null),S([])},$=()=>{F(),o("X"),u(l?"playing":"waiting"),B(!1)},H=z=>{c(z),$(),z==="single"?(a("X"),u("playing")):z==="online"&&k("online")},X=()=>{const z=prompt("请输入房间号:");z&&(w(z.toUpperCase()),V(z.toUpperCase(),"online"),c("online"))},Y=()=>{navigator.clipboard.writeText(b),A(!0),setTimeout(()=>A(!1),2e3)},te=()=>{l==="online"&&b&&W(b),c(null),u("waiting"),F(),w(""),a(null)};return g.useEffect(()=>{l==="single"&&d==="playing"&&n==="O"&&!h&&y()},[l,d,n,h,y]),g.useEffect(()=>{if(v){const z=setTimeout(()=>T(""),3e3);return()=>clearTimeout(z)}},[v]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-lg",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>l?te():e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:l?"菜单":"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"井字棋"}),d==="playing"&&r.jsxs("button",{onClick:$,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]}),l&&r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsxs("div",{className:"text-blue-400 font-game flex items-center justify-center gap-1",children:[r.jsx(As,{size:16}),l==="single"?"玩家":"X"]}),r.jsx("div",{className:"text-xl font-bold text-white",children:D.X})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsx("div",{className:"text-gray-400 font-game",children:"平局"}),r.jsx("div",{className:"text-xl font-bold text-white",children:D.draws})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-2",children:[r.jsxs("div",{className:"text-red-400 font-game flex items-center justify-center gap-1",children:[r.jsx(Ms,{size:16}),l==="single"?"电脑":"O"]}),r.jsx("div",{className:"text-xl font-bold text-white",children:D.O})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsx(be,{children:v&&r.jsx(q.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-4 p-3 bg-blue-600/20 border border-blue-600 rounded-lg text-blue-400 text-center font-game",children:v})}),!l&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-game text-white text-center mb-6",children:"选择游戏模式"}),r.jsxs("button",{onClick:()=>H("single"),className:"w-full p-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all flex items-center justify-center gap-3",children:[r.jsx(wu,{size:24}),r.jsx("span",{className:"font-game text-lg",children:"单机对战"})]}),r.jsxs("button",{onClick:()=>H("online"),disabled:!I,className:`w-full p-4 ${I?"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800":"bg-gray-700 cursor-not-allowed opacity-50"} text-white rounded-lg transition-all flex items-center justify-center gap-3`,children:[r.jsx(Du,{size:24}),r.jsx("span",{className:"font-game text-lg",children:"在线对战"}),!I&&r.jsx("span",{className:"text-xs",children:"(未连接)"})]}),r.jsx("button",{onClick:X,disabled:!I,className:`w-full p-4 ${I?"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800":"bg-gray-700 cursor-not-allowed opacity-50"} text-white rounded-lg transition-all flex items-center justify-center gap-3`,children:r.jsx("span",{className:"font-game text-lg",children:"加入房间"})})]}),l==="online"&&b&&r.jsxs("div",{className:"mb-4 p-3 bg-gray-800 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-gray-400 font-game",children:"房间号:"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-white font-game font-bold text-lg",children:b}),r.jsx("button",{onClick:Y,className:"p-1 hover:bg-gray-700 rounded transition-colors",children:O?r.jsx(li,{size:16,className:"text-green-400"}):r.jsx(mu,{size:16,className:"text-gray-400"})})]})]}),E&&r.jsx("div",{className:"mt-2 text-yellow-400 text-sm font-game animate-pulse",children:"等待对手加入..."})]}),l&&r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-800 p-4 rounded-lg",children:t.map((z,K)=>z.map((_,Q)=>{const ee=x.some(([re,he])=>re===K&&he===Q);return r.jsx(q.button,{whileHover:{scale:_?1:1.05},whileTap:{scale:.95},onClick:()=>f(K,Q),disabled:!!_||d!=="playing"||l==="online"&&n!==i,className:`
                          h-24 sm:h-28 bg-gray-900 rounded-lg border-2 transition-all
                          ${_?"border-gray-600":"border-gray-700 hover:border-gray-500"}
                          ${ee?"bg-green-900/30 border-green-500":""}
                          ${!_&&d==="playing"&&(l==="single"||n===i)?"cursor-pointer":"cursor-not-allowed"}
                          flex items-center justify-center
                        `,children:r.jsx(be,{children:_&&r.jsx(q.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},className:`text-5xl sm:text-6xl font-bold ${_==="X"?"text-blue-400":"text-red-400"}`,children:_==="X"?r.jsx(As,{size:48}):r.jsx(Ms,{size:48})})})},`${K}-${Q}`)}))}),d==="playing"&&!h&&r.jsxs("div",{className:"mt-4 text-center",children:[r.jsx("span",{className:"text-gray-400 font-game",children:"当前回合: "}),r.jsx("span",{className:`font-game font-bold text-lg ${n==="X"?"text-blue-400":"text-red-400"}`,children:l==="single"?n==="X"?"你":"电脑":l==="online"&&n===i?"你":n})]}),d==="finished"&&h&&r.jsx(q.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsxs("div",{className:"text-center p-6",children:[h==="draw"?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-yellow-400 mb-4",children:"平局!"}),r.jsx("p",{className:"text-white font-game mb-4",children:"势均力敌"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:l==="single"?h==="X"?"你赢了!":"电脑赢了!":h===i?"你赢了!":"对手赢了!"}),r.jsx("div",{className:`text-5xl mb-4 ${h==="X"?"text-blue-400":"text-red-400"}`,children:h==="X"?r.jsx(As,{size:60}):r.jsx(Ms,{size:60})})]}),r.jsx("button",{onClick:l==="online"?()=>m(b):$,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"再来一局"})]})})]}),C&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700 max-w-sm",children:[r.jsx("h3",{className:"text-xl font-game text-white mb-4",children:"对手请求重新开始"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{L(b),B(!1)},className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"同意"}),r.jsx("button",{onClick:()=>{U(b),B(!1)},className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"拒绝"})]})]})})]})]})})},Uu=["🎮","🎯","🎲","🎨","🎪","🎭","🎰","🎸","🏀","⚽","🏈","🎾","🎱","🏆","🎪","🎨"],Hu=()=>{const e=Ke(),[t,s]=g.useState([]),[n,o]=g.useState([]),[i,a]=g.useState(0),[l,c]=g.useState(0),[d,u]=g.useState(!1),[h,p]=g.useState(!1),[x,S]=g.useState("medium"),[b,w]=g.useState(0),[D,M]=g.useState(0),[C,B]=g.useState(()=>{const j=localStorage.getItem("memory-best-scores");return j?JSON.parse(j):{easy:{moves:1/0,time:1/0},medium:{moves:1/0,time:1/0},hard:{moves:1/0,time:1/0}}}),E=j=>{switch(j){case"easy":return 8;case"medium":return 12;case"hard":return 16;default:return 12}},P=g.useCallback(()=>{const j=E(x),m=Uu.slice(0,j/2),L=[];m.forEach((U,W)=>{L.push({id:W*2,emoji:U,isFlipped:!1,isMatched:!1},{id:W*2+1,emoji:U,isFlipped:!1,isMatched:!1})});for(let U=L.length-1;U>0;U--){const W=Math.floor(Math.random()*(U+1));[L[U],L[W]]=[L[W],L[U]]}s(L),o([]),a(0),c(0),p(!1),u(!1),M(0)},[x]),O=j=>{d||(u(!0),w(Date.now()));const m=t.find(W=>W.id===j);if(!m||m.isFlipped||m.isMatched||n.length>=2)return;const L=t.map(W=>W.id===j?{...W,isFlipped:!0}:W);s(L);const U=[...n,j];o(U),U.length===2&&(a(i+1),A(U))},A=j=>{const[m,L]=j,U=t.find(G=>G.id===m),W=t.find(G=>G.id===L);U&&W&&U.emoji===W.emoji?setTimeout(()=>{s(y=>y.map(f=>f.id===m||f.id===L?{...f,isMatched:!0}:f)),c(l+1),o([]);const G=E(x);l+1===G/2&&v()},500):setTimeout(()=>{s(G=>G.map(y=>y.id===m||y.id===L?{...y,isFlipped:!1}:y)),o([])},1e3)},v=()=>{const j=Date.now(),m=Math.floor((j-b)/1e3);M(m),p(!0);const L=C[x];if(i<L.moves||m<L.time){const U={...C,[x]:{moves:Math.min(i,L.moves),time:Math.min(m,L.time)}};B(U),localStorage.setItem("memory-best-scores",JSON.stringify(U))}},T=()=>{P()},I=j=>{S(j),u(!1),p(!1)};g.useEffect(()=>{let j;return d&&!h&&(j=setInterval(()=>{M(Math.floor((Date.now()-b)/1e3))},1e3)),()=>clearInterval(j)},[d,h,b]),g.useEffect(()=>{P()},[P]);const V=j=>{const m=Math.floor(j/60),L=j%60;return`${m}:${L.toString().padStart(2,"0")}`},k=()=>{switch(x){case"easy":return"grid-cols-4";case"medium":return"grid-cols-4";case"hard":return"grid-cols-4";default:return"grid-cols-4"}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"记忆翻牌"}),r.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重新开始"})]})]}),r.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["easy","medium","hard"].map(j=>r.jsx("button",{onClick:()=>I(j),className:`px-4 py-2 rounded-lg font-game transition-all ${x===j?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,children:j==="easy"?"简单":j==="medium"?"中等":"困难"},j))}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(di,{size:14}),"步数"]}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:i})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Au,{size:14}),"时间"]}),r.jsx("div",{className:"text-2xl font-bold text-white font-game",children:V(D)})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"匹配"}),r.jsxs("div",{className:"text-2xl font-bold text-green-400 font-game",children:[l,"/",E(x)/2]})]})]}),C[x].moves!==1/0&&r.jsxs("div",{className:"mt-4 p-3 bg-gray-700/30 rounded-lg flex justify-center gap-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-gray-400 text-xs font-game",children:"最少步数"}),r.jsx("div",{className:"text-yellow-400 font-game font-bold",children:C[x].moves})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-gray-400 text-xs font-game flex items-center gap-1",children:[r.jsx(Dt,{size:12}),"最快时间"]}),r.jsx("div",{className:"text-yellow-400 font-game font-bold",children:V(C[x].time)})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsx("div",{className:`grid ${k()} gap-3 max-w-2xl mx-auto`,children:t.map(j=>r.jsx(q.div,{whileHover:{scale:j.isFlipped||j.isMatched?1:1.05},whileTap:{scale:.95},className:"aspect-square",children:r.jsxs("button",{onClick:()=>O(j.id),disabled:j.isFlipped||j.isMatched,className:"w-full h-full relative preserve-3d",style:{transformStyle:"preserve-3d",transform:j.isFlipped||j.isMatched?"rotateY(180deg)":"rotateY(0deg)",transition:"transform 0.6s"},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600 to-purple-800 rounded-lg border-2 border-purple-500 flex items-center justify-center backface-hidden",style:{backfaceVisibility:"hidden"},children:r.jsx("span",{className:"text-3xl sm:text-4xl",children:"❓"})}),r.jsx("div",{className:`absolute inset-0 ${j.isMatched?"bg-gradient-to-br from-green-600 to-green-800 border-green-500":"bg-gradient-to-br from-blue-600 to-blue-800 border-blue-500"} rounded-lg border-2 flex items-center justify-center`,style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:r.jsx(q.span,{className:"text-4xl sm:text-5xl",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:j.emoji})})]})},j.id))}),r.jsx(be,{children:h&&r.jsx(q.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs(q.div,{initial:{y:50},animate:{y:0},className:"bg-gray-800 p-8 rounded-xl border border-gray-700 text-center max-w-md",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:"🎉 完成!"}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("p",{className:"text-white font-game",children:["用时: ",r.jsx("span",{className:"text-yellow-400",children:V(D)})]}),r.jsxs("p",{className:"text-white font-game",children:["步数: ",r.jsx("span",{className:"text-yellow-400",children:i})]}),i<=C[x].moves&&r.jsx("p",{className:"text-green-400 font-game",children:"🏆 新记录!"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:T,className:"flex-1 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"再玩一次"}),r.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-game rounded-lg transition-colors",children:"返回主页"})]})]})})})]})]})})},Rr=e=>{const t=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]],s=e==="easy"?30:e==="medium"?40:50,n=t.map(i=>i.map(a=>({value:a,isFixed:!0,isError:!1,notes:[]})));let o=0;for(;o<s;){const i=Math.floor(Math.random()*9),a=Math.floor(Math.random()*9);n[i][a].value!==null&&(n[i][a]={value:null,isFixed:!1,isError:!1,notes:[]},o++)}return n},Gu=()=>{const e=Ke(),[t,s]=g.useState(()=>Rr("easy")),[n,o]=g.useState(null),[i,a]=g.useState("easy"),[l,c]=g.useState(0),[d,u]=g.useState(3),[h,p]=g.useState(!1),[x,S]=g.useState(!1),[b]=g.useState(Date.now()),[w,D]=g.useState(0),M=(v,T,I,V)=>{for(let m=0;m<9;m++)if(m!==I&&v[T][m].value===V)return!1;for(let m=0;m<9;m++)if(m!==T&&v[m][I].value===V)return!1;const k=Math.floor(T/3)*3,j=Math.floor(I/3)*3;for(let m=0;m<3;m++)for(let L=0;L<3;L++)if((k+m!==T||j+L!==I)&&v[k+m][j+L].value===V)return!1;return!0},C=v=>{if(!n||t[n.row][n.col].isFixed)return;const T=t.map(V=>V.map(k=>({...k}))),I=T[n.row][n.col];if(h)I.notes.includes(v)?I.notes=I.notes.filter(V=>V!==v):I.notes.push(v),I.value=null;else{const V=M(T,n.row,n.col,v);I.value=v,I.notes=[],I.isError=!V,V||c(l+1)}s(T),P(T)},B=()=>{if(!n||t[n.row][n.col].isFixed)return;const v=t.map(T=>T.map(I=>({...I})));v[n.row][n.col]={value:null,isFixed:!1,isError:!1,notes:[]},s(v)},E=()=>{if(d<=0||!n||t[n.row][n.col].isFixed)return;const v=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]],T=t.map(I=>I.map(V=>({...V})));T[n.row][n.col]={value:v[n.row][n.col],isFixed:!1,isError:!1,notes:[]},s(T),u(d-1),P(T)},P=v=>{v.every((I,V)=>I.every((k,j)=>k.value!==null&&!k.isError&&M(v,V,j,k.value)))&&S(!0)},O=v=>{s(Rr(v||i)),o(null),c(0),u(3),p(!1),S(!1),v&&a(v)};g.useEffect(()=>{const v=setInterval(()=>{D(Math.floor((Date.now()-b)/1e3))},1e3);return()=>clearInterval(v)},[b]),g.useEffect(()=>{const v=T=>{T.key>="1"&&T.key<="9"?C(parseInt(T.key)):T.key==="Delete"||T.key==="Backspace"?B():(T.key==="n"||T.key==="N")&&p(!h)};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[n,h]);const A=v=>{const T=Math.floor(v/60),I=v%60;return`${T}:${I.toString().padStart(2,"0")}`};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-indigo-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"数独"}),r.jsxs("button",{onClick:()=>O(),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"新游戏"})]})]}),r.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["easy","medium","hard"].map(v=>r.jsx("button",{onClick:()=>O(v),className:`px-4 py-2 rounded-lg font-game transition-all ${i===v?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white"}`,children:v==="easy"?"简单":v==="medium"?"中等":"困难"},v))}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"时间"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:A(w)})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(du,{size:14}),"错误"]}),r.jsx("div",{className:"text-xl font-bold text-red-400 font-game",children:l})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Mr,{size:14}),"提示"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:d})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-center justify-center",children:[r.jsx("div",{className:"bg-gray-800 p-2 rounded-lg",children:r.jsx("div",{className:"grid grid-cols-9 gap-0",children:t.map((v,T)=>v.map((I,V)=>r.jsx("button",{onClick:()=>o({row:T,col:V}),className:`
                        w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center relative
                        ${I.isFixed?"bg-gray-700":"bg-gray-900 hover:bg-gray-800"}
                        ${(n==null?void 0:n.row)===T&&(n==null?void 0:n.col)===V?"bg-blue-900":""}
                        ${I.isError?"bg-red-900/50":""}
                        ${V%3===2&&V<8?"border-r-2 border-gray-600":"border-r border-gray-700"}
                        ${T%3===2&&T<8?"border-b-2 border-gray-600":"border-b border-gray-700"}
                        transition-colors
                      `,disabled:x,children:I.value?r.jsx("span",{className:`
                          text-lg sm:text-xl font-bold
                          ${I.isFixed?"text-gray-400":I.isError?"text-red-400":"text-white"}
                        `,children:I.value}):r.jsx("div",{className:"grid grid-cols-3 gap-0 text-xs text-blue-400",children:[1,2,3,4,5,6,7,8,9].map(k=>r.jsx("span",{className:"text-[8px]",children:I.notes.includes(k)?k:""},k))})},`${T}-${V}`)))})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3,4,5,6,7,8,9].map(v=>r.jsx("button",{onClick:()=>C(v),className:"w-14 h-14 bg-gray-700 hover:bg-gray-600 text-white text-xl font-bold rounded-lg transition-colors",disabled:x,children:v},v))}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("button",{onClick:()=>p(!h),className:`w-full p-3 ${h?"bg-blue-600 hover:bg-blue-700":"bg-gray-700 hover:bg-gray-600"} text-white rounded-lg transition-colors flex items-center justify-center gap-2`,disabled:x,children:[r.jsx("span",{className:"font-game",children:"笔记模式"}),h&&r.jsx(li,{size:16})]}),r.jsxs("button",{onClick:B,className:"w-full p-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center justify-center gap-2",disabled:x,children:[r.jsx(gu,{size:16}),r.jsx("span",{className:"font-game",children:"清除"})]}),r.jsxs("button",{onClick:E,className:"w-full p-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors flex items-center justify-center gap-2",disabled:x||d<=0,children:[r.jsx(Mr,{size:16}),r.jsxs("span",{className:"font-game",children:["提示 (",d,")"]})]})]})]})]}),x&&r.jsx(q.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-gray-800 p-8 rounded-xl border border-gray-700 text-center",children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-green-400 mb-4",children:"🎉 完成!"}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("p",{className:"text-white font-game",children:["用时: ",r.jsx("span",{className:"text-yellow-400",children:A(w)})]}),r.jsxs("p",{className:"text-white font-game",children:["错误: ",r.jsx("span",{className:"text-yellow-400",children:l})]})]}),r.jsx("button",{onClick:()=>O(),className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"新游戏"})]})})]})]})})},ye=600,ke=400,Ce=100,ot=10,Wt=8,Vr=75,Dr=20,Er=10,_u=60,Wu=35,qu=5,Xu=6,Vs=[{color:"#ef4444",points:50,hits:3},{color:"#f97316",points:40,hits:2},{color:"#eab308",points:30,hits:2},{color:"#22c55e",points:20,hits:1},{color:"#06b6d4",points:10,hits:1}],Ku=()=>{const e=Ke(),t=g.useRef(null),s=g.useRef(),[n,o]=g.useState(!1),[i,a]=g.useState(!1),[l,c]=g.useState(0),[d,u]=g.useState(3),[h,p]=g.useState(1),[x,S]=g.useState(()=>{const V=localStorage.getItem("breakout-high-score");return V?parseInt(V):0}),[b,w]=g.useState({x:ye/2,y:ke-30,dx:3,dy:-3,radius:Wt}),[D,M]=g.useState({x:(ye-Ce)/2,y:ke-ot-10,width:Ce,height:ot}),[C,B]=g.useState([]),E=g.useCallback(()=>{const V=[];for(let k=0;k<qu;k++)for(let j=0;j<Xu;j++){const m=Vs[Math.min(k,Vs.length-1)];V.push({x:j*(Vr+Er)+Wu,y:k*(Dr+Er)+_u,width:Vr,height:Dr,color:m.color,points:m.points,hits:m.hits,destroyed:!1})}B(V)},[]),P=()=>{w({x:ye/2,y:ke-30,dx:3+h*.5,dy:-(3+h*.5),radius:Wt}),M({x:(ye-Ce)/2,y:ke-ot-10,width:Ce,height:ot}),E(),c(0),u(3),p(1),a(!1),o(!1)},O=()=>{w({x:ye/2,y:ke-30,dx:3+h*.5,dy:-(3+h*.5),radius:Wt}),M({x:(ye-Ce)/2,y:ke-ot-10,width:Ce,height:ot})},A=()=>{p(V=>V+1),w({x:ye/2,y:ke-30,dx:3+(h+1)*.5,dy:-(3+(h+1)*.5),radius:Wt}),E()},v=g.useCallback(()=>{if((b.x+b.radius>ye||b.x-b.radius<0)&&(b.dx=-b.dx),b.y-b.radius<0&&(b.dy=-b.dy),b.y+b.radius>ke&&u(k=>{const j=k-1;return j<=0?(a(!0),o(!1),l>x&&(S(l),localStorage.setItem("breakout-high-score",l.toString()))):O(),j}),b.x>D.x&&b.x<D.x+D.width&&b.y+b.radius>D.y&&b.y-b.radius<D.y+D.height){const k=(b.x-D.x)/D.width;b.dx=8*(k-.5),b.dy=-b.dy}let V=!0;C.forEach(k=>{if(!k.destroyed&&(V=!1,b.x>k.x&&b.x<k.x+k.width&&b.y>k.y&&b.y<k.y+k.height))if(b.dy=-b.dy,k.hits--,k.hits<=0)k.destroyed=!0,c(j=>j+k.points);else{const j=k.hits/Vs.find(m=>m.color===k.color).hits;k.color=k.color+Math.floor(j*255).toString(16).padStart(2,"0")}}),V&&A()},[b,D,C,l,x]),T=g.useCallback(()=>{if(!n||i)return;const V=t.current;if(!V)return;const k=V.getContext("2d");if(!k)return;k.clearRect(0,0,ye,ke),C.forEach(m=>{m.destroyed||(k.fillStyle=m.color,k.fillRect(m.x,m.y,m.width,m.height),k.strokeStyle="#1f2937",k.strokeRect(m.x,m.y,m.width,m.height))});const j=k.createLinearGradient(D.x,D.y,D.x,D.y+D.height);j.addColorStop(0,"#8b5cf6"),j.addColorStop(1,"#7c3aed"),k.fillStyle=j,k.fillRect(D.x,D.y,D.width,D.height),k.beginPath(),k.arc(b.x,b.y,b.radius,0,Math.PI*2),k.fillStyle="#ffffff",k.fill(),k.closePath(),b.x+=b.dx,b.y+=b.dy,v(),s.current=requestAnimationFrame(T)},[n,i,b,D,C,v]);g.useEffect(()=>{const V=k=>{if(!t.current||!n)return;const j=t.current.getBoundingClientRect(),m=k.clientX-j.left;M(L=>({...L,x:Math.max(0,Math.min(ye-Ce,m-Ce/2))}))};return window.addEventListener("mousemove",V),()=>window.removeEventListener("mousemove",V)},[n]);const I=V=>{if(!t.current||!n)return;const k=t.current.getBoundingClientRect(),j=V.touches[0].clientX-k.left;M(m=>({...m,x:Math.max(0,Math.min(ye-Ce,j-Ce/2))}))};return g.useEffect(()=>{const V=k=>{if(!n){k.key===" "&&(k.preventDefault(),o(!0));return}switch(k.key){case"ArrowLeft":case"a":case"A":M(j=>({...j,x:Math.max(0,j.x-20)}));break;case"ArrowRight":case"d":case"D":M(j=>({...j,x:Math.min(ye-Ce,j.x+20)}));break;case" ":case"p":case"P":k.preventDefault(),o(j=>!j);break}};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[n]),g.useEffect(()=>(n&&!i&&(s.current=requestAnimationFrame(T)),()=>{s.current&&cancelAnimationFrame(s.current)}),[n,i,T]),g.useEffect(()=>{E()},[E]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex flex-col items-center justify-center p-4",children:r.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-4xl",children:[r.jsxs("div",{className:"bg-gray-800/50 backdrop-blur rounded-t-xl p-4 border-t border-l border-r border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[r.jsx(Je,{size:20}),r.jsx("span",{className:"font-game",children:"返回"})]}),r.jsx("h1",{className:"text-2xl font-game font-bold text-white",children:"打砖块"}),r.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[r.jsx(Qe,{size:16}),r.jsx("span",{className:"font-game",children:"重置"})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"分数"}),r.jsx("div",{className:"text-xl font-bold text-white font-game",children:l})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(yu,{size:14}),"生命"]}),r.jsx("div",{className:"text-xl font-bold text-red-400 font-game",children:d})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsx("div",{className:"text-gray-400 text-sm font-game",children:"关卡"}),r.jsx("div",{className:"text-xl font-bold text-green-400 font-game",children:h})]}),r.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 text-center",children:[r.jsxs("div",{className:"text-gray-400 text-sm font-game flex items-center justify-center gap-1",children:[r.jsx(Dt,{size:14}),"最高分"]}),r.jsx("div",{className:"text-xl font-bold text-yellow-400 font-game",children:x})]})]})]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 p-6 rounded-b-xl",children:[r.jsxs("div",{className:"relative flex justify-center",children:[r.jsx("canvas",{ref:t,width:ye,height:ke,className:"bg-gray-800 rounded-lg border-2 border-gray-700",onTouchMove:I,style:{maxWidth:"100%",height:"auto"}}),(!n||i)&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-center p-6",children:i?r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-game font-bold text-red-400 mb-2",children:"游戏结束!"}),r.jsxs("p",{className:"text-xl font-game text-white mb-2",children:["得分: ",l]}),l>x&&r.jsx("p",{className:"text-lg font-game text-yellow-400 mb-4",children:"🎉 新记录!"}),r.jsx("button",{onClick:P,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-game rounded-lg transition-colors",children:"重新开始"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-2xl font-game font-bold text-white mb-4",children:l===0?"准备开始":"游戏暂停"}),r.jsxs("button",{onClick:()=>o(!0),className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-game rounded-lg transition-colors flex items-center gap-2 mx-auto",children:[r.jsx(ns,{size:20}),l===0?"开始游戏":"继续"]}),r.jsxs("div",{className:"mt-4 text-gray-400 text-sm font-game",children:[r.jsx("p",{children:"使用鼠标或触摸控制挡板"}),r.jsx("p",{children:"← → 或 A/D 键盘控制"}),r.jsx("p",{children:"空格键暂停/继续"})]})]})})})]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx("button",{onClick:()=>o(V=>!V),className:`px-6 py-3 ${n?"bg-orange-600 hover:bg-orange-700":"bg-green-600 hover:bg-green-700"} text-white font-game rounded-lg transition-colors flex items-center gap-2`,children:n?r.jsxs(r.Fragment,{children:[r.jsx(ci,{size:20}),"暂停"]}):r.jsxs(r.Fragment,{children:[r.jsx(ns,{size:20}),l===0?"开始":"继续"]})})})]})]})})},Yu=()=>{const e=mi(),[t,s]=g.useState(new Date);g.useEffect(()=>{const o=setInterval(()=>s(new Date),1e3);return()=>clearInterval(o)},[]);const n=e.pathname==="/";return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900",children:[r.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none -z-10",children:[...Array(window.innerWidth<768?20:50)].map((o,i)=>r.jsx(q.div,{className:"absolute w-1 h-1 bg-white opacity-30",initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{y:[null,-window.innerHeight]},transition:{duration:Math.random()*20+10,repeat:1/0,ease:"linear",delay:Math.random()*10}},i))}),r.jsx("header",{className:"relative z-1",children:r.jsx("nav",{className:"container mx-auto px-3 sm:px-4 py-2 sm:py-3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(Ds,{to:"/",className:"flex items-center space-x-2 sm:space-x-3",children:[r.jsx(q.div,{whileHover:{rotate:360},whileTap:{scale:.95},transition:{duration:.5},className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-white font-bold text-lg sm:text-xl",children:"G"})}),r.jsxs("h1",{className:"text-base sm:text-xl font-game font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:[r.jsx("span",{className:"hidden sm:inline",children:"Game Collection"}),r.jsx("span",{className:"sm:hidden",children:"游戏合集"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-6",children:[!n&&r.jsx(q.div,{whileTap:{scale:.95},transition:{duration:.1},children:r.jsxs(Ds,{to:"/",className:"pixel-btn text-xs px-2 py-1 sm:px-3 sm:py-2 flex items-center justify-center",children:[r.jsx("span",{className:"hidden sm:inline",children:"返回首页"}),r.jsx("span",{className:"sm:hidden",children:"首页"})]})}),r.jsx("div",{className:"text-xs sm:text-sm font-pixel text-gray-400 hidden sm:block",children:t.toLocaleTimeString("zh-CN")})]})]})})}),r.jsx("main",{className:"relative z-1 container mx-auto px-3 sm:px-4 py-1 sm:py-2",children:r.jsx(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:r.jsx(pi,{})},e.pathname)}),r.jsx("footer",{className:"relative z-1",children:r.jsx("div",{className:"container mx-auto px-3 sm:px-4 py-2 sm:py-3",children:r.jsx("div",{className:"text-center text-xs sm:text-sm text-gray-500 font-pixel",children:"© 2024 Game Collection"})})})]})};function Zu(){return r.jsx(gi,{children:r.jsx(be,{mode:"wait",children:r.jsx(xi,{children:r.jsxs(Te,{path:"/",element:r.jsx(Yu,{}),children:[r.jsx(Te,{index:!0,element:r.jsx(Hd,{})}),r.jsx(Te,{path:"games/gomoku",element:r.jsx(Yd,{})}),r.jsx(Te,{path:"games/2048",element:r.jsx(Lu,{})}),r.jsx(Te,{path:"games/colortouch",element:r.jsx(Iu,{})}),r.jsx(Te,{path:"games/tetris",element:r.jsx(Ou,{})}),r.jsx(Te,{path:"games/tictactoe",element:r.jsx($u,{})}),r.jsx(Te,{path:"games/memory",element:r.jsx(Hu,{})}),r.jsx(Te,{path:"games/sudoku",element:r.jsx(Gu,{})}),r.jsx(Te,{path:"games/breakout",element:r.jsx(Ku,{})})]})})})})}Es.createRoot(document.getElementById("root")).render(r.jsx(Ks.StrictMode,{children:r.jsx(Zu,{})}))});export default Ju();
//# sourceMappingURL=index-D6uph4aK.js.map
